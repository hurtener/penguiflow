const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ECharts-BatY2PA0.js","assets/ECharts-SUlEdAZf.css","assets/Mermaid-BnvApiL5.js","assets/_commonjsHelpers-CqkleIqs.js","assets/purify.es-HRjpPm7y.js","assets/Mermaid-CicnNMUS.css","assets/Plotly-CIC-wb6f.js","assets/Plotly-BnH91lxL.css","assets/DataGrid-B6T81wdI.js","assets/DataGrid-CnGdOVL9.css","assets/Json-Dd_7SWV1.js","assets/Json-BfbC447w.css","assets/Metric-D96PNo2P.js","assets/Metric-BR7LGQoy.css","assets/Markdown-DzDi7Rdh.js","assets/katex-XbL3y5x-.js","assets/Markdown-CElcD4b8.css","assets/katex-DvXFAOB1.css","assets/Code-CSPpkFJu.js","assets/Code-CVAv7leM.css","assets/Latex-D19u_OsU.js","assets/Latex-De3SCfkv.css","assets/Callout-C2E-XZZO.js","assets/Callout-B-wLDEhr.css","assets/Form-BlTJgSWQ.js","assets/Form-eWoJO6O2.css","assets/Confirm-RpLTM9UL.js","assets/Confirm-YhSN8Zxn.css","assets/SelectOption-BcYwad_A.js","assets/SelectOption-CEnDdoyK.css","assets/Report-Cw5NbLo_.js","assets/Report-DYNw1-yU.css","assets/Grid-B2hI-naX.js","assets/Grid-Cg7MxYKJ.css","assets/Tabs-De9p1fgW.js","assets/Tabs-BoGLw0iN.css","assets/Accordion-D1aPhfN2.js","assets/Accordion-2qjp3LnE.css","assets/Image-BnfUEj4W.js","assets/Image-CbfbhndX.css","assets/Html-PErmYI5d.js","assets/Html-CBo-9Zlq.css","assets/Video-Cxozw_wp.js","assets/Video-CRk6YMQD.css","assets/Embed-CbA3rtsT.js","assets/Embed-fxz_xzQf.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const sa=!1;var ll=Array.isArray,Zc=Array.prototype.indexOf,za=Array.from,ul=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,cl=Object.getOwnPropertyDescriptors,Xc=Object.prototype,Kc=Array.prototype,Ga=Object.getPrototypeOf,Ti=Object.isExtensible;function sr(e){return typeof e=="function"}const Pe=()=>{};function Jc(e){return typeof e?.then=="function"}function Yc(e){return e()}function aa(e){for(var t=0;t<e.length;t++)e[t]()}function dl(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}function Wc(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const Be=2,ja=4,Cs=8,Qc=1<<24,qt=16,Zt=32,Tn=64,Ns=128,_t=512,Ge=1024,tt=2048,Nt=4096,st=8192,$t=16384,Ba=32768,rn=65536,Ai=1<<17,fl=1<<18,Qn=1<<19,hl=1<<20,_n=32768,ia=1<<21,Fa=1<<22,en=1<<23,xt=Symbol("$state"),vl=Symbol("legacy props"),ed=Symbol(""),Un=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Va(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function td(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function nd(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function rd(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function sd(e){throw new Error("https://svelte.dev/e/effect_orphan")}function ad(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function id(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function od(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ld(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ud(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function cd(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const pl=1,gl=2,ml=4,dd=8,fd=16,hd=1,vd=2,pd=4,gd=8,md=16,_d=1,yd=2,ze=Symbol(),bd="http://www.w3.org/1999/xhtml";function ib(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function wd(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function _l(e){return e===this.v}function yl(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function bl(e){return!yl(e,this.v)}let er=!1,Sd=!1;function Ed(){er=!0}let he=null;function Vn(e){he=e}function yt(e){return wl().get(e)}function it(e,t){return wl().set(e,t),t}function ee(e,t=!1,n){he={p:he,i:!1,c:null,e:null,s:e,x:null,l:er&&!t?{s:null,u:null,$:[]}:null}}function te(e){var t=he,n=t.e;if(n!==null){t.e=null;for(var r of n)Ul(r)}return e!==void 0&&(t.x=e),t.i=!0,he=t.p,e??{}}function An(){return!er||he!==null&&he.l===null}function wl(e){return he===null&&Va(),he.c??=new Map(kd(he)||void 0)}function kd(e){let t=e.p;for(;t!==null;){const n=t.c;if(n!==null)return n;t=t.p}return null}let hn=[];function Sl(){var e=hn;hn=[],aa(e)}function jt(e){if(hn.length===0&&!Gn){var t=hn;queueMicrotask(()=>{t===hn&&Sl()})}hn.push(e)}function xd(){for(;hn.length>0;)Sl()}function El(e){var t=oe;if(t===null)return ne.f|=en,e;if((t.f&Ba)===0){if((t.f&Ns)===0)throw e;t.b.error(e)}else Hn(e,t)}function Hn(e,t){for(;t!==null;){if((t.f&Ns)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Rr=new Set;let ce=null,Dr=null,dt=null,ut=[],Rs=null,oa=!1,Gn=!1;class mt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){ut=[],Dr=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#i(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(Dr=this,ce=null,Ii(n.render_effects),Ii(n.effects),Dr=null,this.#l?.resolve()),dt=null}#i(t,n){t.f^=Ge;for(var r=t.first;r!==null;){var s=r.f,a=(s&(Zt|Tn))!==0,i=a&&(s&Ge)!==0,o=i||(s&st)!==0||this.skipped_effects.has(r);if((r.f&Ns)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){a?r.f^=Ge:(s&ja)!==0?n.effects.push(r):tr(r)&&((r.f&qt)!==0&&n.block_effects.push(r),Zn(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&tt)!==0?this.#a:this.#s).push(n),this.#u(n.deps),je(n,Ge)}#u(t){if(t!==null)for(const n of t)(n.f&Be)===0||(n.f&_n)===0||(n.f^=_n,this.#u(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&en)===0&&(this.current.set(t,t.v),dt?.set(t,t.v))}activate(){ce=this,this.apply()}deactivate(){ce===this&&(ce=null,dt=null)}flush(){if(this.activate(),ut.length>0){if(xl(),ce!==null&&ce!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#c(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#d()}#d(){if(Rr.size>1){this.previous.clear();var t=dt,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of Rr){if(a===this){n=!1;continue}const i=[];for(const[l,u]of this.current){if(a.current.has(l))if(n&&u!==a.current.get(l))a.current.set(l,u);else continue;i.push(l)}if(i.length===0)continue;const o=[...a.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=ut;ut=[];const l=new Set,u=new Map;for(const c of i)Tl(c,o,l,u);if(ut.length>0){ce=a,a.apply();for(const c of ut)a.#i(c,r);a.deactivate()}ut=s}}ce=null,dt=t}this.committed=!0,Rr.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#a)je(t,tt),yn(t);for(const t of this.#s)je(t,Nt),yn(t);this.#a=[],this.#s=[],this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=dl()).promise}static ensure(){if(ce===null){const t=ce=new mt;Rr.add(ce),Gn||mt.enqueue(()=>{ce===t&&t.flush()})}return ce}static enqueue(t){jt(t)}apply(){}}function kl(e){var t=Gn;Gn=!0;try{for(var n;;){if(xd(),ut.length===0&&(ce?.flush(),ut.length===0))return Rs=null,n;xl()}}finally{Gn=t}}function xl(){var e=vn;oa=!0;var t=null;try{var n=0;for(ls(!0);ut.length>0;){var r=mt.ensure();if(n++>1e3){var s,a;Td()}r.process(ut),tn.clear()}}finally{oa=!1,ls(e),Rs=null}}function Td(){try{ad()}catch(e){Hn(e,Rs)}}let Lt=null;function Ii(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&($t|st))===0&&tr(r)&&(Lt=new Set,Zn(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Vl(r):r.fn=null),Lt?.size>0)){tn.clear();for(const s of Lt){if((s.f&($t|st))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Lt.has(i)&&(Lt.delete(i),a.push(i)),i=i.parent;for(let o=a.length-1;o>=0;o--){const l=a[o];(l.f&($t|st))===0&&Zn(l)}}Lt.clear()}}Lt=null}}function Tl(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&Be)!==0?Tl(s,t,n,r):(a&(Fa|qt))!==0&&(a&tt)===0&&Al(s,t,r)&&(je(s,tt),yn(s))}}function Al(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&Be)!==0&&Al(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function yn(e){for(var t=Rs=e;t.parent!==null;){t=t.parent;var n=t.f;if(oa&&t===oe&&(n&qt)!==0&&(n&fl)===0)return;if((n&(Tn|Zt))!==0){if((n&Ge)===0)return;t.f^=Ge}}ut.push(t)}function Ad(e){let t=0,n=Bt(0),r;return()=>{mr()&&(v(n),ln(()=>(t===0&&(r=ie(()=>e(()=>vr(n)))),t+=1,()=>{jt(()=>{t-=1,t===0&&(r?.(),r=void 0,vr(n))})})))}}var Id=rn|Qn|Ns;function Cd(e,t,n){new Nd(e,t,n)}class Nd{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#u=null;#c=null;#d=0;#f=0;#v=!1;#h=null;#y=Ad(()=>(this.#h=Bt(this.#d),()=>{this.#h=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=oe.b,this.#e=!!this.#n.pending,this.#a=In(()=>{oe.b=this;{var s=this.#m();try{this.#s=ct(()=>r(s))}catch(a){this.error(a)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#c?.remove()}},Id)}#b(){try{this.#s=ct(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#w(){const t=this.#n.pending;t&&(this.#i=ct(()=>t(this.#t)),mt.enqueue(()=>{var n=this.#m();this.#s=this.#p(()=>(mt.ensure(),ct(()=>this.#l(n)))),this.#f>0?this.#g():(jn(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#m(){var t=this.#t;return this.#e&&(this.#c=Vt(),this.#t.before(this.#c),t=this.#c),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var n=oe,r=ne,s=he;At(this.#a),We(this.#a),Vn(this.#a.ctx);try{return t()}catch(a){return El(a),null}finally{At(n),We(r),Vn(s)}}#g(){const t=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),Zl(this.#s,this.#u)),this.#i===null&&(this.#i=ct(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#i&&jn(this.#i,()=>{this.#i=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(t){this.#_(t),this.#d+=t,this.#h&&Ut(this.#h,this.#d)}get_effect_pending(){return this.#y(),v(this.#h)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#v||!n&&!r)throw t;this.#s&&(Qe(this.#s),this.#s=null),this.#i&&(Qe(this.#i),this.#i=null),this.#o&&(Qe(this.#o),this.#o=null);var s=!1,a=!1;const i=()=>{if(s){wd();return}s=!0,a&&cd(),mt.ensure(),this.#d=0,this.#o!==null&&jn(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#v=!1,ct(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var o=ne;try{We(null),a=!0,n?.(t,i),a=!1}catch(l){Hn(l,this.#a&&this.#a.parent)}finally{We(o)}r&&jt(()=>{this.#o=this.#p(()=>{mt.ensure(),this.#v=!0;try{return ct(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return Hn(l,this.#a.parent),null}finally{this.#v=!1}})})}}function Rd(e,t,n,r){const s=An()?kr:Os;if(n.length===0&&e.length===0){r(t.map(s));return}var a=ce,i=oe,o=Il();function l(){Promise.all(n.map(u=>Od(u))).then(u=>{o();try{r([...t.map(s),...u])}catch(c){(i.f&$t)===0&&Hn(c,i)}a?.deactivate(),gr()}).catch(u=>{Hn(u,i)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{a?.deactivate(),gr()}}):l()}function Il(){var e=oe,t=ne,n=he,r=ce;return function(a=!0){At(e),We(t),Vn(n),a&&r?.activate()}}function gr(){At(null),We(null),Vn(null)}function kr(e){var t=Be|tt,n=ne!==null&&(ne.f&Be)!==0?ne:null;return oe!==null&&(oe.f|=Qn),{ctx:he,deps:null,effects:null,equals:_l,f:t,fn:e,reactions:null,rv:0,v:ze,wv:0,parent:n??oe,ac:null}}function Od(e,t){let n=oe;n===null&&td();var r=n.b,s=void 0,a=Bt(ze),i=!ne,o=new Map;return Fd(()=>{var l=dl();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{u===ce&&u.committed&&u.deactivate(),gr()})}catch(h){l.reject(h),gr()}var u=ce;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),o.get(u)?.reject(Un),o.delete(u),o.set(u,l)}const d=(h,f=void 0)=>{if(u.activate(),f)f!==Un&&(a.f|=en,Ut(a,f));else{(a.f&en)!==0&&(a.f^=en),Ut(a,h);for(const[p,m]of o){if(o.delete(p),p===u)break;m.reject(Un)}}i&&(r.update_pending_count(-1),u.decrement(c))};l.promise.then(d,h=>d(null,h||"unknown"))}),Tr(()=>{for(const l of o.values())l.reject(Un)}),new Promise(l=>{function u(c){function d(){c===s?l(a):u(s)}c.then(d,d)}u(s)})}function me(e){const t=kr(e);return Xl(t),t}function Os(e){const t=kr(e);return t.equals=bl,t}function Cl(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Qe(t[n])}}function Pd(e){for(var t=e.parent;t!==null;){if((t.f&Be)===0)return(t.f&$t)===0?t:null;t=t.parent}return null}function Ha(e){var t,n=oe;At(Pd(e));try{e.f&=~_n,Cl(e),t=Wl(e)}finally{At(n)}return t}function Nl(e){var t=Ha(e);if(e.equals(t)||(ce?.is_fork||(e.v=t),e.wv=Jl()),!Cn)if(dt!==null)(mr()||ce?.is_fork)&&dt.set(e,t);else{var n=(e.f&_t)===0?Nt:Ge;je(e,n)}}let la=new Set;const tn=new Map;let Rl=!1;function Bt(e,t){var n={f:0,v:e,reactions:null,equals:_l,rv:0,wv:0};return n}function Z(e,t){const n=Bt(e);return Xl(n),n}function Ft(e,t=!1,n=!0){const r=Bt(e);return t||(r.equals=bl),er&&n&&he!==null&&he.l!==null&&(he.l.s??=[]).push(r),r}function Kt(e,t){return x(e,ie(()=>v(e))),t}function x(e,t,n=!1){ne!==null&&(!kt||(ne.f&Ai)!==0)&&An()&&(ne.f&(Be|qt|Fa|Ai))!==0&&!zt?.includes(e)&&ud();let r=n?Ce(t):t;return Ut(e,r)}function Ut(e,t){if(!e.equals(t)){var n=e.v;Cn?tn.set(e,t):tn.set(e,n),e.v=t;var r=mt.ensure();r.capture(e,n),(e.f&Be)!==0&&((e.f&tt)!==0&&Ha(e),je(e,(e.f&_t)!==0?Ge:Nt)),e.wv=Jl(),Ol(e,tt),An()&&oe!==null&&(oe.f&Ge)!==0&&(oe.f&(Zt|Tn))===0&&(lt===null?Hd([e]):lt.push(e)),!r.is_fork&&la.size>0&&!Rl&&Md()}return t}function Md(){Rl=!1;var e=vn;ls(!0);const t=Array.from(la);try{for(const n of t)(n.f&Ge)!==0&&je(n,Nt),tr(n)&&Zn(n)}finally{ls(e)}la.clear()}function vr(e){x(e,e.v+1)}function Ol(e,t){var n=e.reactions;if(n!==null)for(var r=An(),s=n.length,a=0;a<s;a++){var i=n[a],o=i.f;if(!(!r&&i===oe)){var l=(o&tt)===0;if(l&&je(i,t),(o&Be)!==0){var u=i;dt?.delete(u),(o&_n)===0&&(o&_t&&(i.f|=_n),Ol(u,Nt))}else l&&((o&qt)!==0&&Lt!==null&&Lt.add(i),yn(i))}}}function Ce(e){if(typeof e!="object"||e===null||xt in e)return e;const t=Ga(e);if(t!==Xc&&t!==Kc)return e;var n=new Map,r=ll(e),s=Z(0),a=pn,i=o=>{if(pn===a)return o();var l=ne,u=pn;We(null),Pi(a);var c=o();return We(l),Pi(u),c};return r&&n.set("length",Z(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&od();var c=n.get(l);return c===void 0?c=i(()=>{var d=Z(u.value);return n.set(l,d),d}):x(c,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const c=i(()=>Z(ze));n.set(l,c),vr(s)}}else x(u,ze),vr(s);return!0},get(o,l,u){if(l===xt)return e;var c=n.get(l),d=l in o;if(c===void 0&&(!d||Qt(o,l)?.writable)&&(c=i(()=>{var f=Ce(d?o[l]:ze),p=Z(f);return p}),n.set(l,c)),c!==void 0){var h=v(c);return h===ze?void 0:h}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=v(c))}else if(u===void 0){var d=n.get(l),h=d?.v;if(d!==void 0&&h!==ze)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(o,l){if(l===xt)return!0;var u=n.get(l),c=u!==void 0&&u.v!==ze||Reflect.has(o,l);if(u!==void 0||oe!==null&&(!c||Qt(o,l)?.writable)){u===void 0&&(u=i(()=>{var h=c?Ce(o[l]):ze,f=Z(h);return f}),n.set(l,u));var d=v(u);if(d===ze)return!1}return c},set(o,l,u,c){var d=n.get(l),h=l in o;if(r&&l==="length")for(var f=u;f<d.v;f+=1){var p=n.get(f+"");p!==void 0?x(p,ze):f in o&&(p=i(()=>Z(ze)),n.set(f+"",p))}if(d===void 0)(!h||Qt(o,l)?.writable)&&(d=i(()=>Z(void 0)),x(d,Ce(u)),n.set(l,d));else{h=d.v!==ze;var m=i(()=>Ce(u));x(d,m)}var g=Reflect.getOwnPropertyDescriptor(o,l);if(g?.set&&g.set.call(c,u),!h){if(r&&typeof l=="string"){var b=n.get("length"),w=Number(l);Number.isInteger(w)&&w>=b.v&&x(b,w+1)}vr(s)}return!0},ownKeys(o){v(s);var l=Reflect.ownKeys(o).filter(d=>{var h=n.get(d);return h===void 0||h.v!==ze});for(var[u,c]of n)c.v!==ze&&!(u in o)&&l.push(u);return l},setPrototypeOf(){ld()}})}function Ci(e){try{if(e!==null&&typeof e=="object"&&xt in e)return e[xt]}catch{}return e}function Ld(e,t){return Object.is(Ci(e),Ci(t))}var Ni,Pl,Ml,Ll;function Dd(){if(Ni===void 0){Ni=window,Pl=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ml=Qt(t,"firstChild").get,Ll=Qt(t,"nextSibling").get,Ti(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Ti(n)&&(n.__t=void 0)}}function Vt(e=""){return document.createTextNode(e)}function Et(e){return Ml.call(e)}function xr(e){return Ll.call(e)}function y(e,t){return Et(e)}function W(e,t=!1){{var n=Et(e);return n instanceof Comment&&n.data===""?xr(n):n}}function S(e,t=1,n=!1){let r=e;for(;t--;)r=xr(r);return r}function $d(e){e.textContent=""}function Dl(){return!1}let Ri=!1;function Ud(){Ri||(Ri=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Ps(e){var t=ne,n=oe;We(null),At(null);try{return e()}finally{We(t),At(n)}}function qa(e,t,n,r=n){e.addEventListener(t,()=>Ps(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Ud()}function $l(e){oe===null&&(ne===null&&sd(),rd()),Cn&&nd()}function zd(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Rt(e,t,n){var r=oe;r!==null&&(r.f&st)!==0&&(e|=st);var s={ctx:he,deps:null,nodes:null,f:e|tt|_t,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Zn(s),s.f|=Ba}catch(o){throw Qe(s),o}else t!==null&&yn(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&Qn)===0&&(a=a.first,(e&qt)!==0&&(e&rn)!==0&&a!==null&&(a.f|=rn)),a!==null&&(a.parent=r,r!==null&&zd(a,r),ne!==null&&(ne.f&Be)!==0&&(e&Tn)===0)){var i=ne;(i.effects??=[]).push(a)}return s}function mr(){return ne!==null&&!kt}function Tr(e){const t=Rt(Cs,null,!1);return je(t,Ge),t.teardown=e,t}function qn(e){$l();var t=oe.f,n=!ne&&(t&Zt)!==0&&(t&Ba)===0;if(n){var r=he;(r.e??=[]).push(e)}else return Ul(e)}function Ul(e){return Rt(ja|hl,e,!1)}function Gd(e){return $l(),Rt(Cs|hl,e,!0)}function jd(e){mt.ensure();const t=Rt(Tn|Qn,e,!0);return(n={})=>new Promise(r=>{n.outro?jn(t,()=>{Qe(t),r(void 0)}):(Qe(t),r(void 0))})}function Bd(e){return Rt(ja,e,!1)}function zl(e,t){var n=he,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=ln(()=>{e(),!r.ran&&(r.ran=!0,ie(t))})}function Gl(){var e=he;ln(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&Ge)!==0&&je(n,Nt),tr(n)&&Zn(n),t.ran=!1}})}function Fd(e){return Rt(Fa|Qn,e,!0)}function ln(e,t=0){return Rt(Cs|t,e,!0)}function U(e,t=[],n=[],r=[]){Rd(r,t,n,s=>{Rt(Cs,()=>e(...s.map(v)),!0)})}function In(e,t=0){var n=Rt(qt|t,e,!0);return n}function ct(e){return Rt(Zt|Qn,e,!0)}function jl(e){var t=e.teardown;if(t!==null){const n=Cn,r=ne;Oi(!0),We(null);try{t.call(null)}finally{Oi(n),We(r)}}}function Bl(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&Ps(()=>{s.abort(Un)});var r=n.next;(n.f&Tn)!==0?n.parent=null:Qe(n,t),n=r}}function Vd(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Zt)===0&&Qe(t),t=n}}function Qe(e,t=!0){var n=!1;(t||(e.f&fl)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Fl(e.nodes.start,e.nodes.end),n=!0),Bl(e,t&&!n),us(e,0),je(e,$t);var r=e.nodes&&e.nodes.t;if(r!==null)for(const a of r)a.stop();jl(e);var s=e.parent;s!==null&&s.first!==null&&Vl(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Fl(e,t){for(;e!==null;){var n=e===t?null:xr(e);e.remove(),e=n}}function Vl(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function jn(e,t,n=!0){var r=[];Za(e,r,!0),Hl(r,()=>{n&&Qe(e),t&&t()})}function Hl(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Za(e,t,n){if((e.f&st)===0){e.f^=st;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&rn)!==0||(s.f&Zt)!==0&&(e.f&qt)!==0;Za(s,t,i?n:!1),s=a}}}function Xa(e){ql(e,!0)}function ql(e,t){if((e.f&st)!==0){e.f^=st,(e.f&Ge)===0&&(je(e,tt),yn(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&rn)!==0||(n.f&Zt)!==0;ql(n,s?t:!1),n=r}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function Zl(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:xr(n);t.append(n),n=s}}let vn=!1;function ls(e){vn=e}let Cn=!1;function Oi(e){Cn=e}let ne=null,kt=!1;function We(e){ne=e}let oe=null;function At(e){oe=e}let zt=null;function Xl(e){ne!==null&&(zt===null?zt=[e]:zt.push(e))}let He=null,nt=0,lt=null;function Hd(e){lt=e}let Kl=1,_r=0,pn=_r;function Pi(e){pn=e}function Jl(){return++Kl}function tr(e){var t=e.f;if((t&tt)!==0)return!0;if(t&Be&&(e.f&=~_n),(t&Nt)!==0){var n=e.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(tr(a)&&Nl(a),a.wv>e.wv)return!0}(t&_t)!==0&&dt===null&&je(e,Ge)}return!1}function Yl(e,t,n=!0){var r=e.reactions;if(r!==null&&!zt?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&Be)!==0?Yl(a,t,!1):t===a&&(n?je(a,tt):(a.f&Ge)!==0&&je(a,Nt),yn(a))}}function Wl(e){var t=He,n=nt,r=lt,s=ne,a=zt,i=he,o=kt,l=pn,u=e.f;He=null,nt=0,lt=null,ne=(u&(Zt|Tn))===0?e:null,zt=null,Vn(e.ctx),kt=!1,pn=++_r,e.ac!==null&&(Ps(()=>{e.ac.abort(Un)}),e.ac=null);try{e.f|=ia;var c=e.fn,d=c(),h=e.deps;if(He!==null){var f;if(us(e,nt),h!==null&&nt>0)for(h.length=nt+He.length,f=0;f<He.length;f++)h[nt+f]=He[f];else e.deps=h=He;if(mr()&&(e.f&_t)!==0)for(f=nt;f<h.length;f++)(h[f].reactions??=[]).push(e)}else h!==null&&nt<h.length&&(us(e,nt),h.length=nt);if(An()&&lt!==null&&!kt&&h!==null&&(e.f&(Be|Nt|tt))===0)for(f=0;f<lt.length;f++)Yl(lt[f],e);return s!==null&&s!==e&&(_r++,lt!==null&&(r===null?r=lt:r.push(...lt))),(e.f&en)!==0&&(e.f^=en),d}catch(p){return El(p)}finally{e.f^=ia,He=t,nt=n,lt=r,ne=s,zt=a,Vn(i),kt=o,pn=l}}function qd(e,t){let n=t.reactions;if(n!==null){var r=Zc.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&Be)!==0&&(He===null||!He.includes(t))&&(je(t,Nt),(t.f&_t)!==0&&(t.f^=_t,t.f&=~_n),Cl(t),us(t,0))}function us(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)qd(e,n[r])}function Zn(e){var t=e.f;if((t&$t)===0){je(e,Ge);var n=oe,r=vn;oe=e,vn=!0;try{(t&(qt|Qc))!==0?Vd(e):Bl(e),jl(e);var s=Wl(e);e.teardown=typeof s=="function"?s:null,e.wv=Kl;var a;sa&&Sd&&(e.f&tt)!==0&&e.deps}finally{vn=r,oe=n}}}async function Zd(){await Promise.resolve(),kl()}function v(e){var t=e.f,n=(t&Be)!==0;if(ne!==null&&!kt){var r=oe!==null&&(oe.f&$t)!==0;if(!r&&!zt?.includes(e)){var s=ne.deps;if((ne.f&ia)!==0)e.rv<_r&&(e.rv=_r,He===null&&s!==null&&s[nt]===e?nt++:He===null?He=[e]:He.includes(e)||He.push(e));else{(ne.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[ne]:a.includes(ne)||a.push(ne)}}}if(Cn){if(tn.has(e))return tn.get(e);if(n){var i=e,o=i.v;return((i.f&Ge)===0&&i.reactions!==null||eu(i))&&(o=Ha(i)),tn.set(i,o),o}}else n&&(!dt?.has(e)||ce?.is_fork&&!mr())&&(i=e,tr(i)&&Nl(i),vn&&mr()&&(i.f&_t)===0&&Ql(i));if(dt?.has(e))return dt.get(e);if((e.f&en)!==0)throw e.v;return e.v}function Ql(e){if(e.deps!==null){e.f^=_t;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&Be)!==0&&(t.f&_t)===0&&Ql(t)}}function eu(e){if(e.v===ze)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(tn.has(t)||(t.f&Be)!==0&&eu(t))return!0;return!1}function ie(e){var t=kt;try{return kt=!0,e()}finally{kt=t}}const Xd=-7169;function je(e,t){e.f=e.f&Xd|t}function Ye(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(xt in e)ua(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&xt in n&&ua(n)}}}function ua(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{ua(e[r],t)}catch{}const n=Ga(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=cl(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const Kd=["touchstart","touchmove"];function Jd(e){return Kd.includes(e)}const tu=new Set,ca=new Set;function Yd(e,t,n,r={}){function s(a){if(r.capture||lr.call(t,a),!a.cancelBubble)return Ps(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?jt(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function Wd(e,t,n,r,s){var a={capture:r,passive:s},i=Yd(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Tr(()=>{t.removeEventListener(e,i,a)})}function bt(e){for(var t=0;t<e.length;t++)tu.add(e[t]);for(var n of ca)n(e)}let Mi=null;function lr(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;Mi=e;var i=0,o=Mi===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(i=l)}if(a=s[i]||e.target,a!==t){ul(e,"currentTarget",{configurable:!0,get(){return a||n}});var c=ne,d=oe;We(null),At(null);try{for(var h,f=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var m=a["__"+r];m!=null&&(!a.disabled||e.target===a)&&m.call(a,e)}catch(g){h?f.push(g):h=g}if(e.cancelBubble||p===t||p===null)break;a=p}if(h){for(let g of f)queueMicrotask(()=>{throw g});throw h}}finally{e.__root=t,delete e.currentTarget,We(c),At(d)}}}function Ka(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Xn(e,t){var n=oe;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function A(e,t){var n=(t&_d)!==0,r=(t&yd)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Ka(a?e:"<!>"+e),n||(s=Et(s)));var i=r||Pl?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=Et(i),l=i.lastChild;Xn(o,l)}else Xn(i,i);return i}}function Qd(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var i=Ka(s),o=Et(i);a=Et(o)}var l=a.cloneNode(!0);return Xn(l,l),l}}function ef(e,t){return Qd(e,t,"svg")}function Ve(e=""){{var t=Vt(e+"");return Xn(t,t),t}}function Oe(){var e=document.createDocumentFragment(),t=document.createComment(""),n=Vt();return e.append(t,n),Xn(t,n),e}function E(e,t){e!==null&&e.before(t)}function L(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function tf(e,t){return nf(e,t)}const Pn=new Map;function nf(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:i=!0}){Dd();var o=new Set,l=d=>{for(var h=0;h<d.length;h++){var f=d[h];if(!o.has(f)){o.add(f);var p=Jd(f);t.addEventListener(f,lr,{passive:p});var m=Pn.get(f);m===void 0?(document.addEventListener(f,lr,{passive:p}),Pn.set(f,1)):Pn.set(f,m+1)}}};l(za(tu)),ca.add(l);var u=void 0,c=jd(()=>{var d=n??t.appendChild(Vt());return Cd(d,{pending:()=>{}},h=>{if(a){ee({});var f=he;f.c=a}s&&(r.$$events=s),u=e(h,r)||{},a&&te()}),()=>{for(var h of o){t.removeEventListener(h,lr);var f=Pn.get(h);--f===0?(document.removeEventListener(h,lr),Pn.delete(h)):Pn.set(h,f)}ca.delete(l),d!==n&&d.parentNode?.removeChild(d)}});return rf.set(u,c),u}let rf=new WeakMap;class Ar{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#a=()=>{var t=ce;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Xa(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const o=this.#r.get(i);o&&(Qe(o.effect),this.#r.delete(i))}for(const[a,i]of this.#t){if(a===n||this.#n.has(a))continue;const o=()=>{if(Array.from(this.#e.values()).includes(a)){var u=document.createDocumentFragment();Zl(i,u),u.append(Vt()),this.#r.set(a,{effect:i,fragment:u})}else Qe(i);this.#n.delete(a),this.#t.delete(a)};this.#l||!r?(this.#n.add(a),jn(i,o,!1)):o()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(Qe(s.effect),this.#r.delete(r))};ensure(t,n){var r=ce,s=Dl();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(s){var a=document.createDocumentFragment(),i=Vt();a.append(i),this.#r.set(t,{effect:ct(()=>n(i)),fragment:a})}else this.#t.set(t,ct(()=>n(this.anchor)));if(this.#e.set(r,t),s){for(const[o,l]of this.#t)o===t?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===t?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}const sf=0,js=1;function af(e,t,n,r,s){var a=An(),i=ze,o=a?Bt(i):Ft(i,!1,!1),l=a?Bt(i):Ft(i,!1,!1),u=new Ar(e);In(()=>{var c=t(),d=!1;if(Jc(c)){var h=Il(),f=!1;const p=m=>{if(!d){f=!0,h(!1),mt.ensure();try{m()}finally{gr(),Gn||kl()}}};c.then(m=>{p(()=>{Ut(o,m),u.ensure(js,r&&(g=>r(g,o)))})},m=>{p(()=>{if(Ut(l,m),u.ensure(js,s&&(g=>s(g,l))),!s)throw l.v})}),jt(()=>{f||p(()=>{u.ensure(sf,n)})})}else Ut(o,c),u.ensure(js,r&&(p=>r(p,o)));return()=>{d=!0}})}function G(e,t,n=!1){var r=new Ar(e),s=n?rn:0;function a(i,o){r.ensure(i,o)}In(()=>{var i=!1;t((o,l=!0)=>{i=!0,a(l,o)}),i||a(!1,null)},s)}function of(e,t,n){var r=new Ar(e),s=!An();In(()=>{var a=t();s&&a!==null&&typeof a=="object"&&(a={}),r.ensure(a,n)})}function Ja(e,t){return t}function lf(e,t,n){for(var r=[],s=t.length,a=0;a<s;a++)Za(t[a].e,r,!0);Hl(r,()=>{var i=r.length===0&&n!==null;if(i){var o=n,l=o.parentNode;$d(l),l.append(o),e.items.clear(),vt(e,t[0].prev,t[s-1].next)}for(var u=0;u<s;u++){var c=t[u];i||(e.items.delete(c.k),vt(e,c.prev,c.next)),Qe(c.e,!i)}e.first===t[0]&&(e.first=t[0].prev)})}function De(e,t,n,r,s,a=null){var i=e,o=new Map,l=null,u=(t&ml)!==0,c=(t&pl)!==0,d=(t&gl)!==0;if(u){var h=e;i=h.appendChild(Vt())}var f=null,p=Os(()=>{var k=n();return ll(k)?k:k==null?[]:za(k)}),m,g=!0;function b(){uf(_,m,i,t,r),f!==null&&(m.length===0?(f.fragment?(i.before(f.fragment),f.fragment=null):Xa(f.effect),w.first=f.effect):jn(f.effect,()=>{f=null}))}var w=In(()=>{m=v(p);for(var k=m.length,C=new Set,I=ce,R=null,D=Dl(),O=0;O<k;O+=1){var N=m[O],j=r(N,O),H=g?null:o.get(j);H?(c&&Ut(H.v,N),d&&Ut(H.i,O),D&&I.skipped_effects.delete(H.e)):(H=cf(g?i:null,R,N,j,O,s,t,n),g&&(H.o=!0,R===null?l=H:R.next=H,R=H),o.set(j,H)),C.add(j)}if(k===0&&a&&!f)if(g)f={fragment:null,effect:ct(()=>a(i))};else{var q=document.createDocumentFragment(),le=Vt();q.append(le),f={fragment:q,effect:ct(()=>a(le))}}if(!g)if(D){for(const[ve,pe]of o)C.has(ve)||I.skipped_effects.add(pe.e);I.oncommit(b),I.ondiscard(()=>{})}else b();v(p)}),_={effect:w,items:o,first:l};g=!1}function uf(e,t,n,r,s){var a=(r&dd)!==0,i=t.length,o=e.items,l=e.first,u,c=null,d,h=[],f=[],p,m,g,b;if(a)for(b=0;b<i;b+=1)p=t[b],m=s(p,b),g=o.get(m),g.o&&(g.e.nodes?.a?.measure(),(d??=new Set).add(g));for(b=0;b<i;b+=1){if(p=t[b],m=s(p,b),g=o.get(m),e.first??=g,!g.o){g.o=!0;var w=c?c.next:l;vt(e,c,g),vt(e,g,w),Bs(g,w,n),c=g,h=[],f=[],l=c.next;continue}if((g.e.f&st)!==0&&(Xa(g.e),a&&(g.e.nodes?.a?.unfix(),(d??=new Set).delete(g))),g!==l){if(u!==void 0&&u.has(g)){if(h.length<f.length){var _=f[0],k;c=_.prev;var C=h[0],I=h[h.length-1];for(k=0;k<h.length;k+=1)Bs(h[k],_,n);for(k=0;k<f.length;k+=1)u.delete(f[k]);vt(e,C.prev,I.next),vt(e,c,C),vt(e,I,_),l=_,c=I,b-=1,h=[],f=[]}else u.delete(g),Bs(g,l,n),vt(e,g.prev,g.next),vt(e,g,c===null?e.first:c.next),vt(e,c,g),c=g;continue}for(h=[],f=[];l!==null&&l!==g;)(l.e.f&st)===0&&(u??=new Set).add(l),f.push(l),l=l.next;if(l===null)continue;g=l}h.push(g),c=g,l=g.next}let R=o.size>i;if(l!==null||u!==void 0){for(var D=u===void 0?[]:za(u);l!==null;)(l.e.f&st)===0&&D.push(l),l=l.next;var O=D.length;if(R=o.size-O>i,O>0){var N=(r&ml)!==0&&i===0?n:null;if(a){for(b=0;b<O;b+=1)D[b].e.nodes?.a?.measure();for(b=0;b<O;b+=1)D[b].e.nodes?.a?.fix()}lf(e,D,N)}}if(R)for(const j of o.values())j.o||(vt(e,c,j),c=j);e.effect.last=c&&c.e,a&&jt(()=>{if(d!==void 0)for(g of d)g.e.nodes?.a?.apply()})}function cf(e,t,n,r,s,a,i,o){var l=(i&pl)!==0,u=(i&fd)===0,c=l?u?Ft(n,!1,!1):Bt(n):n,d=(i&gl)===0?s:Bt(s),h={i:d,v:c,k:r,e:null,o:!1,prev:t,next:null};if(e===null){var f=document.createDocumentFragment();f.append(e=Vt())}return h.e=ct(()=>a(e,c,d,o)),t!==null&&(t.next=h),h}function Bs(e,t,n){if(e.e.nodes)for(var r=e.next?e.next.e.nodes.start:n,s=t?t.e.nodes.start:n,a=e.e.nodes.start;a!==null&&a!==r;){var i=xr(a);s.before(a),a=i}}function vt(e,t,n){t===null?(e.first=n,e.effect.first=n&&n.e):(t.e.next&&(t.e.next.prev=null),t.next=n,t.e.next=n&&n.e),n!==null&&(n.e.prev&&(n.e.prev.next=null),n.prev=t,n.e.prev=t&&t.e)}function nu(e,t,n=!1,r=!1,s=!1){var a=e,i="";U(()=>{var o=oe;if(i!==(i=t()??"")&&(o.nodes!==null&&(Fl(o.nodes.start,o.nodes.end),o.nodes=null),i!=="")){var l=i+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=Ka(l);if((n||r)&&(u=Et(u)),Xn(Et(u),u.lastChild),n||r)for(;Et(u);)a.before(Et(u));else a.before(u)}})}function df(e,t,n,r,s){var a=t.$$slots?.[n],i=!1;a===!0&&(a=t[n],i=!0),a===void 0?s!==null&&s(e):a(e,i?()=>r:r)}function et(e,t,...n){var r=new Ar(e);In(()=>{const s=t()??null;r.ensure(s,s&&(a=>s(a,...n)))},rn)}function ff(e,t,n){var r=new Ar(e);In(()=>{var s=t()??null;r.ensure(s,s&&(a=>n(a,s)))},rn)}function ru(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=ru(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function hf(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=ru(e))&&(r&&(r+=" "),r+=t);return r}function ob(e){return typeof e=="object"?hf(e):e??""}const Li=[...` 	
\r\fÂ \v\uFEFF`];function vf(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,i=0;(i=r.indexOf(s,i))>=0;){var o=i+a;(i===0||Li.includes(r[i-1]))&&(o===r.length||Li.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function Di(e,t=!1){var n=t?" !important;":";",r="";for(var s in e){var a=e[s];a!=null&&a!==""&&(r+=" "+s+": "+a+n)}return r}function Fs(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function pf(e,t){if(t){var n="",r,s;if(Array.isArray(t)?(r=t[0],s=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,i=0,o=!1,l=[];r&&l.push(...Object.keys(r).map(Fs)),s&&l.push(...Object.keys(s).map(Fs));var u=0,c=-1;const m=e.length;for(var d=0;d<m;d++){var h=e[d];if(o?h==="/"&&e[d-1]==="*"&&(o=!1):a?a===h&&(a=!1):h==="/"&&e[d+1]==="*"?o=!0:h==='"'||h==="'"?a=h:h==="("?i++:h===")"&&i--,!o&&a===!1&&i===0){if(h===":"&&c===-1)c=d;else if(h===";"||d===m-1){if(c!==-1){var f=Fs(e.substring(u,c).trim());if(!l.includes(f)){h!==";"&&d++;var p=e.substring(u,d).trim();n+=" "+p+";"}}u=d+1,c=-1}}}}return r&&(n+=Di(r)),s&&(n+=Di(s,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function Ne(e,t,n,r,s,a){var i=e.__className;if(i!==n||i===void 0){var o=vf(n,r,a);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(a&&s!==a)for(var l in a){var u=!!a[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return a}function Vs(e,t={},n,r){for(var s in n){var a=n[s];t[s]!==a&&(n[s]==null?e.style.removeProperty(s):e.style.setProperty(s,a,r))}}function gf(e,t,n,r){var s=e.__style;if(s!==t){var a=pf(t,r);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}else r&&(Array.isArray(r)?(Vs(e,n?.[0],r[0]),Vs(e,n?.[1],r[1],"important")):Vs(e,n,r));return r}const mf=Symbol("is custom element"),_f=Symbol("is html");function lb(e,t){var n=su(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function ft(e,t,n,r){var s=su(e);s[t]!==(s[t]=n)&&(t==="loading"&&(e[ed]=n),n==null?e.removeAttribute(t):typeof n!="string"&&yf(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function su(e){return e.__attributes??={[mf]:e.nodeName.includes("-"),[_f]:e.namespaceURI===bd}}var $i=new Map;function yf(e){var t=e.getAttribute("is")||e.nodeName,n=$i.get(t);if(n)return n;$i.set(t,n=[]);for(var r,s=e,a=Element.prototype;a!==s;){r=cl(s);for(var i in r)r[i].set&&n.push(i);s=Ga(s)}return n}function fn(e,t,n=t){var r=new WeakSet;qa(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=qs(e)?Zs(a):a,n(a),ce!==null&&r.add(ce),await Zd(),a!==(a=t())){var i=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=a??"",o!==null){var u=e.value.length;i===o&&o===l&&u>l?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=i,e.selectionEnd=Math.min(o,u))}}}),ie(t)==null&&e.value&&(n(qs(e)?Zs(e.value):e.value),ce!==null&&r.add(ce)),ln(()=>{var s=t();if(e===document.activeElement){var a=Dr??ce;if(r.has(a))return}qs(e)&&s===Zs(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}const Hs=new Set;function ub(e,t,n,r,s=r){var a=n.getAttribute("type")==="checkbox",i=e;if(t!==null)for(var o of t)i=i[o]??=[];i.push(n),qa(n,"change",()=>{var l=n.__value;a&&(l=wf(i,l,n.checked)),s(l)},()=>s(a?[]:null)),ln(()=>{var l=r();a?(l=l||[],n.checked=l.includes(n.__value)):n.checked=Ld(n.__value,l)}),Tr(()=>{var l=i.indexOf(n);l!==-1&&i.splice(l,1)}),Hs.has(i)||(Hs.add(i),jt(()=>{i.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Hs.delete(i)})),jt(()=>{})}function bf(e,t,n=t){qa(e,"change",r=>{var s=r?e.defaultChecked:e.checked;n(s)}),ie(t)==null&&n(e.checked),ln(()=>{var r=t();e.checked=!!r})}function wf(e,t,n){for(var r=new Set,s=0;s<e.length;s+=1)e[s].checked&&r.add(e[s].__value);return n||r.delete(t),Array.from(r)}function qs(e){var t=e.type;return t==="number"||t==="range"}function Zs(e){return e===""?null:+e}function Ui(e,t){return e===t||e?.[xt]===t}function yr(e={},t,n,r){return Bd(()=>{var s,a;return ln(()=>{s=a,a=[],ie(()=>{e!==n(...a)&&(t(e,...a),s&&Ui(n(...s),e)&&t(null,...s))})}),()=>{jt(()=>{a&&Ui(n(...a),e)&&t(null,...a)})}}),e}function Sf(e,t,n,r,s){var a=()=>{r(n[e])};n.addEventListener(t,a),s?ln(()=>{n[e]=s()}):a(),(n===document.body||n===window||n===document)&&Tr(()=>{n.removeEventListener(t,a)})}function ot(e=!1){const t=he,n=t.l.u;if(!n)return;let r=()=>Ye(t.s);if(e){let s=0,a={};const i=kr(()=>{let o=!1;const l=t.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&s++,s});r=()=>v(i)}n.b.length&&Gd(()=>{zi(t,r),aa(n.b)}),qn(()=>{const s=ie(()=>n.m.map(Yc));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&qn(()=>{zi(t,r),aa(n.a)})}function zi(e,t){if(e.l.s)for(const n of e.l.s)v(n);t()}function au(e,t,n){if(e==null)return t(void 0),Pe;const r=ie(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Mn=[];function cn(e,t){return{subscribe:Ef(e,t).subscribe}}function Ef(e,t=Pe){let n=null;const r=new Set;function s(o){if(yl(e,o)&&(e=o,n)){const l=!Mn.length;for(const u of r)u[1](),Mn.push(u,e);if(l){for(let u=0;u<Mn.length;u+=2)Mn[u][0](Mn[u+1]);Mn.length=0}}}function a(o){s(o(e))}function i(o,l=Pe){const u=[o,l];return r.add(u),r.size===1&&(n=t(s,a)||Pe),o(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:i}}function kf(e){let t;return au(e,n=>t=n)(),t}let Or=!1,da=Symbol();function ur(e,t,n){const r=n[t]??={store:null,source:Ft(void 0),unsubscribe:Pe};if(r.store!==e&&!(da in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Pe;else{var s=!0;r.unsubscribe=au(e,a=>{s?r.source.v=a:x(r.source,a)}),s=!1}return e&&da in n?kf(e):v(r.source)}function iu(){const e={};function t(){Tr(()=>{for(var n in e)e[n].unsubscribe();ul(e,da,{enumerable:!1,value:!0})})}return[e,t]}function xf(e){var t=Or;try{return Or=!1,[e(),Or]}finally{Or=t}}const Tf={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];sr(s)&&(s=s());const a=Qt(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(sr(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=Qt(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===xt||t===vl)return!1;for(let n of e.props)if(sr(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(sr(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function Af(...e){return new Proxy({props:e},Tf)}function Le(e,t,n,r){var s=!er||(n&vd)!==0,a=(n&gd)!==0,i=(n&md)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?ie(r):r),o),c;if(a){var d=xt in e||vl in e;c=Qt(e,t)?.set??(d&&t in e?_=>e[t]=_:void 0)}var h,f=!1;a?[h,f]=xf(()=>e[t]):h=e[t],h===void 0&&r!==void 0&&(h=u(),c&&(s&&id(),c(h)));var p;if(s?p=()=>{var _=e[t];return _===void 0?u():(l=!0,_)}:p=()=>{var _=e[t];return _!==void 0&&(o=void 0),_===void 0?o:_},s&&(n&pd)===0)return p;if(c){var m=e.$$legacy;return(function(_,k){return arguments.length>0?((!s||!k||m||f)&&c(k?p():_),_):p()})}var g=!1,b=((n&hd)!==0?kr:Os)(()=>(g=!1,p()));a&&v(b);var w=oe;return(function(_,k){if(arguments.length>0){const C=k?v(b):s&&a?Ce(_):_;return x(b,C),g=!0,o!==void 0&&(o=C),_}return Cn&&g||(w.f&$t)!==0?b.v:v(b)})}function ou(e){he===null&&Va(),er&&he.l!==null?If(he).m.push(e):qn(()=>{const t=ie(e);if(typeof t=="function")return t})}function cb(e){he===null&&Va(),ou(()=>()=>ie(e))}function If(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Cf="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Cf);const Nf=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Bn=()=>crypto.randomUUID(),lu=e=>{try{return JSON.parse(e)}catch{return null}},Gi=(e,t)=>{const{label:n}=t,r=e.trim();if(!r)return{};let s;try{s=JSON.parse(r)}catch{throw new Error(`${n} must be valid JSON.`)}if(s===null||Array.isArray(s)||typeof s!="object")throw new Error(`${n} must be a JSON object.`);return s},Dn=-1,ji=200;function Rf(e){return e?e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`:"Unknown size"}function Of(e){return e?e.startsWith("image/")?"image":e==="application/pdf"?"pdf":e.includes("spreadsheet")||e.includes("excel")?"spreadsheet":e.includes("presentation")||e.includes("powerpoint")?"presentation":"file":"file"}function Pf(e){if(!e)return"file";const t=e.split("/");return t[1]??t[0]??"file"}var Mf=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Lf=Object.prototype.hasOwnProperty;function fa(e,t){return Lf.call(e,t)}function ha(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var s in e)fa(e,s)&&r.push(s);return r}function rt(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function va(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function dn(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function uu(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function pa(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(pa(e[t]))return!0}else if(typeof e=="object"){for(var r=ha(e),s=r.length,a=0;a<s;a++)if(pa(e[r[a]]))return!0}}return!1}function Bi(e,t){var n=[e];for(var r in t){var s=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof s<"u"&&n.push(r+": "+s)}return n.join(`
`)}var cu=(function(e){Mf(t,e);function t(n,r,s,a,i){var o=this.constructor,l=e.call(this,Bi(n,{name:r,index:s,operation:a,tree:i}))||this;return l.name=r,l.index=s,l.operation=a,l.tree=i,Object.setPrototypeOf(l,o.prototype),l.message=Bi(n,{name:r,index:s,operation:a,tree:i}),l}return t})(Error),xe=cu,Df=rt,zn={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=cs(n,this.path);r&&(r=rt(r));var s=gn(n,{op:"remove",path:this.from}).removed;return gn(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=cs(n,this.from);return gn(n,{op:"add",path:this.path,value:rt(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:br(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},$f={add:function(e,t,n){return va(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:zn.move,copy:zn.copy,test:zn.test,_get:zn._get};function cs(e,t){if(t=="")return e;var n={op:"_get",path:t};return gn(e,n),n.value}function gn(e,t,n,r,s,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):ds(t,0)),t.path===""){var i={newDocument:e};if(t.op==="add")return i.newDocument=t.value,i;if(t.op==="replace")return i.newDocument=t.value,i.removed=e,i;if(t.op==="move"||t.op==="copy")return i.newDocument=cs(e,t.from),t.op==="move"&&(i.removed=e),i;if(t.op==="test"){if(i.test=br(e,t.value),i.test===!1)throw new xe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i.newDocument=e,i}else{if(t.op==="remove")return i.removed=e,i.newDocument=null,i;if(t.op==="_get")return t.value=e,i;if(n)throw new xe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return i}}else{r||(e=rt(e));var o=t.path||"",l=o.split("/"),u=e,c=1,d=l.length,h=void 0,f=void 0,p=void 0;for(typeof n=="function"?p=n:p=ds;;){if(f=l[c],f&&f.indexOf("~")!=-1&&(f=uu(f)),s&&(f=="__proto__"||f=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[f]===void 0?h=l.slice(0,c).join("/"):c==d-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(u)){if(f==="-")f=u.length;else{if(n&&!va(f))throw new xe("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);va(f)&&(f=~~f)}if(c>=d){if(n&&t.op==="add"&&f>u.length)throw new xe("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var i=$f[t.op].call(t,u,f,e);if(i.test===!1)throw new xe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}}else if(c>=d){var i=zn[t.op].call(t,u,f,e);if(i.test===!1)throw new xe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}if(u=u[f],n&&c<d&&(!u||typeof u!="object"))throw new xe("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function Kn(e,t,n,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),n&&!Array.isArray(t))throw new xe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=rt(e));for(var a=new Array(t.length),i=0,o=t.length;i<o;i++)a[i]=gn(e,t[i],n,!0,s,i),e=a[i].newDocument;return a.newDocument=e,a}function Uf(e,t,n){var r=gn(e,t);if(r.test===!1)throw new xe("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function ds(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new xe("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(zn[e.op]){if(typeof e.path!="string")throw new xe("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new xe('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new xe("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new xe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&pa(e.value))throw new xe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var s=e.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new xe("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new xe("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var i={op:"_get",path:e.from,value:void 0},o=du([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new xe("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new xe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function du(e,t,n){try{if(!Array.isArray(e))throw new xe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Kn(rt(t),rt(e),n||!0);else{n=n||ds;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(s){if(s instanceof xe)return s;throw s}}function br(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),s,a,i;if(n&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!br(e[s],t[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(a=o.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!t.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!br(e[i],t[i]))return!1;return!0}return e!==e&&t!==t}const zf=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:xe,_areEquals:br,applyOperation:gn,applyPatch:Kn,applyReducer:Uf,deepClone:Df,getValueByPointer:cs,validate:du,validator:ds},Symbol.toStringTag,{value:"Module"}));var Ya=new WeakMap,Gf=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),jf=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function Bf(e){return Ya.get(e)}function Ff(e,t){return e.observers.get(t)}function Vf(e,t){e.observers.delete(t.callback)}function Hf(e,t){t.unobserve()}function qf(e,t){var n=[],r,s=Bf(e);if(!s)s=new Gf(e),Ya.set(e,s);else{var a=Ff(s,t);r=a&&a.observer}if(r)return r;if(r={},s.value=rt(e),t){r.callback=t,r.next=null;var i=function(){ga(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){ga(r),clearTimeout(r.next),Vf(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},s.observers.set(t,new jf(t,r)),r}function ga(e,t){t===void 0&&(t=!1);var n=Ya.get(e.object);Wa(n.value,e.object,e.patches,"",t),e.patches.length&&Kn(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Wa(e,t,n,r,s){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=ha(t),i=ha(e),o=!1,l=i.length-1;l>=0;l--){var u=i[l],c=e[u];if(fa(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var d=t[u];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?Wa(c,d,n,r+"/"+dn(u),s):c!==d&&(s&&n.push({op:"test",path:r+"/"+dn(u),value:rt(c)}),n.push({op:"replace",path:r+"/"+dn(u),value:rt(d)}))}else Array.isArray(e)===Array.isArray(t)?(s&&n.push({op:"test",path:r+"/"+dn(u),value:rt(c)}),n.push({op:"remove",path:r+"/"+dn(u)}),o=!0):(s&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!fa(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+dn(u),value:rt(t[u])})}}}function Zf(e,t,n){n===void 0&&(n=!1);var r=[];return Wa(e,t,r,"",n),r}const Xf=Object.freeze(Object.defineProperty({__proto__:null,compare:Zf,generate:ga,observe:qf,unobserve:Hf},Symbol.toStringTag,{value:"Module"}));Object.assign({},zf,Xf,{JsonPatchError:cu,deepClone:rt,escapePathComponent:dn,unescapePathComponent:uu});function Qa(e){return{ok:!0,data:e}}function fs(e){return{ok:!1,error:e}}function Kf(e,t="Unknown error"){return e instanceof Error?e:typeof e=="string"&&e.trim()?new Error(e):new Error(t)}const fu=Symbol("chat-store");function Jf(){let e=Z(Ce([])),t=Z("");return{get messages(){return v(e)},get input(){return v(t)},set input(n){x(t,n,!0)},get isEmpty(){return v(e).length===0},addUserMessage(n){const r={id:Bn(),role:"user",text:n,ts:Date.now()};return v(e).push(r),r},addAgentMessage(){const n={id:Bn(),role:"agent",text:"",observations:"",showObservations:!1,isStreaming:!0,isThinking:!1,answerStreamDone:!1,revisionStreamActive:!1,answerActionSeq:Dn,ts:Date.now()};return v(e).push(n),n},findMessage(n){return v(e).find(r=>r.id===n)},updateMessage(n,r){const s=v(e).find(a=>a.id===n);s&&Object.assign(s,r)},clearInput(){x(t,"")},clear(){x(e,[],!0),x(t,"")}}}function Yf(e=Jf()){return it(fu,e),e}function hu(){return yt(fu)}const vu=Symbol("session-store");function Wf(){let e=Z(Ce(Bn())),t=Z(null),n=Z(!1);return{get sessionId(){return v(e)},set sessionId(r){x(e,r,!0)},get activeTraceId(){return v(t)},set activeTraceId(r){x(t,r,!0)},get isSending(){return v(n)},set isSending(r){x(n,r,!0)},reset(){x(e,Bn(),!0),x(t,null),x(n,!1)},newSession(){x(e,Bn(),!0),x(t,null)}}}function Qf(e=Wf()){return it(vu,e),e}function Ir(){return yt(vu)}const pu=Symbol("artifacts-store");function eh(){let e=Z(Ce(new Map));return{get artifacts(){return v(e)},get list(){return Array.from(v(e).values())},get count(){return v(e).size},has(t){return v(e).has(t)},get(t){return v(e).get(t)},addArtifact(t){const n={id:t.artifact_id,mime_type:t.mime_type,size_bytes:t.size_bytes,filename:t.filename,sha256:null,source:t.source},r=new Map(v(e));r.set(t.artifact_id,n),x(e,r,!0)},remove(t){if(!v(e).has(t))return!1;const n=new Map(v(e));return n.delete(t),x(e,n,!0),!0},clear(){x(e,new Map,!0)}}}function th(e=eh()){return it(pu,e),e}function nh(){return yt(pu)}const gu=Symbol("agent-store"),Fi={name:"loading_agent",description:"",template:"",version:"",flags:[],tools:0,flows:0};function rh(){let e=Z(Ce({...Fi})),t=Z(Ce([])),n=Z(Ce([])),r=Z(Ce([]));return{get meta(){return v(e)},get plannerConfig(){return v(t)},get services(){return v(n)},get catalog(){return v(r)},setFromResponse(s){const a=s.agent??{};x(e,{name:a.name??"agent",description:a.description??"",template:a.template??"",version:a.version??"",flags:a.flags??[],tools:(s.tools??[]).length,flows:(s.flows??[]).length},!0),x(t,s.planner&&Object.keys(s.planner).length?Object.entries(s.planner).map(([i,o])=>({label:i,value:o})):[],!0),x(n,s.services?.map(i=>({name:i.name,status:i.enabled?"enabled":"disabled",url:i.url??null}))??[],!0),x(r,s.tools?.map(i=>({name:i.name,desc:i.description,tags:i.tags??[]}))??[],!0)},reset(){x(e,{...Fi},!0),x(t,[],!0),x(n,[],!0),x(r,[],!0)}}}function sh(e=rh()){return it(gu,e),e}function nr(){return yt(gu)}const mu=Symbol("events-store"),ah=new Set(["thinking","revision","tool_call_start","tool_call_args","tool_call_end","tool_call_result","llm_stream_chunk"]),ih=new Set(["step","step_start","step_complete"]);function oh(){let e=Z(Ce([])),t=Z(Ce(new Set)),n=Z(!1),r=Z(Ce(new Map));function s(){const a=[],i=new Set;for(const o of v(e)){const l=o.event?.toLowerCase()??"";if(!ah.has(l)){if(ih.has(l)||l==="event"){(l==="step_complete"||o.latency_ms)&&a.push({id:o.id,type:"step",name:o.node??"step",description:o.thought?Pr(o.thought,100):void 0,duration_ms:o.latency_ms,ts:o.ts??Date.now()});continue}if(l==="artifact_stored"||l==="artifact_chunk"){a.push({id:o.id,type:"artifact",name:o.artifact_id??"artifact",description:o.mime_type??void 0,ts:o.ts??Date.now()});continue}a.push({id:o.id,type:"other",name:l,description:o.thought?Pr(o.thought,80):void 0,ts:o.ts??Date.now()})}}for(const[o,l]of v(r))l.endTs&&!i.has(o)&&(a.push({id:`tc_${o}`,type:"tool_call",name:l.name,args:l.args?Pr(l.args,100):void 0,result:l.result?Pr(l.result,100):void 0,duration_ms:l.endTs-l.startTs,ts:l.startTs}),i.add(o));return a.sort((o,l)=>l.ts-o.ts),a}return{get events(){return v(e)},get displayEvents(){return s()},get filter(){return v(t)},get paused(){return v(n)},set paused(a){x(n,a,!0)},get isEmpty(){return v(e).length===0},setFilter(a){a?x(t,new Set([a]),!0):x(t,new Set,!0)},addEvent(a,i){const o=a.tool_call_id,l=i.toLowerCase();if(o){if(l==="tool_call_start")v(r).set(o,{id:o,name:a.tool_call_name??"tool",args:"",result:"",startTs:Date.now()});else if(l==="tool_call_args"){const d=v(r).get(o);d&&(d.args+=a.delta??"")}else if(l==="tool_call_result"){const d=v(r).get(o);d&&(d.result=a.content??"")}else if(l==="tool_call_end"){const d=v(r).get(o);d&&(d.endTs=Date.now())}}const u=`${a.event??""}|${a.node??""}|${a.ts??""}`;if(!v(e).some(d=>`${d.event??""}|${d.node??""}|${d.ts??""}`===u)){const d={id:Bn(),event:i,...a};v(e).unshift(d),v(e).length>ji&&(v(e).length=ji)}},shouldProcess(a){return v(n)?!1:v(t).size===0?!0:v(t).has(a)},clear(){x(e,[],!0),x(r,new Map,!0)}}}function Pr(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}function lh(e=oh()){return it(mu,e),e}function ei(){return yt(mu)}const _u=Symbol("trajectory-store");function uh(){let e=Z(Ce([])),t=Z(Ce({}));return{get steps(){return v(e)},get artifactStreams(){return v(t)},get isEmpty(){return v(e).length===0},get hasArtifacts(){return Object.keys(v(t)).length>0},setFromPayload(n){const r=n?.steps??[];x(e,r.map((s,a)=>{const i=s.action??{};return{id:`step-${a}`,name:i.next_node??i.plan?.[0]?.node??"step",thought:i.thought,args:i.args,result:s.observation,latencyMs:s.latency_ms??void 0,reflectionScore:s.metadata?.reflection?.score??void 0,status:s.error?"error":"ok"}}),!0)},addArtifactChunk(n,r){const s=v(t)[n]??[];v(t)[n]=[...s,r]},clearArtifacts(){x(t,{},!0)},clear(){x(e,[],!0),x(t,{},!0)}}}function ch(e=uh()){return it(_u,e),e}function ti(){return yt(_u)}const yu=Symbol("spec-store");function dh(){let e=Z(""),t=Z("pending"),n=Z(Ce([]));return{get content(){return v(e)},set content(r){x(e,r,!0)},get status(){return v(t)},set status(r){x(t,r,!0)},get errors(){return v(n)},get isValid(){return v(t)==="valid"},get hasErrors(){return v(n).length>0},setFromSpecData(r){x(e,r.content,!0),x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`err-${a}`,message:s.message,line:s.line})),!0)},setValidationResult(r){x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`val-err-${a}`,message:s.message,line:s.line})),!0)},setGenerationErrors(r){x(t,"error"),x(n,r.map((s,a)=>({id:`gen-err-${a}`,message:s.message,line:s.line})),!0)},markValid(){x(t,"valid"),x(n,[],!0)},reset(){x(e,""),x(t,"pending"),x(n,[],!0)}}}function fh(e=dh()){return it(yu,e),e}function hh(){return yt(yu)}const bu=Symbol("setup-store");function vh(){let e=Z("playground-tenant"),t=Z("playground-user"),n=Z("{}"),r=Z("{}"),s=Z(null),a=Z(!1);return{get tenantId(){return v(e)},set tenantId(i){x(e,i,!0)},get userId(){return v(t)},set userId(i){x(t,i,!0)},get toolContextRaw(){return v(n)},set toolContextRaw(i){x(n,i,!0)},get llmContextRaw(){return v(r)},set llmContextRaw(i){x(r,i,!0)},get error(){return v(s)},set error(i){x(s,i,!0)},get useAgui(){return v(a)},set useAgui(i){x(a,i,!0)},parseContexts(){try{const i=Gi(v(n),{label:"Tool context"}),o={tenant_id:v(e),user_id:v(t),...i},l=Gi(v(r),{label:"LLM context"});return x(s,null),{toolContext:o,llmContext:l}}catch(i){return x(s,i instanceof Error?i.message:"Invalid setup configuration.",!0),null}},clearError(){x(s,null)},reset(){x(e,"playground-tenant"),x(t,"playground-user"),x(n,"{}"),x(r,"{}"),x(s,null),x(a,!1)}}}function ph(e=vh()){return it(bu,e),e}function gh(){return yt(bu)}const wu=Symbol("interactions-store");function mh(){let e=Z(Ce([])),t=Z(null),n=Z(null);function r(o,{message_id:l}={}){if(o.artifact_type!=="ui_component"||!o.chunk||typeof o.chunk!="object")return;const u=o.chunk,c=typeof u.component=="string"?u.component:void 0,d=u.props||{};if(!c)return;const h={id:(typeof u.id=="string"?u.id:void 0)||`ui_${Date.now()}`,component:c,props:d,title:typeof u.title=="string"?u.title:void 0,message_id:l??(typeof o.meta?.message_id=="string"?o.meta.message_id:void 0),seq:o.seq??0,ts:o.ts??Date.now(),meta:o.meta??{}};x(e,[...v(e),h],!0),x(n,h,!0)}function s(o){x(t,o,!0)}function a(o){v(t)&&x(t,{...v(t),...o},!0)}function i(){x(t,null)}return{get artifacts(){return v(e)},get pendingInteraction(){return v(t)},get lastArtifact(){return v(n)},addArtifactChunk:r,setPendingInteraction:s,updatePendingInteraction:a,clearPendingInteraction:i,clear(){x(e,[],!0),x(t,null),x(n,null)}}}function _h(e=mh()){return it(wu,e),e}function ni(){return yt(wu)}const Su=Symbol("component-registry-store");function yh(){let e=Z(null),t=Z(null);return{get registry(){return v(e)},get error(){return v(t)},get enabled(){return v(e)?.enabled??!1},get components(){return v(e)?.components??{}},get version(){return v(e)?.version??""},get allowlist(){return v(e)?.allowlist??[]},setFromPayload(n){x(e,n,!0),x(t,null)},setError(n){x(t,n,!0)},getComponent(n){return v(e)?.components?.[n]},reset(){x(e,null),x(t,null)}}}function bh(e=yh()){return it(Su,e),e}function ri(){return yt(Su)}const wh=Symbol("layout-store");function Sh(){let e=Z(!1),t=Z(!1);return{get isMobile(){return v(e)},set isMobile(n){x(e,n,!0)},get sidebarOpen(){return v(t)},set sidebarOpen(n){x(t,n,!0)},setMobile(n){x(e,n,!0),n||x(t,!1)},toggleSidebar(){x(t,!v(t))},reset(){x(e,!1),x(t,!1)}}}function Eh(e=Sh()){return it(wh,e),e}const kh=Symbol("notifications-store");function xh(){let e=Z(Ce([]));return{get items(){return v(e)},add(t,n="info"){const r={id:`note_${Date.now()}_${Math.random().toString(16).slice(2)}`,message:t,level:n,ts:Date.now()};return x(e,[r,...v(e)],!0),r},remove(t){x(e,v(e).filter(n=>n.id!==t),!0)},clear(){x(e,[],!0)}}}function Th(e=xh()){return it(kh,e),e}function Ah(){return{chatStore:Yf(),sessionStore:Qf(),artifactsStore:th(),agentStore:sh(),eventsStore:lh(),trajectoryStore:ch(),specStore:fh(),setupStore:ph(),interactionsStore:_h(),componentRegistryStore:bh(),layoutStore:Eh(),notificationsStore:Th()}}const Cr="";class Vi extends Error{constructor(t,n,r){super(t),this.statusCode=n,this.details=r,this.name="ApiError"}}async function Ms(e,t){try{const n=t?await fetch(e,t):await fetch(e);return n.ok?{ok:!0,data:await n.json()}:{ok:!1,error:new Vi(n.statusText||"Request failed",n.status)}}catch(n){return{ok:!1,error:new Vi("Network error",0,n)}}}function Ih(e){if(!e)return null;const n=e.match(/filename="(.+?)"/)?.[1];if(n)return n;const s=e.match(/filename=([^;\s]+)/)?.[1];return s||null}async function Ch(){const e=await Ms(`${Cr}/ui/meta`);return e.ok?e.data:(console.error("meta load failed",e.error),null)}async function Nh(){const e=await Ms(`${Cr}/ui/components`);return e.ok?e.data:(console.error("component registry load failed",e.error),null)}async function Rh(){const e=await Ms(`${Cr}/ui/spec`);return e.ok?e.data:(console.error("spec load failed",e.error),null)}async function Hi(e,t){const n=await Ms(`${Cr}/trajectory/${e}?session_id=${encodeURIComponent(t)}`);return n.ok?n.data:(console.error("trajectory fetch failed",n.error),null)}async function Eu(e,t,n){const r=await fetch(`${Cr}/artifacts/${e}`,{headers:{"X-Session-ID":t}});if(!r.ok)throw new Error(`Download failed: ${r.status} ${r.statusText}`);const s=await r.blob(),a=r.headers.get("Content-Disposition"),i=n||Ih(a)||`artifact-${e}`,o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}var re;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},e.getValidEnumValues=s=>{const a=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return e.objectValues(i)},e.objectValues=s=>e.objectKeys(s).map(function(a){return s[a]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},e.find=(s,a)=>{for(const i of s)if(a(i))return i},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(re||(re={}));var qi;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(qi||(qi={}));const z=re.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jt=e=>{switch(typeof e){case"undefined":return z.undefined;case"string":return z.string;case"number":return Number.isNaN(e)?z.nan:z.number;case"boolean":return z.boolean;case"function":return z.function;case"bigint":return z.bigint;case"symbol":return z.symbol;case"object":return Array.isArray(e)?z.array:e===null?z.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?z.promise:typeof Map<"u"&&e instanceof Map?z.map:typeof Set<"u"&&e instanceof Set?z.set:typeof Date<"u"&&e instanceof Date?z.date:z.object;default:return z.unknown}},M=re.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ht extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(t){if(!(t instanceof Ht))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,re.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ht.create=e=>new Ht(e);const ma=(e,t)=>{let n;switch(e.code){case M.invalid_type:e.received===z.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case M.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,re.jsonStringifyReplacer)}`;break;case M.unrecognized_keys:n=`Unrecognized key(s) in object: ${re.joinValues(e.keys,", ")}`;break;case M.invalid_union:n="Invalid input";break;case M.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${re.joinValues(e.options)}`;break;case M.invalid_enum_value:n=`Invalid enum value. Expected ${re.joinValues(e.options)}, received '${e.received}'`;break;case M.invalid_arguments:n="Invalid function arguments";break;case M.invalid_return_type:n="Invalid function return type";break;case M.invalid_date:n="Invalid date";break;case M.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:re.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case M.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case M.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case M.custom:n="Invalid input";break;case M.invalid_intersection_types:n="Intersection results could not be merged";break;case M.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case M.not_finite:n="Number must be finite";break;default:n=t.defaultError,re.assertNever(e)}return{message:n}};let Oh=ma;function Ph(){return Oh}const Mh=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:t,defaultError:o}).message;return{...s,path:a,message:o}};function $(e,t){const n=Ph(),r=Mh({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===ma?void 0:ma].filter(s=>!!s)});e.common.issues.push(r)}class Ze{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return K;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return Ze.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return K;a.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:t.value,value:r}}}const K=Object.freeze({status:"aborted"}),cr=e=>({status:"dirty",value:e}),ht=e=>({status:"valid",value:e}),Zi=e=>e.status==="aborted",Xi=e=>e.status==="dirty",Jn=e=>e.status==="valid",hs=e=>typeof Promise<"u"&&e instanceof Promise;var B;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(B||(B={}));class It{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ki=(e,t)=>{if(Jn(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ht(e.common.issues);return this._error=n,this._error}}};function Y(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(i,o)=>{const{message:l}=e;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Q{get description(){return this._def.description}_getType(t){return Jt(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Jt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Ze,ctx:{common:t.parent.common,data:t.data,parsedType:Jt(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(hs(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)},s=this._parseSync({data:t,path:r.path,parent:r});return Ki(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return Jn(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>Jn(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Jt(t)},s=this._parse({data:t,path:r.path,parent:r}),a=await(hs(s)?s:Promise.resolve(s));return Ki(r,a)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=t(s),o=()=>a.addIssue({code:M.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Sn({schema:this,typeName:J.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Gt.create(this,this._def)}nullable(){return En.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Tt.create(this)}promise(){return bs.create(this,this._def)}or(t){return ps.create([this,t],this._def)}and(t){return gs.create(this,t,this._def)}transform(t){return new Sn({...Y(this._def),schema:this,typeName:J.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new ws({...Y(this._def),innerType:this,defaultValue:n,typeName:J.ZodDefault})}brand(){return new Au({typeName:J.ZodBranded,type:this,...Y(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Ss({...Y(this._def),innerType:this,catchValue:n,typeName:J.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return ai.create(this,t)}readonly(){return Es.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Lh=/^c[^\s-]{8,}$/i,Dh=/^[0-9a-z]+$/,$h=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Uh=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,zh=/^[a-z0-9_-]{21}$/i,Gh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,jh=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Bh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Fh="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Xs;const Vh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Hh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Xh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Kh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ku="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Jh=new RegExp(`^${ku}$`);function xu(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Yh(e){return new RegExp(`^${xu(e)}$`)}function Wh(e){let t=`${ku}T${xu(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Qh(e,t){return!!((t==="v4"||!t)&&Vh.test(e)||(t==="v6"||!t)&&qh.test(e))}function ev(e,t){if(!Gh.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function tv(e,t){return!!((t==="v4"||!t)&&Hh.test(e)||(t==="v6"||!t)&&Zh.test(e))}class Dt extends Q{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==z.string){const a=this._getOrReturnCtx(t);return $(a,{code:M.invalid_type,expected:z.string,received:a.parsedType}),K}const r=new Ze;let s;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(s=this._getOrReturnCtx(t,s),$(s,{code:M.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(s=this._getOrReturnCtx(t,s),$(s,{code:M.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=t.data.length>a.value,o=t.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(t,s),i?$(s,{code:M.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&$(s,{code:M.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")Bh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"email",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Xs||(Xs=new RegExp(Fh,"u")),Xs.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"emoji",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")Uh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"uuid",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")zh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"nanoid",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Lh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"cuid",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Dh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"cuid2",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")$h.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"ulid",code:M.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),$(s,{validation:"url",code:M.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"regex",code:M.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Wh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?Jh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Yh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{code:M.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?jh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"duration",code:M.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?Qh(t.data,a.version)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"ip",code:M.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?ev(t.data,a.alg)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"jwt",code:M.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?tv(t.data,a.version)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"cidr",code:M.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?Xh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"base64",code:M.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?Kh.test(t.data)||(s=this._getOrReturnCtx(t,s),$(s,{validation:"base64url",code:M.invalid_string,message:a.message}),r.dirty()):re.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:M.invalid_string,...B.errToObj(r)})}_addCheck(t){return new Dt({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...B.errToObj(t)})}url(t){return this._addCheck({kind:"url",...B.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...B.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...B.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...B.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...B.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...B.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...B.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...B.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...B.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...B.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...B.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...B.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...B.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...B.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...B.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...B.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...B.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...B.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...B.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...B.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...B.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...B.errToObj(n)})}nonempty(t){return this.min(1,B.errToObj(t))}trim(){return new Dt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Dt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Dt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Dt.create=e=>new Dt({checks:[],typeName:J.ZodString,coerce:e?.coerce??!1,...Y(e)});function nv(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(e.toFixed(s).replace(".","")),i=Number.parseInt(t.toFixed(s).replace(".",""));return a%i/10**s}class Yn extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==z.number){const a=this._getOrReturnCtx(t);return $(a,{code:M.invalid_type,expected:z.number,received:a.parsedType}),K}let r;const s=new Ze;for(const a of this._def.checks)a.kind==="int"?re.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{code:M.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?nv(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),$(r,{code:M.not_finite,message:a.message}),s.dirty()):re.assertNever(a);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,B.toString(n))}gt(t,n){return this.setLimit("min",t,!1,B.toString(n))}lte(t,n){return this.setLimit("max",t,!0,B.toString(n))}lt(t,n){return this.setLimit("max",t,!1,B.toString(n))}setLimit(t,n,r,s){return new Yn({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:B.toString(s)}]})}_addCheck(t){return new Yn({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:B.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:B.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:B.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:B.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:B.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&re.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Yn.create=e=>new Yn({checks:[],typeName:J.ZodNumber,coerce:e?.coerce||!1,...Y(e)});class wr extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==z.bigint)return this._getInvalidInput(t);let r;const s=new Ze;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),$(r,{code:M.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):re.assertNever(a);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return $(n,{code:M.invalid_type,expected:z.bigint,received:n.parsedType}),K}gte(t,n){return this.setLimit("min",t,!0,B.toString(n))}gt(t,n){return this.setLimit("min",t,!1,B.toString(n))}lte(t,n){return this.setLimit("max",t,!0,B.toString(n))}lt(t,n){return this.setLimit("max",t,!1,B.toString(n))}setLimit(t,n,r,s){return new wr({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:B.toString(s)}]})}_addCheck(t){return new wr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:B.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:B.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:B.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:B.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:B.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}wr.create=e=>new wr({checks:[],typeName:J.ZodBigInt,coerce:e?.coerce??!1,...Y(e)});class _a extends Q{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==z.boolean){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.boolean,received:r.parsedType}),K}return ht(t.data)}}_a.create=e=>new _a({typeName:J.ZodBoolean,coerce:e?.coerce||!1,...Y(e)});class vs extends Q{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==z.date){const a=this._getOrReturnCtx(t);return $(a,{code:M.invalid_type,expected:z.date,received:a.parsedType}),K}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return $(a,{code:M.invalid_date}),K}const r=new Ze;let s;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(s=this._getOrReturnCtx(t,s),$(s,{code:M.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(s=this._getOrReturnCtx(t,s),$(s,{code:M.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):re.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new vs({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:B.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:B.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}vs.create=e=>new vs({checks:[],coerce:e?.coerce||!1,typeName:J.ZodDate,...Y(e)});class Ji extends Q{_parse(t){if(this._getType(t)!==z.symbol){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.symbol,received:r.parsedType}),K}return ht(t.data)}}Ji.create=e=>new Ji({typeName:J.ZodSymbol,...Y(e)});class ya extends Q{_parse(t){if(this._getType(t)!==z.undefined){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.undefined,received:r.parsedType}),K}return ht(t.data)}}ya.create=e=>new ya({typeName:J.ZodUndefined,...Y(e)});class ba extends Q{_parse(t){if(this._getType(t)!==z.null){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.null,received:r.parsedType}),K}return ht(t.data)}}ba.create=e=>new ba({typeName:J.ZodNull,...Y(e)});class wa extends Q{constructor(){super(...arguments),this._any=!0}_parse(t){return ht(t.data)}}wa.create=e=>new wa({typeName:J.ZodAny,...Y(e)});class Yi extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ht(t.data)}}Yi.create=e=>new Yi({typeName:J.ZodUnknown,...Y(e)});class sn extends Q{_parse(t){const n=this._getOrReturnCtx(t);return $(n,{code:M.invalid_type,expected:z.never,received:n.parsedType}),K}}sn.create=e=>new sn({typeName:J.ZodNever,...Y(e)});class Wi extends Q{_parse(t){if(this._getType(t)!==z.undefined){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.void,received:r.parsedType}),K}return ht(t.data)}}Wi.create=e=>new Wi({typeName:J.ZodVoid,...Y(e)});class Tt extends Q{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==z.array)return $(n,{code:M.invalid_type,expected:z.array,received:n.parsedType}),K;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&($(n,{code:i?M.too_big:M.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&($(n,{code:M.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&($(n,{code:M.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new It(n,i,n.path,o)))).then(i=>Ze.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new It(n,i,n.path,o)));return Ze.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new Tt({...this._def,minLength:{value:t,message:B.toString(n)}})}max(t,n){return new Tt({...this._def,maxLength:{value:t,message:B.toString(n)}})}length(t,n){return new Tt({...this._def,exactLength:{value:t,message:B.toString(n)}})}nonempty(t){return this.min(1,t)}}Tt.create=(e,t)=>new Tt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:J.ZodArray,...Y(t)});function $n(e){if(e instanceof Re){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Gt.create($n(r))}return new Re({...e._def,shape:()=>t})}else return e instanceof Tt?new Tt({...e._def,type:$n(e.element)}):e instanceof Gt?Gt.create($n(e.unwrap())):e instanceof En?En.create($n(e.unwrap())):e instanceof bn?bn.create(e.items.map(t=>$n(t))):e}class Re extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=re.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==z.object){const u=this._getOrReturnCtx(t);return $(u,{code:M.invalid_type,expected:z.object,received:u.parsedType}),K}const{status:r,ctx:s}=this._processInputParams(t),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof sn&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const c=a[u],d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new It(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof sn){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&($(s,{code:M.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new It(s,d,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,h=await c.value;u.push({key:d,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>Ze.mergeObjectSync(r,u)):Ze.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return B.errToObj,new Re({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:B.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Re({...this._def,unknownKeys:"strip"})}passthrough(){return new Re({...this._def,unknownKeys:"passthrough"})}extend(t){return new Re({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Re({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:J.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Re({...this._def,catchall:t})}pick(t){const n={};for(const r of re.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Re({...this._def,shape:()=>n})}omit(t){const n={};for(const r of re.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Re({...this._def,shape:()=>n})}deepPartial(){return $n(this)}partial(t){const n={};for(const r of re.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Re({...this._def,shape:()=>n})}required(t){const n={};for(const r of re.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Gt;)a=a._def.innerType;n[r]=a}return new Re({...this._def,shape:()=>n})}keyof(){return Tu(re.objectKeys(this.shape))}}Re.create=(e,t)=>new Re({shape:()=>e,unknownKeys:"strip",catchall:sn.create(),typeName:J.ZodObject,...Y(t)});Re.strictCreate=(e,t)=>new Re({shape:()=>e,unknownKeys:"strict",catchall:sn.create(),typeName:J.ZodObject,...Y(t)});Re.lazycreate=(e,t)=>new Re({shape:e,unknownKeys:"strip",catchall:sn.create(),typeName:J.ZodObject,...Y(t)});class ps extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new Ht(o.ctx.common.issues));return $(n,{code:M.invalid_union,unionErrors:i}),K}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new Ht(l));return $(n,{code:M.invalid_union,unionErrors:o}),K}}get options(){return this._def.options}}ps.create=(e,t)=>new ps({options:e,typeName:J.ZodUnion,...Y(t)});const Pt=e=>e instanceof Ea?Pt(e.schema):e instanceof Sn?Pt(e.innerType()):e instanceof _s?[e.value]:e instanceof wn?e.options:e instanceof ys?re.objectValues(e.enum):e instanceof ws?Pt(e._def.innerType):e instanceof ya?[void 0]:e instanceof ba?[null]:e instanceof Gt?[void 0,...Pt(e.unwrap())]:e instanceof En?[null,...Pt(e.unwrap())]:e instanceof Au||e instanceof Es?Pt(e.unwrap()):e instanceof Ss?Pt(e._def.innerType):[];class si extends Q{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==z.object)return $(n,{code:M.invalid_type,expected:z.object,received:n.parsedType}),K;const r=this.discriminator,s=n.data[r],a=this.optionsMap.get(s);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):($(n,{code:M.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),K)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const a of n){const i=Pt(a.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,a)}}return new si({typeName:J.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Y(r)})}}function Sa(e,t){const n=Jt(e),r=Jt(t);if(e===t)return{valid:!0,data:e};if(n===z.object&&r===z.object){const s=re.objectKeys(t),a=re.objectKeys(e).filter(o=>s.indexOf(o)!==-1),i={...e,...t};for(const o of a){const l=Sa(e[o],t[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===z.array&&r===z.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let a=0;a<e.length;a++){const i=e[a],o=t[a],l=Sa(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===z.date&&r===z.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class gs extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(a,i)=>{if(Zi(a)||Zi(i))return K;const o=Sa(a.value,i.value);return o.valid?((Xi(a)||Xi(i))&&n.dirty(),{status:n.value,value:o.data}):($(r,{code:M.invalid_intersection_types}),K)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}gs.create=(e,t,n)=>new gs({left:e,right:t,typeName:J.ZodIntersection,...Y(n)});class bn extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.array)return $(r,{code:M.invalid_type,expected:z.array,received:r.parsedType}),K;if(r.data.length<this._def.items.length)return $(r,{code:M.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),K;!this._def.rest&&r.data.length>this._def.items.length&&($(r,{code:M.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new It(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>Ze.mergeArray(n,i)):Ze.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new bn({...this._def,rest:t})}}bn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new bn({items:e,typeName:J.ZodTuple,rest:null,...Y(t)})};class ms extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.object)return $(r,{code:M.invalid_type,expected:z.object,received:r.parsedType}),K;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in r.data)s.push({key:a._parse(new It(r,o,r.path,o)),value:i._parse(new It(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Ze.mergeObjectAsync(n,s):Ze.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Q?new ms({keyType:t,valueType:n,typeName:J.ZodRecord,...Y(r)}):new ms({keyType:Dt.create(),valueType:t,typeName:J.ZodRecord,...Y(n)})}}class Qi extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.map)return $(r,{code:M.invalid_type,expected:z.map,received:r.parsedType}),K;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new It(r,o,r.path,[u,"key"])),value:a._parse(new It(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return K;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return K;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}Qi.create=(e,t,n)=>new Qi({valueType:t,keyType:e,typeName:J.ZodMap,...Y(n)});class Sr extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==z.set)return $(r,{code:M.invalid_type,expected:z.set,received:r.parsedType}),K;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&($(r,{code:M.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&($(r,{code:M.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const c of l){if(c.status==="aborted")return K;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new It(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(t,n){return new Sr({...this._def,minSize:{value:t,message:B.toString(n)}})}max(t,n){return new Sr({...this._def,maxSize:{value:t,message:B.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Sr.create=(e,t)=>new Sr({valueType:e,minSize:null,maxSize:null,typeName:J.ZodSet,...Y(t)});class Ea extends Q{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Ea.create=(e,t)=>new Ea({getter:e,typeName:J.ZodLazy,...Y(t)});class _s extends Q{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return $(n,{received:n.data,code:M.invalid_literal,expected:this._def.value}),K}return{status:"valid",value:t.data}}get value(){return this._def.value}}_s.create=(e,t)=>new _s({value:e,typeName:J.ZodLiteral,...Y(t)});function Tu(e,t){return new wn({values:e,typeName:J.ZodEnum,...Y(t)})}class wn extends Q{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return $(n,{expected:re.joinValues(r),received:n.parsedType,code:M.invalid_type}),K}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return $(n,{received:n.data,code:M.invalid_enum_value,options:r}),K}return ht(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return wn.create(t,{...this._def,...n})}exclude(t,n=this._def){return wn.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}wn.create=Tu;class ys extends Q{_parse(t){const n=re.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==z.string&&r.parsedType!==z.number){const s=re.objectValues(n);return $(r,{expected:re.joinValues(s),received:r.parsedType,code:M.invalid_type}),K}if(this._cache||(this._cache=new Set(re.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=re.objectValues(n);return $(r,{received:r.data,code:M.invalid_enum_value,options:s}),K}return ht(t.data)}get enum(){return this._def.values}}ys.create=(e,t)=>new ys({values:e,typeName:J.ZodNativeEnum,...Y(t)});class bs extends Q{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==z.promise&&n.common.async===!1)return $(n,{code:M.invalid_type,expected:z.promise,received:n.parsedType}),K;const r=n.parsedType===z.promise?n.data:Promise.resolve(n.data);return ht(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}bs.create=(e,t)=>new bs({type:e,typeName:J.ZodPromise,...Y(t)});class Sn extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===J.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,a={addIssue:i=>{$(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return K;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?K:l.status==="dirty"||n.value==="dirty"?cr(l.value):l});{if(n.value==="aborted")return K;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?K:o.status==="dirty"||n.value==="dirty"?cr(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?K:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?K:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Jn(i))return K;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>Jn(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):K);re.assertNever(s)}}Sn.create=(e,t,n)=>new Sn({schema:e,typeName:J.ZodEffects,effect:t,...Y(n)});Sn.createWithPreprocess=(e,t,n)=>new Sn({schema:t,effect:{type:"preprocess",transform:e},typeName:J.ZodEffects,...Y(n)});class Gt extends Q{_parse(t){return this._getType(t)===z.undefined?ht(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Gt.create=(e,t)=>new Gt({innerType:e,typeName:J.ZodOptional,...Y(t)});class En extends Q{_parse(t){return this._getType(t)===z.null?ht(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}En.create=(e,t)=>new En({innerType:e,typeName:J.ZodNullable,...Y(t)});class ws extends Q{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===z.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}ws.create=(e,t)=>new ws({innerType:e,typeName:J.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Y(t)});class Ss extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return hs(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ht(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ht(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ss.create=(e,t)=>new Ss({innerType:e,typeName:J.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Y(t)});class eo extends Q{_parse(t){if(this._getType(t)!==z.nan){const r=this._getOrReturnCtx(t);return $(r,{code:M.invalid_type,expected:z.nan,received:r.parsedType}),K}return{status:"valid",value:t.data}}}eo.create=e=>new eo({typeName:J.ZodNaN,...Y(e)});class Au extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ai extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?K:a.status==="dirty"?(n.dirty(),cr(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?K:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new ai({in:t,out:n,typeName:J.ZodPipeline})}}class Es extends Q{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Jn(s)&&(s.value=Object.freeze(s.value)),s);return hs(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Es.create=(e,t)=>new Es({innerType:e,typeName:J.ZodReadonly,...Y(t)});var J;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(J||(J={}));const P=Dt.create,rv=Yn.create,ka=_a.create,Xe=wa.create;sn.create;const nn=Tt.create,ye=Re.create,ii=ps.create,Ls=si.create;gs.create;bn.create;const Iu=ms.create,F=_s.create,Cu=wn.create,sv=ys.create;bs.create;Gt.create;En.create;var av=ye({name:P(),arguments:P()}),iv=ye({id:P(),type:F("function"),function:av}),Ds=ye({id:P(),role:P(),content:P().optional(),name:P().optional()}),ov=ye({type:F("text"),text:P()}),Nu=ye({type:F("binary"),mimeType:P(),id:P().optional(),url:P().optional(),data:P().optional(),filename:P().optional()}),Ru=(e,t)=>{!e.id&&!e.url&&!e.data&&t.addIssue({code:M.custom,message:"BinaryInputContent requires at least one of id, url, or data.",path:["id"]})};Nu.superRefine((e,t)=>{Ru(e,t)});var lv=Ls("type",[ov,Nu]),uv=lv.superRefine((e,t)=>{e.type==="binary"&&Ru(e,t)}),cv=Ds.extend({role:F("developer"),content:P()}),dv=Ds.extend({role:F("system"),content:P()}),fv=Ds.extend({role:F("assistant"),content:P().optional(),toolCalls:nn(iv).optional()}),hv=Ds.extend({role:F("user"),content:ii([P(),nn(uv)])}),vv=ye({id:P(),content:P(),role:F("tool"),toolCallId:P(),error:P().optional()}),pv=ye({id:P(),role:F("activity"),activityType:P(),content:Iu(Xe())}),Ou=Ls("role",[cv,dv,fv,hv,vv,pv]);ii([F("developer"),F("system"),F("assistant"),F("user"),F("tool"),F("activity")]);var gv=ye({description:P(),value:P()}),mv=ye({name:P(),description:P(),parameters:Xe()}),_v=ye({threadId:P(),runId:P(),parentRunId:P().optional(),state:Xe(),messages:nn(Ou),tools:nn(mv),context:nn(gv),forwardedProps:Xe()}),yv=Xe(),ke=class extends Error{constructor(e){super(e)}},to=class extends ke{constructor(){super("Connect not implemented. This method is not supported by the current agent.")}},Pu=ii([F("developer"),F("system"),F("assistant"),F("user")]),T=(e=>(e.TEXT_MESSAGE_START="TEXT_MESSAGE_START",e.TEXT_MESSAGE_CONTENT="TEXT_MESSAGE_CONTENT",e.TEXT_MESSAGE_END="TEXT_MESSAGE_END",e.TEXT_MESSAGE_CHUNK="TEXT_MESSAGE_CHUNK",e.THINKING_TEXT_MESSAGE_START="THINKING_TEXT_MESSAGE_START",e.THINKING_TEXT_MESSAGE_CONTENT="THINKING_TEXT_MESSAGE_CONTENT",e.THINKING_TEXT_MESSAGE_END="THINKING_TEXT_MESSAGE_END",e.TOOL_CALL_START="TOOL_CALL_START",e.TOOL_CALL_ARGS="TOOL_CALL_ARGS",e.TOOL_CALL_END="TOOL_CALL_END",e.TOOL_CALL_CHUNK="TOOL_CALL_CHUNK",e.TOOL_CALL_RESULT="TOOL_CALL_RESULT",e.THINKING_START="THINKING_START",e.THINKING_END="THINKING_END",e.STATE_SNAPSHOT="STATE_SNAPSHOT",e.STATE_DELTA="STATE_DELTA",e.MESSAGES_SNAPSHOT="MESSAGES_SNAPSHOT",e.ACTIVITY_SNAPSHOT="ACTIVITY_SNAPSHOT",e.ACTIVITY_DELTA="ACTIVITY_DELTA",e.RAW="RAW",e.CUSTOM="CUSTOM",e.RUN_STARTED="RUN_STARTED",e.RUN_FINISHED="RUN_FINISHED",e.RUN_ERROR="RUN_ERROR",e.STEP_STARTED="STEP_STARTED",e.STEP_FINISHED="STEP_FINISHED",e))(T||{}),_e=ye({type:sv(T),timestamp:rv().optional(),rawEvent:Xe().optional()}),bv=_e.extend({type:F("TEXT_MESSAGE_START"),messageId:P(),role:Pu.default("assistant")}),Mu=_e.extend({type:F("TEXT_MESSAGE_CONTENT"),messageId:P(),delta:P().refine(e=>e.length>0,"Delta must not be an empty string")}),wv=_e.extend({type:F("TEXT_MESSAGE_END"),messageId:P()}),Sv=_e.extend({type:F("TEXT_MESSAGE_CHUNK"),messageId:P().optional(),role:Pu.optional(),delta:P().optional()}),Ev=_e.extend({type:F("THINKING_TEXT_MESSAGE_START")}),kv=Mu.omit({messageId:!0,type:!0}).extend({type:F("THINKING_TEXT_MESSAGE_CONTENT")}),xv=_e.extend({type:F("THINKING_TEXT_MESSAGE_END")}),Tv=_e.extend({type:F("TOOL_CALL_START"),toolCallId:P(),toolCallName:P(),parentMessageId:P().optional()}),Av=_e.extend({type:F("TOOL_CALL_ARGS"),toolCallId:P(),delta:P()}),Iv=_e.extend({type:F("TOOL_CALL_END"),toolCallId:P()}),Cv=_e.extend({messageId:P(),type:F("TOOL_CALL_RESULT"),toolCallId:P(),content:P(),role:F("tool").optional()}),Nv=_e.extend({type:F("TOOL_CALL_CHUNK"),toolCallId:P().optional(),toolCallName:P().optional(),parentMessageId:P().optional(),delta:P().optional()}),Rv=_e.extend({type:F("THINKING_START"),title:P().optional()}),Ov=_e.extend({type:F("THINKING_END")}),Pv=_e.extend({type:F("STATE_SNAPSHOT"),snapshot:yv}),Mv=_e.extend({type:F("STATE_DELTA"),delta:nn(Xe())}),Lv=_e.extend({type:F("MESSAGES_SNAPSHOT"),messages:nn(Ou)}),Dv=_e.extend({type:F("ACTIVITY_SNAPSHOT"),messageId:P(),activityType:P(),content:Iu(Xe()),replace:ka().optional().default(!0)}),$v=_e.extend({type:F("ACTIVITY_DELTA"),messageId:P(),activityType:P(),patch:nn(Xe())}),Uv=_e.extend({type:F("RAW"),event:Xe(),source:P().optional()}),zv=_e.extend({type:F("CUSTOM"),name:P(),value:Xe()}),Gv=_e.extend({type:F("RUN_STARTED"),threadId:P(),runId:P(),parentRunId:P().optional(),input:_v.optional()}),jv=_e.extend({type:F("RUN_FINISHED"),threadId:P(),runId:P(),result:Xe().optional()}),Bv=_e.extend({type:F("RUN_ERROR"),message:P(),code:P().optional()}),Fv=_e.extend({type:F("STEP_STARTED"),stepName:P()}),Vv=_e.extend({type:F("STEP_FINISHED"),stepName:P()}),Lu=Ls("type",[bv,Mu,wv,Sv,Rv,Ov,Ev,kv,xv,Tv,Av,Iv,Nv,Cv,Pv,Mv,Lv,Dv,$v,Uv,zv,Gv,jv,Bv,Fv,Vv]);function Te(e){return typeof e=="function"}function Hv(e){return Te(e?.lift)}function Ot(e){return function(t){if(Hv(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var xa=function(e,t){return xa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},xa(e,t)};function rr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");xa(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function qv(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(c){try{u(r.next(c))}catch(d){i(d)}}function l(c){try{u(r.throw(c))}catch(d){i(d)}}function u(c){c.done?a(c.value):s(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function Du(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(c){u=[6,c],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Wn(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ta(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,a=[],i;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(o){i={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function Aa(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function Fn(e){return this instanceof Fn?(this.v=e,this):new Fn(e)}function Zv(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(f){return function(p){return Promise.resolve(p).then(f,d)}}function o(f,p){r[f]&&(s[f]=function(m){return new Promise(function(g,b){a.push([f,m,g,b])>1||l(f,m)})},p&&(s[f]=p(s[f])))}function l(f,p){try{u(r[f](p))}catch(m){h(a[0][3],m)}}function u(f){f.value instanceof Fn?Promise.resolve(f.value.v).then(c,d):h(a[0][2],f)}function c(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function Xv(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Wn=="function"?Wn(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(i){return new Promise(function(o,l){i=e[a](i),s(o,l,i.done,i.value)})}}function s(a,i,o,l){Promise.resolve(l).then(function(u){a({value:u,done:o})},i)}}var $u=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function Uu(e){return Te(e?.then)}function oi(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ks=oi(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Ia(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var $s=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=Wn(i),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(m){t={error:m}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}else i.remove(this);var c=this.initialTeardown;if(Te(c))try{c()}catch(m){a=m instanceof Ks?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=Wn(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{no(p)}catch(m){a=a??[],m instanceof Ks?a=Aa(Aa([],Ta(a)),Ta(m.errors)):a.push(m)}}}catch(m){r={error:m}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(a)throw new Ks(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)no(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&Ia(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ia(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),zu=$s.EMPTY;function Gu(e){return e instanceof $s||e&&"closed"in e&&Te(e.remove)&&Te(e.add)&&Te(e.unsubscribe)}function no(e){Te(e)?e():e.unsubscribe()}var Kv={Promise:void 0},Jv={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Aa([e,t],Ta(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function ju(e){Jv.setTimeout(function(){throw e})}function Ca(){}function $r(e){e()}var li=(function(e){rr(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Gu(n)&&n.add(r)):r.destination=Qv,r}return t.create=function(n,r,s){return new Na(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})($s),Yv=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Mr(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Mr(r)}else Mr(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Mr(n)}},e})(),Na=(function(e){rr(t,e);function t(n,r,s){var a=e.call(this)||this,i;return Te(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,a.destination=new Yv(i),a}return t})(li);function Mr(e){ju(e)}function Wv(e){throw e}var Qv={closed:!0,next:Ca,error:Wv,complete:Ca},ui=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function ci(e){return e}function ro(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bu(e)}function Bu(e){return e.length===0?ci:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var Ke=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,a=tp(t)?t:new Na(t,n,r);return $r(function(){var i=s,o=i.operator,l=i.source;a.add(o?o.call(a,l):l?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=so(n),new n(function(s,a){var i=new Na({next:function(o){try{t(o)}catch(l){a(l),i.unsubscribe()}},error:a,complete:s});r.subscribe(i)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ui]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Bu(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=so(t),new t(function(r,s){var a;n.subscribe(function(i){return a=i},function(i){return s(i)},function(){return r(a)})})},e.create=function(t){return new e(t)},e})();function so(e){var t;return(t=e??Kv.Promise)!==null&&t!==void 0?t:Promise}function ep(e){return e&&Te(e.next)&&Te(e.error)&&Te(e.complete)}function tp(e){return e&&e instanceof li||ep(e)&&Gu(e)}function Fu(e){return Te(e[ui])}function Vu(e){return Symbol.asyncIterator&&Te(e?.[Symbol.asyncIterator])}function Hu(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function np(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var qu=np();function Zu(e){return Te(e?.[qu])}function Xu(e){return Zv(this,arguments,function(){var n,r,s,a;return Du(this,function(i){switch(i.label){case 0:n=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Fn(n.read())];case 3:return r=i.sent(),s=r.value,a=r.done,a?[4,Fn(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Fn(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Ku(e){return Te(e?.getReader)}function Xt(e){if(e instanceof Ke)return e;if(e!=null){if(Fu(e))return rp(e);if($u(e))return sp(e);if(Uu(e))return ap(e);if(Vu(e))return Ju(e);if(Zu(e))return ip(e);if(Ku(e))return op(e)}throw Hu(e)}function rp(e){return new Ke(function(t){var n=e[ui]();if(Te(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function sp(e){return new Ke(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function ap(e){return new Ke(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,ju)})}function ip(e){return new Ke(function(t){var n,r;try{for(var s=Wn(e),a=s.next();!a.done;a=s.next()){var i=a.value;if(t.next(i),t.closed)return}}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t.complete()})}function Ju(e){return new Ke(function(t){lp(e,t).catch(function(n){return t.error(n)})})}function op(e){return Ju(Xu(e))}function lp(e,t){var n,r,s,a;return qv(this,void 0,void 0,function(){var i,o;return Du(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=Xv(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Ct(e,t,n,r,s){return new up(e,t,n,r,s)}var up=(function(e){rr(t,e);function t(n,r,s,a,i,o){var l=e.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(li),Yu={now:function(){return(Yu.delegate||Date).now()},delegate:void 0};function cp(e){return e&&Te(e.schedule)}function dp(e){return e[e.length-1]}function fp(e){return cp(dp(e))?e.pop():void 0}function mn(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var a=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!s)return a}function Ra(e){return Ot(function(t,n){var r=null,s=!1,a;r=t.subscribe(Ct(n,void 0,void 0,function(i){a=Xt(e(i,Ra(e)(t))),r?(r.unsubscribe(),r=null,a.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,a.subscribe(n))})}function Wu(e,t){return t===void 0&&(t=0),Ot(function(n,r){n.subscribe(Ct(r,function(s){return mn(r,e,function(){return r.next(s)},t)},function(){return mn(r,e,function(){return r.complete()},t)},function(s){return mn(r,e,function(){return r.error(s)},t)}))})}function Qu(e,t){return t===void 0&&(t=0),Ot(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function hp(e,t){return Xt(e).pipe(Qu(t),Wu(t))}function vp(e,t){return Xt(e).pipe(Qu(t),Wu(t))}function pp(e,t){return new Ke(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function gp(e,t){return new Ke(function(n){var r;return mn(n,t,function(){r=e[qu](),mn(n,t,function(){var s,a,i;try{s=r.next(),a=s.value,i=s.done}catch(o){n.error(o);return}i?n.complete():n.next(a)},0,!0)}),function(){return Te(r?.return)&&r.return()}})}function ec(e,t){if(!e)throw new Error("Iterable cannot be null");return new Ke(function(n){mn(n,t,function(){var r=e[Symbol.asyncIterator]();mn(n,t,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function mp(e,t){return ec(Xu(e),t)}function _p(e,t){if(e!=null){if(Fu(e))return hp(e,t);if($u(e))return pp(e,t);if(Uu(e))return vp(e,t);if(Vu(e))return ec(e,t);if(Zu(e))return gp(e,t);if(Ku(e))return mp(e,t)}throw Hu(e)}function ks(e,t){return t?_p(e,t):Xt(e)}function Oa(e,t){return Ot(function(n,r){var s=0;n.subscribe(Ct(r,function(a){r.next(e.call(t,a,s++))}))})}function yp(e,t,n,r,s,a,i,o){var l=[],u=0,c=0,d=!1,h=function(){d&&!l.length&&!u&&t.complete()},f=function(m){return u<r?p(m):l.push(m)},p=function(m){u++;var g=!1;Xt(n(m,c++)).subscribe(Ct(t,function(b){t.next(b)},function(){g=!0},void 0,function(){if(g)try{u--;for(var b=function(){var w=l.shift();i||p(w)};l.length&&u<r;)b();h()}catch(w){t.error(w)}}))};return e.subscribe(Ct(t,f,function(){d=!0,h()})),function(){}}function an(e,t,n){return n===void 0&&(n=1/0),Te(t)?an(function(r,s){return Oa(function(a,i){return t(r,a,s,i)})(Xt(e(r,s)))},n):(typeof t=="number"&&(n=t),Ot(function(r,s){return yp(r,s,e,n)}))}function bp(e){return e===void 0&&(e=1/0),an(ci,e)}function tc(e,t){return Te(t)?an(e,t,1):an(e,1)}var wp=oi(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),kn=(function(e){rr(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new ao(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new wp},t.prototype.next=function(n){var r=this;$r(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=Wn(r.currentObservers),o=i.next();!o.done;o=i.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;$r(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;$r(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,a=s.hasError,i=s.isStopped,o=s.observers;return a||i?zu:(this.currentObservers=null,o.push(n),new $s(function(){r.currentObservers=null,Ia(o,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,a=r.thrownError,i=r.isStopped;s?n.error(a):i&&n.complete()},t.prototype.asObservable=function(){var n=new Ke;return n.source=this,n},t.create=function(n,r){return new ao(n,r)},t})(Ke),ao=(function(e){rr(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:zu},t})(kn);function Sp(e){return Ot(function(t,n){var r=!1;t.subscribe(Ct(n,function(s){r=!0,n.next(s)},function(){r||n.next(e),n.complete()}))})}var nc=new Ke(function(e){return e.complete()});function Ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fp(e);return ks(e,n)}function we(e,t){var n=Te(e)?e:function(){return e},r=function(s){return s.error(n())};return new Ke(r)}var Ep=oi(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Pa(e){return Ot(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}var rc=(function(e){rr(t,e);function t(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Yu);var a=e.call(this)||this;return a._bufferSize=n,a._windowTime=r,a._timestampProvider=s,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,n),a._windowTime=Math.max(1,r),a}return t.prototype.next=function(n){var r=this,s=r.isStopped,a=r._buffer,i=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(a.push(n),!i&&a.push(o.now()+l)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,a=s._infiniteTimeWindow,i=s._buffer,o=i.slice(),l=0;l<o.length&&!n.closed;l+=a?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},t.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,a=n._buffer,i=n._infiniteTimeWindow,o=(i?1:2)*r;if(r<1/0&&o<a.length&&a.splice(0,a.length-o),!i){for(var l=s.now(),u=0,c=1;c<a.length&&a[c]<=l;c+=2)u=c;u&&a.splice(0,u+1)}},t})(kn);function kp(e,t){return Ot(function(n,r){var s=null,a=0,i=!1,o=function(){return i&&!s&&r.complete()};n.subscribe(Ct(r,function(l){s?.unsubscribe();var u=0,c=a++;Xt(e(l,c)).subscribe(s=Ct(r,function(d){return r.next(t?t(l,d,c,u++):d)},function(){s=null,o()}))},function(){i=!0,o()}))})}function io(e){return Ot(function(t,n){Xt(e).subscribe(Ct(n,function(){return n.complete()},Ca)),!n.closed&&t.subscribe(n)})}function xp(e,t,n){var r=Te(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ot(function(s,a){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var o=!0;s.subscribe(Ct(a,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),a.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),a.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),a.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):ci}function oo(e,t){return new Promise(function(n,r){var s=!1,a;e.subscribe({next:function(i){a=i,s=!0},error:r,complete:function(){s?n(a):r(new Ep)}})})}function Tp(e){return new Ke(function(t){Xt(e()).subscribe(t)})}const Ue=[];for(let e=0;e<256;++e)Ue.push((e+256).toString(16).slice(1));function Ap(e,t=0){return(Ue[e[t+0]]+Ue[e[t+1]]+Ue[e[t+2]]+Ue[e[t+3]]+"-"+Ue[e[t+4]]+Ue[e[t+5]]+"-"+Ue[e[t+6]]+Ue[e[t+7]]+"-"+Ue[e[t+8]]+Ue[e[t+9]]+"-"+Ue[e[t+10]]+Ue[e[t+11]]+Ue[e[t+12]]+Ue[e[t+13]]+Ue[e[t+14]]+Ue[e[t+15]]).toLowerCase()}let Js;const Ip=new Uint8Array(16);function Cp(){if(!Js){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Js=crypto.getRandomValues.bind(crypto)}return Js(Ip)}const Np=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),lo={randomUUID:Np};function ar(e,t,n){if(lo.randomUUID&&!e)return lo.randomUUID();e=e||{};const r=e.random??e.rng?.()??Cp();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ap(r)}function uo(e){return` \r
	`.indexOf(e)>=0}function sc(e){for(var t=["topLevel"],n=0,r,s,a,i=function(w){return t.push(w)},o=function(w){return t[t.length-1]=w},l=function(w){r==null&&(r=n,s=t.length,a=w)},u=function(w){w===a&&(r=void 0,s=void 0,a=void 0)},c=function(){return t.pop()},d=function(){return n--},h=function(w){if("0"<=w&&w<="9"){i("number");return}switch(w){case'"':i("string");return;case"-":i("numberNeedsDigit");return;case"t":i("true");return;case"f":i("false");return;case"n":i("null");return;case"[":i("arrayNeedsValue");return;case"{":i("objectNeedsKey");return}},f=e.length;n<f;n++){var p=e[n];switch(t[t.length-1]){case"topLevel":h(p);break;case"string":switch(p){case'"':c();break;case"\\":l("stringEscape"),i("stringEscaped");break}break;case"stringEscaped":p==="u"?i("stringUnicode"):(u("stringEscape"),c());break;case"stringUnicode":n-e.lastIndexOf("u",n)===4&&(u("stringEscape"),c());break;case"number":p==="."?o("numberNeedsDigit"):p==="e"||p==="E"?o("numberNeedsExponent"):(p<"0"||p>"9")&&(d(),c());break;case"numberNeedsDigit":o("number");break;case"numberNeedsExponent":o(p==="+"||p==="-"?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(p<"a"||p>"z")&&(d(),c());break;case"arrayNeedsValue":p==="]"?c():uo(p)||(u("collectionItem"),o("arrayNeedsComma"),h(p));break;case"arrayNeedsComma":p==="]"?c():p===","&&(l("collectionItem"),o("arrayNeedsValue"));break;case"objectNeedsKey":p==="}"?c():p==='"'&&(l("collectionItem"),o("objectNeedsColon"),i("string"));break;case"objectNeedsColon":p===":"&&o("objectNeedsValue");break;case"objectNeedsValue":uo(p)||(u("collectionItem"),o("objectNeedsComma"),h(p));break;case"objectNeedsComma":p==="}"?c():p===","&&(l("collectionItem"),o("objectNeedsKey"));break}}s!=null&&(t.length=s);for(var m=[r!=null?e.slice(0,r):e],g=function(w){return m.push(w.slice(e.length-e.lastIndexOf(w[0])))},b=t.length-1;b>=0;b--)switch(t[b]){case"string":m.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":m.push("0");break;case"true":g("true");break;case"false":g("false");break;case"null":g("null");break;case"arrayNeedsValue":case"arrayNeedsComma":m.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":m.push("}");break}return m.join("")}function Rp(){let e=0,t=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,(n&128)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Ys(e,t,n){for(let a=0;a<28;a=a+7){const i=e>>>a,o=!(!(i>>>7)&&t==0),l=(o?i|128:i)&255;if(n.push(l),!o)return}const r=e>>>28&15|(t&7)<<4,s=t>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let a=3;a<31;a=a+7){const i=t>>>a,o=!!(i>>>7),l=(o?i|128:i)&255;if(n.push(l),!o)return}n.push(t>>>31&1)}}const Ur=4294967296;function co(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function a(i,o){const l=Number(e.slice(i,o));s*=n,r=r*n+l,r>=Ur&&(s=s+(r/Ur|0),r=r%Ur)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?ic(r,s):di(r,s)}function Op(e,t){let n=di(e,t);const r=n.hi&2147483648;r&&(n=ic(n.lo,n.hi));const s=ac(n.lo,n.hi);return r?"-"+s:s}function ac(e,t){if({lo:e,hi:t}=Pp(e,t),t<=2097151)return String(Ur*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,s=t>>16&65535;let a=n+r*6777216+s*6710656,i=r+s*8147497,o=s*2;const l=1e7;return a>=l&&(i+=Math.floor(a/l),a%=l),i>=l&&(o+=Math.floor(i/l),i%=l),o.toString()+fo(i)+fo(a)}function Pp(e,t){return{lo:e>>>0,hi:t>>>0}}function di(e,t){return{lo:e|0,hi:t|0}}function ic(e,t){return t=~t,e?e=~e+1:t+=1,di(e,t)}const fo=e=>{const t=String(e);return"0000000".slice(t.length)+t};function ho(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function Mp(){let e=this.buf[this.pos++],t=e&127;if((e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,(e&128)==0)return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;(e&128)!==0&&n<10;n++)e=this.buf[this.pos++];if((e&128)!=0)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var vo={};const St=Lp();function Lp(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof vo!="object"||vo.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>r||o<n)throw new Error(`invalid int64: ${i}`);return o},uParse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>a||o<s)throw new Error(`invalid uint64: ${i}`);return o},enc(i){return e.setBigInt64(0,this.parse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(i){return e.setBigInt64(0,this.uParse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigInt64(0,!0)},uDec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),po(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),go(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),po(n),co(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),go(n),co(n)},dec(n,r){return Op(n,r)},uDec(n,r){return ac(n,r)}}}function po(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function go(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const Ws=Symbol.for("@bufbuild/protobuf/text-encoding");function oc(){if(globalThis[Ws]==null){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[Ws]={encodeUtf8(n){return e.encode(n)},decodeUtf8(n){return t.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[Ws]}var Yt;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(Yt||(Yt={}));const Dp=34028234663852886e22,$p=-34028234663852886e22,Up=4294967295,zp=2147483647,Gp=-2147483648;class fe{constructor(t=oc().encodeUtf8){this.encodeUtf8=t,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let t=0;for(let s=0;s<this.chunks.length;s++)t+=this.chunks[s].length;let n=new Uint8Array(t),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(mo(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Qs(t),ho(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.encodeUtf8(t);return this.uint32(n.byteLength),this.raw(n)}float(t){jp(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){mo(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){Qs(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return Qs(t),t=(t<<1^t>>31)>>>0,ho(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=St.enc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=St.uEnc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(t){let n=St.enc(t);return Ys(n.lo,n.hi,this.buf),this}sint64(t){const n=St.enc(t),r=n.hi>>31,s=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Ys(s,a,this.buf),this}uint64(t){const n=St.uEnc(t);return Ys(n.lo,n.hi,this.buf),this}}class V{constructor(t,n=oc().decodeUtf8){this.decodeUtf8=n,this.varint64=Rp,this.uint32=Mp,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength)}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t,n){let r=this.pos;switch(t){case Yt.Varint:for(;this.buf[this.pos++]&128;);break;case Yt.Bit64:this.pos+=4;case Yt.Bit32:this.pos+=4;break;case Yt.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Yt.StartGroup:for(;;){const[a,i]=this.tag();if(i===Yt.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(i,a)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return St.dec(...this.varint64())}uint64(){return St.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,St.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return St.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return St.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.decodeUtf8(this.bytes())}}function Qs(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>zp||e<Gp)throw new Error("invalid int32: "+e)}function mo(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>Up||e<0)throw new Error("invalid uint32: "+e)}function jp(e){if(typeof e=="string"){const t=e;if(e=Number(e),Number.isNaN(e)&&t!=="NaN")throw new Error("invalid float32: "+t)}else if(typeof e!="number")throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>Dp||e<$p))throw new Error("invalid float32: "+e)}function ea(){return{fields:{}}}var dr={encode(e,t=new fe){return Object.entries(e.fields).forEach(([n,r])=>{r!==void 0&&Ma.encode({key:n,value:r},t.uint32(10).fork()).join()}),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=ea();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;const i=Ma.decode(n,n.uint32());i.value!==void 0&&(s.fields[i.key]=i.value);continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return dr.fromPartial(e??{})},fromPartial(e){var t;const n=ea();return n.fields=Object.entries((t=e.fields)!=null?t:{}).reduce((r,[s,a])=>(a!==void 0&&(r[s]=a),r),{}),n},wrap(e){const t=ea();if(e!==void 0)for(const n of Object.keys(e))t.fields[n]=e[n];return t},unwrap(e){const t={};if(e.fields)for(const n of Object.keys(e.fields))t[n]=e.fields[n];return t}};function _o(){return{key:"",value:void 0}}var Ma={encode(e,t=new fe){return e.key!==""&&t.uint32(10).string(e.key),e.value!==void 0&&se.encode(se.wrap(e.value),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=_o();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.key=n.string();continue}case 2:{if(a!==18)break;s.value=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ma.fromPartial(e??{})},fromPartial(e){var t,n;const r=_o();return r.key=(t=e.key)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function ta(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}var se={encode(e,t=new fe){return e.nullValue!==void 0&&t.uint32(8).int32(e.nullValue),e.numberValue!==void 0&&t.uint32(17).double(e.numberValue),e.stringValue!==void 0&&t.uint32(26).string(e.stringValue),e.boolValue!==void 0&&t.uint32(32).bool(e.boolValue),e.structValue!==void 0&&dr.encode(dr.wrap(e.structValue),t.uint32(42).fork()).join(),e.listValue!==void 0&&fr.encode(fr.wrap(e.listValue),t.uint32(50).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=ta();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.nullValue=n.int32();continue}case 2:{if(a!==17)break;s.numberValue=n.double();continue}case 3:{if(a!==26)break;s.stringValue=n.string();continue}case 4:{if(a!==32)break;s.boolValue=n.bool();continue}case 5:{if(a!==42)break;s.structValue=dr.unwrap(dr.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.listValue=fr.unwrap(fr.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return se.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i;const o=ta();return o.nullValue=(t=e.nullValue)!=null?t:void 0,o.numberValue=(n=e.numberValue)!=null?n:void 0,o.stringValue=(r=e.stringValue)!=null?r:void 0,o.boolValue=(s=e.boolValue)!=null?s:void 0,o.structValue=(a=e.structValue)!=null?a:void 0,o.listValue=(i=e.listValue)!=null?i:void 0,o},wrap(e){const t=ta();if(e===null)t.nullValue=0;else if(typeof e=="boolean")t.boolValue=e;else if(typeof e=="number")t.numberValue=e;else if(typeof e=="string")t.stringValue=e;else if(globalThis.Array.isArray(e))t.listValue=e;else if(typeof e=="object")t.structValue=e;else if(typeof e<"u")throw new globalThis.Error("Unsupported any value type: "+typeof e);return t},unwrap(e){if(e.stringValue!==void 0)return e.stringValue;if(e?.numberValue!==void 0)return e.numberValue;if(e?.boolValue!==void 0)return e.boolValue;if(e?.structValue!==void 0)return e.structValue;if(e?.listValue!==void 0)return e.listValue;if(e?.nullValue!==void 0)return null}};function na(){return{values:[]}}var fr={encode(e,t=new fe){for(const n of e.values)se.encode(se.wrap(n),t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=na();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.values.push(se.unwrap(se.decode(n,n.uint32())));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return fr.fromPartial(e??{})},fromPartial(e){var t;const n=na();return n.values=((t=e.values)==null?void 0:t.map(r=>r))||[],n},wrap(e){const t=na();return t.values=e??[],t},unwrap(e){return e?.hasOwnProperty("values")&&globalThis.Array.isArray(e.values)?e.values:e}},lc=(e=>(e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.REPLACE=2]="REPLACE",e[e.MOVE=3]="MOVE",e[e.COPY=4]="COPY",e[e.TEST=5]="TEST",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(lc||{});function yo(){return{op:0,path:"",from:void 0,value:void 0}}var zr={encode(e,t=new fe){return e.op!==0&&t.uint32(8).int32(e.op),e.path!==""&&t.uint32(18).string(e.path),e.from!==void 0&&t.uint32(26).string(e.from),e.value!==void 0&&se.encode(se.wrap(e.value),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=yo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.op=n.int32();continue}case 2:{if(a!==18)break;s.path=n.string();continue}case 3:{if(a!==26)break;s.from=n.string();continue}case 4:{if(a!==34)break;s.value=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return zr.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=yo();return a.op=(t=e.op)!=null?t:0,a.path=(n=e.path)!=null?n:"",a.from=(r=e.from)!=null?r:void 0,a.value=(s=e.value)!=null?s:void 0,a}};function bo(){return{id:"",type:"",function:void 0}}var Gr={encode(e,t=new fe){return e.id!==""&&t.uint32(10).string(e.id),e.type!==""&&t.uint32(18).string(e.type),e.function!==void 0&&jr.encode(e.function,t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=bo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.type=n.string();continue}case 3:{if(a!==26)break;s.function=jr.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Gr.fromPartial(e??{})},fromPartial(e){var t,n;const r=bo();return r.id=(t=e.id)!=null?t:"",r.type=(n=e.type)!=null?n:"",r.function=e.function!==void 0&&e.function!==null?jr.fromPartial(e.function):void 0,r}};function wo(){return{name:"",arguments:""}}var jr={encode(e,t=new fe){return e.name!==""&&t.uint32(10).string(e.name),e.arguments!==""&&t.uint32(18).string(e.arguments),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=wo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.name=n.string();continue}case 2:{if(a!==18)break;s.arguments=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return jr.fromPartial(e??{})},fromPartial(e){var t,n;const r=wo();return r.name=(t=e.name)!=null?t:"",r.arguments=(n=e.arguments)!=null?n:"",r}};function So(){return{id:"",role:"",content:void 0,name:void 0,toolCalls:[],toolCallId:void 0,error:void 0}}var Br={encode(e,t=new fe){e.id!==""&&t.uint32(10).string(e.id),e.role!==""&&t.uint32(18).string(e.role),e.content!==void 0&&t.uint32(26).string(e.content),e.name!==void 0&&t.uint32(34).string(e.name);for(const n of e.toolCalls)Gr.encode(n,t.uint32(42).fork()).join();return e.toolCallId!==void 0&&t.uint32(50).string(e.toolCallId),e.error!==void 0&&t.uint32(58).string(e.error),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=So();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.role=n.string();continue}case 3:{if(a!==26)break;s.content=n.string();continue}case 4:{if(a!==34)break;s.name=n.string();continue}case 5:{if(a!==42)break;s.toolCalls.push(Gr.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.toolCallId=n.string();continue}case 7:{if(a!==58)break;s.error=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Br.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i,o;const l=So();return l.id=(t=e.id)!=null?t:"",l.role=(n=e.role)!=null?n:"",l.content=(r=e.content)!=null?r:void 0,l.name=(s=e.name)!=null?s:void 0,l.toolCalls=((a=e.toolCalls)==null?void 0:a.map(u=>Gr.fromPartial(u)))||[],l.toolCallId=(i=e.toolCallId)!=null?i:void 0,l.error=(o=e.error)!=null?o:void 0,l}},uc=(e=>(e[e.TEXT_MESSAGE_START=0]="TEXT_MESSAGE_START",e[e.TEXT_MESSAGE_CONTENT=1]="TEXT_MESSAGE_CONTENT",e[e.TEXT_MESSAGE_END=2]="TEXT_MESSAGE_END",e[e.TOOL_CALL_START=3]="TOOL_CALL_START",e[e.TOOL_CALL_ARGS=4]="TOOL_CALL_ARGS",e[e.TOOL_CALL_END=5]="TOOL_CALL_END",e[e.STATE_SNAPSHOT=6]="STATE_SNAPSHOT",e[e.STATE_DELTA=7]="STATE_DELTA",e[e.MESSAGES_SNAPSHOT=8]="MESSAGES_SNAPSHOT",e[e.RAW=9]="RAW",e[e.CUSTOM=10]="CUSTOM",e[e.RUN_STARTED=11]="RUN_STARTED",e[e.RUN_FINISHED=12]="RUN_FINISHED",e[e.RUN_ERROR=13]="RUN_ERROR",e[e.STEP_STARTED=14]="STEP_STARTED",e[e.STEP_FINISHED=15]="STEP_FINISHED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(uc||{});function Eo(){return{type:0,timestamp:void 0,rawEvent:void 0}}var X={encode(e,t=new fe){return e.type!==0&&t.uint32(8).int32(e.type),e.timestamp!==void 0&&t.uint32(16).int64(e.timestamp),e.rawEvent!==void 0&&se.encode(se.wrap(e.rawEvent),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Eo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.type=n.int32();continue}case 2:{if(a!==16)break;s.timestamp=Bp(n.int64());continue}case 3:{if(a!==26)break;s.rawEvent=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return X.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Eo();return s.type=(t=e.type)!=null?t:0,s.timestamp=(n=e.timestamp)!=null?n:void 0,s.rawEvent=(r=e.rawEvent)!=null?r:void 0,s}};function ko(){return{baseEvent:void 0,messageId:"",role:void 0}}var Fr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=ko();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Fr.fromPartial(e??{})},fromPartial(e){var t,n;const r=ko();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.role=(n=e.role)!=null?n:void 0,r}};function xo(){return{baseEvent:void 0,messageId:"",delta:""}}var Vr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=xo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Vr.fromPartial(e??{})},fromPartial(e){var t,n;const r=xo();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function To(){return{baseEvent:void 0,messageId:""}}var Hr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=To();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Hr.fromPartial(e??{})},fromPartial(e){var t;const n=To();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.messageId=(t=e.messageId)!=null?t:"",n}};function Ao(){return{baseEvent:void 0,toolCallId:"",toolCallName:"",parentMessageId:void 0}}var qr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.toolCallName!==""&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Ao();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return qr.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Ao();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.toolCallId=(t=e.toolCallId)!=null?t:"",s.toolCallName=(n=e.toolCallName)!=null?n:"",s.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,s}};function Io(){return{baseEvent:void 0,toolCallId:"",delta:""}}var Zr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Io();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Zr.fromPartial(e??{})},fromPartial(e){var t,n;const r=Io();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.toolCallId=(t=e.toolCallId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function Co(){return{baseEvent:void 0,toolCallId:""}}var Xr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Co();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Xr.fromPartial(e??{})},fromPartial(e){var t;const n=Co();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.toolCallId=(t=e.toolCallId)!=null?t:"",n}};function No(){return{baseEvent:void 0,snapshot:void 0}}var Kr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.snapshot!==void 0&&se.encode(se.wrap(e.snapshot),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=No();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.snapshot=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Kr.fromPartial(e??{})},fromPartial(e){var t;const n=No();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.snapshot=(t=e.snapshot)!=null?t:void 0,n}};function Ro(){return{baseEvent:void 0,delta:[]}}var Jr={encode(e,t=new fe){e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.delta)zr.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Ro();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.delta.push(zr.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Jr.fromPartial(e??{})},fromPartial(e){var t;const n=Ro();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.delta=((t=e.delta)==null?void 0:t.map(r=>zr.fromPartial(r)))||[],n}};function Oo(){return{baseEvent:void 0,messages:[]}}var Yr={encode(e,t=new fe){e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.messages)Br.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Oo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messages.push(Br.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Yr.fromPartial(e??{})},fromPartial(e){var t;const n=Oo();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.messages=((t=e.messages)==null?void 0:t.map(r=>Br.fromPartial(r)))||[],n}};function Po(){return{baseEvent:void 0,event:void 0,source:void 0}}var Wr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.event!==void 0&&se.encode(se.wrap(e.event),t.uint32(18).fork()).join(),e.source!==void 0&&t.uint32(26).string(e.source),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Po();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.event=se.unwrap(se.decode(n,n.uint32()));continue}case 3:{if(a!==26)break;s.source=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Wr.fromPartial(e??{})},fromPartial(e){var t,n;const r=Po();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.event=(t=e.event)!=null?t:void 0,r.source=(n=e.source)!=null?n:void 0,r}};function Mo(){return{baseEvent:void 0,name:"",value:void 0}}var Qr={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.name!==""&&t.uint32(18).string(e.name),e.value!==void 0&&se.encode(se.wrap(e.value),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Mo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.name=n.string();continue}case 3:{if(a!==26)break;s.value=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Qr.fromPartial(e??{})},fromPartial(e){var t,n;const r=Mo();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.name=(t=e.name)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function Lo(){return{baseEvent:void 0,threadId:"",runId:""}}var es={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Lo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return es.fromPartial(e??{})},fromPartial(e){var t,n;const r=Lo();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.threadId=(t=e.threadId)!=null?t:"",r.runId=(n=e.runId)!=null?n:"",r}};function Do(){return{baseEvent:void 0,threadId:"",runId:"",result:void 0}}var ts={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),e.result!==void 0&&se.encode(se.wrap(e.result),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Do();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}case 4:{if(a!==34)break;s.result=se.unwrap(se.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ts.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Do();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.threadId=(t=e.threadId)!=null?t:"",s.runId=(n=e.runId)!=null?n:"",s.result=(r=e.result)!=null?r:void 0,s}};function $o(){return{baseEvent:void 0,code:void 0,message:""}}var ns={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.code!==void 0&&t.uint32(18).string(e.code),e.message!==""&&t.uint32(26).string(e.message),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=$o();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.code=n.string();continue}case 3:{if(a!==26)break;s.message=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ns.fromPartial(e??{})},fromPartial(e){var t,n;const r=$o();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.code=(t=e.code)!=null?t:void 0,r.message=(n=e.message)!=null?n:"",r}};function Uo(){return{baseEvent:void 0,stepName:""}}var rs={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Uo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return rs.fromPartial(e??{})},fromPartial(e){var t;const n=Uo();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function zo(){return{baseEvent:void 0,stepName:""}}var ss={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=zo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ss.fromPartial(e??{})},fromPartial(e){var t;const n=zo();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function Go(){return{baseEvent:void 0,messageId:void 0,role:void 0,delta:void 0}}var as={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==void 0&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),e.delta!==void 0&&t.uint32(34).string(e.delta),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Go();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}case 4:{if(a!==34)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return as.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Go();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.messageId=(t=e.messageId)!=null?t:void 0,s.role=(n=e.role)!=null?n:void 0,s.delta=(r=e.delta)!=null?r:void 0,s}};function jo(){return{baseEvent:void 0,toolCallId:void 0,toolCallName:void 0,parentMessageId:void 0,delta:void 0}}var is={encode(e,t=new fe){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==void 0&&t.uint32(18).string(e.toolCallId),e.toolCallName!==void 0&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),e.delta!==void 0&&t.uint32(42).string(e.delta),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=jo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}case 5:{if(a!==42)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return is.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=jo();return a.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,a.toolCallId=(t=e.toolCallId)!=null?t:void 0,a.toolCallName=(n=e.toolCallName)!=null?n:void 0,a.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,a.delta=(s=e.delta)!=null?s:void 0,a}};function Bo(){return{textMessageStart:void 0,textMessageContent:void 0,textMessageEnd:void 0,toolCallStart:void 0,toolCallArgs:void 0,toolCallEnd:void 0,stateSnapshot:void 0,stateDelta:void 0,messagesSnapshot:void 0,raw:void 0,custom:void 0,runStarted:void 0,runFinished:void 0,runError:void 0,stepStarted:void 0,stepFinished:void 0,textMessageChunk:void 0,toolCallChunk:void 0}}var cc={encode(e,t=new fe){return e.textMessageStart!==void 0&&Fr.encode(e.textMessageStart,t.uint32(10).fork()).join(),e.textMessageContent!==void 0&&Vr.encode(e.textMessageContent,t.uint32(18).fork()).join(),e.textMessageEnd!==void 0&&Hr.encode(e.textMessageEnd,t.uint32(26).fork()).join(),e.toolCallStart!==void 0&&qr.encode(e.toolCallStart,t.uint32(34).fork()).join(),e.toolCallArgs!==void 0&&Zr.encode(e.toolCallArgs,t.uint32(42).fork()).join(),e.toolCallEnd!==void 0&&Xr.encode(e.toolCallEnd,t.uint32(50).fork()).join(),e.stateSnapshot!==void 0&&Kr.encode(e.stateSnapshot,t.uint32(58).fork()).join(),e.stateDelta!==void 0&&Jr.encode(e.stateDelta,t.uint32(66).fork()).join(),e.messagesSnapshot!==void 0&&Yr.encode(e.messagesSnapshot,t.uint32(74).fork()).join(),e.raw!==void 0&&Wr.encode(e.raw,t.uint32(82).fork()).join(),e.custom!==void 0&&Qr.encode(e.custom,t.uint32(90).fork()).join(),e.runStarted!==void 0&&es.encode(e.runStarted,t.uint32(98).fork()).join(),e.runFinished!==void 0&&ts.encode(e.runFinished,t.uint32(106).fork()).join(),e.runError!==void 0&&ns.encode(e.runError,t.uint32(114).fork()).join(),e.stepStarted!==void 0&&rs.encode(e.stepStarted,t.uint32(122).fork()).join(),e.stepFinished!==void 0&&ss.encode(e.stepFinished,t.uint32(130).fork()).join(),e.textMessageChunk!==void 0&&as.encode(e.textMessageChunk,t.uint32(138).fork()).join(),e.toolCallChunk!==void 0&&is.encode(e.toolCallChunk,t.uint32(146).fork()).join(),t},decode(e,t){const n=e instanceof V?e:new V(e),r=t===void 0?n.len:n.pos+t,s=Bo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.textMessageStart=Fr.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.textMessageContent=Vr.decode(n,n.uint32());continue}case 3:{if(a!==26)break;s.textMessageEnd=Hr.decode(n,n.uint32());continue}case 4:{if(a!==34)break;s.toolCallStart=qr.decode(n,n.uint32());continue}case 5:{if(a!==42)break;s.toolCallArgs=Zr.decode(n,n.uint32());continue}case 6:{if(a!==50)break;s.toolCallEnd=Xr.decode(n,n.uint32());continue}case 7:{if(a!==58)break;s.stateSnapshot=Kr.decode(n,n.uint32());continue}case 8:{if(a!==66)break;s.stateDelta=Jr.decode(n,n.uint32());continue}case 9:{if(a!==74)break;s.messagesSnapshot=Yr.decode(n,n.uint32());continue}case 10:{if(a!==82)break;s.raw=Wr.decode(n,n.uint32());continue}case 11:{if(a!==90)break;s.custom=Qr.decode(n,n.uint32());continue}case 12:{if(a!==98)break;s.runStarted=es.decode(n,n.uint32());continue}case 13:{if(a!==106)break;s.runFinished=ts.decode(n,n.uint32());continue}case 14:{if(a!==114)break;s.runError=ns.decode(n,n.uint32());continue}case 15:{if(a!==122)break;s.stepStarted=rs.decode(n,n.uint32());continue}case 16:{if(a!==130)break;s.stepFinished=ss.decode(n,n.uint32());continue}case 17:{if(a!==138)break;s.textMessageChunk=as.decode(n,n.uint32());continue}case 18:{if(a!==146)break;s.toolCallChunk=is.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return cc.fromPartial(e??{})},fromPartial(e){const t=Bo();return t.textMessageStart=e.textMessageStart!==void 0&&e.textMessageStart!==null?Fr.fromPartial(e.textMessageStart):void 0,t.textMessageContent=e.textMessageContent!==void 0&&e.textMessageContent!==null?Vr.fromPartial(e.textMessageContent):void 0,t.textMessageEnd=e.textMessageEnd!==void 0&&e.textMessageEnd!==null?Hr.fromPartial(e.textMessageEnd):void 0,t.toolCallStart=e.toolCallStart!==void 0&&e.toolCallStart!==null?qr.fromPartial(e.toolCallStart):void 0,t.toolCallArgs=e.toolCallArgs!==void 0&&e.toolCallArgs!==null?Zr.fromPartial(e.toolCallArgs):void 0,t.toolCallEnd=e.toolCallEnd!==void 0&&e.toolCallEnd!==null?Xr.fromPartial(e.toolCallEnd):void 0,t.stateSnapshot=e.stateSnapshot!==void 0&&e.stateSnapshot!==null?Kr.fromPartial(e.stateSnapshot):void 0,t.stateDelta=e.stateDelta!==void 0&&e.stateDelta!==null?Jr.fromPartial(e.stateDelta):void 0,t.messagesSnapshot=e.messagesSnapshot!==void 0&&e.messagesSnapshot!==null?Yr.fromPartial(e.messagesSnapshot):void 0,t.raw=e.raw!==void 0&&e.raw!==null?Wr.fromPartial(e.raw):void 0,t.custom=e.custom!==void 0&&e.custom!==null?Qr.fromPartial(e.custom):void 0,t.runStarted=e.runStarted!==void 0&&e.runStarted!==null?es.fromPartial(e.runStarted):void 0,t.runFinished=e.runFinished!==void 0&&e.runFinished!==null?ts.fromPartial(e.runFinished):void 0,t.runError=e.runError!==void 0&&e.runError!==null?ns.fromPartial(e.runError):void 0,t.stepStarted=e.stepStarted!==void 0&&e.stepStarted!==null?rs.fromPartial(e.stepStarted):void 0,t.stepFinished=e.stepFinished!==void 0&&e.stepFinished!==null?ss.fromPartial(e.stepFinished):void 0,t.textMessageChunk=e.textMessageChunk!==void 0&&e.textMessageChunk!==null?as.fromPartial(e.textMessageChunk):void 0,t.toolCallChunk=e.toolCallChunk!==void 0&&e.toolCallChunk!==null?is.fromPartial(e.toolCallChunk):void 0,t}};function Bp(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function Fp(e){var t;const n=cc.decode(e),r=Object.values(n).find(s=>s!==void 0);if(!r)throw new Error("Invalid event");if(r.type=uc[r.baseEvent.type],r.timestamp=r.baseEvent.timestamp,r.rawEvent=r.baseEvent.rawEvent,r.type===T.MESSAGES_SNAPSHOT)for(const s of r.messages){const a=s;((t=a.toolCalls)==null?void 0:t.length)===0&&(a.toolCalls=void 0)}if(r.type===T.STATE_DELTA)for(const s of r.delta)s.op=lc[s.op].toLowerCase(),Object.keys(s).forEach(a=>{s[a]===void 0&&delete s[a]});return Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),Lu.parse(r)}var Vp="application/vnd.ag-ui.event+proto";const Hp=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Fo=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");const t=e.match(Hp);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},Vo=e=>e==="*"||e==="x"||e==="X",Ho=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},qp=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],Zp=(e,t)=>{if(Vo(e)||Vo(t))return 0;const[n,r]=qp(Ho(e),Ho(t));return n>r?1:n<r?-1:0},qo=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const r=Zp(e[n]||"0",t[n]||"0");if(r!==0)return r}return 0},Xp=(e,t)=>{const n=Fo(e),r=Fo(t),s=n.pop(),a=r.pop(),i=qo(n,r);return i!==0?i:s&&a?qo(s.split("."),a.split(".")):s||a?s?-1:1:0};var Kp={},Jp=Object.defineProperty,Yp=Object.defineProperties,Wp=Object.getOwnPropertyDescriptors,xs=Object.getOwnPropertySymbols,dc=Object.prototype.hasOwnProperty,fc=Object.prototype.propertyIsEnumerable,Zo=(e,t,n)=>t in e?Jp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fe=(e,t)=>{for(var n in t||(t={}))dc.call(t,n)&&Zo(e,n,t[n]);if(xs)for(var n of xs(t))fc.call(t,n)&&Zo(e,n,t[n]);return e},on=(e,t)=>Yp(e,Wp(t)),Qp=(e,t)=>{var n={};for(var r in e)dc.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&xs)for(var r of xs(e))t.indexOf(r)<0&&fc.call(e,r)&&(n[r]=e[r]);return n},de=e=>{if(typeof structuredClone=="function")return structuredClone(e);try{return JSON.parse(JSON.stringify(e))}catch{return Fe({},e)}};async function Se(e,t,n,r){let s=t,a=n,i;for(let o of e)try{let l=await r(o,de(s),de(a));if(l===void 0)continue;if(l.messages!==void 0&&(s=l.messages),l.state!==void 0&&(a=l.state),i=l.stopPropagation,i===!0)break}catch(l){Kp.JEST_WORKER_ID!==void 0||console.error("Subscriber error:",l);continue}return Fe(Fe(Fe({},JSON.stringify(s)!==JSON.stringify(t)?{messages:s}:{}),JSON.stringify(a)!==JSON.stringify(n)?{state:a}:{}),i!==void 0?{stopPropagation:i}:{})}var hc=(e,t,n,r)=>{let s=de(n.messages),a=de(e.state),i={},o=u=>{u.messages!==void 0&&(s=u.messages,i.messages=u.messages),u.state!==void 0&&(a=u.state,i.state=u.state)},l=()=>{let u=de(i);return i={},u.messages!==void 0||u.state!==void 0?Ie(u):nc};return t.pipe(tc(async u=>{var c,d,h,f;let p=await Se(r,s,a,(m,g,b)=>{var w;return(w=m.onEvent)==null?void 0:w.call(m,{event:u,agent:n,input:e,messages:g,state:b})});if(o(p),p.stopPropagation===!0)return l();switch(u.type){case T.TEXT_MESSAGE_START:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onTextMessageStartEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:g,role:b="assistant"}=u,w={id:g,role:b,content:""};s.push(w),o({messages:s})}return l()}case T.TEXT_MESSAGE_CONTENT:{let{messageId:m,delta:g}=u,b=s.find(_=>_.id===m);if(!b)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${m}'`),l();let w=await Se(r,s,a,(_,k,C)=>{var I;return(I=_.onTextMessageContentEvent)==null?void 0:I.call(_,{event:u,messages:k,state:C,agent:n,input:e,textMessageBuffer:typeof b.content=="string"?b.content:""})});if(o(w),w.stopPropagation!==!0){let _=typeof b.content=="string"?b.content:"";b.content=`${_}${g}`,o({messages:s})}return l()}case T.TEXT_MESSAGE_END:{let{messageId:m}=u,g=s.find(w=>w.id===m);if(!g)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${m}'`),l();let b=await Se(r,s,a,(w,_,k)=>{var C;return(C=w.onTextMessageEndEvent)==null?void 0:C.call(w,{event:u,messages:_,state:k,agent:n,input:e,textMessageBuffer:typeof g.content=="string"?g.content:""})});return o(b),await Promise.all(r.map(w=>{var _;(_=w.onNewMessage)==null||_.call(w,{message:g,messages:s,state:a,agent:n,input:e})})),l()}case T.TOOL_CALL_START:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onToolCallStartEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{toolCallId:g,toolCallName:b,parentMessageId:w}=u,_;w&&s.length>0&&s[s.length-1].id===w?_=s[s.length-1]:(_={id:w||g,role:"assistant",toolCalls:[]},s.push(_)),_.toolCalls!=null||(_.toolCalls=[]),_.toolCalls.push({id:g,type:"function",function:{name:b,arguments:""}}),o({messages:s})}return l()}case T.TOOL_CALL_ARGS:{let{toolCallId:m,delta:g}=u,b=s.find(k=>{var C;return(C=k.toolCalls)==null?void 0:C.some(I=>I.id===m)});if(!b)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${m}'`),l();let w=b.toolCalls.find(k=>k.id===m);if(!w)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${m}'`),l();let _=await Se(r,s,a,(k,C,I)=>{var R;let D=w.function.arguments,O=w.function.name,N={};try{N=sc(D)}catch{}return(R=k.onToolCallArgsEvent)==null?void 0:R.call(k,{event:u,messages:C,state:I,agent:n,input:e,toolCallBuffer:D,toolCallName:O,partialToolCallArgs:N})});return o(_),_.stopPropagation!==!0&&(w.function.arguments+=g,o({messages:s})),l()}case T.TOOL_CALL_END:{let{toolCallId:m}=u,g=s.find(_=>{var k;return(k=_.toolCalls)==null?void 0:k.some(C=>C.id===m)});if(!g)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${m}'`),l();let b=g.toolCalls.find(_=>_.id===m);if(!b)return console.warn(`TOOL_CALL_END: No tool call found with ID '${m}'`),l();let w=await Se(r,s,a,(_,k,C)=>{var I;let R=b.function.arguments,D=b.function.name,O={};try{O=JSON.parse(R)}catch{}return(I=_.onToolCallEndEvent)==null?void 0:I.call(_,{event:u,messages:k,state:C,agent:n,input:e,toolCallName:D,toolCallArgs:O})});return o(w),await Promise.all(r.map(_=>{var k;(k=_.onNewToolCall)==null||k.call(_,{toolCall:b,messages:s,state:a,agent:n,input:e})})),l()}case T.TOOL_CALL_RESULT:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onToolCallResultEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:g,toolCallId:b,content:w,role:_}=u,k={id:g,toolCallId:b,role:_||"tool",content:w};s.push(k),await Promise.all(r.map(C=>{var I;(I=C.onNewMessage)==null||I.call(C,{message:k,messages:s,state:a,agent:n,input:e})})),o({messages:s})}return l()}case T.STATE_SNAPSHOT:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onStateSnapshotEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{snapshot:g}=u;a=g,o({state:a})}return l()}case T.STATE_DELTA:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onStateDeltaEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{delta:g}=u;try{a=Kn(a,g,!0,!1).newDocument,o({state:a})}catch(b){let w=b instanceof Error?b.message:String(b);console.warn(`Failed to apply state patch:
Current state: ${JSON.stringify(a,null,2)}
Patch operations: ${JSON.stringify(g,null,2)}
Error: ${w}`)}}return l()}case T.MESSAGES_SNAPSHOT:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onMessagesSnapshotEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messages:g}=u;s=g,o({messages:s})}return l()}case T.ACTIVITY_SNAPSHOT:{let m=u,g=s.findIndex(C=>C.id===m.messageId),b=g>=0?s[g]:void 0,w=b?.role==="activity"?b:void 0,_=(c=m.replace)!=null?c:!0,k=await Se(r,s,a,(C,I,R)=>{var D;return(D=C.onActivitySnapshotEvent)==null?void 0:D.call(C,{event:m,messages:I,state:R,agent:n,input:e,activityMessage:w,existingMessage:b})});if(o(k),k.stopPropagation!==!0){let C={id:m.messageId,role:"activity",activityType:m.activityType,content:de(m.content)},I;g===-1?(s.push(C),I=C):w?_&&(s[g]=on(Fe({},w),{activityType:m.activityType,content:de(m.content)})):_&&(s[g]=C,I=C),o({messages:s}),I&&await Promise.all(r.map(R=>{var D;return(D=R.onNewMessage)==null?void 0:D.call(R,{message:I,messages:s,state:a,agent:n,input:e})}))}return l()}case T.ACTIVITY_DELTA:{let m=u,g=s.findIndex(k=>k.id===m.messageId);if(g===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${m.messageId}' to apply patch`),l();let b=s[g];if(b.role!=="activity")return console.warn(`ACTIVITY_DELTA: Message '${m.messageId}' is not an activity message`),l();let w=b,_=await Se(r,s,a,(k,C,I)=>{var R;return(R=k.onActivityDeltaEvent)==null?void 0:R.call(k,{event:m,messages:C,state:I,agent:n,input:e,activityMessage:w})});if(o(_),_.stopPropagation!==!0)try{let k=de((d=w.content)!=null?d:{}),C=Kn(k,(h=m.patch)!=null?h:[],!0,!1).newDocument;s[g]=on(Fe({},w),{content:de(C),activityType:m.activityType}),o({messages:s})}catch(k){let C=k instanceof Error?k.message:String(k);console.warn(`Failed to apply activity patch for '${m.messageId}': ${C}`)}return l()}case T.RAW:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onRawEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});return o(m),l()}case T.CUSTOM:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onCustomEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});return o(m),l()}case T.RUN_STARTED:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onRunStartedEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let g=u;if((f=g.input)!=null&&f.messages){for(let b of g.input.messages)s.find(w=>w.id===b.id)||s.push(b);o({messages:s})}}return l()}case T.RUN_FINISHED:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onRunFinishedEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e,result:u.result})});return o(m),l()}case T.RUN_ERROR:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onRunErrorEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});return o(m),l()}case T.STEP_STARTED:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onStepStartedEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});return o(m),l()}case T.STEP_FINISHED:{let m=await Se(r,s,a,(g,b,w)=>{var _;return(_=g.onStepFinishedEvent)==null?void 0:_.call(g,{event:u,messages:b,state:w,agent:n,input:e})});return o(m),l()}case T.TEXT_MESSAGE_CHUNK:throw new Error("TEXT_MESSAGE_CHUNK must be tranformed before being applied");case T.TOOL_CALL_CHUNK:throw new Error("TOOL_CALL_CHUNK must be tranformed before being applied");case T.THINKING_START:return l();case T.THINKING_END:return l();case T.THINKING_TEXT_MESSAGE_START:return l();case T.THINKING_TEXT_MESSAGE_CONTENT:return l();case T.THINKING_TEXT_MESSAGE_END:return l()}return u.type,l()}),bp(),r.length>0?Sp({}):u=>u)},ra=e=>t=>{let n=new Map,r=new Map,s=!1,a=!1,i=!1,o=new Map,l=!1,u=!1,c=!1,d=()=>{n.clear(),r.clear(),o.clear(),l=!1,u=!1,s=!1,a=!1,c=!0};return t.pipe(an(h=>{let f=h.type;if(e&&console.debug("[VERIFY]:",JSON.stringify(h)),a)return we(()=>new ke(`Cannot send event type '${f}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(s&&f!==T.RUN_ERROR&&f!==T.RUN_STARTED)return we(()=>new ke(`Cannot send event type '${f}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(i){if(f===T.RUN_STARTED){if(c&&!s)return we(()=>new ke("Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run."));s&&d()}}else if(i=!0,f!==T.RUN_STARTED&&f!==T.RUN_ERROR)return we(()=>new ke("First event must be 'RUN_STARTED'"));switch(f){case T.TEXT_MESSAGE_START:{let p=h.messageId;return n.has(p)?we(()=>new ke(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${p}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(p,!0),Ie(h))}case T.TEXT_MESSAGE_CONTENT:{let p=h.messageId;return n.has(p)?Ie(h):we(()=>new ke(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${p}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case T.TEXT_MESSAGE_END:{let p=h.messageId;return n.has(p)?(n.delete(p),Ie(h)):we(()=>new ke(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${p}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case T.TOOL_CALL_START:{let p=h.toolCallId;return r.has(p)?we(()=>new ke(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${p}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(r.set(p,!0),Ie(h))}case T.TOOL_CALL_ARGS:{let p=h.toolCallId;return r.has(p)?Ie(h):we(()=>new ke(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${p}'. Start a tool call with 'TOOL_CALL_START' first.`))}case T.TOOL_CALL_END:{let p=h.toolCallId;return r.has(p)?(r.delete(p),Ie(h)):we(()=>new ke(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${p}'. A 'TOOL_CALL_START' event must be sent first.`))}case T.STEP_STARTED:{let p=h.stepName;return o.has(p)?we(()=>new ke(`Step "${p}" is already active for 'STEP_STARTED'`)):(o.set(p,!0),Ie(h))}case T.STEP_FINISHED:{let p=h.stepName;return o.has(p)?(o.delete(p),Ie(h)):we(()=>new ke(`Cannot send 'STEP_FINISHED' for step "${p}" that was not started`))}case T.RUN_STARTED:return c=!0,Ie(h);case T.RUN_FINISHED:{if(o.size>0){let p=Array.from(o.keys()).join(", ");return we(()=>new ke(`Cannot send 'RUN_FINISHED' while steps are still active: ${p}`))}if(n.size>0){let p=Array.from(n.keys()).join(", ");return we(()=>new ke(`Cannot send 'RUN_FINISHED' while text messages are still active: ${p}`))}if(r.size>0){let p=Array.from(r.keys()).join(", ");return we(()=>new ke(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${p}`))}return s=!0,Ie(h)}case T.RUN_ERROR:return a=!0,Ie(h);case T.CUSTOM:return Ie(h);case T.THINKING_TEXT_MESSAGE_START:return l?u?we(()=>new ke("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.")):(u=!0,Ie(h)):we(()=>new ke("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first."));case T.THINKING_TEXT_MESSAGE_CONTENT:return u?Ie(h):we(()=>new ke("Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first."));case T.THINKING_TEXT_MESSAGE_END:return u?(u=!1,Ie(h)):we(()=>new ke("Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first."));case T.THINKING_START:return l?we(()=>new ke("Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.")):(l=!0,Ie(h));case T.THINKING_END:return l?(l=!1,Ie(h)):we(()=>new ke("Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first."));default:return Ie(h)}}))},eg=(e,t)=>Tp(()=>ks(fetch(e,t))).pipe(kp(n=>{var r;if(!n.ok){let i=n.headers.get("content-type")||"";return ks(n.text()).pipe(an(o=>{let l=o;if(i.includes("application/json"))try{l=JSON.parse(o)}catch{}let u=new Error(`HTTP ${n.status}: ${typeof l=="string"?l:JSON.stringify(l)}`);return u.status=n.status,u.payload=l,we(()=>u)}))}let s={type:"headers",status:n.status,headers:n.headers},a=(r=n.body)==null?void 0:r.getReader();return a?new Ke(i=>(i.next(s),(async()=>{try{for(;;){let{done:o,value:l}=await a.read();if(o)break;let u={type:"data",data:l};i.next(u)}i.complete()}catch(o){i.error(o)}})(),()=>{a.cancel().catch(o=>{if(o?.name!=="AbortError")throw o})})):we(()=>new Error("Failed to getReader() from response"))})),tg=e=>{let t=new kn,n=new TextDecoder("utf-8",{fatal:!1}),r="";e.subscribe({next:a=>{if(a.type!=="headers"&&a.type==="data"&&a.data){let i=n.decode(a.data,{stream:!0});r+=i;let o=r.split(/\n\n/);r=o.pop()||"";for(let l of o)s(l)}},error:a=>t.error(a),complete:()=>{r&&(r+=n.decode(),s(r)),t.complete()}});function s(a){let i=a.split(`
`),o=[];for(let l of i)l.startsWith("data: ")&&o.push(l.slice(6));if(o.length>0)try{let l=o.join(`
`),u=JSON.parse(l);t.next(u)}catch(l){t.error(l)}}return t.asObservable()},ng=e=>{let t=new kn,n=new Uint8Array(0);e.subscribe({next:s=>{if(s.type!=="headers"&&s.type==="data"&&s.data){let a=new Uint8Array(n.length+s.data.length);a.set(n,0),a.set(s.data,n.length),n=a,r()}},error:s=>t.error(s),complete:()=>{if(n.length>0)try{r()}catch{console.warn("Incomplete or invalid protocol buffer data at stream end")}t.complete()}});function r(){for(;n.length>=4;){let s=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<s)break;try{let a=n.slice(4,s),i=Fp(a);t.next(i),n=n.slice(s)}catch(a){let i=a instanceof Error?a.message:String(a);t.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return t.asObservable()},rg=e=>{let t=new kn,n=new rc,r=!1;return e.subscribe({next:s=>{n.next(s),s.type==="headers"&&!r?(r=!0,s.headers.get("content-type")===Vp?ng(n).subscribe({next:a=>t.next(a),error:a=>t.error(a),complete:()=>t.complete()}):tg(n).subscribe({next:a=>{try{let i=Lu.parse(a);t.next(i)}catch(i){t.error(i)}},error:a=>{if(a?.name==="AbortError"){t.next({type:T.RUN_ERROR,rawEvent:a}),t.complete();return}return t.error(a)},complete:()=>t.complete()})):r||t.error(new Error("No headers event received before data events"))},error:s=>{n.error(s),t.error(s)},complete:()=>{n.complete()}}),t.asObservable()},ge=Cu(["TextMessageStart","TextMessageContent","TextMessageEnd","ActionExecutionStart","ActionExecutionArgs","ActionExecutionEnd","ActionExecutionResult","AgentStateMessage","MetaEvent","RunStarted","RunFinished","RunError","NodeStarted","NodeFinished"]),sg=Cu(["LangGraphInterruptEvent","PredictState","Exit"]),ag=ye({type:F(ge.enum.TextMessageStart),messageId:P(),parentMessageId:P().optional(),role:P().optional()}),ig=ye({type:F(ge.enum.TextMessageContent),messageId:P(),content:P()}),og=ye({type:F(ge.enum.TextMessageEnd),messageId:P()}),lg=ye({type:F(ge.enum.ActionExecutionStart),actionExecutionId:P(),actionName:P(),parentMessageId:P().optional()}),ug=ye({type:F(ge.enum.ActionExecutionArgs),actionExecutionId:P(),args:P()}),cg=ye({type:F(ge.enum.ActionExecutionEnd),actionExecutionId:P()}),dg=ye({type:F(ge.enum.ActionExecutionResult),actionName:P(),actionExecutionId:P(),result:P()}),fg=ye({type:F(ge.enum.AgentStateMessage),threadId:P(),agentName:P(),nodeName:P(),runId:P(),active:ka(),role:P(),state:P(),running:ka()}),hg=ye({type:F(ge.enum.MetaEvent),name:sg,value:Xe()}),vg=ye({type:F(ge.enum.RunError),message:P(),code:P().optional()});Ls("type",[ag,ig,og,lg,ug,cg,dg,fg,hg,vg]);ye({id:P(),role:P(),content:P(),parentMessageId:P().optional()});ye({id:P(),name:P(),arguments:Xe(),parentMessageId:P().optional()});ye({id:P(),result:Xe(),actionExecutionId:P(),actionName:P()});var pg=e=>{if(typeof e=="string")return e;if(!Array.isArray(e))return;let t=e.filter(n=>n.type==="text").map(n=>n.text).filter(n=>n.length>0);if(t.length!==0)return t.join(`
`)},gg=(e,t,n)=>r=>{let s={},a=!0,i=!0,o="",l=null,u=null,c=[],d={},h=f=>{typeof f=="object"&&f!==null&&("messages"in f&&delete f.messages,s=f)};return r.pipe(an(f=>{switch(f.type){case T.TEXT_MESSAGE_START:{let p=f;return[{type:ge.enum.TextMessageStart,messageId:p.messageId,role:p.role}]}case T.TEXT_MESSAGE_CONTENT:{let p=f;return[{type:ge.enum.TextMessageContent,messageId:p.messageId,content:p.delta}]}case T.TEXT_MESSAGE_END:{let p=f;return[{type:ge.enum.TextMessageEnd,messageId:p.messageId}]}case T.TOOL_CALL_START:{let p=f;return c.push({id:p.toolCallId,type:"function",function:{name:p.toolCallName,arguments:""}}),i=!0,d[p.toolCallId]=p.toolCallName,[{type:ge.enum.ActionExecutionStart,actionExecutionId:p.toolCallId,actionName:p.toolCallName,parentMessageId:p.parentMessageId}]}case T.TOOL_CALL_ARGS:{let p=f,m=c.find(b=>b.id===p.toolCallId);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${p.toolCallId}'`),[];m.function.arguments+=p.delta;let g=!1;if(u){let b=u.find(w=>w.tool==m.function.name);if(b)try{let w=JSON.parse(sc(m.function.arguments));b.tool_argument&&b.tool_argument in w?(h(on(Fe({},s),{[b.state_key]:w[b.tool_argument]})),g=!0):b.tool_argument||(h(on(Fe({},s),{[b.state_key]:w})),g=!0)}catch{}}return[{type:ge.enum.ActionExecutionArgs,actionExecutionId:p.toolCallId,args:p.delta},...g?[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]:[]]}case T.TOOL_CALL_END:{let p=f;return[{type:ge.enum.ActionExecutionEnd,actionExecutionId:p.toolCallId}]}case T.TOOL_CALL_RESULT:{let p=f;return[{type:ge.enum.ActionExecutionResult,actionExecutionId:p.toolCallId,result:p.content,actionName:d[p.toolCallId]||"unknown"}]}case T.RAW:return[];case T.CUSTOM:{let p=f;switch(p.name){case"Exit":a=!1;break;case"PredictState":u=p.value;break}return[{type:ge.enum.MetaEvent,name:p.name,value:p.value}]}case T.STATE_SNAPSHOT:return h(f.snapshot),[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}];case T.STATE_DELTA:{let p=Kn(s,f.delta,!0,!1);return p?(h(p.newDocument),[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]):[]}case T.MESSAGES_SNAPSHOT:return l=f.messages,[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(Fe(Fe({},s),l?{messages:l}:{})),active:!0}];case T.RUN_STARTED:return[];case T.RUN_FINISHED:return l&&(s.messages=l),Object.keys(s).length===0?[]:[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(Fe(Fe({},s),l?{messages:mg(l)}:{})),active:!1}];case T.RUN_ERROR:{let p=f;return[{type:ge.enum.RunError,message:p.message,code:p.code}]}case T.STEP_STARTED:return o=f.stepName,c=[],u=null,[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!0}];case T.STEP_FINISHED:return c=[],u=null,[{type:ge.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!1}];default:return[]}}))};function mg(e){var t;let n=[];for(let r of e)if(r.role==="assistant"||r.role==="user"||r.role==="system"){let s=pg(r.content);if(s){let a={id:r.id,role:r.role,content:s};n.push(a)}if(r.role==="assistant"&&r.toolCalls&&r.toolCalls.length>0)for(let a of r.toolCalls){let i={id:a.id,name:a.function.name,arguments:JSON.parse(a.function.arguments),parentMessageId:r.id};n.push(i)}}else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"&&(t=i.toolCalls)!=null&&t.length){for(let o of i.toolCalls)if(o.id===r.toolCallId){s=o.function.name;break}}let a={id:r.id,result:r.content,actionExecutionId:r.toolCallId,actionName:s};n.push(a)}return n}var os=e=>t=>{let n,r,s,a=()=>{if(!n||s!=="text")throw new Error("No text message to close");let l={type:T.TEXT_MESSAGE_END,messageId:n.messageId};return s=void 0,n=void 0,e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_END",JSON.stringify(l)),l},i=()=>{if(!r||s!=="tool")throw new Error("No tool call to close");let l={type:T.TOOL_CALL_END,toolCallId:r.toolCallId};return s=void 0,r=void 0,e&&console.debug("[TRANSFORM]: TOOL_CALL_END",JSON.stringify(l)),l},o=()=>s==="text"?[a()]:s==="tool"?[i()]:[];return t.pipe(an(l=>{switch(l.type){case T.TEXT_MESSAGE_START:case T.TEXT_MESSAGE_CONTENT:case T.TEXT_MESSAGE_END:case T.TOOL_CALL_START:case T.TOOL_CALL_ARGS:case T.TOOL_CALL_END:case T.TOOL_CALL_RESULT:case T.STATE_SNAPSHOT:case T.STATE_DELTA:case T.MESSAGES_SNAPSHOT:case T.CUSTOM:case T.RUN_STARTED:case T.RUN_FINISHED:case T.RUN_ERROR:case T.STEP_STARTED:case T.STEP_FINISHED:case T.THINKING_START:case T.THINKING_END:case T.THINKING_TEXT_MESSAGE_START:case T.THINKING_TEXT_MESSAGE_CONTENT:case T.THINKING_TEXT_MESSAGE_END:return[...o(),l];case T.RAW:case T.ACTIVITY_SNAPSHOT:case T.ACTIVITY_DELTA:return[l];case T.TEXT_MESSAGE_CHUNK:let u=l,c=[];if((s!=="text"||u.messageId!==void 0&&u.messageId!==n?.messageId)&&c.push(...o()),s!=="text"){if(u.messageId===void 0)throw new Error("First TEXT_MESSAGE_CHUNK must have a messageId");n={messageId:u.messageId},s="text";let f={type:T.TEXT_MESSAGE_START,messageId:u.messageId,role:u.role||"assistant"};c.push(f),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_START",JSON.stringify(f))}if(u.delta!==void 0){let f={type:T.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:u.delta};c.push(f),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_CONTENT",JSON.stringify(f))}return c;case T.TOOL_CALL_CHUNK:let d=l,h=[];if((s!=="tool"||d.toolCallId!==void 0&&d.toolCallId!==r?.toolCallId)&&h.push(...o()),s!=="tool"){if(d.toolCallId===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallId");if(d.toolCallName===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallName");r={toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId},s="tool";let f={type:T.TOOL_CALL_START,toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId};h.push(f),e&&console.debug("[TRANSFORM]: TOOL_CALL_START",JSON.stringify(f))}if(d.delta!==void 0){let f={type:T.TOOL_CALL_ARGS,toolCallId:r.toolCallId,delta:d.delta};h.push(f),e&&console.debug("[TRANSFORM]: TOOL_CALL_ARGS",JSON.stringify(f))}return h}return l.type,[]}),Pa(()=>{o()}))},vc=class{runNext(t,n){return n.run(t).pipe(os(!1))}runNextWithState(t,n){let r=de(t.messages||[]),s=de(t.state||{}),a=new rc;return hc(t,a,n,[]).subscribe(i=>{i.messages!==void 0&&(r=i.messages),i.state!==void 0&&(s=i.state)}),this.runNext(t,n).pipe(tc(async i=>(a.next(i),await new Promise(o=>setTimeout(o,0)),{event:i,messages:de(r),state:de(s)})))}},_g=class extends vc{constructor(t){super(),this.fn=t}run(t,n){return this.fn(t,n)}};function yg(e){let t=e.content;if(Array.isArray(t)){let n=t.filter(r=>typeof r=="object"&&r!==null&&"type"in r&&r.type==="text"&&typeof r.text=="string").map(r=>r.text).join("");return on(Fe({},e),{content:n})}return typeof t=="string"?e:on(Fe({},e),{content:""})}var bg=class extends vc{run(t,n){let r=t,{parentRunId:s}=r,a=Qp(r,["parentRunId"]),i=on(Fe({},a),{messages:a.messages.map(yg)});return this.runNext(i,n)}},wg={version:"0.0.42"},Sg=class{constructor({agentId:t,description:n,threadId:r,initialMessages:s,initialState:a,debug:i}={}){this.debug=!1,this.subscribers=[],this.isRunning=!1,this.middlewares=[],this.agentId=t,this.description=n??"",this.threadId=r??ar(),this.messages=de(s??[]),this.state=de(a??{}),this.debug=i??!1,Xp(this.maxVersion,"0.0.39")<=0&&this.middlewares.unshift(new bg)}get maxVersion(){return wg.version}subscribe(t){return this.subscribers.push(t),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==t)}}}use(...t){let n=t.map(r=>typeof r=="function"?new _g(r):r);return this.middlewares.push(...n),this}async runAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:ar();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(d=>d.id)),o=[{onRunFinishedEvent:d=>{a=d.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new kn;let l;this.activeRunCompletionPromise=new Promise(d=>{l=d});let u=ro(()=>this.middlewares.length===0?this.run(s):this.middlewares.reduceRight((d,h)=>({run:f=>h.run(f,d)}),this).run(s),os(this.debug),ra(this.debug),d=>d.pipe(io(this.activeRunDetach$)),d=>this.apply(s,d,o),d=>this.processApplyEvents(s,d,o),Ra(d=>(this.isRunning=!1,this.onError(s,d,o))),Pa(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await oo(u(Ie(null)));let c=de(this.messages).filter(d=>!i.has(d.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}connect(t){throw new to}async connectAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:ar();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(d=>d.id)),o=[{onRunFinishedEvent:d=>{a=d.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new kn;let l;this.activeRunCompletionPromise=new Promise(d=>{l=d});let u=ro(()=>this.connect(s),os(this.debug),ra(this.debug),d=>d.pipe(io(this.activeRunDetach$)),d=>this.apply(s,d,o),d=>this.processApplyEvents(s,d,o),Ra(d=>(this.isRunning=!1,d instanceof to?nc:this.onError(s,d,o))),Pa(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await oo(u(Ie(null)));let c=de(this.messages).filter(d=>!i.has(d.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}abortRun(){}async detachActiveRun(){var t,n;if(!this.activeRunDetach$)return;let r=(t=this.activeRunCompletionPromise)!=null?t:Promise.resolve();this.activeRunDetach$.next(),(n=this.activeRunDetach$)==null||n.complete(),await r}apply(t,n,r){return hc(t,n,this,r)}processApplyEvents(t,n,r){return n.pipe(xp(s=>{s.messages&&(this.messages=s.messages,r.forEach(a=>{var i;(i=a.onMessagesChanged)==null||i.call(a,{messages:this.messages,state:this.state,agent:this,input:t})})),s.state&&(this.state=s.state,r.forEach(a=>{var i;(i=a.onStateChanged)==null||i.call(a,{state:this.state,messages:this.messages,agent:this,input:t})}))}))}prepareRunAgentInput(t){var n,r,s;let a=de(this.messages).filter(i=>i.role!=="activity");return{threadId:this.threadId,runId:t?.runId||ar(),tools:de((n=t?.tools)!=null?n:[]),context:de((r=t?.context)!=null?r:[]),forwardedProps:de((s=t?.forwardedProps)!=null?s:{}),state:de(this.state),messages:a}}async onInitialize(t,n){let r=await Se(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunInitialized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages&&(this.messages=r.messages,t.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state&&(this.state=r.state,t.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}onError(t,n,r){return ks(Se(r,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFailed)==null?void 0:o.call(s,{error:n,messages:a,state:i,agent:this,input:t})})).pipe(Oa(s=>{let a=s;if((a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,r.forEach(i=>{var o;(o=i.onMessagesChanged)==null||o.call(i,{messages:this.messages,state:this.state,agent:this,input:t})})),a.state!==void 0&&(this.state=a.state,r.forEach(i=>{var o;(o=i.onStateChanged)==null||o.call(i,{state:this.state,messages:this.messages,agent:this,input:t})}))),a.stopPropagation!==!0)throw console.error("Agent execution failed:",n),n;return{}}))}async onFinalize(t,n){let r=await Se(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFinalized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages!==void 0&&(this.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state!==void 0&&(this.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}clone(){let t=Object.create(Object.getPrototypeOf(this));return t.agentId=this.agentId,t.description=this.description,t.threadId=this.threadId,t.messages=de(this.messages),t.state=de(this.state),t.debug=this.debug,t.isRunning=this.isRunning,t.subscribers=[...this.subscribers],t.middlewares=[...this.middlewares],t}addMessage(t){this.messages.push(t),(async()=>{var n,r,s;for(let a of this.subscribers)await((n=a.onNewMessage)==null?void 0:n.call(a,{message:t,messages:this.messages,state:this.state,agent:this}));if(t.role==="assistant"&&t.toolCalls)for(let a of t.toolCalls)for(let i of this.subscribers)await((r=i.onNewToolCall)==null?void 0:r.call(i,{toolCall:a,messages:this.messages,state:this.state,agent:this}));for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(t){this.messages.push(...t),(async()=>{var n,r,s;for(let a of t){for(let i of this.subscribers)await((n=i.onNewMessage)==null?void 0:n.call(i,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role==="assistant"&&a.toolCalls)for(let i of a.toolCalls)for(let o of this.subscribers)await((r=o.onNewToolCall)==null?void 0:r.call(o,{toolCall:i,messages:this.messages,state:this.state,agent:this}))}for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(t){this.messages=de(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onMessagesChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}setState(t){this.state=de(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onStateChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(t){var n;this.agentId=(n=this.agentId)!=null?n:ar();let r=this.prepareRunAgentInput(t);return(this.middlewares.length===0?this.run(r):this.middlewares.reduceRight((s,a)=>({run:i=>a.run(i,s)}),this).run(r)).pipe(os(this.debug),ra(this.debug),gg(this.threadId,r.runId,this.agentId),s=>s.pipe(Oa(a=>(this.debug&&console.debug("[LEGACY]:",JSON.stringify(a)),a))))}},Xo=class extends Sg{constructor(e){var t;super(e),this.abortController=new AbortController,this.url=e.url,this.headers=de((t=e.headers)!=null?t:{})}requestInit(e){return{method:"POST",headers:on(Fe({},this.headers),{"Content-Type":"application/json",Accept:"text/event-stream"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,t){var n;return this.abortController=(n=e?.abortController)!=null?n:new AbortController,super.runAgent(e,t)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let t=eg(this.url,this.requestInit(e));return rg(t)}clone(){var e;let t=super.clone();t.url=this.url,t.headers=de((e=this.headers)!=null?e:{});let n=new AbortController,r=this.abortController.signal;return r.aborted&&n.abort(r.reason),t.abortController=n,t}};class Eg{constructor(t){this.stores=t}eventSource=null;agentMsgId=null;aguiSubscription=null;aguiMessageMap=new Map;aguiMappedPlaceholder=!1;aguiRunId=null;aguiSessionId=null;aguiCompleted=!1;aguiToolCalls=new Map;start(t,n,r,s,a,i="sse"){if(this.close(),i==="agui"){this.startAgui(t,n,r,s,a);return}const o=this.stores.chatStore.addAgentMessage();this.agentMsgId=o.id;const l=new URL("/chat/stream",window.location.origin);l.searchParams.set("query",t),l.searchParams.set("session_id",n),Object.keys(r).length&&l.searchParams.set("tool_context",JSON.stringify(r)),Object.keys(s).length&&l.searchParams.set("llm_context",JSON.stringify(s)),this.eventSource=new EventSource(l.toString()),["chunk","artifact_chunk","artifact_stored","llm_stream_chunk","step","event","done","error"].forEach(c=>{this.eventSource.addEventListener(c,d=>{this.handleEvent(c,d,a)})}),this.eventSource.onerror=()=>{const c=this.findAgentMsg();c&&this.stores.chatStore.updateMessage(c.id,{isStreaming:!1}),a.onError("Connection lost"),this.close()}}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.agentMsgId=null,this.aguiSubscription&&(this.aguiSubscription.unsubscribe(),this.aguiSubscription=null),this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1,this.aguiToolCalls.clear()}findAgentMsg(){return this.agentMsgId?this.stores.chatStore.findMessage(this.agentMsgId):void 0}handleEvent(t,n,r){const s=lu(n.data);if(!s)return;const a=this.findAgentMsg();if(a)switch(t){case"chunk":case"llm_stream_chunk":this.handleChunk(a,s,t);break;case"artifact_chunk":this.handleArtifactChunk(s);break;case"artifact_stored":this.handleArtifactStored(s);break;case"step":case"event":this.handleStepEvent(a,s,t);break;case"done":this.handleDone(a,s,r);break;case"error":this.handleError(a,s,r);break}}handleChunk(t,n,r){const s=n.channel??"thinking",a=n.phase??(r==="chunk"?"observation":void 0),i=n.text??"",o=!!n.done;if(s==="thinking"&&a==="action"){this.stores.chatStore.updateMessage(t.id,{isThinking:!o});return}if(s==="thinking"){i?this.stores.chatStore.updateMessage(t.id,{observations:`${t.observations??""}${i}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(t.id,{isThinking:!1});return}if(s==="revision"){const l={isThinking:!1,isStreaming:!0};t.revisionStreamActive||(l.revisionStreamActive=!0,l.text=""),i&&(l.text=`${t.revisionStreamActive?t.text:""}${i}`),this.stores.chatStore.updateMessage(t.id,l);return}if(s==="answer"){const l=t.answerActionSeq??Dn,u=n.action_seq;if(l===Dn){this.stores.chatStore.updateMessage(t.id,{answerStreamDone:o,isStreaming:!o,isThinking:!1});return}if(u!==void 0&&u!==l){this.stores.chatStore.updateMessage(t.id,{isThinking:!1});return}const c={isThinking:!1,isStreaming:!o};i&&(c.text=`${t.text}${i}`),o&&(c.answerStreamDone=!0),this.stores.chatStore.updateMessage(t.id,c);return}i?this.stores.chatStore.updateMessage(t.id,{observations:`${t.observations??""}${i}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(t.id,{isThinking:!1})}handleArtifactChunk(t){const n=Ko(t);if(n.artifact_type==="ui_component"){this.stores.interactionsStore.addArtifactChunk(n,{message_id:this.agentMsgId??void 0}),this.stores.eventsStore.addEvent(t,"artifact_chunk");return}const r=n.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(r,n.chunk),this.stores.eventsStore.addEvent(t,"artifact_chunk")}handleArtifactStored(t){const n=kg(t);n&&this.stores.artifactsStore.addArtifact(n),this.stores.eventsStore.addEvent(t,"artifact_stored")}handleStepEvent(t,n,r){const s=n.event;if(s==="step_start"){const a=n.action_seq;this.stores.chatStore.updateMessage(t.id,{answerActionSeq:typeof a=="number"?a:Dn})}if(s==="tool_call_start"){const a=n.tool_call_id,i=n.tool_name,o=n.args_json;a&&i&&this.handleInteractiveToolCall(a,i,o??"",this.agentMsgId??void 0)}this.stores.eventsStore.addEvent(n,r)}handleDone(t,n,r){const s=n.pause,a=n.trace_id??null;if(s){this.handlePause(t,n,s,a,r);return}const i=n.answer_action_seq,o=t.answerActionSeq??Dn;o!==Dn&&(i===void 0||i===o)&&n.answer&&typeof n.answer=="string"&&this.stores.chatStore.updateMessage(t.id,{text:n.answer}),this.stores.chatStore.updateMessage(t.id,{isStreaming:!1,isThinking:!1}),r.onDone(a),this.close()}handlePause(t,n,r,s,a){const i=Wt(r.payload)??{},o=Ee(i.auth_url)||Ee(i.url)||"",l=Ee(i.provider)||"",u=Ee(r.reason)||"pause",c=Ee(r.resume_token);c&&this.stores.interactionsStore.updatePendingInteraction({resume_token:c});let d=`Planner paused (${u})`;l&&(d+=` for ${l}`),o&&(d+=`
[Open auth link](${o})`),c&&(d+=`
Resume token: \`${c}\``),this.stores.chatStore.updateMessage(t.id,{pause:{reason:u,payload:i,resume_token:c},traceId:s??void 0,text:d,isStreaming:!1,isThinking:!1}),a.onDone(s),this.close()}handleError(t,n,r){const s=n.error??"Unexpected error";this.stores.chatStore.updateMessage(t.id,{text:s,isStreaming:!1,isThinking:!1}),r.onError(s),this.close()}handleInteractiveToolCall(t,n,r,s){const a=this.mapInteractiveComponent(n);if(!a)return;let i={};if(r)try{const o=JSON.parse(r);o&&typeof o=="object"&&(i=o)}catch{i={}}this.stores.interactionsStore.setPendingInteraction({tool_call_id:t,tool_name:n,component:a,props:i,message_id:s,created_at:Date.now()})}mapInteractiveComponent(t){return t==="ui_form"?"form":t==="ui_confirm"?"confirm":t==="ui_select_option"?"select_option":null}startAgui(t,n,r,s,a){const i=this.buildHistory();!i.some(f=>f.role==="user"&&this.hasTextContent(f.content))&&t.trim()&&i.push({id:`msg_${Date.now()}`,role:"user",content:t});const l=this.stores.chatStore.addAgentMessage();this.agentMsgId=l.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const u=new URL("/agui/agent",window.location.origin),c={threadId:n,runId:`run_${Date.now()}`,messages:i,tools:[],context:[],state:{},forwardedProps:{penguiflow:{llm_context:s,tool_context:r}}};this.aguiRunId=c.runId,this.aguiSessionId=n,console.log("[AG-UI] Sending request:",JSON.stringify(c,null,2));const h=new Xo({url:u.toString()}).run(c);this.aguiSubscription=h.subscribe({next:f=>this.handleAguiEvent(f,a),error:f=>{const p=this.findAgentMsg();p&&this.stores.chatStore.updateMessage(p.id,{isStreaming:!1}),a.onError(f.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}resumeAgui(t,n,r,s,a){if(!t.resume_token){a.onError("Resume token missing");return}this.close();const i=this.stores.chatStore.addAgentMessage();this.agentMsgId=i.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const o=new URL("/agui/resume",window.location.origin),l={resume_token:t.resume_token,thread_id:r,run_id:`run_${Date.now()}`,tool_name:t.tool_name,component:t.component,result:n,tool_context:s};this.aguiRunId=l.run_id,this.aguiSessionId=r;const c=new Xo({url:o.toString()}).run(l);this.aguiSubscription=c.subscribe({next:d=>this.handleAguiEvent(d,a),error:d=>{const h=this.findAgentMsg();h&&this.stores.chatStore.updateMessage(h.id,{isStreaming:!1}),a.onError(d.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}handleAguiEvent(t,n){const r=t;switch(console.log("[AG-UI] Received event:",r.type,r),r.type){case T.RUN_STARTED:{const s=r;this.aguiRunId=s.runId??this.aguiRunId;return}case T.RUN_FINISHED:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onDone(s.runId??this.aguiRunId),this.aguiCompleted=!0;return}case T.RUN_ERROR:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onError(s.message||"Run error"),this.aguiCompleted=!0;return}case T.TEXT_MESSAGE_START:{const s=r;if(s.role!=="assistant")return;this.ensureAguiMessage(s.messageId);return}case T.TEXT_MESSAGE_CONTENT:{const s=r,a=this.ensureAguiMessage(s.messageId),i=this.stores.chatStore.findMessage(a);i&&s.delta&&this.stores.chatStore.updateMessage(i.id,{text:`${i.text}${s.delta}`,isStreaming:!0});return}case T.TEXT_MESSAGE_END:{const s=r,a=this.ensureAguiMessage(s.messageId);this.stores.chatStore.updateMessage(a,{isStreaming:!1});return}case T.TOOL_CALL_START:{const s=r,a=s.toolCallId,i=s.toolCallName,o=s.parentMessageId,l=o?this.ensureAguiMessage(o):this.agentMsgId??void 0;this.aguiToolCalls.set(a,{name:i,args:"",messageId:l}),this.stores.eventsStore.addEvent({tool_call_id:a,tool_call_name:i},"tool_call_start");return}case T.TOOL_CALL_ARGS:{const s=r,a=s.toolCallId,i=this.aguiToolCalls.get(a);i&&(i.args+=s.delta??""),this.stores.eventsStore.addEvent({tool_call_id:a,delta:s.delta},"tool_call_args");return}case T.TOOL_CALL_END:{const a=r.toolCallId,i=this.aguiToolCalls.get(a);i&&(this.handleInteractiveToolCall(a,i.name,i.args,i.messageId),this.aguiToolCalls.delete(a)),this.stores.eventsStore.addEvent({tool_call_id:a},"tool_call_end");return}case T.TOOL_CALL_RESULT:{const s=r,a=s.toolCallId;this.stores.eventsStore.addEvent({tool_call_id:a,content:s.content},"tool_call_result");return}case T.CUSTOM:{const s=r,a=s.name,i=s.value,o=Wt(i);if(a==="artifact_stored"&&o){const u=Wt(o.artifact),c=u?xg(u,this.aguiRunId,this.aguiSessionId):null;c&&this.stores.artifactsStore.addArtifact(c)}if(a==="artifact_chunk"&&o){const u=Ko(o);if(u.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(u,{message_id:this.agentMsgId??void 0});else{const c=u.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(c,u.chunk)}}if(a==="thinking"&&o){const u=this.findAgentMsg();if(u){const c=Ee(o.text)??"";Ee(o.phase)==="action"?this.stores.chatStore.updateMessage(u.id,{isThinking:!0}):c&&this.stores.chatStore.updateMessage(u.id,{observations:`${u.observations??""}${c}`,showObservations:!0,isThinking:!1})}}if(a==="revision"&&o){const u=this.findAgentMsg();if(u){const c=Ee(o.text)??"",h={isThinking:!1,isStreaming:!(pc(o.done)??!1)};u.revisionStreamActive||(h.revisionStreamActive=!0,h.text=""),c&&(h.text=`${u.revisionStreamActive?u.text:""}${c}`),this.stores.chatStore.updateMessage(u.id,h)}}if(a==="pause"&&o){const u=this.findAgentMsg();u&&this.handlePause(u,{},o,this.aguiRunId,n);const c=Wt(o.payload),d=c?Ee(c.component):void 0,h=c?Wt(c.props):void 0;c&&d&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Ee(c.tool)??"ui_pause",component:d,props:h,message_id:this.agentMsgId??void 0,resume_token:Ee(o.resume_token),created_at:Date.now()}):Ee(o.resume_token)&&this.stores.interactionsStore.updatePendingInteraction({resume_token:Ee(o.resume_token)}),this.aguiCompleted=!0}const l=o??{value:i};this.stores.eventsStore.addEvent(l,a);return}default:return}}ensureAguiMessage(t){const n=this.aguiMessageMap.get(t);if(n)return n;if(!this.aguiMappedPlaceholder&&this.agentMsgId)return this.aguiMappedPlaceholder=!0,this.aguiMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.aguiMessageMap.set(t,r.id),r.id}buildHistory(){console.log("[AG-UI] Building history from this.stores.chatStore.messages:",this.stores.chatStore.messages.length,"messages");const t=this.stores.chatStore.messages.filter(n=>n.role==="user"||n.role==="agent").map(n=>({id:n.id,role:n.role==="agent"?"assistant":"user",content:n.text}));return console.log("[AG-UI] Built history:",t),t}hasTextContent(t){return typeof t=="string"?t.trim().length>0:Array.isArray(t)?t.some(n=>typeof n=="object"&&n!==null&&"text"in n):!1}}function Wt(e){return!e||typeof e!="object"||Array.isArray(e)?null:e}function Ee(e){return typeof e=="string"?e:void 0}function Er(e){return typeof e=="number"?e:void 0}function pc(e){return typeof e=="boolean"?e:void 0}function Ko(e){return{stream_id:Ee(e.stream_id),seq:Er(e.seq),done:pc(e.done),artifact_type:Ee(e.artifact_type),chunk:e.chunk,meta:Wt(e.meta)??void 0,ts:Er(e.ts)}}function kg(e){const t=Ee(e.artifact_id),n=Ee(e.mime_type),r=Er(e.size_bytes),s=Ee(e.filename),a=Ee(e.trace_id),i=Ee(e.session_id),o=Er(e.ts);return!t||!n||r===void 0||!s||!a||!i||o===void 0?null:{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:Wt(e.source)??{},trace_id:a,session_id:i,ts:o}}function xg(e,t,n){if(!t||!n)return null;const r=Ee(e.id),s=Ee(e.mime_type),a=Er(e.size_bytes),i=Ee(e.filename);return!r||!s||a===void 0||!i?null:{artifact_id:r,mime_type:s,size_bytes:a,filename:i,source:Wt(e.source)??{},trace_id:t,session_id:n,ts:Date.now()}}function Tg(e){return new Eg(e)}class Ag{constructor(t){this.stores=t}eventSource=null;start(t,n){this.close();const r=new URL("/events",window.location.origin);r.searchParams.set("trace_id",t),r.searchParams.set("session_id",n),r.searchParams.set("follow","true"),this.eventSource=new EventSource(r.toString());const s=a=>{const i=lu(a.data);if(!i)return;const o=a.type||i.event||"";if(this.stores.eventsStore.shouldProcess(o)){if(o==="artifact_chunk"){const l=Ig(i);if(l.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(l,{});else{const u=l.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(u,l.chunk)}}if(o==="artifact_stored"){const l=Cg(i);l&&this.stores.artifactsStore.addArtifact(l)}o!=="llm_stream_chunk"&&this.stores.eventsStore.addEvent(i,o||"event")}};["event","step","chunk","llm_stream_chunk","artifact_chunk","artifact_stored"].forEach(a=>{this.eventSource.addEventListener(a,s)}),this.eventSource.onmessage=s,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}}function Ig(e){const t=e.meta;return{stream_id:typeof e.stream_id=="string"?e.stream_id:void 0,seq:typeof e.seq=="number"?e.seq:void 0,done:typeof e.done=="boolean"?e.done:void 0,artifact_type:typeof e.artifact_type=="string"?e.artifact_type:void 0,chunk:e.chunk,meta:t&&typeof t=="object"&&!Array.isArray(t)?t:void 0,ts:typeof e.ts=="number"?e.ts:void 0}}function Cg(e){const t=typeof e.artifact_id=="string"?e.artifact_id:null,n=typeof e.mime_type=="string"?e.mime_type:null,r=typeof e.size_bytes=="number"?e.size_bytes:null,s=typeof e.filename=="string"?e.filename:null,a=typeof e.trace_id=="string"?e.trace_id:null,i=typeof e.session_id=="string"?e.session_id:null,o=typeof e.ts=="number"?e.ts:null;if(!t||!n||r===null||!s||!a||!i||o===null)return null;const l=e.source;return{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:l&&typeof l=="object"&&!Array.isArray(l)?l:{},trace_id:a,session_id:i,ts:o}}function Ng(e){return new Ag(e)}function fi(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Nn=fi();function gc(e){Nn=e}var pr={exec:()=>null};function ae(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(qe.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}var Rg=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),qe={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Og=/^(?:[ \t]*(?:\n|$))+/,Pg=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Mg=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Nr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Lg=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hi=/(?:[*+-]|\d{1,9}[.)])/,mc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_c=ae(mc).replace(/bull/g,hi).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Dg=ae(mc).replace(/bull/g,hi).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),vi=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$g=/^[^\n]+/,pi=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ug=ae(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",pi).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),zg=ae(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,hi).getRegex(),Us="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",gi=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Gg=ae("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",gi).replace("tag",Us).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),yc=ae(vi).replace("hr",Nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex(),jg=ae(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",yc).getRegex(),mi={blockquote:jg,code:Pg,def:Ug,fences:Mg,heading:Lg,hr:Nr,html:Gg,lheading:_c,list:zg,newline:Og,paragraph:yc,table:pr,text:$g},Jo=ae("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex(),Bg={...mi,lheading:Dg,table:Jo,paragraph:ae(vi).replace("hr",Nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Jo).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Us).getRegex()},Fg={...mi,html:ae(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",gi).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:pr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ae(vi).replace("hr",Nr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",_c).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Vg=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Hg=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,bc=/^( {2,}|\\)\n(?!\s*$)/,qg=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,zs=/[\p{P}\p{S}]/u,_i=/[\s\p{P}\p{S}]/u,wc=/[^\s\p{P}\p{S}]/u,Zg=ae(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,_i).getRegex(),Sc=/(?!~)[\p{P}\p{S}]/u,Xg=/(?!~)[\s\p{P}\p{S}]/u,Kg=/(?:[^\s\p{P}\p{S}]|~)/u,Jg=ae(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",Rg?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ec=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Yg=ae(Ec,"u").replace(/punct/g,zs).getRegex(),Wg=ae(Ec,"u").replace(/punct/g,Sc).getRegex(),kc="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Qg=ae(kc,"gu").replace(/notPunctSpace/g,wc).replace(/punctSpace/g,_i).replace(/punct/g,zs).getRegex(),em=ae(kc,"gu").replace(/notPunctSpace/g,Kg).replace(/punctSpace/g,Xg).replace(/punct/g,Sc).getRegex(),tm=ae("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,wc).replace(/punctSpace/g,_i).replace(/punct/g,zs).getRegex(),nm=ae(/\\(punct)/,"gu").replace(/punct/g,zs).getRegex(),rm=ae(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sm=ae(gi).replace("(?:-->|$)","-->").getRegex(),am=ae("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ts=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,im=ae(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ts).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),xc=ae(/^!?\[(label)\]\[(ref)\]/).replace("label",Ts).replace("ref",pi).getRegex(),Tc=ae(/^!?\[(ref)\](?:\[\])?/).replace("ref",pi).getRegex(),om=ae("reflink|nolink(?!\\()","g").replace("reflink",xc).replace("nolink",Tc).getRegex(),Yo=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,yi={_backpedal:pr,anyPunctuation:nm,autolink:rm,blockSkip:Jg,br:bc,code:Hg,del:pr,emStrongLDelim:Yg,emStrongRDelimAst:Qg,emStrongRDelimUnd:tm,escape:Vg,link:im,nolink:Tc,punctuation:Zg,reflink:xc,reflinkSearch:om,tag:am,text:qg,url:pr},lm={...yi,link:ae(/^!?\[(label)\]\((.*?)\)/).replace("label",Ts).getRegex(),reflink:ae(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ts).getRegex()},La={...yi,emStrongRDelimAst:em,emStrongLDelim:Wg,url:ae(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Yo).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ae(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Yo).getRegex()},um={...La,br:ae(bc).replace("{2,}","*").getRegex(),text:ae(La.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Lr={normal:mi,gfm:Bg,pedantic:Fg},ir={normal:yi,gfm:La,breaks:um,pedantic:lm},cm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Wo=e=>cm[e];function Mt(e,t){if(t){if(qe.escapeTest.test(e))return e.replace(qe.escapeReplace,Wo)}else if(qe.escapeTestNoEncode.test(e))return e.replace(qe.escapeReplaceNoEncode,Wo);return e}function Qo(e){try{e=encodeURI(e).replace(qe.percentDecode,"%")}catch{return null}return e}function el(e,t){let n=e.replace(qe.findPipe,(a,i,o)=>{let l=!1,u=i;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(qe.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(qe.slashPipe,"|");return r}function or(e,t,n){let r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function dm(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function tl(e,t,n,r,s){let a=t.href,i=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:i,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function fm(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let s=r[1];return t.split(`
`).map(a=>{let i=a.match(n.other.beginningSpace);if(i===null)return a;let[o]=i;return o.length>=s.length?a.slice(s.length):a}).join(`
`)}var As=class{options;rules;lexer;constructor(e){this.options=e||Nn}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:or(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=fm(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=or(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:or(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=or(t[0],`
`).split(`
`),r="",s="",a=[];for(;n.length>0;){let i=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),i=!0;else if(!i)o.push(n[l]);else break;n=n.slice(l);let u=o.join(`
`),c=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${u}`:u,s=s?`${s}
${c}`:c;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,a,!0),this.lexer.state.top=d,n.length===0)break;let h=a.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let f=h,p=f.raw+`
`+n.join(`
`),m=this.blockquote(p);a[a.length-1]=m,r=r.substring(0,r.length-f.raw.length)+m.raw,s=s.substring(0,s.length-f.text.length)+m.text;break}else if(h?.type==="list"){let f=h,p=f.raw+`
`+n.join(`
`),m=this.list(p);a[a.length-1]=m,r=r.substring(0,r.length-h.raw.length)+m.raw,s=s.substring(0,s.length-f.raw.length)+m.raw,n=p.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:a,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let a=this.rules.other.listItemRegex(n),i=!1;for(;e;){let l=!1,u="",c="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),h=e.split(`
`,1)[0],f=!d.trim(),p=0;if(this.options.pedantic?(p=2,c=d.trimStart()):f?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,c=d.slice(p),p+=t[1].length),f&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),l=!0),!l){let m=this.rules.other.nextBulletRegex(p),g=this.rules.other.hrRegex(p),b=this.rules.other.fencesBeginRegex(p),w=this.rules.other.headingBeginRegex(p),_=this.rules.other.htmlBeginRegex(p);for(;e;){let k=e.split(`
`,1)[0],C;if(h=k,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),C=h):C=h.replace(this.rules.other.tabCharGlobal,"    "),b.test(h)||w.test(h)||_.test(h)||m.test(h)||g.test(h))break;if(C.search(this.rules.other.nonSpaceChar)>=p||!h.trim())c+=`
`+C.slice(p);else{if(f||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||b.test(d)||w.test(d)||g.test(d))break;c+=`
`+h}!f&&!h.trim()&&(f=!0),u+=k+`
`,e=e.substring(k.length+1),d=C.slice(p)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),s.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(c),loose:!1,text:c,tokens:[]}),s.raw+=u}let o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let c=this.lexer.inlineQueue.length-1;c>=0;c--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[c].src)){this.lexer.inlineQueue[c].src=this.lexer.inlineQueue[c].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(l.raw);if(u){let c={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};l.checked=c.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=c.raw+l.tokens[0].raw,l.tokens[0].text=c.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(c)):l.tokens.unshift({type:"paragraph",raw:c.raw,text:c.raw,tokens:[c]}):l.tokens.unshift(c)}}if(!s.loose){let u=l.tokens.filter(d=>d.type==="space"),c=u.length>0&&u.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=c}}if(s.loose)for(let l of s.items){l.loose=!0;for(let u of l.tokens)u.type==="text"&&(u.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=el(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?a.align.push("right"):this.rules.other.tableAlignCenter.test(i)?a.align.push("center"):this.rules.other.tableAlignLeft.test(i)?a.align.push("left"):a.align.push(null);for(let i=0;i<n.length;i++)a.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:a.align[i]});for(let i of s)a.rows.push(el(i,a.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:a.align[l]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=or(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=dm(t[2],"()");if(a===-2)return;if(a>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(r);a&&(r=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),tl(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return tl(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,a,i,o=s,l=0,u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(i=[...a].length,r[3]||r[4]){o+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(o-=i,o>0)continue;i=Math.min(i,i+o+l);let c=[...r[0]][0].length,d=e.slice(0,s+r.index+c+i);if(Math.min(s,i)%2){let f=d.slice(1,-1);return{type:"em",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}let h=d.slice(2,-2);return{type:"strong",raw:d,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},pt=class Da{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Nn,this.options.tokenizer=this.options.tokenizer||new As,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:qe,block:Lr.normal,inline:ir.normal};this.options.pedantic?(n.block=Lr.pedantic,n.inline=ir.pedantic):this.options.gfm&&(n.block=Lr.gfm,this.options.breaks?n.inline=ir.breaks:n.inline=ir.gfm),this.tokenizer.rules=n}static get rules(){return{block:Lr,inline:ir}}static lex(t,n){return new Da(n).lex(t)}static lexInline(t,n){return new Da(n).inlineTokens(t)}lex(t){t=t.replace(qe.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(qe.tabCharGlobal,"    ").replace(qe.spaceLine,""));t;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}let a=t;if(this.options.extensions?.startBlock){let i=1/0,o=t.slice(1),l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(a=t.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=a.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)a=s[2]?s[2].length:0,r=r.slice(0,s.index+a)+"["+"a".repeat(s[0].length-a-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,o="";for(;t;){i||(o=""),i=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let c=n.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,r,o)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let u=t;if(this.options.extensions?.startInline){let c=1/0,d=t.slice(1),h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(l=this.tokenizer.inlineText(u)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),i=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},Is=class{options;parser;constructor(e){this.options=e||Nn}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(qe.notSpaceStart)?.[0],s=e.replace(qe.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Mt(r)+'">'+(n?s:Mt(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Mt(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let i=0;i<e.items.length;i++){let o=e.items[i];r+=this.listitem(o)}let s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+r+"</"+s+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];n="";for(let i=0;i<a.length;i++)n+=this.tablecell(a[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Mt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=Qo(e);if(s===null)return r;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+Mt(t)+'"'),a+=">"+r+"</a>",a}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=Qo(e);if(s===null)return Mt(n);e=s;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${Mt(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Mt(e.text)}},bi=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},gt=class $a{options;renderer;textRenderer;constructor(t){this.options=t||Nn,this.options.renderer=this.options.renderer||new Is,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new bi}static parse(t,n){return new $a(n).parse(t)}static parseInline(t,n){return new $a(n).parseInline(t)}parse(t){let n="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,o=this.options.extensions.renderers[i.type].call({parser:this},i);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=o||"";continue}}let a=s;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(t,n=this.renderer){let r="";for(let s=0;s<t.length;s++){let a=t[s];if(this.options.extensions?.renderers?.[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=o||"";continue}}let i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},hr=class{options;block;constructor(e){this.options=e||Nn}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?pt.lex:pt.lexInline}provideParser(){return this.block?gt.parse:gt.parseInline}},hm=class{defaults=fi();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=gt;Renderer=Is;TextRenderer=bi;Lexer=pt;Tokenizer=As;Hooks=hr;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let s=r;for(let a of s.header)n=n.concat(this.walkTokens(a.tokens,t));for(let a of s.rows)for(let i of a)n=n.concat(this.walkTokens(i.tokens,t));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{let i=s[a].flat(1/0);n=n.concat(this.walkTokens(i,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=t.renderers[s.name];a?t.renderers[s.name]=function(...i){let o=s.renderer.apply(this,i);return o===!1&&(o=a.apply(this,i)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){let s=this.defaults.renderer||new Is(this.defaults);for(let a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let i=a,o=n.renderer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new As(this.defaults);for(let a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let i=a,o=n.tokenizer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new hr;for(let a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let i=a,o=n.hooks[i],l=s[i];hr.passThroughHooks.has(a)?s[i]=u=>{if(this.defaults.async&&hr.passThroughHooksRespectAsync.has(a))return(async()=>{let d=await o.call(s,u);return l.call(s,d)})();let c=o.call(s,u);return l.call(s,c)}:s[i]=(...u)=>{if(this.defaults.async)return(async()=>{let d=await o.apply(s,u);return d===!1&&(d=await l.apply(s,u)),d})();let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(i){let o=[];return o.push(a.call(this,i)),s&&(o=o.concat(s.call(this,i))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return pt.lex(e,t??this.defaults)}parser(e,t){return gt.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(t):t,o=await(s.hooks?await s.hooks.provideLexer():e?pt.lex:pt.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(o):o;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let u=await(s.hooks?await s.hooks.provideParser():e?gt.parse:gt.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(u):u})().catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let i=(s.hooks?s.hooks.provideLexer():e?pt.lex:pt.lexInline)(t,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let o=(s.hooks?s.hooks.provideParser():e?gt.parse:gt.parseInline)(i,s);return s.hooks&&(o=s.hooks.postprocess(o)),o}catch(i){return a(i)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+Mt(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},xn=new hm;function ue(e,t){return xn.parse(e,t)}ue.options=ue.setOptions=function(e){return xn.setOptions(e),ue.defaults=xn.defaults,gc(ue.defaults),ue};ue.getDefaults=fi;ue.defaults=Nn;ue.use=function(...e){return xn.use(...e),ue.defaults=xn.defaults,gc(ue.defaults),ue};ue.walkTokens=function(e,t){return xn.walkTokens(e,t)};ue.parseInline=xn.parseInline;ue.Parser=gt;ue.parser=gt.parse;ue.Renderer=Is;ue.TextRenderer=bi;ue.Lexer=pt;ue.lexer=pt.lex;ue.Tokenizer=As;ue.Hooks=hr;ue.parse=ue;ue.options;ue.setOptions;ue.use;ue.walkTokens;ue.parseInline;gt.parse;pt.lex;ue.setOptions({breaks:!0,gfm:!0});function Ac(e){if(!e)return"";try{return ue.parse(e,{async:!1})}catch{return e}}let nl=!1;function vm(){nl||typeof window>"u"||(nl=!0,window.addEventListener("error",e=>{console.error("[playground-ui] Unhandled error:",e.error??e.message)}),window.addEventListener("unhandledrejection",e=>{console.error("[playground-ui] Unhandled rejection:",e.reason)}))}var pm=A("<div><!></div>");function wi(e,t){let n=Le(t,"position",3,"center"),r=Le(t,"class",3,"");var s=pm(),a=y(s);et(a,()=>t.children??Pe),U(()=>Ne(s,1,`column ${n()??""} ${r()??""}`,"svelte-1k9hy8f")),E(e,s)}var gm=A('<div class="page svelte-1g511ye"><!></div>');function mm(e,t){var n=gm(),r=y(n);et(r,()=>t.children??Pe),E(e,n)}function _m(e,t){wi(e,{position:"left",children:(n,r)=>{var s=Oe(),a=W(s);et(a,()=>t.children??Pe),E(n,s)},$$slots:{default:!0}})}Ed();var ym=A("<div><!></div>");function Rn(e,t){let n=Le(t,"class",3,"");var r=ym(),s=y(r);et(s,()=>t.children??Pe),U(()=>Ne(r,1,`card ${n()??""}`,"svelte-4n6w97")),E(e,r)}var bm=A('<button type="button"> </button>'),wm=A('<div class="tabs svelte-1nusxqd"><!> <!></div>');function Sm(e,t){ee(t,!0);var n=wm(),r=y(n);De(r,17,()=>t.tabs,a=>a.id,(a,i)=>{var o=bm();let l;o.__click=()=>t.onchange?.(v(i).id);var u=y(o);U(()=>{l=Ne(o,1,"tab svelte-1nusxqd",null,l,{active:t.active===v(i).id}),L(u,v(i).label)}),E(a,o)});var s=S(r,2);et(s,()=>t.right??Pe),E(e,n),te()}bt(["click"]);var Em=A('<div class="icon svelte-12nvmli"> </div>'),km=A('<div class="subtitle svelte-12nvmli"> </div>'),xm=A('<div><!> <div class="title svelte-12nvmli"> </div> <!></div>');function Si(e,t){let n=Le(t,"inline",3,!1);var r=xm();let s;var a=y(r);{var i=d=>{var h=Em(),f=y(h);U(()=>L(f,t.icon)),E(d,h)};G(a,d=>{t.icon&&d(i)})}var o=S(a,2),l=y(o),u=S(o,2);{var c=d=>{var h=km(),f=y(h);U(()=>L(f,t.subtitle)),E(d,h)};G(u,d=>{t.subtitle&&d(c)})}U(()=>{s=Ne(r,1,"empty svelte-12nvmli",null,s,{inline:n()}),L(l,t.title)}),E(e,r)}var Tm=A('<div class="error-row svelte-1bc74kj"> </div>'),Am=A('<div class="errors svelte-1bc74kj"></div>');function Ic(e,t){ee(t,!0);var n=Oe(),r=W(n);{var s=a=>{var i=Am();De(i,21,()=>t.errors,o=>o.id,(o,l)=>{var u=Tm(),c=y(u);U(()=>L(c,`Warning ${v(l).message??""}`)),E(o,u)}),E(a,i)};G(r,a=>{t.errors.length>0&&a(s)})}E(e,n),te()}var Im=A('<div class="label svelte-1hc9aln"> </div>'),Cm=A('<div class="code-block svelte-1hc9aln"><!> <pre class="svelte-1hc9aln"> </pre></div>');function rl(e,t){let n=Le(t,"maxHeight",3,"100px");const r=me(()=>typeof t.content=="string"?t.content:JSON.stringify(t.content,null,2));var s=Cm(),a=y(s);{var i=u=>{var c=Im(),d=y(c);U(()=>L(d,t.label)),E(u,c)};G(a,u=>{t.label&&u(i)})}var o=S(a,2),l=y(o);U(()=>{gf(o,`max-height: ${n()??""}`),L(l,v(r))}),E(e,s)}var Nm=A("<span><!></span>");function at(e,t){let n=Le(t,"variant",3,"default"),r=Le(t,"size",3,"default"),s=Le(t,"class",3,"");var a=Nm(),i=y(a);et(i,()=>t.children??Pe),U(()=>Ne(a,1,`pill ${n()??""} ${r()??""} ${s()??""}`,"svelte-1qe3l4g")),E(e,a)}var Rm=A("<span><!></span>");function Om(e,t){var n=Rm(),r=y(n);{var s=a=>{var i=Ve();U(()=>L(i,t.label)),E(a,i)};G(r,a=>{t.label&&a(s)})}U(()=>Ne(n,1,`status-dot ${t.status??""}`,"svelte-1506mec")),E(e,n)}var Pm=A('<button class="icon-btn svelte-w50x32"><!></button>');function Mm(e,t){var n=Pm();n.__click=function(...s){t.onclick?.apply(this,s)};var r=y(n);et(r,()=>t.children??Pe),U(()=>ft(n,"title",t.title)),E(e,n)}bt(["click"]);var Lm=A('<div class="row space-between align-center svelte-1683ey6"><div><div class="title svelte-1683ey6"> </div> <div class="muted svelte-1683ey6"> </div></div> <!></div> <div class="badges svelte-1683ey6"></div> <div class="stats-row svelte-1683ey6"><div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">TOOLS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">FLOWS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">SVCS</div> <div class="stat-value svelte-1683ey6"> </div></div></div>',1);function sl(e,t){ee(t,!1);const n=nr();ot(),Rn(e,{class:"project-card",children:(r,s)=>{var a=Lm(),i=W(a),o=y(i),l=y(o),u=y(l),c=S(l,2),d=y(c),h=S(o,2);at(h,{variant:"subtle",children:(D,O)=>{var N=Ve();U(()=>L(N,n.meta.version||n.meta.template)),E(D,N)},$$slots:{default:!0}});var f=S(i,2);De(f,5,()=>n.meta.flags,Ja,(D,O)=>{at(D,{variant:"ghost",children:(N,j)=>{var H=Ve();U(()=>L(H,v(O))),E(N,H)},$$slots:{default:!0}})});var p=S(f,2),m=y(p),g=S(y(m),2),b=y(g),w=S(m,2),_=S(y(w),2),k=y(_),C=S(w,2),I=S(y(C),2),R=y(I);U(()=>{L(u,n.meta.name),L(d,n.meta.description),L(b,n.meta.tools),L(k,n.meta.flows),L(R,n.services.length)}),E(r,a)},$$slots:{default:!0}}),te()}var Dm=A('<div class="tabs svelte-1t9psp2"><div class="tab active svelte-1t9psp2">Spec YAML</div> <div class="tab svelte-1t9psp2">Validation</div> <!></div> <pre class="spec-view svelte-1t9psp2"> </pre> <!>',1);function al(e,t){ee(t,!0);const n=hh(),r=me(()=>n.status==="valid"?"Valid":n.status==="error"?"Errors":"Pending");Rn(e,{class:"spec-card",children:(s,a)=>{var i=Dm(),o=W(i),l=S(y(o),4);Om(l,{get status(){return n.status},get label(){return v(r)}});var u=S(o,2),c=y(u),d=S(u,2);Ic(d,{get errors(){return n.errors}}),U(()=>L(c,n.content)),E(s,i)},$$slots:{default:!0}}),te()}bt(["click"]);var $m=A('<span class="dot active svelte-15dukw8"></span> ',1),Um=A('<div class="chat-header svelte-15dukw8"><!> <!></div>');function zm(e,t){ee(t,!1);const n=nr();ot();var r=Um(),s=y(r);at(s,{class:"header-pill",children:(i,o)=>{var l=$m(),u=S(W(l));U(()=>L(u,` ${n.meta.name??""}`)),E(i,l)},$$slots:{default:!0}});var a=S(s,2);at(a,{variant:"ghost",children:(i,o)=>{var l=Ve("DEV PLAYGROUND");E(i,l)},$$slots:{default:!0}}),E(e,r),te()}var Gm=A('<details class="thinking-panel svelte-1xc7ue3"><summary class="thinking-summary svelte-1xc7ue3"> </summary> <div class="thinking-body svelte-1xc7ue3"><div class="markdown-content"><!></div></div></details>');function jm(e,t){ee(t,!0);const n=u=>{const c=u.currentTarget;t.ontoggle?.(c.open)};var r=Gm(),s=y(r),a=y(s),i=S(s,2),o=y(i),l=y(o);nu(l,()=>Ac(t.observations)),U(()=>{r.open=t.open,L(a,t.isStreaming?"Thinking...":"Thought")}),Wd("toggle",r,n),E(e,r),te()}var Bm=A('<a class="pause-link svelte-sbh9b9" target="_blank" rel="noreferrer">Open authorization link</a>'),Fm=A('<div class="pause-token svelte-sbh9b9"> </div>'),Vm=A('<div class="pause-card svelte-sbh9b9"><div class="pause-title svelte-sbh9b9">Action required</div> <!> <!> <div class="pause-meta svelte-sbh9b9"> <!></div></div>');function Hm(e,t){ee(t,!0);const n=me(()=>t.pause.payload?.auth_url||t.pause.payload?.url||""),r=me(()=>t.pause.payload?.provider||"");var s=Vm(),a=S(y(s),2);{var i=f=>{var p=Bm();U(()=>ft(p,"href",v(n))),E(f,p)};G(a,f=>{v(n)&&f(i)})}var o=S(a,2);{var l=f=>{var p=Fm(),m=y(p);U(()=>L(m,`Resume token: ${t.pause.resume_token??""}`)),E(f,p)};G(o,f=>{t.pause.resume_token&&f(l)})}var u=S(o,2),c=y(u),d=S(c);{var h=f=>{var p=Ve();U(()=>L(p,`- provider: ${v(r)??""}`)),E(f,p)};G(d,f=>{v(r)&&f(h)})}U(()=>L(c,`${t.pause.reason?`reason: ${t.pause.reason}`:"paused"} `)),E(e,s),te()}var qm=A('<div class="typing svelte-1gl9kj5"><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span></div>');function Zm(e){var t=qm();E(e,t)}const Xm="modulepreload",Km=function(e){return"/"+e},il={},Ae=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");s=l(n.map(u=>{if(u=Km(u),u in il)return;il[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Xm,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function Ei(e,t=[]){if(!e||typeof e!="object"||Array.isArray(e))return fs(new Error("Props must be an object."));const n=e;for(const r of t)if(!(r in n))return fs(new Error(`Missing required prop: ${r}`));return Qa(n)}function Jm(e,t){const n=e[t];return typeof n!="string"||!n.trim()?fs(new Error(`Invalid or missing string prop: ${t}`)):Qa(e)}function Ym(e,t){const n=e[t];return!n||typeof n!="object"||Array.isArray(n)?fs(new Error(`Invalid or missing object prop: ${t}`)):Qa(e)}const Me=e=>Ei(e),Wm=e=>{const t=Ei(e,["option"]);return t.ok?Ym(t.data,"option"):t},Qm=e=>{const t=Ei(e,["code"]);return t.ok?Jm(t.data,"code"):t},e_={echarts:{load:()=>Ae(()=>import("./ECharts-BatY2PA0.js"),__vite__mapDeps([0,1])),validateProps:Wm},mermaid:{load:()=>Ae(()=>import("./Mermaid-BnvApiL5.js").then(e=>e.bA),__vite__mapDeps([2,3,4,5])),validateProps:Qm},plotly:{load:()=>Ae(()=>import("./Plotly-CIC-wb6f.js"),__vite__mapDeps([6,3,7])),validateProps:Me},datagrid:{load:()=>Ae(()=>import("./DataGrid-B6T81wdI.js"),__vite__mapDeps([8,9])),validateProps:Me},json:{load:()=>Ae(()=>import("./Json-Dd_7SWV1.js"),__vite__mapDeps([10,11])),validateProps:Me},metric:{load:()=>Ae(()=>import("./Metric-D96PNo2P.js"),__vite__mapDeps([12,13])),validateProps:Me},markdown:{load:()=>Ae(()=>import("./Markdown-DzDi7Rdh.js"),__vite__mapDeps([14,4,15,16,17])),validateProps:Me},code:{load:()=>Ae(()=>import("./Code-CSPpkFJu.js"),__vite__mapDeps([18,19])),validateProps:Me},latex:{load:()=>Ae(()=>import("./Latex-D19u_OsU.js"),__vite__mapDeps([20,15,21,17])),validateProps:Me},callout:{load:()=>Ae(()=>import("./Callout-C2E-XZZO.js"),__vite__mapDeps([22,14,4,15,16,17,23])),validateProps:Me},form:{load:()=>Ae(()=>import("./Form-BlTJgSWQ.js"),__vite__mapDeps([24,25])),validateProps:Me},confirm:{load:()=>Ae(()=>import("./Confirm-RpLTM9UL.js"),__vite__mapDeps([26,14,4,15,16,17,27])),validateProps:Me},select_option:{load:()=>Ae(()=>import("./SelectOption-BcYwad_A.js"),__vite__mapDeps([28,29])),validateProps:Me},report:{load:()=>Ae(()=>import("./Report-Cw5NbLo_.js"),__vite__mapDeps([30,14,4,15,16,17,31])),validateProps:Me},grid:{load:()=>Ae(()=>import("./Grid-B2hI-naX.js"),__vite__mapDeps([32,33])),validateProps:Me},tabs:{load:()=>Ae(()=>import("./Tabs-De9p1fgW.js"),__vite__mapDeps([34,14,4,15,16,17,35])),validateProps:Me},accordion:{load:()=>Ae(()=>import("./Accordion-D1aPhfN2.js"),__vite__mapDeps([36,14,4,15,16,17,37])),validateProps:Me},image:{load:()=>Ae(()=>import("./Image-BnfUEj4W.js"),__vite__mapDeps([38,39])),validateProps:Me},html:{load:()=>Ae(()=>import("./Html-PErmYI5d.js"),__vite__mapDeps([40,41])),validateProps:Me},video:{load:()=>Ae(()=>import("./Video-Cxozw_wp.js"),__vite__mapDeps([42,43])),validateProps:Me},embed:{load:()=>Ae(()=>import("./Embed-CbA3rtsT.js"),__vite__mapDeps([44,45])),validateProps:Me}};var t_=A("<div><!></div>"),n_=A('<div class="artifact-error svelte-1ly7nl2"><strong> </strong> <pre class="svelte-1ly7nl2"> </pre></div>'),r_=A('<div class="renderer-loading svelte-1ly7nl2">Loading...</div>');function Ua(e,t){ee(t,!0);let n=Le(t,"props",19,()=>({})),r=Le(t,"onResult",3,void 0);const s=ri(),a=me(()=>s.getComponent(t.component)),i=me(()=>v(a)?.interactive??!1),o=me(async()=>{const c=e_[t.component];if(!c)return{ok:!1,error:new Error(`Renderer not found: ${t.component}`)};try{const d=await c.load(),h=c.validateProps(n());return h.ok?{ok:!0,data:{Renderer:d.default,props:h.data}}:h}catch(d){return{ok:!1,error:Kf(d,`Failed to load renderer: ${t.component}`)}}});var l=Oe(),u=W(l);af(u,()=>v(o),c=>{var d=r_();E(c,d)},(c,d)=>{var h=Oe(),f=W(h);{var p=g=>{const b=me(()=>v(d).data.Renderer);var w=t_();let _;var k=y(w);ff(k,()=>v(b),(C,I)=>{I(C,Af(()=>v(d).data.props,{get onResult(){return r()}}))}),U(()=>{_=Ne(w,1,"artifact svelte-1ly7nl2",null,_,{interactive:v(i)}),ft(w,"data-component",t.component)}),E(g,w)},m=g=>{var b=n_(),w=y(b),_=y(w),k=S(w),C=S(k),I=y(C);U(R=>{L(_,`Failed to render ${t.component??""}:`),L(k,` ${v(d).error.message??""} `),L(I,R)},[()=>JSON.stringify(n(),null,2)]),E(g,b)};G(f,g=>{v(d).ok?g(p):g(m,!1)})}E(c,h)}),E(e,l),te()}var s_=A('<div class="artifact-title svelte-1dv1zra"> </div>'),a_=A("<!> <!>",1),i_=A('<div class="component-artifacts svelte-1dv1zra"></div>'),o_=A('<div class="component-interaction svelte-1dv1zra"><!></div>'),l_=A('<span class="link svelte-1dv1zra"> </span>'),u_=A('<div><div><!> <div class="markdown-content"><!></div> <!> <!> <!> <!></div> <div class="meta-row svelte-1dv1zra"><span> </span> <!></div></div>');function c_(e,t){ee(t,!0);let n=Le(t,"message",7);const r=me(()=>n().role==="agent"&&n().observations&&n().observations.trim()!==""),s=ni(),a=me(()=>s.artifacts.filter(N=>N.message_id===n().id)),i=me(()=>{const N=s.pendingInteraction;return!N||N.message_id!==n().id?null:N});var o=u_(),l=y(o),u=y(l);{var c=N=>{{let j=me(()=>n().showObservations??!1),H=me(()=>n().isStreaming??!1);jm(N,{get observations(){return n().observations},get open(){return v(j)},get isStreaming(){return v(H)},ontoggle:q=>{n().showObservations=q}})}};G(u,N=>{v(r)&&N(c)})}var d=S(u,2),h=y(d);nu(h,()=>Ac(n().text));var f=S(d,2);{var p=N=>{var j=i_();De(j,21,()=>v(a),H=>H.id,(H,q)=>{var le=a_(),ve=W(le);{var pe=be=>{var wt=s_(),un=y(wt);U(()=>L(un,v(q).title)),E(be,wt)};G(ve,be=>{v(q).title&&be(pe)})}var $e=S(ve,2);Ua($e,{get component(){return v(q).component},get props(){return v(q).props}}),E(H,le)}),E(N,j)};G(f,N=>{n().role==="agent"&&v(a).length>0&&N(p)})}var m=S(f,2);{var g=N=>{var j=o_(),H=y(j);Ua(H,{get component(){return v(i).component},get props(){return v(i).props},onResult:q=>t.onInteractionResult?.(v(i),q)}),E(N,j)};G(m,N=>{n().role==="agent"&&v(i)&&N(g)})}var b=S(m,2);{var w=N=>{Hm(N,{get pause(){return n().pause}})};G(b,N=>{n().pause&&N(w)})}var _=S(b,2);{var k=N=>{Zm(N)};G(_,N=>{(n().isStreaming||n().isThinking)&&N(k)})}var C=S(l,2),I=y(C),R=y(I),D=S(I,2);{var O=N=>{var j=l_(),H=y(j);U(()=>L(H,`#${n().traceId??""}`)),E(N,j)};G(D,N=>{n().traceId&&N(O)})}U(N=>{Ne(o,1,`message-row ${n().role==="agent"?"agent":"user"}`,"svelte-1dv1zra"),Ne(l,1,`bubble ${n().role}`,"svelte-1dv1zra"),L(R,N)},[()=>Nf(n().ts)]),E(e,o),te()}var d_=A('<div class="chat-body svelte-mwyedf"><!></div>');function f_(e,t){ee(t,!0);const n=hu();let r=Le(t,"chatBodyEl",15,null);var s=d_(),a=y(s);{var i=l=>{Si(l,{icon:"*",title:"Ready to test agent behavior.",subtitle:"Type a message below to start a run."})},o=l=>{var u=Oe(),c=W(u);De(c,17,()=>n.messages,d=>d.id,(d,h)=>{c_(d,{get message(){return v(h)},get onInteractionResult(){return t.onInteractionResult}})}),E(l,u)};G(a,l=>{n.isEmpty?l(i):l(o,!1)})}yr(s,l=>r(l),()=>r()),E(e,s),te()}var h_=A('<div class="chat-input svelte-esbonz"><textarea placeholder="Ask your agent something..." class="svelte-esbonz"></textarea> <button class="send-btn svelte-esbonz">></button></div>');function v_(e,t){ee(t,!0);const n=hu(),r=Ir(),s=l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),t.onsubmit())};var a=h_(),i=y(a);i.__keydown=s;var o=S(i,2);o.__click=function(...l){t.onsubmit?.apply(this,l)},U(l=>o.disabled=l,[()=>r.isSending||!n.input.trim()]),fn(i,()=>n.input,l=>n.input=l),E(e,a),te()}bt(["keydown","click"]);const Cc=Symbol("agui");function p_(e){it(Cc,e)}function Nc(){const e=yt(Cc);if(!e)throw new Error("AGUIProvider not found");return e}var g_=A('<span class="dots svelte-z9q8sr">...</span>'),m_=A('<div class="result svelte-z9q8sr"><div class="label svelte-z9q8sr">Result</div> <pre class="svelte-z9q8sr"> </pre></div>'),__=A('<div><div class="header svelte-z9q8sr"><span class="icon svelte-z9q8sr">tool</span> <strong class="svelte-z9q8sr"> </strong> <!></div> <pre class="args svelte-z9q8sr"> </pre> <!></div>');function y_(e,t){ee(t,!1);const n=Ft();let r=Le(t,"toolCall",8);zl(()=>Ye(r()),()=>{x(n,(()=>{try{return JSON.parse(r().arguments)}catch{return null}})())}),Gl(),ot();var s=__();let a;var i=y(s),o=S(y(i),2),l=y(o),u=S(o,2);{var c=m=>{var g=g_();E(m,g)};G(u,m=>{Ye(r()),ie(()=>r().isStreaming)&&m(c)})}var d=S(i,2),h=y(d),f=S(d,2);{var p=m=>{var g=m_(),b=S(y(g),2),w=y(b);U(()=>L(w,(Ye(r()),ie(()=>r().result)))),E(m,g)};G(f,m=>{Ye(r()),ie(()=>r().result)&&m(p)})}U(m=>{a=Ne(s,1,"agui-tool-call svelte-z9q8sr",null,a,{streaming:r().isStreaming}),L(l,(Ye(r()),ie(()=>r().name))),L(h,`${m??""}
  `)},[()=>(v(n),Ye(r()),ie(()=>v(n)?JSON.stringify(v(n),null,2):r().arguments))]),E(e,s),te()}var b_=A('<span class="cursor svelte-19eh49q">|</span>'),w_=A('<div class="agui-tool-calls svelte-19eh49q"></div>'),S_=A('<div><div><div class="agui-role svelte-19eh49q"> </div> <div class="agui-message-content svelte-19eh49q"> <!></div> <!></div></div>');function E_(e,t){ee(t,!1);let n=Le(t,"message",8);ot();var r=S_(),s=y(r),a=y(s),i=y(a),o=S(a,2),l=y(o),u=S(l);{var c=f=>{var p=b_();E(f,p)};G(u,f=>{Ye(n()),ie(()=>n().isStreaming)&&f(c)})}var d=S(o,2);{var h=f=>{var p=w_();De(p,5,()=>(Ye(n()),ie(()=>n().toolCalls)),m=>m.id,(m,g)=>{y_(m,{get toolCall(){return v(g)}})}),E(f,p)};G(d,f=>{Ye(n()),ie(()=>n().toolCalls.length>0)&&f(h)})}U(()=>{Ne(r,1,(Ye(n()),ie(()=>`agui-message-row ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),Ne(s,1,(Ye(n()),ie(()=>`agui-bubble ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),L(i,(Ye(n()),ie(()=>n().role))),L(l,(Ye(n()),ie(()=>n().content)))}),E(e,r),te()}var k_=A('<p class="agui-empty svelte-15on836">No messages yet</p>'),x_=A('<div class="agui-message-list svelte-15on836"><!> <!></div>');function T_(e,t){ee(t,!1);const n=()=>ur(a,"$messages",r),[r,s]=iu(),{messages:a}=Nc();let i=Ft();zl(()=>(n(),v(i)),()=>{n().length&&v(i)&&requestAnimationFrame(()=>{v(i)&&Kt(i,v(i).scrollTop=v(i).scrollHeight)})}),Gl(),ot();var o=x_(),l=y(o);De(l,1,n,d=>d.id,(d,h)=>{E_(d,{get message(){return v(h)}})});var u=S(l,2);{var c=d=>{var h=Oe(),f=W(h);df(f,t,"empty",{},p=>{var m=k_();E(p,m)}),E(d,h)};G(u,d=>{n(),ie(()=>n().length===0)&&d(c)})}yr(o,d=>x(i,d),()=>v(i)),E(e,o),te(),s()}var A_=A("<li> </li>"),I_=A('<section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Active Steps</h4> <ul class="svelte-rwecvr"></ul></section>'),C_=A('<section class="error svelte-rwecvr"><h4 class="svelte-rwecvr">Error</h4> <pre class="svelte-rwecvr"> </pre></section>'),N_=A('<details class="agui-debugger svelte-rwecvr"><summary class="svelte-rwecvr">AG-UI Debug <span> </span></summary> <div class="content svelte-rwecvr"><section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Thread / Run</h4> <code class="svelte-rwecvr"> </code></section> <!> <section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Agent State</h4> <pre class="svelte-rwecvr"> </pre></section> <!></div></details>');function R_(e,t){ee(t,!1);const n=()=>ur(u,"$status",i),r=()=>ur(l,"$state",i),s=()=>ur(d,"$activeSteps",i),a=()=>ur(c,"$agentState",i),[i,o]=iu(),{state:l,status:u,agentState:c,activeSteps:d}=Nc();let h=Le(t,"expanded",12,!1);ot();var f=N_(),p=y(f),m=S(y(p));let g;var b=y(m),w=S(p,2),_=y(w),k=S(y(_),2),C=y(k),I=S(_,2);{var R=q=>{var le=I_(),ve=S(y(le),2);De(ve,5,s,Ja,(pe,$e)=>{var be=A_(),wt=y(be);U(()=>L(wt,(v($e),ie(()=>v($e).name)))),E(pe,be)}),E(q,le)};G(I,q=>{s(),ie(()=>s().length>0)&&q(R)})}var D=S(I,2),O=S(y(D),2),N=y(O),j=S(D,2);{var H=q=>{var le=C_(),ve=S(y(le),2),pe=y(ve);U($e=>L(pe,$e),[()=>(r(),ie(()=>JSON.stringify(r().error,null,2)))]),E(q,le)};G(j,q=>{r(),ie(()=>r().error)&&q(H)})}U(q=>{g=Ne(m,1,"status svelte-rwecvr",null,g,{running:n()==="running",error:n()==="error"}),L(b,n()),L(C,`${r(),ie(()=>r().threadId??"â")??""} / ${r(),ie(()=>r().runId??"â")??""}`),L(N,q)},[()=>(a(),ie(()=>JSON.stringify(a(),null,2)))]),Sf("open","toggle",f,h,h),E(e,f),te(),o()}var O_=A('<div class="muted tiny svelte-asidmd"> </div>'),P_=A('<div><div class="label svelte-asidmd"> </div> <!> <!></div>');function Ln(e,t){let n=Le(t,"full",3,!1);var r=P_();let s;var a=y(r),i=y(a),o=S(a,2);et(o,()=>t.children??Pe);var l=S(o,2);{var u=c=>{var d=O_(),h=y(d);U(()=>L(h,t.hint)),E(c,d)};G(l,c=>{t.hint&&c(u)})}U(()=>{s=Ne(r,1,"setup-field svelte-asidmd",null,s,{full:n()}),L(i,t.label)}),E(e,r)}var M_=A('<div class="row gap svelte-18icuuu"><input class="setup-input svelte-18icuuu"/> <button class="ghost-btn small svelte-18icuuu">New</button></div>'),L_=A('<input class="setup-input svelte-18icuuu"/>'),D_=A('<input class="setup-input svelte-18icuuu"/>'),$_=A('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),U_=A('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),z_=A('<label class="toggle-row svelte-18icuuu"><input class="toggle-input svelte-18icuuu" type="checkbox"/> <span>Use AG-UI</span></label>'),G_=A('<div class="agui-preview svelte-18icuuu"><div class="agui-preview-title svelte-18icuuu">AG-UI Preview</div> <!> <!></div>'),j_=A('<div class="setup-body svelte-18icuuu"><div class="setup-grid svelte-18icuuu"><!> <!> <!> <!> <!> <!></div> <!> <!></div>');function B_(e,t){ee(t,!1);const n={messages:cn([{id:"preview-msg",role:"assistant",content:"AG-UI preview message with a tool call.",isStreaming:!1,toolCalls:[{id:"preview-call",name:"search",arguments:'{"query":"preview"}',isStreaming:!1,result:"ok"}]}]),state:cn({status:"idle",threadId:"preview-thread",runId:"preview-run",messages:[],agentState:{mode:"preview"},activeSteps:[],error:null}),status:cn("idle"),agentState:cn({mode:"preview"}),isRunning:cn(!1),error:cn(null),activeSteps:cn([]),sendMessage:async()=>{},cancel:()=>{},reset:()=>{}},r=Ft(Ir()),s=Ft(gh()),a=ti(),i=ei(),o=ni();p_(n),ot();var l=j_(),u=y(l),c=y(u);Ln(c,{label:"Session ID",hint:"Used to scope short-term memory and trajectory lookups.",children:(k,C)=>{var I=M_(),R=y(I),D=S(R,2);D.__click=()=>{v(r).newSession(),a.clear(),i.clear(),o.clear()},fn(R,()=>v(r).sessionId,O=>Kt(r,v(r).sessionId=O)),E(k,I)},$$slots:{default:!0}});var d=S(c,2);Ln(d,{label:"Tenant ID",children:(k,C)=>{var I=L_();fn(I,()=>v(s).tenantId,R=>Kt(s,v(s).tenantId=R)),E(k,I)},$$slots:{default:!0}});var h=S(d,2);Ln(h,{label:"User ID",children:(k,C)=>{var I=D_();fn(I,()=>v(s).userId,R=>Kt(s,v(s).userId=R)),E(k,I)},$$slots:{default:!0}});var f=S(h,2);Ln(f,{label:"Tool Context (JSON)",hint:"Merged with tenant/user and injected as runtime tool_context.",full:!0,children:(k,C)=>{var I=$_();ft(I,"placeholder",'{"any_runtime_key": "value"}'),fn(I,()=>v(s).toolContextRaw,R=>Kt(s,v(s).toolContextRaw=R)),E(k,I)},$$slots:{default:!0}});var p=S(f,2);Ln(p,{label:"LLM Context (JSON)",hint:"Only used when the playground wraps a planner entry point.",full:!0,children:(k,C)=>{var I=U_();ft(I,"placeholder","{}"),fn(I,()=>v(s).llmContextRaw,R=>Kt(s,v(s).llmContextRaw=R)),E(k,I)},$$slots:{default:!0}});var m=S(p,2);Ln(m,{label:"Streaming Protocol",hint:"Enable AG-UI streaming for the playground.",full:!0,children:(k,C)=>{var I=z_(),R=y(I);bf(R,()=>v(s).useAgui,D=>Kt(s,v(s).useAgui=D)),E(k,I)},$$slots:{default:!0}});var g=S(u,2);{var b=k=>{{let C=Os(()=>[{id:"setup-err",message:v(s).error}]);Ic(k,{get errors(){return v(C)}})}};G(g,k=>{v(s).error&&k(b)})}var w=S(g,2);{var _=k=>{var C=G_(),I=S(y(C),2);T_(I,{});var R=S(I,2);R_(R,{}),E(k,C)};G(w,k=>{v(s).useAgui&&k(_)})}E(e,l),te()}bt(["click"]);var F_=A('<button><span class="name svelte-al447k"> </span> <span class="meta svelte-al447k"> </span></button>'),V_=A('<div class="error svelte-al447k"> </div>'),H_=A('<div class="empty svelte-al447k">Fix payload to preview.</div>'),q_=A('<header class="svelte-al447k"><div><h2 class="svelte-al447k"> </h2> <p class="svelte-al447k"> </p></div> <div class="actions svelte-al447k"><button class="svelte-al447k">Use Example</button> <button class="svelte-al447k">Use Last Artifact</button> <button class="svelte-al447k">Reset</button></div></header> <div class="detail-grid svelte-al447k"><div class="schema svelte-al447k"><h4>Props Schema</h4> <pre class="svelte-al447k"> </pre></div> <div class="example svelte-al447k"><h4>Example</h4> <pre class="svelte-al447k"> </pre></div></div> <div class="editor svelte-al447k"><h4>Payload</h4> <textarea class="svelte-al447k"></textarea> <!></div> <div class="preview svelte-al447k"><h4>Preview</h4> <!></div>',1),Z_=A('<div class="empty svelte-al447k">No registry loaded.</div>'),X_=A('<div class="component-lab svelte-al447k"><aside class="component-list svelte-al447k"><h3>Components</h3> <div class="component-scroll svelte-al447k"></div></aside> <section class="component-detail svelte-al447k"><!></section></div>');function K_(e,t){ee(t,!0);const n=ri(),r=ni(),s=me(()=>Object.values(n.components||{})),a=me(()=>[...v(s)].sort((R,D)=>`${R.category}-${R.name}`.localeCompare(`${D.category}-${D.name}`)));let i=Z(null),o=Z("");qn(()=>{if(!v(i)&&v(a).length){const[R]=v(a);R&&x(i,R.name,!0)}}),qn(()=>{if(v(i)&&!v(o)){const D=n.getComponent(v(i))?.example?.props??{};x(o,JSON.stringify({component:v(i),props:D},null,2),!0)}});const l=me(()=>v(i)?n.getComponent(v(i)):void 0),u=me(()=>{try{const R=JSON.parse(v(o));return!R||typeof R!="object"?{preview:null,error:"Payload must be a JSON object."}:!R.component||!R.props?{preview:null,error:"Payload must include component and props keys."}:{preview:R,error:null}}catch(R){return{preview:null,error:R instanceof Error?R.message:"Invalid JSON."}}}),c=me(()=>v(u).preview),d=me(()=>v(u).error);function h(){v(l)&&x(o,JSON.stringify({component:v(l).name,props:v(l).example?.props??{}},null,2),!0)}function f(){const R=r.lastArtifact;R&&x(o,JSON.stringify({component:R.component,props:R.props},null,2),!0)}function p(){x(o,"")}function m(R){x(i,R,!0),x(o,"")}var g=X_(),b=y(g),w=S(y(b),2);De(w,21,()=>v(a),Ja,(R,D)=>{var O=F_();O.__click=()=>m(v(D).name);var N=y(O),j=y(N),H=S(N,2),q=y(H);U(()=>{Ne(O,1,`component-item ${v(i)===v(D).name?"active":""}`,"svelte-al447k"),L(j,v(D).name),L(q,`${v(D).category??""}${v(D).interactive?" â¢ interactive":""}`)}),E(R,O)});var _=S(b,2),k=y(_);{var C=R=>{var D=q_(),O=W(D),N=y(O),j=y(N),H=y(j),q=S(j,2),le=y(q),ve=S(N,2),pe=y(ve);pe.__click=h;var $e=S(pe,2);$e.__click=f;var be=S($e,2);be.__click=p;var wt=S(O,2),un=y(wt),Gs=S(y(un),2),Dc=y(Gs),$c=S(un,2),Uc=S(y($c),2),zc=y(Uc),ki=S(wt,2),xi=S(y(ki),2),Gc=S(xi,2);{var jc=Je=>{var On=V_(),qc=y(On);U(()=>L(qc,v(d))),E(Je,On)};G(Gc,Je=>{v(d)&&Je(jc)})}var Bc=S(ki,2),Fc=S(y(Bc),2);{var Vc=Je=>{Ua(Je,{get component(){return v(c).component},get props(){return v(c).props}})},Hc=Je=>{var On=H_();E(Je,On)};G(Fc,Je=>{v(c)?Je(Vc):Je(Hc,!1)})}U((Je,On)=>{L(H,v(l).name),L(le,v(l).description),$e.disabled=!r.lastArtifact,L(Dc,Je),L(zc,On)},[()=>JSON.stringify(v(l).propsSchema,null,2),()=>JSON.stringify(v(l).example?.props??{},null,2)]),fn(xi,()=>v(o),Je=>x(o,Je)),E(R,D)},I=R=>{var D=Z_();E(R,D)};G(k,R=>{v(l)?R(C):R(I,!1)})}E(e,g),te()}bt(["click"]);var J_=A("<!> <!>",1),Y_=A("<!> <!> <!>",1);function Rc(e,t){ee(t,!0);let n=Le(t,"chatBodyEl",15,null),r=Z("chat");const s=ri(),a=me(()=>{const l=[{id:"chat",label:"Chat"},{id:"setup",label:"Setup"}];return s.enabled&&l.push({id:"components",label:"Components"}),l});var o={switchToSetup:()=>{x(r,"setup")}};return Rn(e,{class:"chat-card",children:(l,u)=>{var c=Y_(),d=W(c);zm(d,{});var h=S(d,2);Sm(h,{get tabs(){return v(a)},get active(){return v(r)},onchange:g=>{x(r,g,!0)}});var f=S(h,2);{var p=g=>{B_(g,{})},m=g=>{var b=Oe(),w=W(b);{var _=C=>{K_(C,{})},k=C=>{var I=J_(),R=W(I);f_(R,{get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(O){n(O)}});var D=S(R,2);v_(D,{get onsubmit(){return t.onSendChat}}),E(C,I)};G(w,C=>{v(r)==="components"?C(_):C(k,!1)},!0)}E(g,b)};G(f,g=>{v(r)==="setup"?g(p):g(m,!1)})}E(l,c)},$$slots:{default:!0}}),te(o)}var W_=A('<details class="svelte-1pjwbaq"><summary class="svelte-1pjwbaq">Details</summary> <!> <!></details>');function Q_(e,t){var n=W_(),r=S(y(n),2);{var s=o=>{rl(o,{label:"args",get content(){return t.args}})};G(r,o=>{t.args&&o(s)})}var a=S(r,2);{var i=o=>{rl(o,{label:"result",get content(){return t.result}})};G(a,o=>{t.result&&o(i)})}E(e,n)}var ey=A('<div class="thought svelte-kirucq"> </div>'),ty=A('<div class="timeline-item svelte-kirucq"><div class="line svelte-kirucq"></div> <div></div> <div class="timeline-body svelte-kirucq"><div class="row space-between align-center svelte-kirucq"><div class="step-name svelte-kirucq"> </div> <!></div> <!> <!></div></div>');function ny(e,t){ee(t,!0);var n=ty(),r=S(y(n),2),s=S(r,2),a=y(s),i=y(a),o=y(i),l=S(i,2);{var u=f=>{at(f,{variant:"subtle",size:"small",children:(p,m)=>{var g=Ve();U(()=>L(g,`${t.step.latencyMs??""} ms`)),E(p,g)},$$slots:{default:!0}})};G(l,f=>{t.step.latencyMs&&f(u)})}var c=S(a,2);{var d=f=>{var p=ey(),m=y(p);U(()=>L(m,`"${t.step.thought??""}"`)),E(f,p)};G(c,f=>{t.step.thought&&f(d)})}var h=S(c,2);Q_(h,{get args(){return t.step.args},get result(){return t.step.result}}),U(()=>{Ne(r,1,`dot ${t.step.status??""}`,"svelte-kirucq"),L(o,t.step.name)}),E(e,n),te()}var ry=A('<div class="timeline svelte-a305uj"></div>');function sy(e,t){var n=ry();De(n,21,()=>t.steps,r=>r.id,(r,s)=>{ny(r,{get step(){return v(s)}})}),E(e,n)}var ay=A('<div class="trajectory-header svelte-a3gaf7"><div class="title-small svelte-a3gaf7">Execution Trajectory</div> <!></div> <!>',1);function Oc(e,t){ee(t,!1);const n=Ir(),r=ti();ot(),Rn(e,{class:"trajectory-card",children:(s,a)=>{var i=ay(),o=W(i),l=S(y(o),2);{var u=f=>{at(f,{variant:"subtle",size:"small",children:(p,m)=>{var g=Ve();U(b=>L(g,`trace ${b??""}`),[()=>n.activeTraceId.slice(0,8)]),E(p,g)},$$slots:{default:!0}})};G(l,f=>{n.activeTraceId&&f(u)})}var c=S(o,2);{var d=f=>{Si(f,{inline:!0,title:"No trajectory yet",subtitle:"Send a prompt to see steps."})},h=f=>{var p=Oe(),m=W(p);of(m,()=>n.activeTraceId,g=>{sy(g,{get steps(){return r.steps}})}),E(f,p)};G(c,f=>{r.isEmpty?f(d):f(h,!1)})}E(s,i)},$$slots:{default:!0}}),te()}var iy=A("<!> <!>",1);function oy(e,t){ee(t,!0);let n=Le(t,"chatBodyEl",15,null),r;var a={switchToSetup:()=>{r?.switchToSetup()}};return wi(e,{position:"center",children:(i,o)=>{var l=iy(),u=W(l);yr(Rc(u,{get onSendChat(){return t.onSendChat},get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(d){n(d)}}),d=>r=d,()=>r);var c=S(u,2);Oc(c,{}),E(i,l)},$$slots:{default:!0}}),te(a)}var ly=A('<div class="events-header svelte-1d58ppa"><div class="title-small svelte-1d58ppa">Planner Events</div> <div class="icon-row svelte-1d58ppa"><!> <select class="filter svelte-1d58ppa"><option>All</option><option>step</option><option>event</option><option>chunk</option><option>artifact_chunk</option></select></div></div>');function uy(e,t){ee(t,!1);const n=Ft(ei());ot();var r=ly(),s=S(y(r),2),a=y(s);Mm(a,{onclick:()=>{Kt(n,v(n).paused=!v(n).paused)},children:(h,f)=>{var p=Ve();U(()=>L(p,v(n).paused?">":"||")),E(h,p)}});var i=S(a,2);i.__change=h=>{const f=h.currentTarget.value;v(n).setFilter(f||null)};var o=y(i);o.value=o.__value="";var l=S(o);l.value=l.__value="step";var u=S(l);u.value=u.__value="event";var c=S(u);c.value=c.__value="chunk";var d=S(c);d.value=d.__value="artifact_chunk",E(e,r),te()}bt(["change"]);var cy=A('<div class="event-desc svelte-1tjxgju"> </div>'),dy=A('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Args:</span> </div>'),fy=A('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Result:</span> </div>'),hy=A('<div><div class="event-icon svelte-1tjxgju"> </div> <div class="event-main svelte-1tjxgju"><div class="event-header svelte-1tjxgju"><span class="event-name svelte-1tjxgju"> </span> <!></div> <!> <!> <!></div> <!></div>');function vy(e,t){ee(t,!0);let n=Le(t,"alt",3,!1);const r={step:{icon:"â¶",variant:"ghost"},tool_call:{icon:"ð§",variant:"subtle"},artifact:{icon:"ð",variant:"subtle"},other:{icon:"â¢",variant:"ghost"}};let s=me(()=>r[t.event.type]??r.other);function a(O){return O?O<1e3?`${O.toFixed(0)}ms`:`${(O/1e3).toFixed(2)}s`:""}var i=hy();let o;var l=y(i),u=y(l),c=S(l,2),d=y(c),h=y(d),f=y(h),p=S(h,2);{var m=O=>{at(O,{variant:"subtle",size:"small",children:(N,j)=>{var H=Ve("tool");E(N,H)},$$slots:{default:!0}})},g=O=>{var N=Oe(),j=W(N);{var H=q=>{at(q,{variant:"subtle",size:"small",children:(le,ve)=>{var pe=Ve("artifact");E(le,pe)},$$slots:{default:!0}})};G(j,q=>{t.event.type==="artifact"&&q(H)},!0)}E(O,N)};G(p,O=>{t.event.type==="tool_call"?O(m):O(g,!1)})}var b=S(d,2);{var w=O=>{var N=cy(),j=y(N);U(()=>L(j,t.event.description)),E(O,N)};G(b,O=>{t.event.description&&O(w)})}var _=S(b,2);{var k=O=>{var N=dy(),j=S(y(N));U(()=>L(j,` ${t.event.args??""}`)),E(O,N)};G(_,O=>{t.event.type==="tool_call"&&t.event.args&&O(k)})}var C=S(_,2);{var I=O=>{var N=fy(),j=S(y(N));U(()=>L(j,` ${t.event.result??""}`)),E(O,N)};G(C,O=>{t.event.type==="tool_call"&&t.event.result&&O(I)})}var R=S(c,2);{var D=O=>{at(O,{variant:"subtle",size:"small",children:(N,j)=>{var H=Ve();U(q=>L(H,q),[()=>a(t.event.duration_ms)]),E(N,H)},$$slots:{default:!0}})};G(R,O=>{t.event.duration_ms&&O(D)})}U(()=>{o=Ne(i,1,"event-row svelte-1tjxgju",null,o,{alt:n()}),L(u,v(s).icon),L(f,t.event.name)}),E(e,i),te()}var py=A('<div class="events-body svelte-f0vs81"><!></div>');function gy(e,t){ee(t,!0);const n=ei();let r=me(()=>n.displayEvents);var s=py(),a=y(s);{var i=l=>{Si(l,{inline:!0,title:"No events yet",subtitle:"Events will appear during runs."})},o=l=>{var u=Oe(),c=W(u);De(c,19,()=>v(r),d=>d.id,(d,h,f)=>{{let p=me(()=>v(f)%2===0);vy(d,{get event(){return v(h)},get alt(){return v(p)}})}}),E(l,u)};G(a,l=>{v(r).length===0?l(i):l(o,!1)})}E(e,s),te()}var my=A('<div class="artifact-row svelte-ko4yy5"><!> <pre class="svelte-ko4yy5"> </pre></div>'),_y=A('<div class="section svelte-ko4yy5"><div class="title-small svelte-ko4yy5">Artifact Streams</div> <!></div>');function yy(e,t){ee(t,!1);const n=ti();ot();var r=Oe(),s=W(r);{var a=i=>{var o=_y(),l=S(y(o),2);De(l,1,()=>Object.entries(n.artifactStreams),([u,c])=>u,(u,c)=>{var d=me(()=>Wc(v(c),2));let h=()=>v(d)[0],f=()=>v(d)[1];var p=my(),m=y(p);at(m,{variant:"ghost",size:"small",children:(w,_)=>{var k=Ve();U(()=>L(k,h())),E(w,k)},$$slots:{default:!0}});var g=S(m,2),b=y(g);U(w=>L(b,w),[()=>JSON.stringify(f()[f().length-1],null,2)]),E(u,p)}),E(i,o)};G(s,i=>{n.hasArtifacts&&i(a)})}E(e,r),te()}var by=A("<!> <!> <!>",1);function Pc(e){Rn(e,{class:"events-card",children:(t,n)=>{var r=by(),s=W(r);uy(s,{});var a=S(s,2);gy(a,{});var i=S(a,2);yy(i,{}),E(t,r)},$$slots:{default:!0}})}var wy=A('<span class="spinner svelte-tbolst"></span>'),Sy=ef('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12L3 7L4.4 5.55L7 8.15V1H9V8.15L11.6 5.55L13 7L8 12Z" fill="currentColor"></path><path d="M2 14V11H4V13H12V11H14V14C14 14.55 13.55 15 13 15H3C2.45 15 2 14.55 2 14Z" fill="currentColor"></path></svg>'),Ey=A('<span class="artifact-error svelte-tbolst" role="alert"> </span>'),ky=A('<div class="artifact-item svelte-tbolst"><div class="artifact-info svelte-tbolst"><span class="artifact-icon svelte-tbolst"></span> <div class="artifact-details svelte-tbolst"><span class="artifact-name svelte-tbolst"> </span> <span class="artifact-meta svelte-tbolst"> <!></span></div></div> <button type="button" class="download-btn svelte-tbolst"><!></button> <!></div>');function xy(e,t){ee(t,!0);const n=Ir();let r=Z(!1),s=Z(null);async function a(){x(r,!0),x(s,null);try{await Eu(t.artifact.id,n.sessionId,t.artifact.filename??void 0)}catch(I){x(s,I instanceof Error?I.message:"Download failed",!0)}finally{x(r,!1)}}var i=ky(),o=y(i),l=y(o),u=S(l,2),c=y(u),d=y(c),h=S(c,2),f=y(h),p=S(f);{var m=I=>{at(I,{size:"small",variant:"subtle",children:(R,D)=>{var O=Ve();U(N=>L(O,N),[()=>Pf(t.artifact.mime_type)]),E(R,O)},$$slots:{default:!0}})};G(p,I=>{t.artifact.mime_type&&I(m)})}var g=S(o,2);g.__click=a;var b=y(g);{var w=I=>{var R=wy();E(I,R)},_=I=>{var R=Sy();E(I,R)};G(b,I=>{v(r)?I(w):I(_,!1)})}var k=S(g,2);{var C=I=>{var R=Ey(),D=y(R);U(()=>L(D,v(s))),E(I,R)};G(k,I=>{v(s)&&I(C)})}U((I,R)=>{ft(l,"data-type",I),ft(c,"title",t.artifact.filename||t.artifact.id),L(d,t.artifact.filename||t.artifact.id),L(f,`${R??""} `),ft(g,"title",v(r)?"Downloading...":"Download"),g.disabled=v(r),ft(g,"aria-label",v(r)?"Downloading":`Download ${t.artifact.filename||"artifact"}`)},[()=>Of(t.artifact.mime_type),()=>Rf(t.artifact.size_bytes)]),E(e,i),te()}bt(["click"]);var Ty=A('<span class="count-badge svelte-1cjy38f"> </span>'),Ay=A('<span class="spinner svelte-1cjy38f"></span> Downloading...',1),Iy=A('<button type="button" class="download-all-btn svelte-1cjy38f"><!></button>'),Cy=A('<p class="no-artifacts svelte-1cjy38f">No artifacts yet. Artifacts will appear here when tools generate downloadable files.</p>'),Ny=A('<div class="artifacts-list svelte-1cjy38f"></div>'),Ry=A('<div class="artifacts-header svelte-1cjy38f"><h3 class="artifacts-title svelte-1cjy38f">Artifacts <!></h3> <!></div> <div class="artifacts-body svelte-1cjy38f"><!></div>',1);function Mc(e,t){ee(t,!0);let n=Z(!1);const r=nh(),s=Ir();async function a(){x(n,!0);for(const i of r.list)try{await Eu(i.id,s.sessionId,i.filename??void 0),await new Promise(o=>setTimeout(o,300))}catch{}x(n,!1)}Rn(e,{class:"artifacts-card",children:(i,o)=>{var l=Ry(),u=W(l),c=y(u),d=S(y(c));{var h=_=>{var k=Ty(),C=y(k);U(()=>L(C,r.count)),E(_,k)};G(d,_=>{r.count>0&&_(h)})}var f=S(c,2);{var p=_=>{var k=Iy();k.__click=a;var C=y(k);{var I=D=>{var O=Ay();E(D,O)},R=D=>{var O=Ve("Download All");E(D,O)};G(C,D=>{v(n)?D(I):D(R,!1)})}U(()=>{k.disabled=v(n),ft(k,"aria-label",v(n)?"Downloading all artifacts":"Download all artifacts")}),E(_,k)};G(f,_=>{r.count>1&&_(p)})}var m=S(u,2),g=y(m);{var b=_=>{var k=Cy();E(_,k)},w=_=>{var k=Ny();De(k,21,()=>r.list,C=>C.id,(C,I)=>{xy(C,{get artifact(){return v(I)}})}),E(_,k)};G(g,_=>{r.count===0?_(b):_(w,!1)})}E(i,l)},$$slots:{default:!0}}),te()}bt(["click"]);var Oy=A("<!> <!>",1);function Py(e){wi(e,{position:"right",children:(t,n)=>{var r=Oy(),s=W(r);Pc(s);var a=S(s,2);Mc(a,{}),E(t,r)},$$slots:{default:!0}})}var My=A('<div class="tile svelte-9qt9q6"><div class="tile-label svelte-9qt9q6"> </div> <div class="tile-value svelte-9qt9q6"> </div></div>'),Ly=A('<div class="section svelte-9qt9q6"><div class="section-label svelte-9qt9q6">Planner Config</div> <div class="tile-grid svelte-9qt9q6"></div></div>');function Dy(e,t){ee(t,!1);const n=nr();ot();var r=Ly(),s=S(y(r),2);De(s,5,()=>n.plannerConfig,a=>a.label,(a,i)=>{var o=My(),l=y(o),u=y(l),c=S(l,2),d=y(c);U(()=>{L(u,v(i).label),L(d,v(i).value)}),E(a,o)}),E(e,r),te()}var $y=A('<div class="service-row svelte-k5f3xe"><div><div class="service-name svelte-k5f3xe"> </div> <div class="muted tiny svelte-k5f3xe"> </div></div> <!></div>');function Uy(e,t){ee(t,!0);var n=$y(),r=y(n),s=y(r),a=y(s),i=S(s,2),o=y(i),l=S(r,2);{let u=me(()=>t.service.status==="enabled"?"subtle":"ghost");at(l,{get variant(){return v(u)},size:"small",children:(c,d)=>{var h=Ve();U(()=>L(h,t.service.status)),E(c,h)},$$slots:{default:!0}})}U(()=>{L(a,t.service.name),L(o,t.service.url||"not configured")}),E(e,n),te()}var zy=A('<div class="section svelte-1eltd2"><div class="section-label svelte-1eltd2">Services</div> <!></div>');function Gy(e,t){ee(t,!1);const n=nr();ot();var r=zy(),s=S(y(r),2);De(s,1,()=>n.services,a=>a.name,(a,i)=>{Uy(a,{get service(){return v(i)}})}),E(e,r),te()}var jy=A('<div class="tool-row svelte-8lkzhn"><div><div class="tool-name svelte-8lkzhn"> </div> <div class="muted tiny svelte-8lkzhn"> </div></div> <div class="tag-row svelte-8lkzhn"></div></div>');function By(e,t){ee(t,!0);var n=jy(),r=y(n),s=y(r),a=y(s),i=S(s,2),o=y(i),l=S(r,2);De(l,23,()=>t.tool.tags,(u,c)=>`${t.tool.name}-${c}`,(u,c)=>{at(u,{variant:"ghost",size:"small",children:(d,h)=>{var f=Ve();U(()=>L(f,v(c))),E(d,f)},$$slots:{default:!0}})}),U(()=>{L(a,t.tool.name),L(o,t.tool.desc)}),E(e,n),te()}var Fy=A('<div class="section svelte-njx06l"><div class="section-label svelte-njx06l">Tool Catalog</div> <!></div>');function Vy(e,t){ee(t,!1);const n=nr();ot();var r=Fy(),s=S(y(r),2);De(s,1,()=>n.catalog,a=>a.name,(a,i)=>{By(a,{get tool(){return v(i)}})}),E(e,r),te()}var Hy=A('<div class="title-small svelte-kxiy41">Config & Catalog</div> <!> <!> <!>',1);function ol(e){Rn(e,{class:"config-card",children:(t,n)=>{var r=Hy(),s=S(W(r),2);Dy(s,{});var a=S(s,2);Gy(a,{});var i=S(a,2);Vy(i,{}),E(t,r)},$$slots:{default:!0}})}var qy=A('<button type="button"> </button>'),Zy=A('<div class="drawer svelte-1g84vkc"><div class="drawer-tabs svelte-1g84vkc"></div> <div class="drawer-content svelte-1g84vkc"><!></div></div>'),Xy=A('<button type="button" class="backdrop svelte-1g84vkc" aria-label="Close menu"></button>'),Ky=A('<header class="mobile-header svelte-1g84vkc"><div class="header-bar svelte-1g84vkc"><button type="button" class="menu-btn svelte-1g84vkc" aria-label="Toggle menu"><span><span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span></span></button> <h1 class="agent-name svelte-1g84vkc"> </h1> <div class="header-spacer svelte-1g84vkc"></div></div> <!></header> <!>',1);function Jy(e,t){ee(t,!0);const n=nr();let r=Z(!1),s=Z("info");const a=[{id:"info",label:"Info"},{id:"spec",label:"Spec"},{id:"config",label:"Config"}],i=()=>{x(r,!1)};var o=Ky(),l=W(o),u=y(l),c=y(u);c.__click=()=>x(r,!v(r));var d=y(c);let h;var f=S(c,2),p=y(f),m=S(u,2);{var g=_=>{var k=Zy(),C=y(k);De(C,21,()=>a,N=>N.id,(N,j)=>{var H=qy();let q;H.__click=()=>x(s,v(j).id,!0);var le=y(H);U(()=>{q=Ne(H,1,"drawer-tab svelte-1g84vkc",null,q,{active:v(s)===v(j).id}),L(le,v(j).label)}),E(N,H)});var I=S(C,2),R=y(I);{var D=N=>{var j=Oe(),H=W(j);et(H,()=>t.infoContent??Pe),E(N,j)},O=N=>{var j=Oe(),H=W(j);{var q=ve=>{var pe=Oe(),$e=W(pe);et($e,()=>t.specContent??Pe),E(ve,pe)},le=ve=>{var pe=Oe(),$e=W(pe);et($e,()=>t.configContent??Pe),E(ve,pe)};G(H,ve=>{v(s)==="spec"?ve(q):ve(le,!1)},!0)}E(N,j)};G(R,N=>{v(s)==="info"?N(D):N(O,!1)})}E(_,k)};G(m,_=>{v(r)&&_(g)})}var b=S(l,2);{var w=_=>{var k=Xy();k.__click=i,E(_,k)};G(b,_=>{v(r)&&_(w)})}U(()=>{h=Ne(d,1,"hamburger svelte-1g84vkc",null,h,{open:v(r)}),L(p,n.meta.name)}),E(e,o),te()}bt(["click"]);var Yy=A('<button type="button"> </button>'),Wy=A('<div class="panel-tabs svelte-1wcjmjk"></div> <div class="panel-content svelte-1wcjmjk"><!></div>',1),Qy=A('<div><button type="button" class="toggle-bar svelte-1wcjmjk"><div class="toggle-handle svelte-1wcjmjk"></div> <span class="toggle-label svelte-1wcjmjk"> </span></button> <!></div>');function eb(e,t){let n=Z(!1),r=Z("trajectory");const s=[{id:"trajectory",label:"Steps"},{id:"events",label:"Events"},{id:"artifacts",label:"Artifacts"}];var a=Qy();let i;var o=y(a);o.__click=()=>x(n,!v(n));var l=S(y(o),2),u=y(l),c=S(o,2);{var d=h=>{var f=Wy(),p=W(f);De(p,21,()=>s,_=>_.id,(_,k)=>{var C=Yy();let I;C.__click=()=>x(r,v(k).id,!0);var R=y(C);U(()=>{I=Ne(C,1,"panel-tab svelte-1wcjmjk",null,I,{active:v(r)===v(k).id}),L(R,v(k).label)}),E(_,C)});var m=S(p,2),g=y(m);{var b=_=>{var k=Oe(),C=W(k);et(C,()=>t.trajectoryContent??Pe),E(_,k)},w=_=>{var k=Oe(),C=W(k);{var I=D=>{var O=Oe(),N=W(O);et(N,()=>t.eventsContent??Pe),E(D,O)},R=D=>{var O=Oe(),N=W(O);et(N,()=>t.artifactsContent??Pe),E(D,O)};G(C,D=>{v(r)==="events"?D(I):D(R,!1)},!0)}E(_,k)};G(g,_=>{v(r)==="trajectory"?_(b):_(w,!1)})}E(h,f)};G(c,h=>{v(n)&&h(d)})}U(()=>{i=Ne(a,1,"bottom-panel svelte-1wcjmjk",null,i,{open:v(n)}),ft(o,"aria-label",v(n)?"Hide details panel":"Show details panel"),ft(o,"aria-expanded",v(n)),L(u,v(n)?"Hide Details":"Show Details")}),E(e,a)}bt(["click"]);var tb=A('<div class="mobile-layout svelte-1n46o8q"><!> <main class="mobile-main svelte-1n46o8q"><!></main> <!></div>'),nb=A("<!> <!> <!>",1),rb=A("<!> <!> <!>",1);function sb(e,t){ee(t,!0);const n=Ah(),{sessionStore:r,chatStore:s,trajectoryStore:a,agentStore:i,specStore:o,setupStore:l,componentRegistryStore:u,interactionsStore:c}=n,d=Tg(n),h=Ng(n);let f=Z(null),p=Z(void 0),m=Z(void 0),g=Z(!1);const b=()=>{x(g,window.innerWidth<=1200)};qn(()=>{s.messages.length;const O=s.messages.find(N=>N.isStreaming);O&&`${O.text}${O.observations??""}`,v(f)&&requestAnimationFrame(()=>{v(f)&&(v(f).scrollTop=v(f).scrollHeight)})}),ou(()=>(b(),window.addEventListener("resize",b),w(),()=>{window.removeEventListener("resize",b),d.close(),h.close()}));const w=async()=>{const[O,N,j]=await Promise.all([Ch(),Rh(),Nh()]);O&&i.setFromResponse(O),N&&o.setFromSpecData(N),j&&u.setFromPayload(j)},_=()=>{const O=s.input.trim();if(!O||r.isSending)return;l.clearError();const N=l.parseContexts();if(!N){v(g)?v(m)?.switchToSetup():v(p)?.switchToSetup();return}const{toolContext:j,llmContext:H}=N;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),s.addUserMessage(O),s.clearInput(),d.start(O,r.sessionId,j,H,{onDone:async q=>{if(r.activeTraceId=q,q){const le=await Hi(q,r.sessionId);le&&r.activeTraceId===q&&a.setFromPayload(le),h.start(q,r.sessionId)}r.isSending=!1},onError:()=>{r.isSending=!1}},l.useAgui?"agui":"sse")},k=(O,N)=>{if(!l.useAgui){l.error="Interactive components require AG-UI streaming.";return}if(!O.resume_token){l.error="Cannot submit: session expired or interrupted. Please resend your message.",c.clearPendingInteraction();return}const j=l.parseContexts();if(!j){v(g)?v(m)?.switchToSetup():v(p)?.switchToSetup();return}const{toolContext:H}=j;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),d.resumeAgui(O,N,r.sessionId,H,{onDone:async q=>{if(r.activeTraceId=q,q){const le=await Hi(q,r.sessionId);le&&r.activeTraceId===q&&a.setFromPayload(le),h.start(q,r.sessionId)}r.isSending=!1},onError:q=>{l.error=q||"Failed to submit response. Please try again.",r.isSending=!1}})};var C=Oe(),I=W(C);{var R=O=>{var N=tb(),j=y(N);Jy(j,{infoContent:be=>{sl(be,{})},specContent:be=>{al(be,{})},configContent:be=>{ol(be)},$$slots:{infoContent:!0,specContent:!0,configContent:!0}});var H=S(j,2),q=y(H);yr(Rc(q,{onSendChat:_,onInteractionResult:k,get chatBodyEl(){return v(f)},set chatBodyEl(ve){x(f,ve,!0)}}),ve=>x(m,ve,!0),()=>v(m));var le=S(H,2);eb(le,{trajectoryContent:be=>{Oc(be,{})},eventsContent:be=>{Pc(be)},artifactsContent:be=>{Mc(be,{})}}),E(O,N)},D=O=>{mm(O,{children:(N,j)=>{var H=rb(),q=W(H);_m(q,{children:(pe,$e)=>{var be=nb(),wt=W(be);sl(wt,{});var un=S(wt,2);al(un,{});var Gs=S(un,2);ol(Gs),E(pe,be)}});var le=S(q,2);yr(oy(le,{onSendChat:_,onInteractionResult:k,get chatBodyEl(){return v(f)},set chatBodyEl(pe){x(f,pe,!0)}}),pe=>x(p,pe,!0),()=>v(p));var ve=S(le,2);Py(ve),E(N,H)}})};G(I,O=>{v(g)?O(R):O(D,!1)})}E(e,C),te()}vm();const Lc=document.getElementById("app");if(!Lc)throw new Error("Missing #app element");tf(sb,{target:Lc});export{W as A,nu as B,ob as C,Oe as D,Kf as E,ft as F,Ua as G,ou as H,ue as I,qa as J,ce as K,Bd as L,Dr as M,ll as N,ib as O,Ld as P,Tr as Q,Wd as R,bf as S,ub as T,yr as U,cb as V,Ae as _,Le as a,Ce as b,me as c,x as d,y as e,A as f,v as g,S as h,G as i,De as j,gf as k,Ne as l,L as m,E as n,Ja as o,ee as p,lb as q,te as r,Z as s,U as t,qn as u,ar as v,fn as w,bt as x,Wc as y,Ve as z};
