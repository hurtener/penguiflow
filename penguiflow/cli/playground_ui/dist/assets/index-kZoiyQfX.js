const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ECharts-BBkaRltJ.js","assets/ECharts-SUlEdAZf.css","assets/Mermaid-BymvIKEV.js","assets/_commonjsHelpers-CqkleIqs.js","assets/purify.es-HRjpPm7y.js","assets/Mermaid-D_q-5SJ2.css","assets/Plotly-CCx5sBoC.js","assets/Plotly-BnH91lxL.css","assets/DataGrid-bnp_ueOV.js","assets/DataGrid-CnGdOVL9.css","assets/Json-mUv6RMZ5.js","assets/Json-BfbC447w.css","assets/Metric-LyxAXz1J.js","assets/Metric-BR7LGQoy.css","assets/Markdown-BGfrotu-.js","assets/katex-XbL3y5x-.js","assets/Markdown-CElcD4b8.css","assets/katex-DvXFAOB1.css","assets/Code-CthstjSM.js","assets/Code-CS6X8G3Y.css","assets/Latex-C_l7ODKx.js","assets/Latex-De3SCfkv.css","assets/Callout-IE8nu5-9.js","assets/Callout-B-wLDEhr.css","assets/Form-74YU3wNj.js","assets/Form-eWoJO6O2.css","assets/Confirm-B63UY2g_.js","assets/Confirm-YhSN8Zxn.css","assets/SelectOption-B_0uPwtb.js","assets/SelectOption-CEnDdoyK.css","assets/Report-YbELa83v.js","assets/Report-DYNw1-yU.css","assets/Grid-DA-D4GmC.js","assets/Grid-Cg7MxYKJ.css","assets/Tabs-QpVhpYQi.js","assets/Tabs-BoGLw0iN.css","assets/Accordion-Dl6wN9Vi.js","assets/Accordion-2qjp3LnE.css","assets/Image-BkSVb7GW.js","assets/Image-CbfbhndX.css","assets/Html-B31GZ0RD.js","assets/Html-CBo-9Zlq.css","assets/Video-q97f_mwO.js","assets/Video-CRk6YMQD.css","assets/Embed-Ca9ERMMu.js","assets/Embed-fxz_xzQf.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const oi=!1;var cu=Array.isArray,Hd=Array.prototype.indexOf,Fi=Array.from,du=Object.defineProperty,Qn=Object.getOwnPropertyDescriptor,fu=Object.getOwnPropertyDescriptors,Zd=Object.prototype,Xd=Array.prototype,Vi=Object.getPrototypeOf,Io=Object.isExtensible;function is(e){return typeof e=="function"}const et=()=>{};function Kd(e){return typeof e?.then=="function"}function Jd(e){return e()}function li(e){for(var t=0;t<e.length;t++)e[t]()}function vu(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}function Yd(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const Et=2,qi=4,Oa=8,Wd=1<<24,qn=16,Hn=32,Cr=64,Ma=128,gn=512,kt=1024,Vt=2048,Tn=4096,Jt=8192,$n=16384,Hi=32768,rr=65536,Co=1<<17,hu=1<<18,ts=1<<19,pu=1<<20,Sr=32768,ui=1<<21,Zi=1<<22,er=1<<23,Sn=Symbol("$state"),gu=Symbol("legacy props"),Qd=Symbol(""),jr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Xi(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ef(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function tf(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function nf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function rf(e){throw new Error("https://svelte.dev/e/effect_orphan")}function sf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function af(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function of(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function lf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function uf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function cf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const _u=1,mu=2,yu=4,df=8,ff=16,vf=1,hf=2,pf=4,gf=8,_f=16,mf=1,yf=2,St=Symbol(),bf="http://www.w3.org/1999/xhtml";function jS(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Sf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function bu(e){return e===this.v}function Su(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function ku(e){return!Su(e,this.v)}let ns=!1,kf=!1;function wf(){ns=!0}let De=null;function Hr(e){De=e}function Yt(e){return wu().get(e)}function qt(e,t){return wu().set(e,t),t}function fe(e,t=!1,n){De={p:De,i:!1,c:null,e:null,s:e,x:null,l:ns&&!t?{s:null,u:null,$:[]}:null}}function ve(e){var t=De,n=t.e;if(n!==null){t.e=null;for(var r of n)ju(r)}return e!==void 0&&(t.x=e),t.i=!0,De=t.p,e??{}}function Nr(){return!ns||De!==null&&De.l===null}function wu(e){return De===null&&Xi(),De.c??=new Map(Ef(De)||void 0)}function Ef(e){let t=e.p;for(;t!==null;){const n=t.c;if(n!==null)return n;t=t.p}return null}let gr=[];function Eu(){var e=gr;gr=[],li(e)}function jn(e){if(gr.length===0&&!Br){var t=gr;queueMicrotask(()=>{t===gr&&Eu()})}gr.push(e)}function xf(){for(;gr.length>0;)Eu()}function xu(e){var t=Ce;if(t===null)return be.f|=er,e;if((t.f&Hi)===0){if((t.f&Ma)===0)throw e;t.b.error(e)}else Zr(e,t)}function Zr(e,t){for(;t!==null;){if((t.f&Ma)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Rs=new Set;let Pe=null,zs=null,sn=null,nn=[],Pa=null,ci=!1,Br=!1;class pn{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){nn=[],zs=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#i(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(zs=this,Pe=null,No(n.render_effects),No(n.effects),zs=null,this.#l?.resolve()),sn=null}#i(t,n){t.f^=kt;for(var r=t.first;r!==null;){var s=r.f,a=(s&(Hn|Cr))!==0,i=a&&(s&kt)!==0,o=i||(s&Jt)!==0||this.skipped_effects.has(r);if((r.f&Ma)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){a?r.f^=kt:(s&qi)!==0?n.effects.push(r):rs(r)&&((r.f&qn)!==0&&n.block_effects.push(r),Xr(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&Vt)!==0?this.#a:this.#s).push(n),this.#u(n.deps),wt(n,kt)}#u(t){if(t!==null)for(const n of t)(n.f&Et)===0||(n.f&Sr)===0||(n.f^=Sr,this.#u(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&er)===0&&(this.current.set(t,t.v),sn?.set(t,t.v))}activate(){Pe=this,this.apply()}deactivate(){Pe===this&&(Pe=null,sn=null)}flush(){if(this.activate(),nn.length>0){if(Au(),Pe!==null&&Pe!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#c(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#d()}#d(){if(Rs.size>1){this.previous.clear();var t=sn,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of Rs){if(a===this){n=!1;continue}const i=[];for(const[l,u]of this.current){if(a.current.has(l))if(n&&u!==a.current.get(l))a.current.set(l,u);else continue;i.push(l)}if(i.length===0)continue;const o=[...a.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=nn;nn=[];const l=new Set,u=new Map;for(const d of i)Iu(d,o,l,u);if(nn.length>0){Pe=a,a.apply();for(const d of nn)a.#i(d,r);a.deactivate()}nn=s}}Pe=null,sn=t}this.committed=!0,Rs.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#a)wt(t,Vt),kr(t);for(const t of this.#s)wt(t,Tn),kr(t);this.#a=[],this.#s=[],this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=vu()).promise}static ensure(){if(Pe===null){const t=Pe=new pn;Rs.add(Pe),Br||pn.enqueue(()=>{Pe===t&&t.flush()})}return Pe}static enqueue(t){jn(t)}apply(){}}function Tu(e){var t=Br;Br=!0;try{for(var n;;){if(xf(),nn.length===0&&(Pe?.flush(),nn.length===0))return Pa=null,n;Au()}}finally{Br=t}}function Au(){var e=_r;ci=!0;var t=null;try{var n=0;for(da(!0);nn.length>0;){var r=pn.ensure();if(n++>1e3){var s,a;Tf()}r.process(nn),tr.clear()}}finally{ci=!1,da(e),Pa=null}}function Tf(){try{sf()}catch(e){Zr(e,Pa)}}let Mn=null;function No(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&($n|Jt))===0&&rs(r)&&(Mn=new Set,Xr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Hu(r):r.fn=null),Mn?.size>0)){tr.clear();for(const s of Mn){if((s.f&($n|Jt))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Mn.has(i)&&(Mn.delete(i),a.push(i)),i=i.parent;for(let o=a.length-1;o>=0;o--){const l=a[o];(l.f&($n|Jt))===0&&Xr(l)}}Mn.clear()}}Mn=null}}function Iu(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&Et)!==0?Iu(s,t,n,r):(a&(Zi|qn))!==0&&(a&Vt)===0&&Cu(s,t,r)&&(wt(s,Vt),kr(s))}}function Cu(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&Et)!==0&&Cu(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function kr(e){for(var t=Pa=e;t.parent!==null;){t=t.parent;var n=t.f;if(ci&&t===Ce&&(n&qn)!==0&&(n&hu)===0)return;if((n&(Cr|Hn))!==0){if((n&kt)===0)return;t.f^=kt}}nn.push(t)}function Af(e){let t=0,n=Gn(0),r;return()=>{ys()&&(c(n),lr(()=>(t===0&&(r=Ie(()=>e(()=>gs(n)))),t+=1,()=>{jn(()=>{t-=1,t===0&&(r?.(),r=void 0,gs(n))})})))}}var If=rr|ts|Ma;function Cf(e,t,n){new Nf(e,t,n)}class Nf{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#u=null;#c=null;#d=0;#f=0;#h=!1;#v=null;#y=Af(()=>(this.#v=Gn(this.#d),()=>{this.#v=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=Ce.b,this.#e=!!this.#n.pending,this.#a=Rr(()=>{Ce.b=this;{var s=this.#_();try{this.#s=rn(()=>r(s))}catch(a){this.error(a)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#c?.remove()}},If)}#b(){try{this.#s=rn(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#S(){const t=this.#n.pending;t&&(this.#i=rn(()=>t(this.#t)),pn.enqueue(()=>{var n=this.#_();this.#s=this.#p(()=>(pn.ensure(),rn(()=>this.#l(n)))),this.#f>0?this.#g():(Fr(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#c=Fn(),this.#t.before(this.#c),t=this.#c),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var n=Ce,r=be,s=De;wn(this.#a),Bt(this.#a),Hr(this.#a.ctx);try{return t()}catch(a){return xu(a),null}finally{wn(n),Bt(r),Hr(s)}}#g(){const t=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),Ku(this.#s,this.#u)),this.#i===null&&(this.#i=rn(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#i&&Fr(this.#i,()=>{this.#i=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(t){this.#m(t),this.#d+=t,this.#v&&Dn(this.#v,this.#d)}get_effect_pending(){return this.#y(),c(this.#v)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#h||!n&&!r)throw t;this.#s&&(Ft(this.#s),this.#s=null),this.#i&&(Ft(this.#i),this.#i=null),this.#o&&(Ft(this.#o),this.#o=null);var s=!1,a=!1;const i=()=>{if(s){Sf();return}s=!0,a&&cf(),pn.ensure(),this.#d=0,this.#o!==null&&Fr(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#h=!1,rn(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var o=be;try{Bt(null),a=!0,n?.(t,i),a=!1}catch(l){Zr(l,this.#a&&this.#a.parent)}finally{Bt(o)}r&&jn(()=>{this.#o=this.#p(()=>{pn.ensure(),this.#h=!0;try{return rn(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return Zr(l,this.#a.parent),null}finally{this.#h=!1}})})}}function Rf(e,t,n,r){const s=Nr()?Ts:La;if(n.length===0&&e.length===0){r(t.map(s));return}var a=Pe,i=Ce,o=Nu();function l(){Promise.all(n.map(u=>Of(u))).then(u=>{o();try{r([...t.map(s),...u])}catch(d){(i.f&$n)===0&&Zr(d,i)}a?.deactivate(),ms()}).catch(u=>{Zr(u,i)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{a?.deactivate(),ms()}}):l()}function Nu(){var e=Ce,t=be,n=De,r=Pe;return function(a=!0){wn(e),Bt(t),Hr(n),a&&r?.activate()}}function ms(){wn(null),Bt(null),Hr(null)}function Ts(e){var t=Et|Vt,n=be!==null&&(be.f&Et)!==0?be:null;return Ce!==null&&(Ce.f|=ts),{ctx:De,deps:null,effects:null,equals:bu,f:t,fn:e,reactions:null,rv:0,v:St,wv:0,parent:n??Ce,ac:null}}function Of(e,t){let n=Ce;n===null&&ef();var r=n.b,s=void 0,a=Gn(St),i=!be,o=new Map;return Ff(()=>{var l=vu();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{u===Pe&&u.committed&&u.deactivate(),ms()})}catch(h){l.reject(h),ms()}var u=Pe;if(i){var d=!r.is_pending();r.update_pending_count(1),u.increment(d),o.get(u)?.reject(jr),o.delete(u),o.set(u,l)}const f=(h,v=void 0)=>{if(u.activate(),v)v!==jr&&(a.f|=er,Dn(a,v));else{(a.f&er)!==0&&(a.f^=er),Dn(a,h);for(const[p,b]of o){if(o.delete(p),p===u)break;b.reject(jr)}}i&&(r.update_pending_count(-1),u.decrement(d))};l.promise.then(f,h=>f(null,h||"unknown"))}),Is(()=>{for(const l of o.values())l.reject(jr)}),new Promise(l=>{function u(d){function f(){d===s?l(a):u(s)}d.then(f,f)}u(s)})}function de(e){const t=Ts(e);return Ju(t),t}function La(e){const t=Ts(e);return t.equals=ku,t}function Ru(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Ft(t[n])}}function Mf(e){for(var t=e.parent;t!==null;){if((t.f&Et)===0)return(t.f&$n)===0?t:null;t=t.parent}return null}function Ki(e){var t,n=Ce;wn(Mf(e));try{e.f&=~Sr,Ru(e),t=ec(e)}finally{wn(n)}return t}function Ou(e){var t=Ki(e);if(e.equals(t)||(Pe?.is_fork||(e.v=t),e.wv=Wu()),!Or)if(sn!==null)(ys()||Pe?.is_fork)&&sn.set(e,t);else{var n=(e.f&gn)===0?Tn:kt;wt(e,n)}}let di=new Set;const tr=new Map;let Mu=!1;function Gn(e,t){var n={f:0,v:e,reactions:null,equals:bu,rv:0,wv:0};return n}function G(e,t){const n=Gn(e);return Ju(n),n}function Bn(e,t=!1,n=!0){const r=Gn(e);return t||(r.equals=ku),ns&&n&&De!==null&&De.l!==null&&(De.l.s??=[]).push(r),r}function Jn(e,t){return x(e,Ie(()=>c(e))),t}function x(e,t,n=!1){be!==null&&(!bn||(be.f&Co)!==0)&&Nr()&&(be.f&(Et|qn|Zi|Co))!==0&&!Un?.includes(e)&&uf();let r=n?Xe(t):t;return Dn(e,r)}function Dn(e,t){if(!e.equals(t)){var n=e.v;Or?tr.set(e,t):tr.set(e,n),e.v=t;var r=pn.ensure();r.capture(e,n),(e.f&Et)!==0&&((e.f&Vt)!==0&&Ki(e),wt(e,(e.f&gn)!==0?kt:Tn)),e.wv=Wu(),Pu(e,Vt),Nr()&&Ce!==null&&(Ce.f&kt)!==0&&(Ce.f&(Hn|Cr))===0&&(tn===null?qf([e]):tn.push(e)),!r.is_fork&&di.size>0&&!Mu&&Pf()}return t}function Pf(){Mu=!1;var e=_r;da(!0);const t=Array.from(di);try{for(const n of t)(n.f&kt)!==0&&wt(n,Tn),rs(n)&&Xr(n)}finally{da(e)}di.clear()}function gs(e){x(e,e.v+1)}function Pu(e,t){var n=e.reactions;if(n!==null)for(var r=Nr(),s=n.length,a=0;a<s;a++){var i=n[a],o=i.f;if(!(!r&&i===Ce)){var l=(o&Vt)===0;if(l&&wt(i,t),(o&Et)!==0){var u=i;sn?.delete(u),(o&Sr)===0&&(o&gn&&(i.f|=Sr),Pu(u,Tn))}else l&&((o&qn)!==0&&Mn!==null&&Mn.add(i),kr(i))}}}function Xe(e){if(typeof e!="object"||e===null||Sn in e)return e;const t=Vi(e);if(t!==Zd&&t!==Xd)return e;var n=new Map,r=cu(e),s=G(0),a=mr,i=o=>{if(mr===a)return o();var l=be,u=mr;Bt(null),Lo(a);var d=o();return Bt(l),Lo(u),d};return r&&n.set("length",G(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&of();var d=n.get(l);return d===void 0?d=i(()=>{var f=G(u.value);return n.set(l,f),f}):x(d,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const d=i(()=>G(St));n.set(l,d),gs(s)}}else x(u,St),gs(s);return!0},get(o,l,u){if(l===Sn)return e;var d=n.get(l),f=l in o;if(d===void 0&&(!f||Qn(o,l)?.writable)&&(d=i(()=>{var v=Xe(f?o[l]:St),p=G(v);return p}),n.set(l,d)),d!==void 0){var h=c(d);return h===St?void 0:h}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var d=n.get(l);d&&(u.value=c(d))}else if(u===void 0){var f=n.get(l),h=f?.v;if(f!==void 0&&h!==St)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(o,l){if(l===Sn)return!0;var u=n.get(l),d=u!==void 0&&u.v!==St||Reflect.has(o,l);if(u!==void 0||Ce!==null&&(!d||Qn(o,l)?.writable)){u===void 0&&(u=i(()=>{var h=d?Xe(o[l]):St,v=G(h);return v}),n.set(l,u));var f=c(u);if(f===St)return!1}return d},set(o,l,u,d){var f=n.get(l),h=l in o;if(r&&l==="length")for(var v=u;v<f.v;v+=1){var p=n.get(v+"");p!==void 0?x(p,St):v in o&&(p=i(()=>G(St)),n.set(v+"",p))}if(f===void 0)(!h||Qn(o,l)?.writable)&&(f=i(()=>G(void 0)),x(f,Xe(u)),n.set(l,f));else{h=f.v!==St;var b=i(()=>Xe(u));x(f,b)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m?.set&&m.set.call(d,u),!h){if(r&&typeof l=="string"){var S=n.get("length"),k=Number(l);Number.isInteger(k)&&k>=S.v&&x(S,k+1)}gs(s)}return!0},ownKeys(o){c(s);var l=Reflect.ownKeys(o).filter(f=>{var h=n.get(f);return h===void 0||h.v!==St});for(var[u,d]of n)d.v!==St&&!(u in o)&&l.push(u);return l},setPrototypeOf(){lf()}})}function Ro(e){try{if(e!==null&&typeof e=="object"&&Sn in e)return e[Sn]}catch{}return e}function Lf(e,t){return Object.is(Ro(e),Ro(t))}var Oo,Lu,$u,Du;function $f(){if(Oo===void 0){Oo=window,Lu=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;$u=Qn(t,"firstChild").get,Du=Qn(t,"nextSibling").get,Io(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Io(n)&&(n.__t=void 0)}}function Fn(e=""){return document.createTextNode(e)}function yn(e){return $u.call(e)}function As(e){return Du.call(e)}function g(e,t){return yn(e)}function re(e,t=!1){{var n=yn(e);return n instanceof Comment&&n.data===""?As(n):n}}function _(e,t=1,n=!1){let r=e;for(;t--;)r=As(r);return r}function Df(e){e.textContent=""}function Uu(){return!1}let Mo=!1;function Uf(){Mo||(Mo=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function $a(e){var t=be,n=Ce;Bt(null),wn(null);try{return e()}finally{Bt(t),wn(n)}}function Ji(e,t,n,r=n){e.addEventListener(t,()=>$a(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Uf()}function zu(e){Ce===null&&(be===null&&rf(),nf()),Or&&tf()}function zf(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function An(e,t,n){var r=Ce;r!==null&&(r.f&Jt)!==0&&(e|=Jt);var s={ctx:De,deps:null,nodes:null,f:e|Vt|gn,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Xr(s),s.f|=Hi}catch(o){throw Ft(s),o}else t!==null&&kr(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&ts)===0&&(a=a.first,(e&qn)!==0&&(e&rr)!==0&&a!==null&&(a.f|=rr)),a!==null&&(a.parent=r,r!==null&&zf(a,r),be!==null&&(be.f&Et)!==0&&(e&Cr)===0)){var i=be;(i.effects??=[]).push(a)}return s}function ys(){return be!==null&&!bn}function Is(e){const t=An(Oa,null,!1);return wt(t,kt),t.teardown=e,t}function sr(e){zu();var t=Ce.f,n=!be&&(t&Hn)!==0&&(t&Hi)===0;if(n){var r=De;(r.e??=[]).push(e)}else return ju(e)}function ju(e){return An(qi|pu,e,!1)}function jf(e){return zu(),An(Oa|pu,e,!0)}function Gf(e){pn.ensure();const t=An(Cr|ts,e,!0);return(n={})=>new Promise(r=>{n.outro?Fr(t,()=>{Ft(t),r(void 0)}):(Ft(t),r(void 0))})}function Bf(e){return An(qi,e,!1)}function Gu(e,t){var n=De,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=lr(()=>{e(),!r.ran&&(r.ran=!0,Ie(t))})}function Bu(){var e=De;lr(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&kt)!==0&&wt(n,Tn),rs(n)&&Xr(n),t.ran=!1}})}function Ff(e){return An(Zi|ts,e,!0)}function lr(e,t=0){return An(Oa|t,e,!0)}function O(e,t=[],n=[],r=[]){Rf(r,t,n,s=>{An(Oa,()=>e(...s.map(c)),!0)})}function Rr(e,t=0){var n=An(qn|t,e,!0);return n}function rn(e){return An(Hn|ts,e,!0)}function Fu(e){var t=e.teardown;if(t!==null){const n=Or,r=be;Po(!0),Bt(null);try{t.call(null)}finally{Po(n),Bt(r)}}}function Vu(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&$a(()=>{s.abort(jr)});var r=n.next;(n.f&Cr)!==0?n.parent=null:Ft(n,t),n=r}}function Vf(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Hn)===0&&Ft(t),t=n}}function Ft(e,t=!0){var n=!1;(t||(e.f&hu)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(qu(e.nodes.start,e.nodes.end),n=!0),Vu(e,t&&!n),fa(e,0),wt(e,$n);var r=e.nodes&&e.nodes.t;if(r!==null)for(const a of r)a.stop();Fu(e);var s=e.parent;s!==null&&s.first!==null&&Hu(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function qu(e,t){for(;e!==null;){var n=e===t?null:As(e);e.remove(),e=n}}function Hu(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Fr(e,t,n=!0){var r=[];Yi(e,r,!0),Zu(r,()=>{n&&Ft(e),t&&t()})}function Zu(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Yi(e,t,n){if((e.f&Jt)===0){e.f^=Jt;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&rr)!==0||(s.f&Hn)!==0&&(e.f&qn)!==0;Yi(s,t,i?n:!1),s=a}}}function Wi(e){Xu(e,!0)}function Xu(e,t){if((e.f&Jt)!==0){e.f^=Jt,(e.f&kt)===0&&(wt(e,Vt),kr(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&rr)!==0||(n.f&Hn)!==0;Xu(n,s?t:!1),n=r}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function Ku(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:As(n);t.append(n),n=s}}let _r=!1;function da(e){_r=e}let Or=!1;function Po(e){Or=e}let be=null,bn=!1;function Bt(e){be=e}let Ce=null;function wn(e){Ce=e}let Un=null;function Ju(e){be!==null&&(Un===null?Un=[e]:Un.push(e))}let Rt=null,Xt=0,tn=null;function qf(e){tn=e}let Yu=1,bs=0,mr=bs;function Lo(e){mr=e}function Wu(){return++Yu}function rs(e){var t=e.f;if((t&Vt)!==0)return!0;if(t&Et&&(e.f&=~Sr),(t&Tn)!==0){var n=e.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(rs(a)&&Ou(a),a.wv>e.wv)return!0}(t&gn)!==0&&sn===null&&wt(e,kt)}return!1}function Qu(e,t,n=!0){var r=e.reactions;if(r!==null&&!Un?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&Et)!==0?Qu(a,t,!1):t===a&&(n?wt(a,Vt):(a.f&kt)!==0&&wt(a,Tn),kr(a))}}function ec(e){var t=Rt,n=Xt,r=tn,s=be,a=Un,i=De,o=bn,l=mr,u=e.f;Rt=null,Xt=0,tn=null,be=(u&(Hn|Cr))===0?e:null,Un=null,Hr(e.ctx),bn=!1,mr=++bs,e.ac!==null&&($a(()=>{e.ac.abort(jr)}),e.ac=null);try{e.f|=ui;var d=e.fn,f=d(),h=e.deps;if(Rt!==null){var v;if(fa(e,Xt),h!==null&&Xt>0)for(h.length=Xt+Rt.length,v=0;v<Rt.length;v++)h[Xt+v]=Rt[v];else e.deps=h=Rt;if(ys()&&(e.f&gn)!==0)for(v=Xt;v<h.length;v++)(h[v].reactions??=[]).push(e)}else h!==null&&Xt<h.length&&(fa(e,Xt),h.length=Xt);if(Nr()&&tn!==null&&!bn&&h!==null&&(e.f&(Et|Tn|Vt))===0)for(v=0;v<tn.length;v++)Qu(tn[v],e);return s!==null&&s!==e&&(bs++,tn!==null&&(r===null?r=tn:r.push(...tn))),(e.f&er)!==0&&(e.f^=er),f}catch(p){return xu(p)}finally{e.f^=ui,Rt=t,Xt=n,tn=r,be=s,Un=a,Hr(i),bn=o,mr=l}}function Hf(e,t){let n=t.reactions;if(n!==null){var r=Hd.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&Et)!==0&&(Rt===null||!Rt.includes(t))&&(wt(t,Tn),(t.f&gn)!==0&&(t.f^=gn,t.f&=~Sr),Ru(t),fa(t,0))}function fa(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Hf(e,n[r])}function Xr(e){var t=e.f;if((t&$n)===0){wt(e,kt);var n=Ce,r=_r;Ce=e,_r=!0;try{(t&(qn|Wd))!==0?Vf(e):Vu(e),Fu(e);var s=ec(e);e.teardown=typeof s=="function"?s:null,e.wv=Yu;var a;oi&&kf&&(e.f&Vt)!==0&&e.deps}finally{_r=r,Ce=n}}}async function Zf(){await Promise.resolve(),Tu()}function c(e){var t=e.f,n=(t&Et)!==0;if(be!==null&&!bn){var r=Ce!==null&&(Ce.f&$n)!==0;if(!r&&!Un?.includes(e)){var s=be.deps;if((be.f&ui)!==0)e.rv<bs&&(e.rv=bs,Rt===null&&s!==null&&s[Xt]===e?Xt++:Rt===null?Rt=[e]:Rt.includes(e)||Rt.push(e));else{(be.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[be]:a.includes(be)||a.push(be)}}}if(Or){if(tr.has(e))return tr.get(e);if(n){var i=e,o=i.v;return((i.f&kt)===0&&i.reactions!==null||nc(i))&&(o=Ki(i)),tr.set(i,o),o}}else n&&(!sn?.has(e)||Pe?.is_fork&&!ys())&&(i=e,rs(i)&&Ou(i),_r&&ys()&&(i.f&gn)===0&&tc(i));if(sn?.has(e))return sn.get(e);if((e.f&er)!==0)throw e.v;return e.v}function tc(e){if(e.deps!==null){e.f^=gn;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&Et)!==0&&(t.f&gn)===0&&tc(t)}}function nc(e){if(e.v===St)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(tr.has(t)||(t.f&Et)!==0&&nc(t))return!0;return!1}function Ie(e){var t=bn;try{return bn=!0,e()}finally{bn=t}}const Xf=-7169;function wt(e,t){e.f=e.f&Xf|t}function Gt(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Sn in e)fi(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Sn in n&&fi(n)}}}function fi(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{fi(e[r],t)}catch{}const n=Vi(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=fu(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const Kf=["touchstart","touchmove"];function Jf(e){return Kf.includes(e)}const rc=new Set,vi=new Set;function Yf(e,t,n,r={}){function s(a){if(r.capture||cs.call(t,a),!a.cancelBubble)return $a(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?jn(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function Wf(e,t,n,r,s){var a={capture:r,passive:s},i=Yf(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Is(()=>{t.removeEventListener(e,i,a)})}function Dt(e){for(var t=0;t<e.length;t++)rc.add(e[t]);for(var n of vi)n(e)}let $o=null;function cs(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;$o=e;var i=0,o=$o===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(i=l)}if(a=s[i]||e.target,a!==t){du(e,"currentTarget",{configurable:!0,get(){return a||n}});var d=be,f=Ce;Bt(null),wn(null);try{for(var h,v=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var b=a["__"+r];b!=null&&(!a.disabled||e.target===a)&&b.call(a,e)}catch(m){h?v.push(m):h=m}if(e.cancelBubble||p===t||p===null)break;a=p}if(h){for(let m of v)queueMicrotask(()=>{throw m});throw h}}finally{e.__root=t,delete e.currentTarget,Bt(d),wn(f)}}}function Qi(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Kr(e,t){var n=Ce;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function E(e,t){var n=(t&mf)!==0,r=(t&yf)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Qi(a?e:"<!>"+e),n||(s=yn(s)));var i=r||Lu?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=yn(i),l=i.lastChild;Kr(o,l)}else Kr(i,i);return i}}function Qf(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var i=Qi(s),o=yn(i);a=yn(o)}var l=a.cloneNode(!0);return Kr(l,l),l}}function ev(e,t){return Qf(e,t,"svg")}function _t(e=""){{var t=Fn(e+"");return Kr(t,t),t}}function je(){var e=document.createDocumentFragment(),t=document.createComment(""),n=Fn();return e.append(t,n),Kr(t,n),e}function y(e,t){e!==null&&e.before(t)}function A(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function tv(e,t){return nv(e,t)}const Lr=new Map;function nv(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:i=!0}){$f();var o=new Set,l=f=>{for(var h=0;h<f.length;h++){var v=f[h];if(!o.has(v)){o.add(v);var p=Jf(v);t.addEventListener(v,cs,{passive:p});var b=Lr.get(v);b===void 0?(document.addEventListener(v,cs,{passive:p}),Lr.set(v,1)):Lr.set(v,b+1)}}};l(Fi(rc)),vi.add(l);var u=void 0,d=Gf(()=>{var f=n??t.appendChild(Fn());return Cf(f,{pending:()=>{}},h=>{if(a){fe({});var v=De;v.c=a}s&&(r.$$events=s),u=e(h,r)||{},a&&ve()}),()=>{for(var h of o){t.removeEventListener(h,cs);var v=Lr.get(h);--v===0?(document.removeEventListener(h,cs),Lr.delete(h)):Lr.set(h,v)}vi.delete(l),f!==n&&f.parentNode?.removeChild(f)}});return rv.set(u,d),u}let rv=new WeakMap;class Cs{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#a=()=>{var t=Pe;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Wi(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const o=this.#r.get(i);o&&(Ft(o.effect),this.#r.delete(i))}for(const[a,i]of this.#t){if(a===n||this.#n.has(a))continue;const o=()=>{if(Array.from(this.#e.values()).includes(a)){var u=document.createDocumentFragment();Ku(i,u),u.append(Fn()),this.#r.set(a,{effect:i,fragment:u})}else Ft(i);this.#n.delete(a),this.#t.delete(a)};this.#l||!r?(this.#n.add(a),Fr(i,o,!1)):o()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(Ft(s.effect),this.#r.delete(r))};ensure(t,n){var r=Pe,s=Uu();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(s){var a=document.createDocumentFragment(),i=Fn();a.append(i),this.#r.set(t,{effect:rn(()=>n(i)),fragment:a})}else this.#t.set(t,rn(()=>n(this.anchor)));if(this.#e.set(r,t),s){for(const[o,l]of this.#t)o===t?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===t?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}const sv=0,Va=1;function av(e,t,n,r,s){var a=Nr(),i=St,o=a?Gn(i):Bn(i,!1,!1),l=a?Gn(i):Bn(i,!1,!1),u=new Cs(e);Rr(()=>{var d=t(),f=!1;if(Kd(d)){var h=Nu(),v=!1;const p=b=>{if(!f){v=!0,h(!1),pn.ensure();try{b()}finally{ms(),Br||Tu()}}};d.then(b=>{p(()=>{Dn(o,b),u.ensure(Va,r&&(m=>r(m,o)))})},b=>{p(()=>{if(Dn(l,b),u.ensure(Va,s&&(m=>s(m,l))),!s)throw l.v})}),jn(()=>{v||p(()=>{u.ensure(sv,n)})})}else Dn(o,d),u.ensure(Va,r&&(p=>r(p,o)));return()=>{f=!0}})}function I(e,t,n=!1){var r=new Cs(e),s=n?rr:0;function a(i,o){r.ensure(i,o)}Rr(()=>{var i=!1;t((o,l=!0)=>{i=!0,a(l,o)}),i||a(!1,null)},s)}function iv(e,t,n){var r=new Cs(e),s=!Nr();Rr(()=>{var a=t();s&&a!==null&&typeof a=="object"&&(a={}),r.ensure(a,n)})}function Jr(e,t){return t}function ov(e,t,n){for(var r=[],s=t.length,a=0;a<s;a++)Yi(t[a].e,r,!0);Zu(r,()=>{var i=r.length===0&&n!==null;if(i){var o=n,l=o.parentNode;Df(l),l.append(o),e.items.clear(),fn(e,t[0].prev,t[s-1].next)}for(var u=0;u<s;u++){var d=t[u];i||(e.items.delete(d.k),fn(e,d.prev,d.next)),Ft(d.e,!i)}e.first===t[0]&&(e.first=t[0].prev)})}function Ue(e,t,n,r,s,a=null){var i=e,o=new Map,l=null,u=(t&yu)!==0,d=(t&_u)!==0,f=(t&mu)!==0;if(u){var h=e;i=h.appendChild(Fn())}var v=null,p=La(()=>{var T=n();return cu(T)?T:T==null?[]:Fi(T)}),b,m=!0;function S(){lv(w,b,i,t,r),v!==null&&(b.length===0?(v.fragment?(i.before(v.fragment),v.fragment=null):Wi(v.effect),k.first=v.effect):Fr(v.effect,()=>{v=null}))}var k=Rr(()=>{b=c(p);for(var T=b.length,N=new Set,C=Pe,M=null,z=Uu(),$=0;$<T;$+=1){var P=b[$],F=r(P,$),U=m?null:o.get(F);U?(d&&Dn(U.v,P),f&&Dn(U.i,$),z&&C.skipped_effects.delete(U.e)):(U=uv(m?i:null,M,P,F,$,s,t,n),m&&(U.o=!0,M===null?l=U:M.next=U,M=U),o.set(F,U)),N.add(F)}if(T===0&&a&&!v)if(m)v={fragment:null,effect:rn(()=>a(i))};else{var V=document.createDocumentFragment(),H=Fn();V.append(H),v={fragment:V,effect:rn(()=>a(H))}}if(!m)if(z){for(const[Y,j]of o)N.has(Y)||C.skipped_effects.add(j.e);C.oncommit(S),C.ondiscard(()=>{})}else S();c(p)}),w={effect:k,items:o,first:l};m=!1}function lv(e,t,n,r,s){var a=(r&df)!==0,i=t.length,o=e.items,l=e.first,u,d=null,f,h=[],v=[],p,b,m,S;if(a)for(S=0;S<i;S+=1)p=t[S],b=s(p,S),m=o.get(b),m.o&&(m.e.nodes?.a?.measure(),(f??=new Set).add(m));for(S=0;S<i;S+=1){if(p=t[S],b=s(p,S),m=o.get(b),e.first??=m,!m.o){m.o=!0;var k=d?d.next:l;fn(e,d,m),fn(e,m,k),qa(m,k,n),d=m,h=[],v=[],l=d.next;continue}if((m.e.f&Jt)!==0&&(Wi(m.e),a&&(m.e.nodes?.a?.unfix(),(f??=new Set).delete(m))),m!==l){if(u!==void 0&&u.has(m)){if(h.length<v.length){var w=v[0],T;d=w.prev;var N=h[0],C=h[h.length-1];for(T=0;T<h.length;T+=1)qa(h[T],w,n);for(T=0;T<v.length;T+=1)u.delete(v[T]);fn(e,N.prev,C.next),fn(e,d,N),fn(e,C,w),l=w,d=C,S-=1,h=[],v=[]}else u.delete(m),qa(m,l,n),fn(e,m.prev,m.next),fn(e,m,d===null?e.first:d.next),fn(e,d,m),d=m;continue}for(h=[],v=[];l!==null&&l!==m;)(l.e.f&Jt)===0&&(u??=new Set).add(l),v.push(l),l=l.next;if(l===null)continue;m=l}h.push(m),d=m,l=m.next}let M=o.size>i;if(l!==null||u!==void 0){for(var z=u===void 0?[]:Fi(u);l!==null;)(l.e.f&Jt)===0&&z.push(l),l=l.next;var $=z.length;if(M=o.size-$>i,$>0){var P=(r&yu)!==0&&i===0?n:null;if(a){for(S=0;S<$;S+=1)z[S].e.nodes?.a?.measure();for(S=0;S<$;S+=1)z[S].e.nodes?.a?.fix()}ov(e,z,P)}}if(M)for(const F of o.values())F.o||(fn(e,d,F),d=F);e.effect.last=d&&d.e,a&&jn(()=>{if(f!==void 0)for(m of f)m.e.nodes?.a?.apply()})}function uv(e,t,n,r,s,a,i,o){var l=(i&_u)!==0,u=(i&ff)===0,d=l?u?Bn(n,!1,!1):Gn(n):n,f=(i&mu)===0?s:Gn(s),h={i:f,v:d,k:r,e:null,o:!1,prev:t,next:null};if(e===null){var v=document.createDocumentFragment();v.append(e=Fn())}return h.e=rn(()=>a(e,d,f,o)),t!==null&&(t.next=h),h}function qa(e,t,n){if(e.e.nodes)for(var r=e.next?e.next.e.nodes.start:n,s=t?t.e.nodes.start:n,a=e.e.nodes.start;a!==null&&a!==r;){var i=As(a);s.before(a),a=i}}function fn(e,t,n){t===null?(e.first=n,e.effect.first=n&&n.e):(t.e.next&&(t.e.next.prev=null),t.next=n,t.e.next=n&&n.e),n!==null&&(n.e.prev&&(n.e.prev.next=null),n.prev=t,n.e.prev=t&&t.e)}function sc(e,t,n=!1,r=!1,s=!1){var a=e,i="";O(()=>{var o=Ce;if(i!==(i=t()??"")&&(o.nodes!==null&&(qu(o.nodes.start,o.nodes.end),o.nodes=null),i!=="")){var l=i+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=Qi(l);if((n||r)&&(u=yn(u)),Kr(yn(u),u.lastChild),n||r)for(;yn(u);)a.before(yn(u));else a.before(u)}})}function cv(e,t,n,r,s){var a=t.$$slots?.[n],i=!1;a===!0&&(a=t[n],i=!0),a===void 0?s!==null&&s(e):a(e,i?()=>r:r)}function It(e,t,...n){var r=new Cs(e);Rr(()=>{const s=t()??null;r.ensure(s,s&&(a=>s(a,...n)))},rr)}function dv(e,t,n){var r=new Cs(e);Rr(()=>{var s=t()??null;r.ensure(s,s&&(a=>n(a,s)))},rr)}function ac(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=ac(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function fv(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=ac(e))&&(r&&(r+=" "),r+=t);return r}function vv(e){return typeof e=="object"?fv(e):e??""}const Do=[...` 	
\r\fÂ \v\uFEFF`];function hv(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,i=0;(i=r.indexOf(s,i))>=0;){var o=i+a;(i===0||Do.includes(r[i-1]))&&(o===r.length||Do.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function Uo(e,t=!1){var n=t?" !important;":";",r="";for(var s in e){var a=e[s];a!=null&&a!==""&&(r+=" "+s+": "+a+n)}return r}function Ha(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function pv(e,t){if(t){var n="",r,s;if(Array.isArray(t)?(r=t[0],s=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,i=0,o=!1,l=[];r&&l.push(...Object.keys(r).map(Ha)),s&&l.push(...Object.keys(s).map(Ha));var u=0,d=-1;const b=e.length;for(var f=0;f<b;f++){var h=e[f];if(o?h==="/"&&e[f-1]==="*"&&(o=!1):a?a===h&&(a=!1):h==="/"&&e[f+1]==="*"?o=!0:h==='"'||h==="'"?a=h:h==="("?i++:h===")"&&i--,!o&&a===!1&&i===0){if(h===":"&&d===-1)d=f;else if(h===";"||f===b-1){if(d!==-1){var v=Ha(e.substring(u,d).trim());if(!l.includes(v)){h!==";"&&f++;var p=e.substring(u,f).trim();n+=" "+p+";"}}u=f+1,d=-1}}}}return r&&(n+=Uo(r)),s&&(n+=Uo(s,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function ke(e,t,n,r,s,a){var i=e.__className;if(i!==n||i===void 0){var o=hv(n,r,a);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(a&&s!==a)for(var l in a){var u=!!a[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return a}function Za(e,t={},n,r){for(var s in n){var a=n[s];t[s]!==a&&(n[s]==null?e.style.removeProperty(s):e.style.setProperty(s,a,r))}}function hi(e,t,n,r){var s=e.__style;if(s!==t){var a=pv(t,r);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}else r&&(Array.isArray(r)?(Za(e,n?.[0],r[0]),Za(e,n?.[1],r[1],"important")):Za(e,n,r));return r}const gv=Symbol("is custom element"),_v=Symbol("is html");function GS(e,t){var n=ic(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function at(e,t,n,r){var s=ic(e);s[t]!==(s[t]=n)&&(t==="loading"&&(e[Qd]=n),n==null?e.removeAttribute(t):typeof n!="string"&&mv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ic(e){return e.__attributes??={[gv]:e.nodeName.includes("-"),[_v]:e.namespaceURI===bf}}var zo=new Map;function mv(e){var t=e.getAttribute("is")||e.nodeName,n=zo.get(t);if(n)return n;zo.set(t,n=[]);for(var r,s=e,a=Element.prototype;a!==s;){r=fu(s);for(var i in r)r[i].set&&n.push(i);s=Vi(s)}return n}function pr(e,t,n=t){var r=new WeakSet;Ji(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=Ka(e)?Ja(a):a,n(a),Pe!==null&&r.add(Pe),await Zf(),a!==(a=t())){var i=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=a??"",o!==null){var u=e.value.length;i===o&&o===l&&u>l?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=i,e.selectionEnd=Math.min(o,u))}}}),Ie(t)==null&&e.value&&(n(Ka(e)?Ja(e.value):e.value),Pe!==null&&r.add(Pe)),lr(()=>{var s=t();if(e===document.activeElement){var a=zs??Pe;if(r.has(a))return}Ka(e)&&s===Ja(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}const Xa=new Set;function BS(e,t,n,r,s=r){var a=n.getAttribute("type")==="checkbox",i=e;if(t!==null)for(var o of t)i=i[o]??=[];i.push(n),Ji(n,"change",()=>{var l=n.__value;a&&(l=bv(i,l,n.checked)),s(l)},()=>s(a?[]:null)),lr(()=>{var l=r();a?(l=l||[],n.checked=l.includes(n.__value)):n.checked=Lf(n.__value,l)}),Is(()=>{var l=i.indexOf(n);l!==-1&&i.splice(l,1)}),Xa.has(i)||(Xa.add(i),jn(()=>{i.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Xa.delete(i)})),jn(()=>{})}function yv(e,t,n=t){Ji(e,"change",r=>{var s=r?e.defaultChecked:e.checked;n(s)}),Ie(t)==null&&n(e.checked),lr(()=>{var r=t();e.checked=!!r})}function bv(e,t,n){for(var r=new Set,s=0;s<e.length;s+=1)e[s].checked&&r.add(e[s].__value);return n||r.delete(t),Array.from(r)}function Ka(e){var t=e.type;return t==="number"||t==="range"}function Ja(e){return e===""?null:+e}function jo(e,t){return e===t||e?.[Sn]===t}function Ss(e={},t,n,r){return Bf(()=>{var s,a;return lr(()=>{s=a,a=[],Ie(()=>{e!==n(...a)&&(t(e,...a),s&&jo(n(...s),e)&&t(null,...s))})}),()=>{jn(()=>{a&&jo(n(...a),e)&&t(null,...a)})}}),e}function Sv(e,t,n,r,s){var a=()=>{r(n[e])};n.addEventListener(t,a),s?lr(()=>{n[e]=s()}):a(),(n===document.body||n===window||n===document)&&Is(()=>{n.removeEventListener(t,a)})}function Ht(e=!1){const t=De,n=t.l.u;if(!n)return;let r=()=>Gt(t.s);if(e){let s=0,a={};const i=Ts(()=>{let o=!1;const l=t.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&s++,s});r=()=>c(i)}n.b.length&&jf(()=>{Go(t,r),li(n.b)}),sr(()=>{const s=Ie(()=>n.m.map(Jd));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&sr(()=>{Go(t,r),li(n.a)})}function Go(e,t){if(e.l.s)for(const n of e.l.s)c(n);t()}function oc(e,t,n){if(e==null)return t(void 0),et;const r=Ie(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const $r=[];function vr(e,t){return{subscribe:kv(e,t).subscribe}}function kv(e,t=et){let n=null;const r=new Set;function s(o){if(Su(e,o)&&(e=o,n)){const l=!$r.length;for(const u of r)u[1](),$r.push(u,e);if(l){for(let u=0;u<$r.length;u+=2)$r[u][0]($r[u+1]);$r.length=0}}}function a(o){s(o(e))}function i(o,l=et){const u=[o,l];return r.add(u),r.size===1&&(n=t(s,a)||et),o(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:i}}function wv(e){let t;return oc(e,n=>t=n)(),t}let Os=!1,pi=Symbol();function ds(e,t,n){const r=n[t]??={store:null,source:Bn(void 0),unsubscribe:et};if(r.store!==e&&!(pi in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=et;else{var s=!0;r.unsubscribe=oc(e,a=>{s?r.source.v=a:x(r.source,a)}),s=!1}return e&&pi in n?wv(e):c(r.source)}function lc(){const e={};function t(){Is(()=>{for(var n in e)e[n].unsubscribe();du(e,pi,{enumerable:!1,value:!0})})}return[e,t]}function Ev(e){var t=Os;try{return Os=!1,[e(),Os]}finally{Os=t}}const xv={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(is(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];is(s)&&(s=s());const a=Qn(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(is(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=Qn(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===Sn||t===gu)return!1;for(let n of e.props)if(is(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(is(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function Tv(...e){return new Proxy({props:e},xv)}function dt(e,t,n,r){var s=!ns||(n&hf)!==0,a=(n&gf)!==0,i=(n&_f)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?Ie(r):r),o),d;if(a){var f=Sn in e||gu in e;d=Qn(e,t)?.set??(f&&t in e?w=>e[t]=w:void 0)}var h,v=!1;a?[h,v]=Ev(()=>e[t]):h=e[t],h===void 0&&r!==void 0&&(h=u(),d&&(s&&af(),d(h)));var p;if(s?p=()=>{var w=e[t];return w===void 0?u():(l=!0,w)}:p=()=>{var w=e[t];return w!==void 0&&(o=void 0),w===void 0?o:w},s&&(n&pf)===0)return p;if(d){var b=e.$$legacy;return(function(w,T){return arguments.length>0?((!s||!T||b||v)&&d(T?p():w),w):p()})}var m=!1,S=((n&vf)!==0?Ts:La)(()=>(m=!1,p()));a&&c(S);var k=Ce;return(function(w,T){if(arguments.length>0){const N=T?c(S):s&&a?Xe(w):w;return x(S,N),m=!0,o!==void 0&&(o=N),w}return Or&&m||(k.f&$n)!==0?S.v:c(S)})}function uc(e){De===null&&Xi(),ns&&De.l!==null?Av(De).m.push(e):sr(()=>{const t=Ie(e);if(typeof t=="function")return t})}function FS(e){De===null&&Xi(),uc(()=>()=>Ie(e))}function Av(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Iv="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Iv);const Cv=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Vr=()=>crypto.randomUUID(),eo=e=>{try{return JSON.parse(e)}catch{return null}},Bo=(e,t)=>{const{label:n}=t,r=e.trim();if(!r)return{};let s;try{s=JSON.parse(r)}catch{throw new Error(`${n} must be valid JSON.`)}if(s===null||Array.isArray(s)||typeof s!="object")throw new Error(`${n} must be a JSON object.`);return s},Ur=-1,Fo=200;function cc(e){return e?e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`:"Unknown size"}function dc(e){return e?e.startsWith("image/")?"image":e==="application/pdf"?"pdf":e.includes("spreadsheet")||e.includes("excel")?"spreadsheet":e.includes("presentation")||e.includes("powerpoint")?"presentation":"file":"file"}function fc(e){if(!e)return"file";const t=e.split("/");return t[1]??t[0]??"file"}var Nv=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Rv=Object.prototype.hasOwnProperty;function gi(e,t){return Rv.call(e,t)}function _i(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var s in e)gi(e,s)&&r.push(s);return r}function Kt(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function mi(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function hr(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function vc(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function yi(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(yi(e[t]))return!0}else if(typeof e=="object"){for(var r=_i(e),s=r.length,a=0;a<s;a++)if(yi(e[r[a]]))return!0}}return!1}function Vo(e,t){var n=[e];for(var r in t){var s=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof s<"u"&&n.push(r+": "+s)}return n.join(`
`)}var hc=(function(e){Nv(t,e);function t(n,r,s,a,i){var o=this.constructor,l=e.call(this,Vo(n,{name:r,index:s,operation:a,tree:i}))||this;return l.name=r,l.index=s,l.operation=a,l.tree=i,Object.setPrototypeOf(l,o.prototype),l.message=Vo(n,{name:r,index:s,operation:a,tree:i}),l}return t})(Error),Qe=hc,Ov=Kt,Gr={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=va(n,this.path);r&&(r=Kt(r));var s=yr(n,{op:"remove",path:this.from}).removed;return yr(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=va(n,this.from);return yr(n,{op:"add",path:this.path,value:Kt(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:ks(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Mv={add:function(e,t,n){return mi(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Gr.move,copy:Gr.copy,test:Gr.test,_get:Gr._get};function va(e,t){if(t=="")return e;var n={op:"_get",path:t};return yr(e,n),n.value}function yr(e,t,n,r,s,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):ha(t,0)),t.path===""){var i={newDocument:e};if(t.op==="add")return i.newDocument=t.value,i;if(t.op==="replace")return i.newDocument=t.value,i.removed=e,i;if(t.op==="move"||t.op==="copy")return i.newDocument=va(e,t.from),t.op==="move"&&(i.removed=e),i;if(t.op==="test"){if(i.test=ks(e,t.value),i.test===!1)throw new Qe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i.newDocument=e,i}else{if(t.op==="remove")return i.removed=e,i.newDocument=null,i;if(t.op==="_get")return t.value=e,i;if(n)throw new Qe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return i}}else{r||(e=Kt(e));var o=t.path||"",l=o.split("/"),u=e,d=1,f=l.length,h=void 0,v=void 0,p=void 0;for(typeof n=="function"?p=n:p=ha;;){if(v=l[d],v&&v.indexOf("~")!=-1&&(v=vc(v)),s&&(v=="__proto__"||v=="prototype"&&d>0&&l[d-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[v]===void 0?h=l.slice(0,d).join("/"):d==f-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),d++,Array.isArray(u)){if(v==="-")v=u.length;else{if(n&&!mi(v))throw new Qe("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);mi(v)&&(v=~~v)}if(d>=f){if(n&&t.op==="add"&&v>u.length)throw new Qe("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var i=Mv[t.op].call(t,u,v,e);if(i.test===!1)throw new Qe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}}else if(d>=f){var i=Gr[t.op].call(t,u,v,e);if(i.test===!1)throw new Qe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}if(u=u[v],n&&d<f&&(!u||typeof u!="object"))throw new Qe("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function Yr(e,t,n,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),n&&!Array.isArray(t))throw new Qe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Kt(e));for(var a=new Array(t.length),i=0,o=t.length;i<o;i++)a[i]=yr(e,t[i],n,!0,s,i),e=a[i].newDocument;return a.newDocument=e,a}function Pv(e,t,n){var r=yr(e,t);if(r.test===!1)throw new Qe("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function ha(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Qe("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Gr[e.op]){if(typeof e.path!="string")throw new Qe("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Qe('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Qe("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Qe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&yi(e.value))throw new Qe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var s=e.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new Qe("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Qe("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var i={op:"_get",path:e.from,value:void 0},o=pc([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Qe("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Qe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function pc(e,t,n){try{if(!Array.isArray(e))throw new Qe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Yr(Kt(t),Kt(e),n||!0);else{n=n||ha;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(s){if(s instanceof Qe)return s;throw s}}function ks(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),s,a,i;if(n&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!ks(e[s],t[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(a=o.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!t.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!ks(e[i],t[i]))return!1;return!0}return e!==e&&t!==t}const Lv=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Qe,_areEquals:ks,applyOperation:yr,applyPatch:Yr,applyReducer:Pv,deepClone:Ov,getValueByPointer:va,validate:pc,validator:ha},Symbol.toStringTag,{value:"Module"}));var to=new WeakMap,$v=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),Dv=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function Uv(e){return to.get(e)}function zv(e,t){return e.observers.get(t)}function jv(e,t){e.observers.delete(t.callback)}function Gv(e,t){t.unobserve()}function Bv(e,t){var n=[],r,s=Uv(e);if(!s)s=new $v(e),to.set(e,s);else{var a=zv(s,t);r=a&&a.observer}if(r)return r;if(r={},s.value=Kt(e),t){r.callback=t,r.next=null;var i=function(){bi(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){bi(r),clearTimeout(r.next),jv(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},s.observers.set(t,new Dv(t,r)),r}function bi(e,t){t===void 0&&(t=!1);var n=to.get(e.object);no(n.value,e.object,e.patches,"",t),e.patches.length&&Yr(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function no(e,t,n,r,s){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=_i(t),i=_i(e),o=!1,l=i.length-1;l>=0;l--){var u=i[l],d=e[u];if(gi(t,u)&&!(t[u]===void 0&&d!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof d=="object"&&d!=null&&typeof f=="object"&&f!=null&&Array.isArray(d)===Array.isArray(f)?no(d,f,n,r+"/"+hr(u),s):d!==f&&(s&&n.push({op:"test",path:r+"/"+hr(u),value:Kt(d)}),n.push({op:"replace",path:r+"/"+hr(u),value:Kt(f)}))}else Array.isArray(e)===Array.isArray(t)?(s&&n.push({op:"test",path:r+"/"+hr(u),value:Kt(d)}),n.push({op:"remove",path:r+"/"+hr(u)}),o=!0):(s&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!gi(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+hr(u),value:Kt(t[u])})}}}function Fv(e,t,n){n===void 0&&(n=!1);var r=[];return no(e,t,r,"",n),r}const Vv=Object.freeze(Object.defineProperty({__proto__:null,compare:Fv,generate:bi,observe:Bv,unobserve:Gv},Symbol.toStringTag,{value:"Module"}));Object.assign({},Lv,Vv,{JsonPatchError:hc,deepClone:Kt,escapePathComponent:hr,unescapePathComponent:vc});function ro(e){return{ok:!0,data:e}}function pa(e){return{ok:!1,error:e}}function qv(e,t="Unknown error"){return e instanceof Error?e:typeof e=="string"&&e.trim()?new Error(e):new Error(t)}const gc=Symbol("chat-store");function Hv(){let e=G(Xe([])),t=G("");return{get messages(){return c(e)},get input(){return c(t)},set input(n){x(t,n,!0)},get isEmpty(){return c(e).length===0},addUserMessage(n){const r={id:Vr(),role:"user",text:n,ts:Date.now()};return c(e).push(r),r},addAgentMessage(){const n={id:Vr(),role:"agent",text:"",observations:"",showObservations:!1,isStreaming:!0,isThinking:!1,answerStreamDone:!1,revisionStreamActive:!1,answerActionSeq:Ur,ts:Date.now()};return c(e).push(n),n},findMessage(n){return c(e).find(r=>r.id===n)},updateMessage(n,r){const s=c(e).find(a=>a.id===n);s&&Object.assign(s,r)},clearInput(){x(t,"")},clear(){x(e,[],!0),x(t,"")}}}function Zv(e=Hv()){return qt(gc,e),e}function _c(){return Yt(gc)}const mc=Symbol("session-store");function Xv(){let e=G(Xe(Vr())),t=G(null),n=G(!1);return{get sessionId(){return c(e)},set sessionId(r){x(e,r,!0)},get activeTraceId(){return c(t)},set activeTraceId(r){x(t,r,!0)},get isSending(){return c(n)},set isSending(r){x(n,r,!0)},reset(){x(e,Vr(),!0),x(t,null),x(n,!1)},newSession(){x(e,Vr(),!0),x(t,null)}}}function Kv(e=Xv()){return qt(mc,e),e}function ur(){return Yt(mc)}const yc=Symbol("artifacts-store");function Jv(){let e=G(Xe(new Map));return{get artifacts(){return c(e)},get list(){return Array.from(c(e).values())},get count(){return c(e).size},has(t){return c(e).has(t)},get(t){return c(e).get(t)},addArtifact(t){const n={id:t.artifact_id,mime_type:t.mime_type,size_bytes:t.size_bytes,filename:t.filename,sha256:null,source:t.source},r=new Map(c(e));r.set(t.artifact_id,n),x(e,r,!0)},remove(t){if(!c(e).has(t))return!1;const n=new Map(c(e));return n.delete(t),x(e,n,!0),!0},clear(){x(e,new Map,!0)}}}function Yv(e=Jv()){return qt(yc,e),e}function Wv(){return Yt(yc)}const bc=Symbol("agent-store"),qo={name:"loading_agent",description:"",template:"",version:"",flags:[],tools:0,flows:0};function Qv(){let e=G(Xe({...qo})),t=G(Xe([])),n=G(Xe([])),r=G(Xe([]));return{get meta(){return c(e)},get plannerConfig(){return c(t)},get services(){return c(n)},get catalog(){return c(r)},setFromResponse(s){const a=s.agent??{};x(e,{name:a.name??"agent",description:a.description??"",template:a.template??"",version:a.version??"",flags:a.flags??[],tools:(s.tools??[]).length,flows:(s.flows??[]).length},!0),x(t,s.planner&&Object.keys(s.planner).length?Object.entries(s.planner).map(([i,o])=>({label:i,value:o})):[],!0),x(n,s.services?.map(i=>({name:i.name,status:i.enabled?"enabled":"disabled",url:i.url??null}))??[],!0),x(r,s.tools?.map(i=>({name:i.name,desc:i.description,tags:i.tags??[]}))??[],!0)},reset(){x(e,{...qo},!0),x(t,[],!0),x(n,[],!0),x(r,[],!0)}}}function eh(e=Qv()){return qt(bc,e),e}function ss(){return Yt(bc)}const Sc=Symbol("events-store"),th=new Set(["thinking","revision","tool_call_start","tool_call_args","tool_call_end","tool_call_result","llm_stream_chunk","state_update","connected"]),nh=new Set(["step","step_start","step_complete"]);function rh(){let e=G(Xe([])),t=G(Xe(new Set)),n=G(!1),r=G(Xe(new Map));function s(){const a=[],i=new Set;for(const o of c(e)){const l=o.event?.toLowerCase()??"";if(!th.has(l)){if(nh.has(l)||l==="event"){(l==="step_complete"||o.latency_ms)&&a.push({id:o.id,type:"step",name:o.node??"step",description:o.thought?Ms(o.thought,100):void 0,duration_ms:o.latency_ms,ts:o.ts??Date.now()});continue}if(l==="artifact_stored"||l==="artifact_chunk"){a.push({id:o.id,type:"artifact",name:o.artifact_id??"artifact",description:o.mime_type??void 0,ts:o.ts??Date.now()});continue}a.push({id:o.id,type:"other",name:l,description:o.thought?Ms(o.thought,80):void 0,ts:o.ts??Date.now()})}}for(const[o,l]of c(r))l.endTs&&!i.has(o)&&(a.push({id:`tc_${o}`,type:"tool_call",name:l.name,args:l.args?Ms(l.args,100):void 0,result:l.result?Ms(l.result,100):void 0,duration_ms:l.endTs-l.startTs,ts:l.startTs}),i.add(o));return a.sort((o,l)=>l.ts-o.ts),a}return{get events(){return c(e)},get displayEvents(){return s()},get filter(){return c(t)},get paused(){return c(n)},set paused(a){x(n,a,!0)},get isEmpty(){return c(e).length===0},setFilter(a){a?x(t,new Set([a]),!0):x(t,new Set,!0)},addEvent(a,i){const o=a.tool_call_id,l=i.toLowerCase();if(o){if(l==="tool_call_start")c(r).set(o,{id:o,name:a.tool_call_name??"tool",args:"",result:"",startTs:Date.now()});else if(l==="tool_call_args"){const f=c(r).get(o);f&&(f.args+=a.delta??"")}else if(l==="tool_call_result"){const f=c(r).get(o);f&&(f.result=a.content??"")}else if(l==="tool_call_end"){const f=c(r).get(o);f&&(f.endTs=Date.now())}}const u=`${a.event??""}|${a.node??""}|${a.ts??""}`;if(!c(e).some(f=>`${f.event??""}|${f.node??""}|${f.ts??""}`===u)){const f={id:Vr(),event:i,...a};c(e).unshift(f),c(e).length>Fo&&(c(e).length=Fo)}},shouldProcess(a){return c(n)?!1:c(t).size===0?!0:c(t).has(a)},clear(){x(e,[],!0),x(r,new Map,!0)}}}function Ms(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}function sh(e=rh()){return qt(Sc,e),e}function so(){return Yt(Sc)}const kc=Symbol("tasks-store");function ah(){let e=G(Xe({})),t=G(null),n=G(null),r=G(Xe([])),s=G(!1);function a(o,l){const u=c(e)[o];if(u)return u;const d={task_id:o,session_id:l,status:"PENDING",task_type:"FOREGROUND",priority:0};return x(e,{...c(e),[o]:d},!0),d}function i(o,l){const u=l.status;u&&(o.status=u);const d=l.task_type;typeof d=="string"&&(o.task_type=d);const f=l.priority;typeof f=="number"&&(o.priority=f);const h=l.progress;h&&typeof h=="object"&&!Array.isArray(h)&&(o.progress=h),o.updated_at=new Date().toISOString()}return{get tasks(){return Object.values(c(e)).sort((o,l)=>{const u=o.updated_at?Date.parse(o.updated_at):0;return(l.updated_at?Date.parse(l.updated_at):0)-u})},get count(){return Object.keys(c(e)).length},get foregroundTaskId(){return c(t)},get foregroundStatus(){return c(n)},get backgroundTasks(){return c(r)},get isPolling(){return c(s)},get hasForegroundRunning(){return c(t)!==null&&c(n)==="RUNNING"},get hasActiveBackgroundTasks(){return c(r).length>0},get shouldShowSteerButton(){return c(t)!==null&&c(n)==="RUNNING"},applyUpdate(o){const l=a(o.task_id,o.session_id);if(o.trace_id&&(l.trace_id=o.trace_id),o.update_type==="STATUS_CHANGE"){if(o.content&&typeof o.content=="object"&&!Array.isArray(o.content)){const u=o.content;i(l,u);const d=u.task_type,f=u.status;d==="FOREGROUND"&&(f==="RUNNING"?(x(t,o.task_id,!0),x(n,f,!0)):f==="COMPLETE"||f==="FAILED"||f==="CANCELLED"?c(t)===o.task_id&&(x(t,null),x(n,null)):c(t)===o.task_id&&x(n,f??null,!0)),d==="BACKGROUND"&&(f&&new Set(["RUNNING","PENDING","PAUSED"]).has(f)?c(r).find(p=>p.task_id===o.task_id)?x(r,c(r).map(p=>p.task_id===o.task_id?{...p,status:f}:p),!0):x(r,[...c(r),{task_id:o.task_id,description:l.description??null,status:f,task_type:d,priority:l.priority}],!0):x(r,c(r).filter(v=>v.task_id!==o.task_id),!0))}return}if(o.update_type==="PROGRESS"){o.content&&typeof o.content=="object"&&!Array.isArray(o.content)&&(l.progress=o.content,l.updated_at=new Date().toISOString());return}if(o.update_type==="RESULT"){const u=o.content;l.result=o.content,u&&typeof u=="object"&&("task_patch"in u&&(l.task_patch=u.task_patch),"patch_id"in u&&(l.patch_id=u.patch_id)),l.status="COMPLETE",l.updated_at=new Date().toISOString(),c(t)===o.task_id&&(x(t,null),x(n,null));return}if(o.update_type==="CHECKPOINT"){const u=o.content;if(u&&typeof u=="object"){const d=u.patch_id;d&&(l.patch_id=d,l.updated_at=new Date().toISOString())}return}o.update_type==="ERROR"&&(o.content&&typeof o.content=="object"&&!Array.isArray(o.content)?l.error=String(o.content.error??"Error"):l.error="Error",l.status="FAILED",l.updated_at=new Date().toISOString(),c(t)===o.task_id&&(x(t,null),x(n,null)),x(r,c(r).filter(u=>u.task_id!==o.task_id),!0))},setTasks(o){const l={};for(const u of o)l[u.task_id]={...u};x(e,l,!0)},async fetchTaskState(o){try{x(s,!0);const l=await fetch(`/session/${o}/task-state`);if(!l.ok){console.error("Failed to fetch task state:",l.statusText);return}const u=await l.json();x(t,u.foreground_task_id,!0),x(n,u.foreground_status,!0),x(r,u.background_tasks,!0)}catch(l){console.error("Failed to fetch task state:",l)}finally{x(s,!1)}},setPolling(o){x(s,o,!0)},clear(){x(e,{},!0),x(t,null),x(n,null),x(r,[],!0),x(s,!1)}}}function ih(e=ah()){return qt(kc,e),e}function wc(){return Yt(kc)}const Ec=Symbol("trajectory-store");function oh(){let e=G(Xe([])),t=G(Xe({})),n=G(null),r=G(null),s=G(null),a=G(null),i=G(null),o=G(null);return{get steps(){return c(e)},get artifactStreams(){return c(t)},get query(){return c(n)},get llmContext(){return c(r)},get toolContext(){return c(s)},get backgroundResults(){return c(a)},get traceId(){return c(i)},get sessionId(){return c(o)},get isEmpty(){return c(e).length===0},get hasArtifacts(){return Object.keys(c(t)).length>0},get hasBackgroundResults(){return c(a)!=null&&Object.keys(c(a)).length>0},get hasContext(){return c(i)!=null||c(r)!=null||c(s)!=null||c(a)!=null&&Object.keys(c(a)).length>0},get conversationMemory(){return c(r)?.conversation_memory??null},get hasMemory(){return c(r)?.conversation_memory!=null},setFromPayload(l){const u=l?.steps??[];x(e,u.map((d,f)=>{const h=d.action??{};return{id:`step-${f}`,name:h.next_node??h.plan?.[0]?.node??"step",thought:h.thought,args:h.args,result:d.observation,latencyMs:d.latency_ms??void 0,reflectionScore:d.metadata?.reflection?.score??void 0,status:d.error?"error":"ok"}}),!0),x(n,l?.query??null,!0),x(r,l?.llm_context??null,!0),x(s,l?.tool_context??null,!0),x(a,l?.background_results??null,!0),x(i,l?.trace_id??null,!0),x(o,l?.session_id??null,!0)},addArtifactChunk(l,u){const d=c(t)[l]??[];c(t)[l]=[...d,u]},clearArtifacts(){x(t,{},!0)},clear(){x(e,[],!0),x(t,{},!0),x(n,null),x(r,null),x(s,null),x(a,null),x(i,null),x(o,null)}}}function lh(e=oh()){return qt(Ec,e),e}function Da(){return Yt(Ec)}const xc=Symbol("spec-store");function uh(){let e=G(""),t=G("pending"),n=G(Xe([]));return{get content(){return c(e)},set content(r){x(e,r,!0)},get status(){return c(t)},set status(r){x(t,r,!0)},get errors(){return c(n)},get isValid(){return c(t)==="valid"},get hasErrors(){return c(n).length>0},setFromSpecData(r){x(e,r.content,!0),x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`err-${a}`,message:s.message,line:s.line})),!0)},setValidationResult(r){x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`val-err-${a}`,message:s.message,line:s.line})),!0)},setGenerationErrors(r){x(t,"error"),x(n,r.map((s,a)=>({id:`gen-err-${a}`,message:s.message,line:s.line})),!0)},markValid(){x(t,"valid"),x(n,[],!0)},reset(){x(e,""),x(t,"pending"),x(n,[],!0)}}}function ch(e=uh()){return qt(xc,e),e}function dh(){return Yt(xc)}const Tc=Symbol("setup-store");function fh(){let e=G("playground-tenant"),t=G("playground-user"),n=G("{}"),r=G("{}"),s=G(null),a=G(!1);return{get tenantId(){return c(e)},set tenantId(i){x(e,i,!0)},get userId(){return c(t)},set userId(i){x(t,i,!0)},get toolContextRaw(){return c(n)},set toolContextRaw(i){x(n,i,!0)},get llmContextRaw(){return c(r)},set llmContextRaw(i){x(r,i,!0)},get error(){return c(s)},set error(i){x(s,i,!0)},get useAgui(){return c(a)},set useAgui(i){x(a,i,!0)},parseContexts(){try{const i=Bo(c(n),{label:"Tool context"}),o={tenant_id:c(e),user_id:c(t),...i},l=Bo(c(r),{label:"LLM context"});return x(s,null),{toolContext:o,llmContext:l}}catch(i){return x(s,i instanceof Error?i.message:"Invalid setup configuration.",!0),null}},clearError(){x(s,null)},reset(){x(e,"playground-tenant"),x(t,"playground-user"),x(n,"{}"),x(r,"{}"),x(s,null),x(a,!1)}}}function vh(e=fh()){return qt(Tc,e),e}function hh(){return Yt(Tc)}const Ac=Symbol("interactions-store");function ph(){let e=G(Xe([])),t=G(null),n=G(null);function r(o,{message_id:l}={}){if(o.artifact_type!=="ui_component"||!o.chunk||typeof o.chunk!="object")return;const u=o.chunk,d=typeof u.component=="string"?u.component:void 0,f=u.props||{};if(!d)return;const h={id:(typeof u.id=="string"?u.id:void 0)||`ui_${Date.now()}`,component:d,props:f,title:typeof u.title=="string"?u.title:void 0,message_id:l??(typeof o.meta?.message_id=="string"?o.meta.message_id:void 0),seq:o.seq??0,ts:o.ts??Date.now(),meta:o.meta??{}};x(e,[...c(e),h],!0),x(n,h,!0)}function s(o){x(t,o,!0)}function a(o){c(t)&&x(t,{...c(t),...o},!0)}function i(){x(t,null)}return{get artifacts(){return c(e)},get pendingInteraction(){return c(t)},get lastArtifact(){return c(n)},addArtifactChunk:r,setPendingInteraction:s,updatePendingInteraction:a,clearPendingInteraction:i,clear(){x(e,[],!0),x(t,null),x(n,null)}}}function gh(e=ph()){return qt(Ac,e),e}function ao(){return Yt(Ac)}const Ic=Symbol("component-registry-store");function _h(){let e=G(null),t=G(null);return{get registry(){return c(e)},get error(){return c(t)},get enabled(){return c(e)?.enabled??!1},get components(){return c(e)?.components??{}},get version(){return c(e)?.version??""},get allowlist(){return c(e)?.allowlist??[]},setFromPayload(n){x(e,n,!0),x(t,null)},setError(n){x(t,n,!0)},getComponent(n){return c(e)?.components?.[n]},reset(){x(e,null),x(t,null)}}}function mh(e=_h()){return qt(Ic,e),e}function io(){return Yt(Ic)}const yh=Symbol("layout-store");function bh(){let e=G(!1),t=G(!1);return{get isMobile(){return c(e)},set isMobile(n){x(e,n,!0)},get sidebarOpen(){return c(t)},set sidebarOpen(n){x(t,n,!0)},setMobile(n){x(e,n,!0),n||x(t,!1)},toggleSidebar(){x(t,!c(t))},reset(){x(e,!1),x(t,!1)}}}function Sh(e=bh()){return qt(yh,e),e}const Cc=Symbol("notifications-store");function kh(){let e=G(Xe([]));return{get items(){return c(e)},add(t,n="info",r){const s={id:`note_${Date.now()}_${Math.random().toString(16).slice(2)}`,message:t,level:n,ts:Date.now(),actions:r};return x(e,[s,...c(e)],!0),s},remove(t){x(e,c(e).filter(n=>n.id!==t),!0)},clear(){x(e,[],!0)}}}function wh(e=kh()){return qt(Cc,e),e}function Eh(){return Yt(Cc)}function xh(){return{chatStore:Zv(),sessionStore:Kv(),artifactsStore:Yv(),agentStore:eh(),eventsStore:sh(),tasksStore:ih(),trajectoryStore:lh(),specStore:ch(),setupStore:vh(),interactionsStore:gh(),componentRegistryStore:mh(),layoutStore:Sh(),notificationsStore:wh()}}const cr="";class Ho extends Error{constructor(t,n,r){super(t),this.statusCode=n,this.details=r,this.name="ApiError"}}async function Mr(e,t){try{const n=t?await fetch(e,t):await fetch(e);return n.ok?{ok:!0,data:await n.json()}:{ok:!1,error:new Ho(n.statusText||"Request failed",n.status)}}catch(n){return{ok:!1,error:new Ho("Network error",0,n)}}}function Th(e){if(!e)return null;const n=e.match(/filename="(.+?)"/)?.[1];if(n)return n;const s=e.match(/filename=([^;\s]+)/)?.[1];return s||null}async function Ah(){const e=await Mr(`${cr}/ui/meta`);return e.ok?e.data:(console.error("meta load failed",e.error),null)}async function Ih(){const e=await Mr(`${cr}/ui/components`);return e.ok?e.data:(console.error("component registry load failed",e.error),null)}async function Ch(){const e=await Mr(`${cr}/ui/spec`);return e.ok?e.data:(console.error("spec load failed",e.error),null)}async function Zo(e,t){const n=await Mr(`${cr}/trajectory/${e}?session_id=${encodeURIComponent(t)}`);return n.ok?n.data:(console.error("trajectory fetch failed",n.error),null)}async function oo(e,t,n){const r=await fetch(`${cr}/artifacts/${e}`,{headers:{"X-Session-ID":t}});if(!r.ok)throw new Error(`Download failed: ${r.status} ${r.statusText}`);const s=await r.blob(),a=r.headers.get("Content-Disposition"),i=n||Th(a)||`artifact-${e}`,o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}async function Ps(e,t,n,r={},s="user"){const a=await Mr(`${cr}/steer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,task_id:t,event_type:n,payload:r,source:s})});return a.ok?!!a.data.accepted:(console.error("steer task failed",a.error),!1)}async function Nh(e,t){const n=new URL(`${cr}/tasks`,window.location.origin);n.searchParams.set("session_id",e);const r=await Mr(n.toString());return r.ok?r.data:(console.error("tasks fetch failed",r.error),null)}async function Nc(e,t,n="apply"){const r=await Mr(`${cr}/sessions/${e}/apply-context-patch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch_id:t,action:n})});return r.ok?!!r.data.ok:(console.error("apply context patch failed",r.error),!1)}var Se;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},e.getValidEnumValues=s=>{const a=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return e.objectValues(i)},e.objectValues=s=>e.objectKeys(s).map(function(a){return s[a]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},e.find=(s,a)=>{for(const i of s)if(a(i))return i},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(Se||(Se={}));var Xo;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(Xo||(Xo={}));const q=Se.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yn=e=>{switch(typeof e){case"undefined":return q.undefined;case"string":return q.string;case"number":return Number.isNaN(e)?q.nan:q.number;case"boolean":return q.boolean;case"function":return q.function;case"bigint":return q.bigint;case"symbol":return q.symbol;case"object":return Array.isArray(e)?q.array:e===null?q.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?q.promise:typeof Map<"u"&&e instanceof Map?q.map:typeof Set<"u"&&e instanceof Set?q.set:typeof Date<"u"&&e instanceof Date?q.date:q.object;default:return q.unknown}},D=Se.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Vn extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(t){if(!(t instanceof Vn))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Se.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Vn.create=e=>new Vn(e);const Si=(e,t)=>{let n;switch(e.code){case D.invalid_type:e.received===q.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case D.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Se.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:n=`Unrecognized key(s) in object: ${Se.joinValues(e.keys,", ")}`;break;case D.invalid_union:n="Invalid input";break;case D.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Se.joinValues(e.options)}`;break;case D.invalid_enum_value:n=`Invalid enum value. Expected ${Se.joinValues(e.options)}, received '${e.received}'`;break;case D.invalid_arguments:n="Invalid function arguments";break;case D.invalid_return_type:n="Invalid function return type";break;case D.invalid_date:n="Invalid date";break;case D.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Se.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case D.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case D.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case D.custom:n="Invalid input";break;case D.invalid_intersection_types:n="Intersection results could not be merged";break;case D.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case D.not_finite:n="Number must be finite";break;default:n=t.defaultError,Se.assertNever(e)}return{message:n}};let Rh=Si;function Oh(){return Rh}const Mh=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:t,defaultError:o}).message;return{...s,path:a,message:o}};function B(e,t){const n=Oh(),r=Mh({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Si?void 0:Si].filter(s=>!!s)});e.common.issues.push(r)}class Pt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return se;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return Pt.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return se;a.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:t.value,value:r}}}const se=Object.freeze({status:"aborted"}),fs=e=>({status:"dirty",value:e}),an=e=>({status:"valid",value:e}),Ko=e=>e.status==="aborted",Jo=e=>e.status==="dirty",Wr=e=>e.status==="valid",ga=e=>typeof Promise<"u"&&e instanceof Promise;var Z;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(Z||(Z={}));class En{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Yo=(e,t)=>{if(Wr(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Vn(e.common.issues);return this._error=n,this._error}}};function ue(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(i,o)=>{const{message:l}=e;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class ge{get description(){return this._def.description}_getType(t){return Yn(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Yn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Pt,ctx:{common:t.parent.common,data:t.data,parsedType:Yn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(ga(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)},s=this._parseSync({data:t,path:r.path,parent:r});return Yo(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return Wr(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>Wr(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yn(t)},s=this._parse({data:t,path:r.path,parent:r}),a=await(ga(s)?s:Promise.resolve(s));return Yo(r,a)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=t(s),o=()=>a.addIssue({code:D.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new xr({schema:this,typeName:ae.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return zn.create(this,this._def)}nullable(){return Tr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return kn.create(this)}promise(){return wa.create(this,this._def)}or(t){return ma.create([this,t],this._def)}and(t){return ya.create(this,t,this._def)}transform(t){return new xr({...ue(this._def),schema:this,typeName:ae.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Ea({...ue(this._def),innerType:this,defaultValue:n,typeName:ae.ZodDefault})}brand(){return new Pc({typeName:ae.ZodBranded,type:this,...ue(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new xa({...ue(this._def),innerType:this,catchValue:n,typeName:ae.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return uo.create(this,t)}readonly(){return Ta.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Ph=/^c[^\s-]{8,}$/i,Lh=/^[0-9a-z]+$/,$h=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Dh=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Uh=/^[a-z0-9_-]{21}$/i,zh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,jh=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Gh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Bh="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ya;const Fh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Vh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Hh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Zh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Xh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Rc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Kh=new RegExp(`^${Rc}$`);function Oc(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Jh(e){return new RegExp(`^${Oc(e)}$`)}function Yh(e){let t=`${Rc}T${Oc(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Wh(e,t){return!!((t==="v4"||!t)&&Fh.test(e)||(t==="v6"||!t)&&qh.test(e))}function Qh(e,t){if(!zh.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function ep(e,t){return!!((t==="v4"||!t)&&Vh.test(e)||(t==="v6"||!t)&&Hh.test(e))}class Ln extends ge{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==q.string){const a=this._getOrReturnCtx(t);return B(a,{code:D.invalid_type,expected:q.string,received:a.parsedType}),se}const r=new Pt;let s;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(s=this._getOrReturnCtx(t,s),B(s,{code:D.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(s=this._getOrReturnCtx(t,s),B(s,{code:D.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=t.data.length>a.value,o=t.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(t,s),i?B(s,{code:D.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&B(s,{code:D.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")Gh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"email",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Ya||(Ya=new RegExp(Bh,"u")),Ya.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"emoji",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")Dh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"uuid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")Uh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"nanoid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Ph.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"cuid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Lh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"cuid2",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")$h.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"ulid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),B(s,{validation:"url",code:D.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"regex",code:D.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Yh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?Kh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Jh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{code:D.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?jh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"duration",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?Wh(t.data,a.version)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"ip",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?Qh(t.data,a.alg)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"jwt",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?ep(t.data,a.version)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"cidr",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?Zh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"base64",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?Xh.test(t.data)||(s=this._getOrReturnCtx(t,s),B(s,{validation:"base64url",code:D.invalid_string,message:a.message}),r.dirty()):Se.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:D.invalid_string,...Z.errToObj(r)})}_addCheck(t){return new Ln({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Z.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Z.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Z.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Z.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Z.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Z.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Z.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Z.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Z.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Z.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Z.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Z.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Z.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...Z.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...Z.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...Z.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Z.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...Z.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Z.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Z.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Z.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Z.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Z.errToObj(n)})}nonempty(t){return this.min(1,Z.errToObj(t))}trim(){return new Ln({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ln({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ln({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ln.create=e=>new Ln({checks:[],typeName:ae.ZodString,coerce:e?.coerce??!1,...ue(e)});function tp(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(e.toFixed(s).replace(".","")),i=Number.parseInt(t.toFixed(s).replace(".",""));return a%i/10**s}class Qr extends ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==q.number){const a=this._getOrReturnCtx(t);return B(a,{code:D.invalid_type,expected:q.number,received:a.parsedType}),se}let r;const s=new Pt;for(const a of this._def.checks)a.kind==="int"?Se.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),B(r,{code:D.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?tp(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),B(r,{code:D.not_finite,message:a.message}),s.dirty()):Se.assertNever(a);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Z.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Z.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Z.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Z.toString(n))}setLimit(t,n,r,s){return new Qr({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Z.toString(s)}]})}_addCheck(t){return new Qr({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Z.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Z.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Z.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Z.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Z.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Z.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Se.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Qr.create=e=>new Qr({checks:[],typeName:ae.ZodNumber,coerce:e?.coerce||!1,...ue(e)});class ws extends ge{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==q.bigint)return this._getInvalidInput(t);let r;const s=new Pt;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),B(r,{code:D.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):Se.assertNever(a);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return B(n,{code:D.invalid_type,expected:q.bigint,received:n.parsedType}),se}gte(t,n){return this.setLimit("min",t,!0,Z.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Z.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Z.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Z.toString(n))}setLimit(t,n,r,s){return new ws({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Z.toString(s)}]})}_addCheck(t){return new ws({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Z.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Z.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Z.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Z.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Z.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}ws.create=e=>new ws({checks:[],typeName:ae.ZodBigInt,coerce:e?.coerce??!1,...ue(e)});class ki extends ge{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==q.boolean){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.boolean,received:r.parsedType}),se}return an(t.data)}}ki.create=e=>new ki({typeName:ae.ZodBoolean,coerce:e?.coerce||!1,...ue(e)});class _a extends ge{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==q.date){const a=this._getOrReturnCtx(t);return B(a,{code:D.invalid_type,expected:q.date,received:a.parsedType}),se}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return B(a,{code:D.invalid_date}),se}const r=new Pt;let s;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(s=this._getOrReturnCtx(t,s),B(s,{code:D.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(s=this._getOrReturnCtx(t,s),B(s,{code:D.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Se.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new _a({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Z.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Z.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}_a.create=e=>new _a({checks:[],coerce:e?.coerce||!1,typeName:ae.ZodDate,...ue(e)});class Wo extends ge{_parse(t){if(this._getType(t)!==q.symbol){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.symbol,received:r.parsedType}),se}return an(t.data)}}Wo.create=e=>new Wo({typeName:ae.ZodSymbol,...ue(e)});class wi extends ge{_parse(t){if(this._getType(t)!==q.undefined){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.undefined,received:r.parsedType}),se}return an(t.data)}}wi.create=e=>new wi({typeName:ae.ZodUndefined,...ue(e)});class Ei extends ge{_parse(t){if(this._getType(t)!==q.null){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.null,received:r.parsedType}),se}return an(t.data)}}Ei.create=e=>new Ei({typeName:ae.ZodNull,...ue(e)});class xi extends ge{constructor(){super(...arguments),this._any=!0}_parse(t){return an(t.data)}}xi.create=e=>new xi({typeName:ae.ZodAny,...ue(e)});class Qo extends ge{constructor(){super(...arguments),this._unknown=!0}_parse(t){return an(t.data)}}Qo.create=e=>new Qo({typeName:ae.ZodUnknown,...ue(e)});class ar extends ge{_parse(t){const n=this._getOrReturnCtx(t);return B(n,{code:D.invalid_type,expected:q.never,received:n.parsedType}),se}}ar.create=e=>new ar({typeName:ae.ZodNever,...ue(e)});class el extends ge{_parse(t){if(this._getType(t)!==q.undefined){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.void,received:r.parsedType}),se}return an(t.data)}}el.create=e=>new el({typeName:ae.ZodVoid,...ue(e)});class kn extends ge{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==q.array)return B(n,{code:D.invalid_type,expected:q.array,received:n.parsedType}),se;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&(B(n,{code:i?D.too_big:D.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(B(n,{code:D.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(B(n,{code:D.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new En(n,i,n.path,o)))).then(i=>Pt.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new En(n,i,n.path,o)));return Pt.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new kn({...this._def,minLength:{value:t,message:Z.toString(n)}})}max(t,n){return new kn({...this._def,maxLength:{value:t,message:Z.toString(n)}})}length(t,n){return new kn({...this._def,exactLength:{value:t,message:Z.toString(n)}})}nonempty(t){return this.min(1,t)}}kn.create=(e,t)=>new kn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ae.ZodArray,...ue(t)});function zr(e){if(e instanceof ot){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=zn.create(zr(r))}return new ot({...e._def,shape:()=>t})}else return e instanceof kn?new kn({...e._def,type:zr(e.element)}):e instanceof zn?zn.create(zr(e.unwrap())):e instanceof Tr?Tr.create(zr(e.unwrap())):e instanceof wr?wr.create(e.items.map(t=>zr(t))):e}class ot extends ge{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Se.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==q.object){const u=this._getOrReturnCtx(t);return B(u,{code:D.invalid_type,expected:q.object,received:u.parsedType}),se}const{status:r,ctx:s}=this._processInputParams(t),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof ar&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const d=a[u],f=s.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new En(s,f,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof ar){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of o)l.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(u==="strict")o.length>0&&(B(s,{code:D.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of o){const f=s.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new En(s,f,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const f=await d.key,h=await d.value;u.push({key:f,value:h,alwaysSet:d.alwaysSet})}return u}).then(u=>Pt.mergeObjectSync(r,u)):Pt.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return Z.errToObj,new ot({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:Z.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new ot({...this._def,unknownKeys:"strip"})}passthrough(){return new ot({...this._def,unknownKeys:"passthrough"})}extend(t){return new ot({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ot({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ae.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new ot({...this._def,catchall:t})}pick(t){const n={};for(const r of Se.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new ot({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Se.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new ot({...this._def,shape:()=>n})}deepPartial(){return zr(this)}partial(t){const n={};for(const r of Se.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new ot({...this._def,shape:()=>n})}required(t){const n={};for(const r of Se.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof zn;)a=a._def.innerType;n[r]=a}return new ot({...this._def,shape:()=>n})}keyof(){return Mc(Se.objectKeys(this.shape))}}ot.create=(e,t)=>new ot({shape:()=>e,unknownKeys:"strip",catchall:ar.create(),typeName:ae.ZodObject,...ue(t)});ot.strictCreate=(e,t)=>new ot({shape:()=>e,unknownKeys:"strict",catchall:ar.create(),typeName:ae.ZodObject,...ue(t)});ot.lazycreate=(e,t)=>new ot({shape:e,unknownKeys:"strip",catchall:ar.create(),typeName:ae.ZodObject,...ue(t)});class ma extends ge{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new Vn(o.ctx.common.issues));return B(n,{code:D.invalid_union,unionErrors:i}),se}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},d=l._parseSync({data:n.data,path:n.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!a&&(a={result:d,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new Vn(l));return B(n,{code:D.invalid_union,unionErrors:o}),se}}get options(){return this._def.options}}ma.create=(e,t)=>new ma({options:e,typeName:ae.ZodUnion,...ue(t)});const Rn=e=>e instanceof Ai?Rn(e.schema):e instanceof xr?Rn(e.innerType()):e instanceof Sa?[e.value]:e instanceof Er?e.options:e instanceof ka?Se.objectValues(e.enum):e instanceof Ea?Rn(e._def.innerType):e instanceof wi?[void 0]:e instanceof Ei?[null]:e instanceof zn?[void 0,...Rn(e.unwrap())]:e instanceof Tr?[null,...Rn(e.unwrap())]:e instanceof Pc||e instanceof Ta?Rn(e.unwrap()):e instanceof xa?Rn(e._def.innerType):[];class lo extends ge{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==q.object)return B(n,{code:D.invalid_type,expected:q.object,received:n.parsedType}),se;const r=this.discriminator,s=n.data[r],a=this.optionsMap.get(s);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(B(n,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),se)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const a of n){const i=Rn(a.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,a)}}return new lo({typeName:ae.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...ue(r)})}}function Ti(e,t){const n=Yn(e),r=Yn(t);if(e===t)return{valid:!0,data:e};if(n===q.object&&r===q.object){const s=Se.objectKeys(t),a=Se.objectKeys(e).filter(o=>s.indexOf(o)!==-1),i={...e,...t};for(const o of a){const l=Ti(e[o],t[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===q.array&&r===q.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let a=0;a<e.length;a++){const i=e[a],o=t[a],l=Ti(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===q.date&&r===q.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ya extends ge{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(a,i)=>{if(Ko(a)||Ko(i))return se;const o=Ti(a.value,i.value);return o.valid?((Jo(a)||Jo(i))&&n.dirty(),{status:n.value,value:o.data}):(B(r,{code:D.invalid_intersection_types}),se)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ya.create=(e,t,n)=>new ya({left:e,right:t,typeName:ae.ZodIntersection,...ue(n)});class wr extends ge{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==q.array)return B(r,{code:D.invalid_type,expected:q.array,received:r.parsedType}),se;if(r.data.length<this._def.items.length)return B(r,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),se;!this._def.rest&&r.data.length>this._def.items.length&&(B(r,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new En(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>Pt.mergeArray(n,i)):Pt.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new wr({...this._def,rest:t})}}wr.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wr({items:e,typeName:ae.ZodTuple,rest:null,...ue(t)})};class ba extends ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==q.object)return B(r,{code:D.invalid_type,expected:q.object,received:r.parsedType}),se;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in r.data)s.push({key:a._parse(new En(r,o,r.path,o)),value:i._parse(new En(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Pt.mergeObjectAsync(n,s):Pt.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof ge?new ba({keyType:t,valueType:n,typeName:ae.ZodRecord,...ue(r)}):new ba({keyType:Ln.create(),valueType:t,typeName:ae.ZodRecord,...ue(n)})}}class tl extends ge{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==q.map)return B(r,{code:D.invalid_type,expected:q.map,received:r.parsedType}),se;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new En(r,o,r.path,[u,"key"])),value:a._parse(new En(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return se;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return se;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),o.set(u.value,d.value)}return{status:n.value,value:o}}}}tl.create=(e,t,n)=>new tl({valueType:t,keyType:e,typeName:ae.ZodMap,...ue(n)});class Es extends ge{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==q.set)return B(r,{code:D.invalid_type,expected:q.set,received:r.parsedType}),se;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(B(r,{code:D.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(B(r,{code:D.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const d of l){if(d.status==="aborted")return se;d.status==="dirty"&&n.dirty(),u.add(d.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new En(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(t,n){return new Es({...this._def,minSize:{value:t,message:Z.toString(n)}})}max(t,n){return new Es({...this._def,maxSize:{value:t,message:Z.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Es.create=(e,t)=>new Es({valueType:e,minSize:null,maxSize:null,typeName:ae.ZodSet,...ue(t)});class Ai extends ge{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Ai.create=(e,t)=>new Ai({getter:e,typeName:ae.ZodLazy,...ue(t)});class Sa extends ge{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return B(n,{received:n.data,code:D.invalid_literal,expected:this._def.value}),se}return{status:"valid",value:t.data}}get value(){return this._def.value}}Sa.create=(e,t)=>new Sa({value:e,typeName:ae.ZodLiteral,...ue(t)});function Mc(e,t){return new Er({values:e,typeName:ae.ZodEnum,...ue(t)})}class Er extends ge{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return B(n,{expected:Se.joinValues(r),received:n.parsedType,code:D.invalid_type}),se}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return B(n,{received:n.data,code:D.invalid_enum_value,options:r}),se}return an(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Er.create(t,{...this._def,...n})}exclude(t,n=this._def){return Er.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Er.create=Mc;class ka extends ge{_parse(t){const n=Se.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==q.string&&r.parsedType!==q.number){const s=Se.objectValues(n);return B(r,{expected:Se.joinValues(s),received:r.parsedType,code:D.invalid_type}),se}if(this._cache||(this._cache=new Set(Se.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Se.objectValues(n);return B(r,{received:r.data,code:D.invalid_enum_value,options:s}),se}return an(t.data)}get enum(){return this._def.values}}ka.create=(e,t)=>new ka({values:e,typeName:ae.ZodNativeEnum,...ue(t)});class wa extends ge{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==q.promise&&n.common.async===!1)return B(n,{code:D.invalid_type,expected:q.promise,received:n.parsedType}),se;const r=n.parsedType===q.promise?n.data:Promise.resolve(n.data);return an(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}wa.create=(e,t)=>new wa({type:e,typeName:ae.ZodPromise,...ue(t)});class xr extends ge{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ae.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,a={addIssue:i=>{B(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return se;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?se:l.status==="dirty"||n.value==="dirty"?fs(l.value):l});{if(n.value==="aborted")return se;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?se:o.status==="dirty"||n.value==="dirty"?fs(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?se:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?se:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Wr(i))return se;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>Wr(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):se);Se.assertNever(s)}}xr.create=(e,t,n)=>new xr({schema:e,typeName:ae.ZodEffects,effect:t,...ue(n)});xr.createWithPreprocess=(e,t,n)=>new xr({schema:t,effect:{type:"preprocess",transform:e},typeName:ae.ZodEffects,...ue(n)});class zn extends ge{_parse(t){return this._getType(t)===q.undefined?an(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}zn.create=(e,t)=>new zn({innerType:e,typeName:ae.ZodOptional,...ue(t)});class Tr extends ge{_parse(t){return this._getType(t)===q.null?an(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Tr.create=(e,t)=>new Tr({innerType:e,typeName:ae.ZodNullable,...ue(t)});class Ea extends ge{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===q.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ea.create=(e,t)=>new Ea({innerType:e,typeName:ae.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ue(t)});class xa extends ge{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ga(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Vn(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Vn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}xa.create=(e,t)=>new xa({innerType:e,typeName:ae.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ue(t)});class nl extends ge{_parse(t){if(this._getType(t)!==q.nan){const r=this._getOrReturnCtx(t);return B(r,{code:D.invalid_type,expected:q.nan,received:r.parsedType}),se}return{status:"valid",value:t.data}}}nl.create=e=>new nl({typeName:ae.ZodNaN,...ue(e)});class Pc extends ge{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class uo extends ge{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?se:a.status==="dirty"?(n.dirty(),fs(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?se:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new uo({in:t,out:n,typeName:ae.ZodPipeline})}}class Ta extends ge{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Wr(s)&&(s.value=Object.freeze(s.value)),s);return ga(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Ta.create=(e,t)=>new Ta({innerType:e,typeName:ae.ZodReadonly,...ue(t)});var ae;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ae||(ae={}));const L=Ln.create,np=Qr.create,Ii=ki.create,Lt=xi.create;ar.create;const nr=kn.create,Ve=ot.create,co=ma.create,Ua=lo.create;ya.create;wr.create;const Lc=ba.create,X=Sa.create,$c=Er.create,rp=ka.create;wa.create;zn.create;Tr.create;var sp=Ve({name:L(),arguments:L()}),ap=Ve({id:L(),type:X("function"),function:sp}),za=Ve({id:L(),role:L(),content:L().optional(),name:L().optional()}),ip=Ve({type:X("text"),text:L()}),Dc=Ve({type:X("binary"),mimeType:L(),id:L().optional(),url:L().optional(),data:L().optional(),filename:L().optional()}),Uc=(e,t)=>{!e.id&&!e.url&&!e.data&&t.addIssue({code:D.custom,message:"BinaryInputContent requires at least one of id, url, or data.",path:["id"]})};Dc.superRefine((e,t)=>{Uc(e,t)});var op=Ua("type",[ip,Dc]),lp=op.superRefine((e,t)=>{e.type==="binary"&&Uc(e,t)}),up=za.extend({role:X("developer"),content:L()}),cp=za.extend({role:X("system"),content:L()}),dp=za.extend({role:X("assistant"),content:L().optional(),toolCalls:nr(ap).optional()}),fp=za.extend({role:X("user"),content:co([L(),nr(lp)])}),vp=Ve({id:L(),content:L(),role:X("tool"),toolCallId:L(),error:L().optional()}),hp=Ve({id:L(),role:X("activity"),activityType:L(),content:Lc(Lt())}),zc=Ua("role",[up,cp,dp,fp,vp,hp]);co([X("developer"),X("system"),X("assistant"),X("user"),X("tool"),X("activity")]);var pp=Ve({description:L(),value:L()}),gp=Ve({name:L(),description:L(),parameters:Lt()}),_p=Ve({threadId:L(),runId:L(),parentRunId:L().optional(),state:Lt(),messages:nr(zc),tools:nr(gp),context:nr(pp),forwardedProps:Lt()}),mp=Lt(),We=class extends Error{constructor(e){super(e)}},rl=class extends We{constructor(){super("Connect not implemented. This method is not supported by the current agent.")}},jc=co([X("developer"),X("system"),X("assistant"),X("user")]),R=(e=>(e.TEXT_MESSAGE_START="TEXT_MESSAGE_START",e.TEXT_MESSAGE_CONTENT="TEXT_MESSAGE_CONTENT",e.TEXT_MESSAGE_END="TEXT_MESSAGE_END",e.TEXT_MESSAGE_CHUNK="TEXT_MESSAGE_CHUNK",e.THINKING_TEXT_MESSAGE_START="THINKING_TEXT_MESSAGE_START",e.THINKING_TEXT_MESSAGE_CONTENT="THINKING_TEXT_MESSAGE_CONTENT",e.THINKING_TEXT_MESSAGE_END="THINKING_TEXT_MESSAGE_END",e.TOOL_CALL_START="TOOL_CALL_START",e.TOOL_CALL_ARGS="TOOL_CALL_ARGS",e.TOOL_CALL_END="TOOL_CALL_END",e.TOOL_CALL_CHUNK="TOOL_CALL_CHUNK",e.TOOL_CALL_RESULT="TOOL_CALL_RESULT",e.THINKING_START="THINKING_START",e.THINKING_END="THINKING_END",e.STATE_SNAPSHOT="STATE_SNAPSHOT",e.STATE_DELTA="STATE_DELTA",e.MESSAGES_SNAPSHOT="MESSAGES_SNAPSHOT",e.ACTIVITY_SNAPSHOT="ACTIVITY_SNAPSHOT",e.ACTIVITY_DELTA="ACTIVITY_DELTA",e.RAW="RAW",e.CUSTOM="CUSTOM",e.RUN_STARTED="RUN_STARTED",e.RUN_FINISHED="RUN_FINISHED",e.RUN_ERROR="RUN_ERROR",e.STEP_STARTED="STEP_STARTED",e.STEP_FINISHED="STEP_FINISHED",e))(R||{}),Fe=Ve({type:rp(R),timestamp:np().optional(),rawEvent:Lt().optional()}),yp=Fe.extend({type:X("TEXT_MESSAGE_START"),messageId:L(),role:jc.default("assistant")}),Gc=Fe.extend({type:X("TEXT_MESSAGE_CONTENT"),messageId:L(),delta:L().refine(e=>e.length>0,"Delta must not be an empty string")}),bp=Fe.extend({type:X("TEXT_MESSAGE_END"),messageId:L()}),Sp=Fe.extend({type:X("TEXT_MESSAGE_CHUNK"),messageId:L().optional(),role:jc.optional(),delta:L().optional()}),kp=Fe.extend({type:X("THINKING_TEXT_MESSAGE_START")}),wp=Gc.omit({messageId:!0,type:!0}).extend({type:X("THINKING_TEXT_MESSAGE_CONTENT")}),Ep=Fe.extend({type:X("THINKING_TEXT_MESSAGE_END")}),xp=Fe.extend({type:X("TOOL_CALL_START"),toolCallId:L(),toolCallName:L(),parentMessageId:L().optional()}),Tp=Fe.extend({type:X("TOOL_CALL_ARGS"),toolCallId:L(),delta:L()}),Ap=Fe.extend({type:X("TOOL_CALL_END"),toolCallId:L()}),Ip=Fe.extend({messageId:L(),type:X("TOOL_CALL_RESULT"),toolCallId:L(),content:L(),role:X("tool").optional()}),Cp=Fe.extend({type:X("TOOL_CALL_CHUNK"),toolCallId:L().optional(),toolCallName:L().optional(),parentMessageId:L().optional(),delta:L().optional()}),Np=Fe.extend({type:X("THINKING_START"),title:L().optional()}),Rp=Fe.extend({type:X("THINKING_END")}),Op=Fe.extend({type:X("STATE_SNAPSHOT"),snapshot:mp}),Mp=Fe.extend({type:X("STATE_DELTA"),delta:nr(Lt())}),Pp=Fe.extend({type:X("MESSAGES_SNAPSHOT"),messages:nr(zc)}),Lp=Fe.extend({type:X("ACTIVITY_SNAPSHOT"),messageId:L(),activityType:L(),content:Lc(Lt()),replace:Ii().optional().default(!0)}),$p=Fe.extend({type:X("ACTIVITY_DELTA"),messageId:L(),activityType:L(),patch:nr(Lt())}),Dp=Fe.extend({type:X("RAW"),event:Lt(),source:L().optional()}),Up=Fe.extend({type:X("CUSTOM"),name:L(),value:Lt()}),zp=Fe.extend({type:X("RUN_STARTED"),threadId:L(),runId:L(),parentRunId:L().optional(),input:_p.optional()}),jp=Fe.extend({type:X("RUN_FINISHED"),threadId:L(),runId:L(),result:Lt().optional()}),Gp=Fe.extend({type:X("RUN_ERROR"),message:L(),code:L().optional()}),Bp=Fe.extend({type:X("STEP_STARTED"),stepName:L()}),Fp=Fe.extend({type:X("STEP_FINISHED"),stepName:L()}),Bc=Ua("type",[yp,Gc,bp,Sp,Np,Rp,kp,wp,Ep,xp,Tp,Ap,Cp,Ip,Op,Mp,Pp,Lp,$p,Dp,Up,zp,jp,Gp,Bp,Fp]);function tt(e){return typeof e=="function"}function Vp(e){return tt(e?.lift)}function In(e){return function(t){if(Vp(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var Ci=function(e,t){return Ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},Ci(e,t)};function as(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ci(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function qp(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(d){try{u(r.next(d))}catch(f){i(f)}}function l(d){try{u(r.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function Fc(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(d){return l([u,d])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(d){u=[6,d],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function es(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ni(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,a=[],i;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(o){i={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function Ri(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function qr(e){return this instanceof qr?(this.v=e,this):new qr(e)}function Hp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(v){return function(p){return Promise.resolve(p).then(v,f)}}function o(v,p){r[v]&&(s[v]=function(b){return new Promise(function(m,S){a.push([v,b,m,S])>1||l(v,b)})},p&&(s[v]=p(s[v])))}function l(v,p){try{u(r[v](p))}catch(b){h(a[0][3],b)}}function u(v){v.value instanceof qr?Promise.resolve(v.value.v).then(d,f):h(a[0][2],v)}function d(v){l("next",v)}function f(v){l("throw",v)}function h(v,p){v(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function Zp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof es=="function"?es(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(i){return new Promise(function(o,l){i=e[a](i),s(o,l,i.done,i.value)})}}function s(a,i,o,l){Promise.resolve(l).then(function(u){a({value:u,done:o})},i)}}var Vc=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function qc(e){return tt(e?.then)}function fo(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Wa=fo(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Oi(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ja=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=es(i),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(b){t={error:b}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}else i.remove(this);var d=this.initialTeardown;if(tt(d))try{d()}catch(b){a=b instanceof Wa?b.errors:[b]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=es(f),v=h.next();!v.done;v=h.next()){var p=v.value;try{sl(p)}catch(b){a=a??[],b instanceof Wa?a=Ri(Ri([],Ni(a)),Ni(b.errors)):a.push(b)}}}catch(b){r={error:b}}finally{try{v&&!v.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(a)throw new Wa(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)sl(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&Oi(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&Oi(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),Hc=ja.EMPTY;function Zc(e){return e instanceof ja||e&&"closed"in e&&tt(e.remove)&&tt(e.add)&&tt(e.unsubscribe)}function sl(e){tt(e)?e():e.unsubscribe()}var Xp={Promise:void 0},Kp={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Ri([e,t],Ni(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Xc(e){Kp.setTimeout(function(){throw e})}function Mi(){}function js(e){e()}var vo=(function(e){as(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Zc(n)&&n.add(r)):r.destination=Wp,r}return t.create=function(n,r,s){return new Pi(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(ja),Jp=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Ls(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Ls(r)}else Ls(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Ls(n)}},e})(),Pi=(function(e){as(t,e);function t(n,r,s){var a=e.call(this)||this,i;return tt(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,a.destination=new Jp(i),a}return t})(vo);function Ls(e){Xc(e)}function Yp(e){throw e}var Wp={closed:!0,next:Mi,error:Yp,complete:Mi},ho=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function po(e){return e}function al(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Kc(e)}function Kc(e){return e.length===0?po:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var $t=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,a=eg(t)?t:new Pi(t,n,r);return js(function(){var i=s,o=i.operator,l=i.source;a.add(o?o.call(a,l):l?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=il(n),new n(function(s,a){var i=new Pi({next:function(o){try{t(o)}catch(l){a(l),i.unsubscribe()}},error:a,complete:s});r.subscribe(i)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[ho]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Kc(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=il(t),new t(function(r,s){var a;n.subscribe(function(i){return a=i},function(i){return s(i)},function(){return r(a)})})},e.create=function(t){return new e(t)},e})();function il(e){var t;return(t=e??Xp.Promise)!==null&&t!==void 0?t:Promise}function Qp(e){return e&&tt(e.next)&&tt(e.error)&&tt(e.complete)}function eg(e){return e&&e instanceof vo||Qp(e)&&Zc(e)}function Jc(e){return tt(e[ho])}function Yc(e){return Symbol.asyncIterator&&tt(e?.[Symbol.asyncIterator])}function Wc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function tg(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qc=tg();function ed(e){return tt(e?.[Qc])}function td(e){return Hp(this,arguments,function(){var n,r,s,a;return Fc(this,function(i){switch(i.label){case 0:n=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,qr(n.read())];case 3:return r=i.sent(),s=r.value,a=r.done,a?[4,qr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,qr(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function nd(e){return tt(e?.getReader)}function Zn(e){if(e instanceof $t)return e;if(e!=null){if(Jc(e))return ng(e);if(Vc(e))return rg(e);if(qc(e))return sg(e);if(Yc(e))return rd(e);if(ed(e))return ag(e);if(nd(e))return ig(e)}throw Wc(e)}function ng(e){return new $t(function(t){var n=e[ho]();if(tt(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function rg(e){return new $t(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function sg(e){return new $t(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Xc)})}function ag(e){return new $t(function(t){var n,r;try{for(var s=es(e),a=s.next();!a.done;a=s.next()){var i=a.value;if(t.next(i),t.closed)return}}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t.complete()})}function rd(e){return new $t(function(t){og(e,t).catch(function(n){return t.error(n)})})}function ig(e){return rd(td(e))}function og(e,t){var n,r,s,a;return qp(this,void 0,void 0,function(){var i,o;return Fc(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=Zp(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function xn(e,t,n,r,s){return new lg(e,t,n,r,s)}var lg=(function(e){as(t,e);function t(n,r,s,a,i,o){var l=e.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(d){n.error(d)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(d){n.error(d)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(vo),sd={now:function(){return(sd.delegate||Date).now()},delegate:void 0};function ug(e){return e&&tt(e.schedule)}function cg(e){return e[e.length-1]}function dg(e){return ug(cg(e))?e.pop():void 0}function br(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var a=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!s)return a}function Li(e){return In(function(t,n){var r=null,s=!1,a;r=t.subscribe(xn(n,void 0,void 0,function(i){a=Zn(e(i,Li(e)(t))),r?(r.unsubscribe(),r=null,a.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,a.subscribe(n))})}function ad(e,t){return t===void 0&&(t=0),In(function(n,r){n.subscribe(xn(r,function(s){return br(r,e,function(){return r.next(s)},t)},function(){return br(r,e,function(){return r.complete()},t)},function(s){return br(r,e,function(){return r.error(s)},t)}))})}function id(e,t){return t===void 0&&(t=0),In(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function fg(e,t){return Zn(e).pipe(id(t),ad(t))}function vg(e,t){return Zn(e).pipe(id(t),ad(t))}function hg(e,t){return new $t(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function pg(e,t){return new $t(function(n){var r;return br(n,t,function(){r=e[Qc](),br(n,t,function(){var s,a,i;try{s=r.next(),a=s.value,i=s.done}catch(o){n.error(o);return}i?n.complete():n.next(a)},0,!0)}),function(){return tt(r?.return)&&r.return()}})}function od(e,t){if(!e)throw new Error("Iterable cannot be null");return new $t(function(n){br(n,t,function(){var r=e[Symbol.asyncIterator]();br(n,t,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function gg(e,t){return od(td(e),t)}function _g(e,t){if(e!=null){if(Jc(e))return fg(e,t);if(Vc(e))return hg(e,t);if(qc(e))return vg(e,t);if(Yc(e))return od(e,t);if(ed(e))return pg(e,t);if(nd(e))return gg(e,t)}throw Wc(e)}function Aa(e,t){return t?_g(e,t):Zn(e)}function $i(e,t){return In(function(n,r){var s=0;n.subscribe(xn(r,function(a){r.next(e.call(t,a,s++))}))})}function mg(e,t,n,r,s,a,i,o){var l=[],u=0,d=0,f=!1,h=function(){f&&!l.length&&!u&&t.complete()},v=function(b){return u<r?p(b):l.push(b)},p=function(b){u++;var m=!1;Zn(n(b,d++)).subscribe(xn(t,function(S){t.next(S)},function(){m=!0},void 0,function(){if(m)try{u--;for(var S=function(){var k=l.shift();i||p(k)};l.length&&u<r;)S();h()}catch(k){t.error(k)}}))};return e.subscribe(xn(t,v,function(){f=!0,h()})),function(){}}function ir(e,t,n){return n===void 0&&(n=1/0),tt(t)?ir(function(r,s){return $i(function(a,i){return t(r,a,s,i)})(Zn(e(r,s)))},n):(typeof t=="number"&&(n=t),In(function(r,s){return mg(r,s,e,n)}))}function yg(e){return e===void 0&&(e=1/0),ir(po,e)}function ld(e,t){return tt(t)?ir(e,t,1):ir(e,1)}var bg=fo(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ar=(function(e){as(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new ol(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new bg},t.prototype.next=function(n){var r=this;js(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=es(r.currentObservers),o=i.next();!o.done;o=i.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;js(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;js(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,a=s.hasError,i=s.isStopped,o=s.observers;return a||i?Hc:(this.currentObservers=null,o.push(n),new ja(function(){r.currentObservers=null,Oi(o,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,a=r.thrownError,i=r.isStopped;s?n.error(a):i&&n.complete()},t.prototype.asObservable=function(){var n=new $t;return n.source=this,n},t.create=function(n,r){return new ol(n,r)},t})($t),ol=(function(e){as(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:Hc},t})(Ar);function Sg(e){return In(function(t,n){var r=!1;t.subscribe(xn(n,function(s){r=!0,n.next(s)},function(){r||n.next(e),n.complete()}))})}var ud=new $t(function(e){return e.complete()});function st(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=dg(e);return Aa(e,n)}function He(e,t){var n=tt(e)?e:function(){return e},r=function(s){return s.error(n())};return new $t(r)}var kg=fo(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Di(e){return In(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}var cd=(function(e){as(t,e);function t(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=sd);var a=e.call(this)||this;return a._bufferSize=n,a._windowTime=r,a._timestampProvider=s,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,n),a._windowTime=Math.max(1,r),a}return t.prototype.next=function(n){var r=this,s=r.isStopped,a=r._buffer,i=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(a.push(n),!i&&a.push(o.now()+l)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,a=s._infiniteTimeWindow,i=s._buffer,o=i.slice(),l=0;l<o.length&&!n.closed;l+=a?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},t.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,a=n._buffer,i=n._infiniteTimeWindow,o=(i?1:2)*r;if(r<1/0&&o<a.length&&a.splice(0,a.length-o),!i){for(var l=s.now(),u=0,d=1;d<a.length&&a[d]<=l;d+=2)u=d;u&&a.splice(0,u+1)}},t})(Ar);function wg(e,t){return In(function(n,r){var s=null,a=0,i=!1,o=function(){return i&&!s&&r.complete()};n.subscribe(xn(r,function(l){s?.unsubscribe();var u=0,d=a++;Zn(e(l,d)).subscribe(s=xn(r,function(f){return r.next(t?t(l,f,d,u++):f)},function(){s=null,o()}))},function(){i=!0,o()}))})}function ll(e){return In(function(t,n){Zn(e).subscribe(xn(n,function(){return n.complete()},Mi)),!n.closed&&t.subscribe(n)})}function Eg(e,t,n){var r=tt(e)||t||n?{next:e,error:t,complete:n}:e;return r?In(function(s,a){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var o=!0;s.subscribe(xn(a,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),a.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),a.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),a.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):po}function ul(e,t){return new Promise(function(n,r){var s=!1,a;e.subscribe({next:function(i){a=i,s=!0},error:r,complete:function(){s?n(a):r(new kg)}})})}function xg(e){return new $t(function(t){Zn(e()).subscribe(t)})}const bt=[];for(let e=0;e<256;++e)bt.push((e+256).toString(16).slice(1));function Tg(e,t=0){return(bt[e[t+0]]+bt[e[t+1]]+bt[e[t+2]]+bt[e[t+3]]+"-"+bt[e[t+4]]+bt[e[t+5]]+"-"+bt[e[t+6]]+bt[e[t+7]]+"-"+bt[e[t+8]]+bt[e[t+9]]+"-"+bt[e[t+10]]+bt[e[t+11]]+bt[e[t+12]]+bt[e[t+13]]+bt[e[t+14]]+bt[e[t+15]]).toLowerCase()}let Qa;const Ag=new Uint8Array(16);function Ig(){if(!Qa){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Qa=crypto.getRandomValues.bind(crypto)}return Qa(Ag)}const Cg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),cl={randomUUID:Cg};function os(e,t,n){if(cl.randomUUID&&!e)return cl.randomUUID();e=e||{};const r=e.random??e.rng?.()??Ig();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Tg(r)}function dl(e){return` \r
	`.indexOf(e)>=0}function dd(e){for(var t=["topLevel"],n=0,r,s,a,i=function(k){return t.push(k)},o=function(k){return t[t.length-1]=k},l=function(k){r==null&&(r=n,s=t.length,a=k)},u=function(k){k===a&&(r=void 0,s=void 0,a=void 0)},d=function(){return t.pop()},f=function(){return n--},h=function(k){if("0"<=k&&k<="9"){i("number");return}switch(k){case'"':i("string");return;case"-":i("numberNeedsDigit");return;case"t":i("true");return;case"f":i("false");return;case"n":i("null");return;case"[":i("arrayNeedsValue");return;case"{":i("objectNeedsKey");return}},v=e.length;n<v;n++){var p=e[n];switch(t[t.length-1]){case"topLevel":h(p);break;case"string":switch(p){case'"':d();break;case"\\":l("stringEscape"),i("stringEscaped");break}break;case"stringEscaped":p==="u"?i("stringUnicode"):(u("stringEscape"),d());break;case"stringUnicode":n-e.lastIndexOf("u",n)===4&&(u("stringEscape"),d());break;case"number":p==="."?o("numberNeedsDigit"):p==="e"||p==="E"?o("numberNeedsExponent"):(p<"0"||p>"9")&&(f(),d());break;case"numberNeedsDigit":o("number");break;case"numberNeedsExponent":o(p==="+"||p==="-"?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(p<"a"||p>"z")&&(f(),d());break;case"arrayNeedsValue":p==="]"?d():dl(p)||(u("collectionItem"),o("arrayNeedsComma"),h(p));break;case"arrayNeedsComma":p==="]"?d():p===","&&(l("collectionItem"),o("arrayNeedsValue"));break;case"objectNeedsKey":p==="}"?d():p==='"'&&(l("collectionItem"),o("objectNeedsColon"),i("string"));break;case"objectNeedsColon":p===":"&&o("objectNeedsValue");break;case"objectNeedsValue":dl(p)||(u("collectionItem"),o("objectNeedsComma"),h(p));break;case"objectNeedsComma":p==="}"?d():p===","&&(l("collectionItem"),o("objectNeedsKey"));break}}s!=null&&(t.length=s);for(var b=[r!=null?e.slice(0,r):e],m=function(k){return b.push(k.slice(e.length-e.lastIndexOf(k[0])))},S=t.length-1;S>=0;S--)switch(t[S]){case"string":b.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":b.push("0");break;case"true":m("true");break;case"false":m("false");break;case"null":m("null");break;case"arrayNeedsValue":case"arrayNeedsComma":b.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":b.push("}");break}return b.join("")}function Ng(){let e=0,t=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,(n&128)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function ei(e,t,n){for(let a=0;a<28;a=a+7){const i=e>>>a,o=!(!(i>>>7)&&t==0),l=(o?i|128:i)&255;if(n.push(l),!o)return}const r=e>>>28&15|(t&7)<<4,s=t>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let a=3;a<31;a=a+7){const i=t>>>a,o=!!(i>>>7),l=(o?i|128:i)&255;if(n.push(l),!o)return}n.push(t>>>31&1)}}const Gs=4294967296;function fl(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function a(i,o){const l=Number(e.slice(i,o));s*=n,r=r*n+l,r>=Gs&&(s=s+(r/Gs|0),r=r%Gs)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?vd(r,s):go(r,s)}function Rg(e,t){let n=go(e,t);const r=n.hi&2147483648;r&&(n=vd(n.lo,n.hi));const s=fd(n.lo,n.hi);return r?"-"+s:s}function fd(e,t){if({lo:e,hi:t}=Og(e,t),t<=2097151)return String(Gs*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,s=t>>16&65535;let a=n+r*6777216+s*6710656,i=r+s*8147497,o=s*2;const l=1e7;return a>=l&&(i+=Math.floor(a/l),a%=l),i>=l&&(o+=Math.floor(i/l),i%=l),o.toString()+vl(i)+vl(a)}function Og(e,t){return{lo:e>>>0,hi:t>>>0}}function go(e,t){return{lo:e|0,hi:t|0}}function vd(e,t){return t=~t,e?e=~e+1:t+=1,go(e,t)}const vl=e=>{const t=String(e);return"0000000".slice(t.length)+t};function hl(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function Mg(){let e=this.buf[this.pos++],t=e&127;if((e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,(e&128)==0)return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;(e&128)!==0&&n<10;n++)e=this.buf[this.pos++];if((e&128)!=0)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var pl={};const mn=Pg();function Pg(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof pl!="object"||pl.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>r||o<n)throw new Error(`invalid int64: ${i}`);return o},uParse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>a||o<s)throw new Error(`invalid uint64: ${i}`);return o},enc(i){return e.setBigInt64(0,this.parse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(i){return e.setBigInt64(0,this.uParse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigInt64(0,!0)},uDec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),gl(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),_l(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),gl(n),fl(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),_l(n),fl(n)},dec(n,r){return Rg(n,r)},uDec(n,r){return fd(n,r)}}}function gl(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function _l(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const ti=Symbol.for("@bufbuild/protobuf/text-encoding");function hd(){if(globalThis[ti]==null){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[ti]={encodeUtf8(n){return e.encode(n)},decodeUtf8(n){return t.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[ti]}var Wn;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(Wn||(Wn={}));const Lg=34028234663852886e22,$g=-34028234663852886e22,Dg=4294967295,Ug=2147483647,zg=-2147483648;class $e{constructor(t=hd().encodeUtf8){this.encodeUtf8=t,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let t=0;for(let s=0;s<this.chunks.length;s++)t+=this.chunks[s].length;let n=new Uint8Array(t),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(ml(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return ni(t),hl(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.encodeUtf8(t);return this.uint32(n.byteLength),this.raw(n)}float(t){jg(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){ml(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){ni(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return ni(t),t=(t<<1^t>>31)>>>0,hl(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=mn.enc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=mn.uEnc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(t){let n=mn.enc(t);return ei(n.lo,n.hi,this.buf),this}sint64(t){const n=mn.enc(t),r=n.hi>>31,s=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return ei(s,a,this.buf),this}uint64(t){const n=mn.uEnc(t);return ei(n.lo,n.hi,this.buf),this}}class K{constructor(t,n=hd().decodeUtf8){this.decodeUtf8=n,this.varint64=Ng,this.uint32=Mg,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength)}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t,n){let r=this.pos;switch(t){case Wn.Varint:for(;this.buf[this.pos++]&128;);break;case Wn.Bit64:this.pos+=4;case Wn.Bit32:this.pos+=4;break;case Wn.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Wn.StartGroup:for(;;){const[a,i]=this.tag();if(i===Wn.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(i,a)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return mn.dec(...this.varint64())}uint64(){return mn.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,mn.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return mn.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return mn.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.decodeUtf8(this.bytes())}}function ni(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>Ug||e<zg)throw new Error("invalid int32: "+e)}function ml(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>Dg||e<0)throw new Error("invalid uint32: "+e)}function jg(e){if(typeof e=="string"){const t=e;if(e=Number(e),Number.isNaN(e)&&t!=="NaN")throw new Error("invalid float32: "+t)}else if(typeof e!="number")throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>Lg||e<$g))throw new Error("invalid float32: "+e)}function ri(){return{fields:{}}}var vs={encode(e,t=new $e){return Object.entries(e.fields).forEach(([n,r])=>{r!==void 0&&Ui.encode({key:n,value:r},t.uint32(10).fork()).join()}),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=ri();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;const i=Ui.decode(n,n.uint32());i.value!==void 0&&(s.fields[i.key]=i.value);continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return vs.fromPartial(e??{})},fromPartial(e){var t;const n=ri();return n.fields=Object.entries((t=e.fields)!=null?t:{}).reduce((r,[s,a])=>(a!==void 0&&(r[s]=a),r),{}),n},wrap(e){const t=ri();if(e!==void 0)for(const n of Object.keys(e))t.fields[n]=e[n];return t},unwrap(e){const t={};if(e.fields)for(const n of Object.keys(e.fields))t[n]=e.fields[n];return t}};function yl(){return{key:"",value:void 0}}var Ui={encode(e,t=new $e){return e.key!==""&&t.uint32(10).string(e.key),e.value!==void 0&&we.encode(we.wrap(e.value),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=yl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.key=n.string();continue}case 2:{if(a!==18)break;s.value=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ui.fromPartial(e??{})},fromPartial(e){var t,n;const r=yl();return r.key=(t=e.key)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function si(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}var we={encode(e,t=new $e){return e.nullValue!==void 0&&t.uint32(8).int32(e.nullValue),e.numberValue!==void 0&&t.uint32(17).double(e.numberValue),e.stringValue!==void 0&&t.uint32(26).string(e.stringValue),e.boolValue!==void 0&&t.uint32(32).bool(e.boolValue),e.structValue!==void 0&&vs.encode(vs.wrap(e.structValue),t.uint32(42).fork()).join(),e.listValue!==void 0&&hs.encode(hs.wrap(e.listValue),t.uint32(50).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=si();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.nullValue=n.int32();continue}case 2:{if(a!==17)break;s.numberValue=n.double();continue}case 3:{if(a!==26)break;s.stringValue=n.string();continue}case 4:{if(a!==32)break;s.boolValue=n.bool();continue}case 5:{if(a!==42)break;s.structValue=vs.unwrap(vs.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.listValue=hs.unwrap(hs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return we.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i;const o=si();return o.nullValue=(t=e.nullValue)!=null?t:void 0,o.numberValue=(n=e.numberValue)!=null?n:void 0,o.stringValue=(r=e.stringValue)!=null?r:void 0,o.boolValue=(s=e.boolValue)!=null?s:void 0,o.structValue=(a=e.structValue)!=null?a:void 0,o.listValue=(i=e.listValue)!=null?i:void 0,o},wrap(e){const t=si();if(e===null)t.nullValue=0;else if(typeof e=="boolean")t.boolValue=e;else if(typeof e=="number")t.numberValue=e;else if(typeof e=="string")t.stringValue=e;else if(globalThis.Array.isArray(e))t.listValue=e;else if(typeof e=="object")t.structValue=e;else if(typeof e<"u")throw new globalThis.Error("Unsupported any value type: "+typeof e);return t},unwrap(e){if(e.stringValue!==void 0)return e.stringValue;if(e?.numberValue!==void 0)return e.numberValue;if(e?.boolValue!==void 0)return e.boolValue;if(e?.structValue!==void 0)return e.structValue;if(e?.listValue!==void 0)return e.listValue;if(e?.nullValue!==void 0)return null}};function ai(){return{values:[]}}var hs={encode(e,t=new $e){for(const n of e.values)we.encode(we.wrap(n),t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=ai();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.values.push(we.unwrap(we.decode(n,n.uint32())));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return hs.fromPartial(e??{})},fromPartial(e){var t;const n=ai();return n.values=((t=e.values)==null?void 0:t.map(r=>r))||[],n},wrap(e){const t=ai();return t.values=e??[],t},unwrap(e){return e?.hasOwnProperty("values")&&globalThis.Array.isArray(e.values)?e.values:e}},pd=(e=>(e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.REPLACE=2]="REPLACE",e[e.MOVE=3]="MOVE",e[e.COPY=4]="COPY",e[e.TEST=5]="TEST",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(pd||{});function bl(){return{op:0,path:"",from:void 0,value:void 0}}var Bs={encode(e,t=new $e){return e.op!==0&&t.uint32(8).int32(e.op),e.path!==""&&t.uint32(18).string(e.path),e.from!==void 0&&t.uint32(26).string(e.from),e.value!==void 0&&we.encode(we.wrap(e.value),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=bl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.op=n.int32();continue}case 2:{if(a!==18)break;s.path=n.string();continue}case 3:{if(a!==26)break;s.from=n.string();continue}case 4:{if(a!==34)break;s.value=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Bs.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=bl();return a.op=(t=e.op)!=null?t:0,a.path=(n=e.path)!=null?n:"",a.from=(r=e.from)!=null?r:void 0,a.value=(s=e.value)!=null?s:void 0,a}};function Sl(){return{id:"",type:"",function:void 0}}var Fs={encode(e,t=new $e){return e.id!==""&&t.uint32(10).string(e.id),e.type!==""&&t.uint32(18).string(e.type),e.function!==void 0&&Vs.encode(e.function,t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Sl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.type=n.string();continue}case 3:{if(a!==26)break;s.function=Vs.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Fs.fromPartial(e??{})},fromPartial(e){var t,n;const r=Sl();return r.id=(t=e.id)!=null?t:"",r.type=(n=e.type)!=null?n:"",r.function=e.function!==void 0&&e.function!==null?Vs.fromPartial(e.function):void 0,r}};function kl(){return{name:"",arguments:""}}var Vs={encode(e,t=new $e){return e.name!==""&&t.uint32(10).string(e.name),e.arguments!==""&&t.uint32(18).string(e.arguments),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=kl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.name=n.string();continue}case 2:{if(a!==18)break;s.arguments=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Vs.fromPartial(e??{})},fromPartial(e){var t,n;const r=kl();return r.name=(t=e.name)!=null?t:"",r.arguments=(n=e.arguments)!=null?n:"",r}};function wl(){return{id:"",role:"",content:void 0,name:void 0,toolCalls:[],toolCallId:void 0,error:void 0}}var qs={encode(e,t=new $e){e.id!==""&&t.uint32(10).string(e.id),e.role!==""&&t.uint32(18).string(e.role),e.content!==void 0&&t.uint32(26).string(e.content),e.name!==void 0&&t.uint32(34).string(e.name);for(const n of e.toolCalls)Fs.encode(n,t.uint32(42).fork()).join();return e.toolCallId!==void 0&&t.uint32(50).string(e.toolCallId),e.error!==void 0&&t.uint32(58).string(e.error),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=wl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.role=n.string();continue}case 3:{if(a!==26)break;s.content=n.string();continue}case 4:{if(a!==34)break;s.name=n.string();continue}case 5:{if(a!==42)break;s.toolCalls.push(Fs.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.toolCallId=n.string();continue}case 7:{if(a!==58)break;s.error=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return qs.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i,o;const l=wl();return l.id=(t=e.id)!=null?t:"",l.role=(n=e.role)!=null?n:"",l.content=(r=e.content)!=null?r:void 0,l.name=(s=e.name)!=null?s:void 0,l.toolCalls=((a=e.toolCalls)==null?void 0:a.map(u=>Fs.fromPartial(u)))||[],l.toolCallId=(i=e.toolCallId)!=null?i:void 0,l.error=(o=e.error)!=null?o:void 0,l}},gd=(e=>(e[e.TEXT_MESSAGE_START=0]="TEXT_MESSAGE_START",e[e.TEXT_MESSAGE_CONTENT=1]="TEXT_MESSAGE_CONTENT",e[e.TEXT_MESSAGE_END=2]="TEXT_MESSAGE_END",e[e.TOOL_CALL_START=3]="TOOL_CALL_START",e[e.TOOL_CALL_ARGS=4]="TOOL_CALL_ARGS",e[e.TOOL_CALL_END=5]="TOOL_CALL_END",e[e.STATE_SNAPSHOT=6]="STATE_SNAPSHOT",e[e.STATE_DELTA=7]="STATE_DELTA",e[e.MESSAGES_SNAPSHOT=8]="MESSAGES_SNAPSHOT",e[e.RAW=9]="RAW",e[e.CUSTOM=10]="CUSTOM",e[e.RUN_STARTED=11]="RUN_STARTED",e[e.RUN_FINISHED=12]="RUN_FINISHED",e[e.RUN_ERROR=13]="RUN_ERROR",e[e.STEP_STARTED=14]="STEP_STARTED",e[e.STEP_FINISHED=15]="STEP_FINISHED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(gd||{});function El(){return{type:0,timestamp:void 0,rawEvent:void 0}}var J={encode(e,t=new $e){return e.type!==0&&t.uint32(8).int32(e.type),e.timestamp!==void 0&&t.uint32(16).int64(e.timestamp),e.rawEvent!==void 0&&we.encode(we.wrap(e.rawEvent),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=El();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.type=n.int32();continue}case 2:{if(a!==16)break;s.timestamp=Gg(n.int64());continue}case 3:{if(a!==26)break;s.rawEvent=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return J.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=El();return s.type=(t=e.type)!=null?t:0,s.timestamp=(n=e.timestamp)!=null?n:void 0,s.rawEvent=(r=e.rawEvent)!=null?r:void 0,s}};function xl(){return{baseEvent:void 0,messageId:"",role:void 0}}var Hs={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=xl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Hs.fromPartial(e??{})},fromPartial(e){var t,n;const r=xl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.role=(n=e.role)!=null?n:void 0,r}};function Tl(){return{baseEvent:void 0,messageId:"",delta:""}}var Zs={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Tl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Zs.fromPartial(e??{})},fromPartial(e){var t,n;const r=Tl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function Al(){return{baseEvent:void 0,messageId:""}}var Xs={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Al();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Xs.fromPartial(e??{})},fromPartial(e){var t;const n=Al();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.messageId=(t=e.messageId)!=null?t:"",n}};function Il(){return{baseEvent:void 0,toolCallId:"",toolCallName:"",parentMessageId:void 0}}var Ks={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.toolCallName!==""&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Il();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ks.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Il();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,s.toolCallId=(t=e.toolCallId)!=null?t:"",s.toolCallName=(n=e.toolCallName)!=null?n:"",s.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,s}};function Cl(){return{baseEvent:void 0,toolCallId:"",delta:""}}var Js={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Cl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Js.fromPartial(e??{})},fromPartial(e){var t,n;const r=Cl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.toolCallId=(t=e.toolCallId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function Nl(){return{baseEvent:void 0,toolCallId:""}}var Ys={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Nl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ys.fromPartial(e??{})},fromPartial(e){var t;const n=Nl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.toolCallId=(t=e.toolCallId)!=null?t:"",n}};function Rl(){return{baseEvent:void 0,snapshot:void 0}}var Ws={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.snapshot!==void 0&&we.encode(we.wrap(e.snapshot),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Rl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.snapshot=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ws.fromPartial(e??{})},fromPartial(e){var t;const n=Rl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.snapshot=(t=e.snapshot)!=null?t:void 0,n}};function Ol(){return{baseEvent:void 0,delta:[]}}var Qs={encode(e,t=new $e){e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.delta)Bs.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Ol();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.delta.push(Bs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Qs.fromPartial(e??{})},fromPartial(e){var t;const n=Ol();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.delta=((t=e.delta)==null?void 0:t.map(r=>Bs.fromPartial(r)))||[],n}};function Ml(){return{baseEvent:void 0,messages:[]}}var ea={encode(e,t=new $e){e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.messages)qs.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Ml();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messages.push(qs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ea.fromPartial(e??{})},fromPartial(e){var t;const n=Ml();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.messages=((t=e.messages)==null?void 0:t.map(r=>qs.fromPartial(r)))||[],n}};function Pl(){return{baseEvent:void 0,event:void 0,source:void 0}}var ta={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.event!==void 0&&we.encode(we.wrap(e.event),t.uint32(18).fork()).join(),e.source!==void 0&&t.uint32(26).string(e.source),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Pl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.event=we.unwrap(we.decode(n,n.uint32()));continue}case 3:{if(a!==26)break;s.source=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ta.fromPartial(e??{})},fromPartial(e){var t,n;const r=Pl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.event=(t=e.event)!=null?t:void 0,r.source=(n=e.source)!=null?n:void 0,r}};function Ll(){return{baseEvent:void 0,name:"",value:void 0}}var na={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.name!==""&&t.uint32(18).string(e.name),e.value!==void 0&&we.encode(we.wrap(e.value),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Ll();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.name=n.string();continue}case 3:{if(a!==26)break;s.value=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return na.fromPartial(e??{})},fromPartial(e){var t,n;const r=Ll();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.name=(t=e.name)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function $l(){return{baseEvent:void 0,threadId:"",runId:""}}var ra={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=$l();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ra.fromPartial(e??{})},fromPartial(e){var t,n;const r=$l();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.threadId=(t=e.threadId)!=null?t:"",r.runId=(n=e.runId)!=null?n:"",r}};function Dl(){return{baseEvent:void 0,threadId:"",runId:"",result:void 0}}var sa={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),e.result!==void 0&&we.encode(we.wrap(e.result),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Dl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}case 4:{if(a!==34)break;s.result=we.unwrap(we.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return sa.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Dl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,s.threadId=(t=e.threadId)!=null?t:"",s.runId=(n=e.runId)!=null?n:"",s.result=(r=e.result)!=null?r:void 0,s}};function Ul(){return{baseEvent:void 0,code:void 0,message:""}}var aa={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.code!==void 0&&t.uint32(18).string(e.code),e.message!==""&&t.uint32(26).string(e.message),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Ul();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.code=n.string();continue}case 3:{if(a!==26)break;s.message=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return aa.fromPartial(e??{})},fromPartial(e){var t,n;const r=Ul();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,r.code=(t=e.code)!=null?t:void 0,r.message=(n=e.message)!=null?n:"",r}};function zl(){return{baseEvent:void 0,stepName:""}}var ia={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=zl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ia.fromPartial(e??{})},fromPartial(e){var t;const n=zl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function jl(){return{baseEvent:void 0,stepName:""}}var oa={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=jl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return oa.fromPartial(e??{})},fromPartial(e){var t;const n=jl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function Gl(){return{baseEvent:void 0,messageId:void 0,role:void 0,delta:void 0}}var la={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==void 0&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),e.delta!==void 0&&t.uint32(34).string(e.delta),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Gl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}case 4:{if(a!==34)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return la.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Gl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,s.messageId=(t=e.messageId)!=null?t:void 0,s.role=(n=e.role)!=null?n:void 0,s.delta=(r=e.delta)!=null?r:void 0,s}};function Bl(){return{baseEvent:void 0,toolCallId:void 0,toolCallName:void 0,parentMessageId:void 0,delta:void 0}}var ua={encode(e,t=new $e){return e.baseEvent!==void 0&&J.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==void 0&&t.uint32(18).string(e.toolCallId),e.toolCallName!==void 0&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),e.delta!==void 0&&t.uint32(42).string(e.delta),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Bl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=J.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}case 5:{if(a!==42)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ua.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=Bl();return a.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?J.fromPartial(e.baseEvent):void 0,a.toolCallId=(t=e.toolCallId)!=null?t:void 0,a.toolCallName=(n=e.toolCallName)!=null?n:void 0,a.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,a.delta=(s=e.delta)!=null?s:void 0,a}};function Fl(){return{textMessageStart:void 0,textMessageContent:void 0,textMessageEnd:void 0,toolCallStart:void 0,toolCallArgs:void 0,toolCallEnd:void 0,stateSnapshot:void 0,stateDelta:void 0,messagesSnapshot:void 0,raw:void 0,custom:void 0,runStarted:void 0,runFinished:void 0,runError:void 0,stepStarted:void 0,stepFinished:void 0,textMessageChunk:void 0,toolCallChunk:void 0}}var _d={encode(e,t=new $e){return e.textMessageStart!==void 0&&Hs.encode(e.textMessageStart,t.uint32(10).fork()).join(),e.textMessageContent!==void 0&&Zs.encode(e.textMessageContent,t.uint32(18).fork()).join(),e.textMessageEnd!==void 0&&Xs.encode(e.textMessageEnd,t.uint32(26).fork()).join(),e.toolCallStart!==void 0&&Ks.encode(e.toolCallStart,t.uint32(34).fork()).join(),e.toolCallArgs!==void 0&&Js.encode(e.toolCallArgs,t.uint32(42).fork()).join(),e.toolCallEnd!==void 0&&Ys.encode(e.toolCallEnd,t.uint32(50).fork()).join(),e.stateSnapshot!==void 0&&Ws.encode(e.stateSnapshot,t.uint32(58).fork()).join(),e.stateDelta!==void 0&&Qs.encode(e.stateDelta,t.uint32(66).fork()).join(),e.messagesSnapshot!==void 0&&ea.encode(e.messagesSnapshot,t.uint32(74).fork()).join(),e.raw!==void 0&&ta.encode(e.raw,t.uint32(82).fork()).join(),e.custom!==void 0&&na.encode(e.custom,t.uint32(90).fork()).join(),e.runStarted!==void 0&&ra.encode(e.runStarted,t.uint32(98).fork()).join(),e.runFinished!==void 0&&sa.encode(e.runFinished,t.uint32(106).fork()).join(),e.runError!==void 0&&aa.encode(e.runError,t.uint32(114).fork()).join(),e.stepStarted!==void 0&&ia.encode(e.stepStarted,t.uint32(122).fork()).join(),e.stepFinished!==void 0&&oa.encode(e.stepFinished,t.uint32(130).fork()).join(),e.textMessageChunk!==void 0&&la.encode(e.textMessageChunk,t.uint32(138).fork()).join(),e.toolCallChunk!==void 0&&ua.encode(e.toolCallChunk,t.uint32(146).fork()).join(),t},decode(e,t){const n=e instanceof K?e:new K(e),r=t===void 0?n.len:n.pos+t,s=Fl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.textMessageStart=Hs.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.textMessageContent=Zs.decode(n,n.uint32());continue}case 3:{if(a!==26)break;s.textMessageEnd=Xs.decode(n,n.uint32());continue}case 4:{if(a!==34)break;s.toolCallStart=Ks.decode(n,n.uint32());continue}case 5:{if(a!==42)break;s.toolCallArgs=Js.decode(n,n.uint32());continue}case 6:{if(a!==50)break;s.toolCallEnd=Ys.decode(n,n.uint32());continue}case 7:{if(a!==58)break;s.stateSnapshot=Ws.decode(n,n.uint32());continue}case 8:{if(a!==66)break;s.stateDelta=Qs.decode(n,n.uint32());continue}case 9:{if(a!==74)break;s.messagesSnapshot=ea.decode(n,n.uint32());continue}case 10:{if(a!==82)break;s.raw=ta.decode(n,n.uint32());continue}case 11:{if(a!==90)break;s.custom=na.decode(n,n.uint32());continue}case 12:{if(a!==98)break;s.runStarted=ra.decode(n,n.uint32());continue}case 13:{if(a!==106)break;s.runFinished=sa.decode(n,n.uint32());continue}case 14:{if(a!==114)break;s.runError=aa.decode(n,n.uint32());continue}case 15:{if(a!==122)break;s.stepStarted=ia.decode(n,n.uint32());continue}case 16:{if(a!==130)break;s.stepFinished=oa.decode(n,n.uint32());continue}case 17:{if(a!==138)break;s.textMessageChunk=la.decode(n,n.uint32());continue}case 18:{if(a!==146)break;s.toolCallChunk=ua.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return _d.fromPartial(e??{})},fromPartial(e){const t=Fl();return t.textMessageStart=e.textMessageStart!==void 0&&e.textMessageStart!==null?Hs.fromPartial(e.textMessageStart):void 0,t.textMessageContent=e.textMessageContent!==void 0&&e.textMessageContent!==null?Zs.fromPartial(e.textMessageContent):void 0,t.textMessageEnd=e.textMessageEnd!==void 0&&e.textMessageEnd!==null?Xs.fromPartial(e.textMessageEnd):void 0,t.toolCallStart=e.toolCallStart!==void 0&&e.toolCallStart!==null?Ks.fromPartial(e.toolCallStart):void 0,t.toolCallArgs=e.toolCallArgs!==void 0&&e.toolCallArgs!==null?Js.fromPartial(e.toolCallArgs):void 0,t.toolCallEnd=e.toolCallEnd!==void 0&&e.toolCallEnd!==null?Ys.fromPartial(e.toolCallEnd):void 0,t.stateSnapshot=e.stateSnapshot!==void 0&&e.stateSnapshot!==null?Ws.fromPartial(e.stateSnapshot):void 0,t.stateDelta=e.stateDelta!==void 0&&e.stateDelta!==null?Qs.fromPartial(e.stateDelta):void 0,t.messagesSnapshot=e.messagesSnapshot!==void 0&&e.messagesSnapshot!==null?ea.fromPartial(e.messagesSnapshot):void 0,t.raw=e.raw!==void 0&&e.raw!==null?ta.fromPartial(e.raw):void 0,t.custom=e.custom!==void 0&&e.custom!==null?na.fromPartial(e.custom):void 0,t.runStarted=e.runStarted!==void 0&&e.runStarted!==null?ra.fromPartial(e.runStarted):void 0,t.runFinished=e.runFinished!==void 0&&e.runFinished!==null?sa.fromPartial(e.runFinished):void 0,t.runError=e.runError!==void 0&&e.runError!==null?aa.fromPartial(e.runError):void 0,t.stepStarted=e.stepStarted!==void 0&&e.stepStarted!==null?ia.fromPartial(e.stepStarted):void 0,t.stepFinished=e.stepFinished!==void 0&&e.stepFinished!==null?oa.fromPartial(e.stepFinished):void 0,t.textMessageChunk=e.textMessageChunk!==void 0&&e.textMessageChunk!==null?la.fromPartial(e.textMessageChunk):void 0,t.toolCallChunk=e.toolCallChunk!==void 0&&e.toolCallChunk!==null?ua.fromPartial(e.toolCallChunk):void 0,t}};function Gg(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function Bg(e){var t;const n=_d.decode(e),r=Object.values(n).find(s=>s!==void 0);if(!r)throw new Error("Invalid event");if(r.type=gd[r.baseEvent.type],r.timestamp=r.baseEvent.timestamp,r.rawEvent=r.baseEvent.rawEvent,r.type===R.MESSAGES_SNAPSHOT)for(const s of r.messages){const a=s;((t=a.toolCalls)==null?void 0:t.length)===0&&(a.toolCalls=void 0)}if(r.type===R.STATE_DELTA)for(const s of r.delta)s.op=pd[s.op].toLowerCase(),Object.keys(s).forEach(a=>{s[a]===void 0&&delete s[a]});return Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),Bc.parse(r)}var Fg="application/vnd.ag-ui.event+proto";const Vg=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Vl=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");const t=e.match(Vg);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},ql=e=>e==="*"||e==="x"||e==="X",Hl=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},qg=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],Hg=(e,t)=>{if(ql(e)||ql(t))return 0;const[n,r]=qg(Hl(e),Hl(t));return n>r?1:n<r?-1:0},Zl=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const r=Hg(e[n]||"0",t[n]||"0");if(r!==0)return r}return 0},Zg=(e,t)=>{const n=Vl(e),r=Vl(t),s=n.pop(),a=r.pop(),i=Zl(n,r);return i!==0?i:s&&a?Zl(s.split("."),a.split(".")):s||a?s?-1:1:0};var Xg={},Kg=Object.defineProperty,Jg=Object.defineProperties,Yg=Object.getOwnPropertyDescriptors,Ia=Object.getOwnPropertySymbols,md=Object.prototype.hasOwnProperty,yd=Object.prototype.propertyIsEnumerable,Xl=(e,t,n)=>t in e?Kg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,At=(e,t)=>{for(var n in t||(t={}))md.call(t,n)&&Xl(e,n,t[n]);if(Ia)for(var n of Ia(t))yd.call(t,n)&&Xl(e,n,t[n]);return e},or=(e,t)=>Jg(e,Yg(t)),Wg=(e,t)=>{var n={};for(var r in e)md.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ia)for(var r of Ia(e))t.indexOf(r)<0&&yd.call(e,r)&&(n[r]=e[r]);return n},Le=e=>{if(typeof structuredClone=="function")return structuredClone(e);try{return JSON.parse(JSON.stringify(e))}catch{return At({},e)}};async function Ze(e,t,n,r){let s=t,a=n,i;for(let o of e)try{let l=await r(o,Le(s),Le(a));if(l===void 0)continue;if(l.messages!==void 0&&(s=l.messages),l.state!==void 0&&(a=l.state),i=l.stopPropagation,i===!0)break}catch(l){Xg.JEST_WORKER_ID!==void 0||console.error("Subscriber error:",l);continue}return At(At(At({},JSON.stringify(s)!==JSON.stringify(t)?{messages:s}:{}),JSON.stringify(a)!==JSON.stringify(n)?{state:a}:{}),i!==void 0?{stopPropagation:i}:{})}var bd=(e,t,n,r)=>{let s=Le(n.messages),a=Le(e.state),i={},o=u=>{u.messages!==void 0&&(s=u.messages,i.messages=u.messages),u.state!==void 0&&(a=u.state,i.state=u.state)},l=()=>{let u=Le(i);return i={},u.messages!==void 0||u.state!==void 0?st(u):ud};return t.pipe(ld(async u=>{var d,f,h,v;let p=await Ze(r,s,a,(b,m,S)=>{var k;return(k=b.onEvent)==null?void 0:k.call(b,{event:u,agent:n,input:e,messages:m,state:S})});if(o(p),p.stopPropagation===!0)return l();switch(u.type){case R.TEXT_MESSAGE_START:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onTextMessageStartEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{messageId:m,role:S="assistant"}=u,k={id:m,role:S,content:""};s.push(k),o({messages:s})}return l()}case R.TEXT_MESSAGE_CONTENT:{let{messageId:b,delta:m}=u,S=s.find(w=>w.id===b);if(!S)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${b}'`),l();let k=await Ze(r,s,a,(w,T,N)=>{var C;return(C=w.onTextMessageContentEvent)==null?void 0:C.call(w,{event:u,messages:T,state:N,agent:n,input:e,textMessageBuffer:typeof S.content=="string"?S.content:""})});if(o(k),k.stopPropagation!==!0){let w=typeof S.content=="string"?S.content:"";S.content=`${w}${m}`,o({messages:s})}return l()}case R.TEXT_MESSAGE_END:{let{messageId:b}=u,m=s.find(k=>k.id===b);if(!m)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${b}'`),l();let S=await Ze(r,s,a,(k,w,T)=>{var N;return(N=k.onTextMessageEndEvent)==null?void 0:N.call(k,{event:u,messages:w,state:T,agent:n,input:e,textMessageBuffer:typeof m.content=="string"?m.content:""})});return o(S),await Promise.all(r.map(k=>{var w;(w=k.onNewMessage)==null||w.call(k,{message:m,messages:s,state:a,agent:n,input:e})})),l()}case R.TOOL_CALL_START:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onToolCallStartEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{toolCallId:m,toolCallName:S,parentMessageId:k}=u,w;k&&s.length>0&&s[s.length-1].id===k?w=s[s.length-1]:(w={id:k||m,role:"assistant",toolCalls:[]},s.push(w)),w.toolCalls!=null||(w.toolCalls=[]),w.toolCalls.push({id:m,type:"function",function:{name:S,arguments:""}}),o({messages:s})}return l()}case R.TOOL_CALL_ARGS:{let{toolCallId:b,delta:m}=u,S=s.find(T=>{var N;return(N=T.toolCalls)==null?void 0:N.some(C=>C.id===b)});if(!S)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${b}'`),l();let k=S.toolCalls.find(T=>T.id===b);if(!k)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${b}'`),l();let w=await Ze(r,s,a,(T,N,C)=>{var M;let z=k.function.arguments,$=k.function.name,P={};try{P=dd(z)}catch{}return(M=T.onToolCallArgsEvent)==null?void 0:M.call(T,{event:u,messages:N,state:C,agent:n,input:e,toolCallBuffer:z,toolCallName:$,partialToolCallArgs:P})});return o(w),w.stopPropagation!==!0&&(k.function.arguments+=m,o({messages:s})),l()}case R.TOOL_CALL_END:{let{toolCallId:b}=u,m=s.find(w=>{var T;return(T=w.toolCalls)==null?void 0:T.some(N=>N.id===b)});if(!m)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${b}'`),l();let S=m.toolCalls.find(w=>w.id===b);if(!S)return console.warn(`TOOL_CALL_END: No tool call found with ID '${b}'`),l();let k=await Ze(r,s,a,(w,T,N)=>{var C;let M=S.function.arguments,z=S.function.name,$={};try{$=JSON.parse(M)}catch{}return(C=w.onToolCallEndEvent)==null?void 0:C.call(w,{event:u,messages:T,state:N,agent:n,input:e,toolCallName:z,toolCallArgs:$})});return o(k),await Promise.all(r.map(w=>{var T;(T=w.onNewToolCall)==null||T.call(w,{toolCall:S,messages:s,state:a,agent:n,input:e})})),l()}case R.TOOL_CALL_RESULT:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onToolCallResultEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{messageId:m,toolCallId:S,content:k,role:w}=u,T={id:m,toolCallId:S,role:w||"tool",content:k};s.push(T),await Promise.all(r.map(N=>{var C;(C=N.onNewMessage)==null||C.call(N,{message:T,messages:s,state:a,agent:n,input:e})})),o({messages:s})}return l()}case R.STATE_SNAPSHOT:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onStateSnapshotEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{snapshot:m}=u;a=m,o({state:a})}return l()}case R.STATE_DELTA:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onStateDeltaEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{delta:m}=u;try{a=Yr(a,m,!0,!1).newDocument,o({state:a})}catch(S){let k=S instanceof Error?S.message:String(S);console.warn(`Failed to apply state patch:
Current state: ${JSON.stringify(a,null,2)}
Patch operations: ${JSON.stringify(m,null,2)}
Error: ${k}`)}}return l()}case R.MESSAGES_SNAPSHOT:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onMessagesSnapshotEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let{messages:m}=u;s=m,o({messages:s})}return l()}case R.ACTIVITY_SNAPSHOT:{let b=u,m=s.findIndex(N=>N.id===b.messageId),S=m>=0?s[m]:void 0,k=S?.role==="activity"?S:void 0,w=(d=b.replace)!=null?d:!0,T=await Ze(r,s,a,(N,C,M)=>{var z;return(z=N.onActivitySnapshotEvent)==null?void 0:z.call(N,{event:b,messages:C,state:M,agent:n,input:e,activityMessage:k,existingMessage:S})});if(o(T),T.stopPropagation!==!0){let N={id:b.messageId,role:"activity",activityType:b.activityType,content:Le(b.content)},C;m===-1?(s.push(N),C=N):k?w&&(s[m]=or(At({},k),{activityType:b.activityType,content:Le(b.content)})):w&&(s[m]=N,C=N),o({messages:s}),C&&await Promise.all(r.map(M=>{var z;return(z=M.onNewMessage)==null?void 0:z.call(M,{message:C,messages:s,state:a,agent:n,input:e})}))}return l()}case R.ACTIVITY_DELTA:{let b=u,m=s.findIndex(T=>T.id===b.messageId);if(m===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${b.messageId}' to apply patch`),l();let S=s[m];if(S.role!=="activity")return console.warn(`ACTIVITY_DELTA: Message '${b.messageId}' is not an activity message`),l();let k=S,w=await Ze(r,s,a,(T,N,C)=>{var M;return(M=T.onActivityDeltaEvent)==null?void 0:M.call(T,{event:b,messages:N,state:C,agent:n,input:e,activityMessage:k})});if(o(w),w.stopPropagation!==!0)try{let T=Le((f=k.content)!=null?f:{}),N=Yr(T,(h=b.patch)!=null?h:[],!0,!1).newDocument;s[m]=or(At({},k),{content:Le(N),activityType:b.activityType}),o({messages:s})}catch(T){let N=T instanceof Error?T.message:String(T);console.warn(`Failed to apply activity patch for '${b.messageId}': ${N}`)}return l()}case R.RAW:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onRawEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});return o(b),l()}case R.CUSTOM:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onCustomEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});return o(b),l()}case R.RUN_STARTED:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onRunStartedEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});if(o(b),b.stopPropagation!==!0){let m=u;if((v=m.input)!=null&&v.messages){for(let S of m.input.messages)s.find(k=>k.id===S.id)||s.push(S);o({messages:s})}}return l()}case R.RUN_FINISHED:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onRunFinishedEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e,result:u.result})});return o(b),l()}case R.RUN_ERROR:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onRunErrorEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});return o(b),l()}case R.STEP_STARTED:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onStepStartedEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});return o(b),l()}case R.STEP_FINISHED:{let b=await Ze(r,s,a,(m,S,k)=>{var w;return(w=m.onStepFinishedEvent)==null?void 0:w.call(m,{event:u,messages:S,state:k,agent:n,input:e})});return o(b),l()}case R.TEXT_MESSAGE_CHUNK:throw new Error("TEXT_MESSAGE_CHUNK must be tranformed before being applied");case R.TOOL_CALL_CHUNK:throw new Error("TOOL_CALL_CHUNK must be tranformed before being applied");case R.THINKING_START:return l();case R.THINKING_END:return l();case R.THINKING_TEXT_MESSAGE_START:return l();case R.THINKING_TEXT_MESSAGE_CONTENT:return l();case R.THINKING_TEXT_MESSAGE_END:return l()}return u.type,l()}),yg(),r.length>0?Sg({}):u=>u)},ii=e=>t=>{let n=new Map,r=new Map,s=!1,a=!1,i=!1,o=new Map,l=!1,u=!1,d=!1,f=()=>{n.clear(),r.clear(),o.clear(),l=!1,u=!1,s=!1,a=!1,d=!0};return t.pipe(ir(h=>{let v=h.type;if(e&&console.debug("[VERIFY]:",JSON.stringify(h)),a)return He(()=>new We(`Cannot send event type '${v}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(s&&v!==R.RUN_ERROR&&v!==R.RUN_STARTED)return He(()=>new We(`Cannot send event type '${v}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(i){if(v===R.RUN_STARTED){if(d&&!s)return He(()=>new We("Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run."));s&&f()}}else if(i=!0,v!==R.RUN_STARTED&&v!==R.RUN_ERROR)return He(()=>new We("First event must be 'RUN_STARTED'"));switch(v){case R.TEXT_MESSAGE_START:{let p=h.messageId;return n.has(p)?He(()=>new We(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${p}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(p,!0),st(h))}case R.TEXT_MESSAGE_CONTENT:{let p=h.messageId;return n.has(p)?st(h):He(()=>new We(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${p}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case R.TEXT_MESSAGE_END:{let p=h.messageId;return n.has(p)?(n.delete(p),st(h)):He(()=>new We(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${p}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case R.TOOL_CALL_START:{let p=h.toolCallId;return r.has(p)?He(()=>new We(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${p}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(r.set(p,!0),st(h))}case R.TOOL_CALL_ARGS:{let p=h.toolCallId;return r.has(p)?st(h):He(()=>new We(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${p}'. Start a tool call with 'TOOL_CALL_START' first.`))}case R.TOOL_CALL_END:{let p=h.toolCallId;return r.has(p)?(r.delete(p),st(h)):He(()=>new We(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${p}'. A 'TOOL_CALL_START' event must be sent first.`))}case R.STEP_STARTED:{let p=h.stepName;return o.has(p)?He(()=>new We(`Step "${p}" is already active for 'STEP_STARTED'`)):(o.set(p,!0),st(h))}case R.STEP_FINISHED:{let p=h.stepName;return o.has(p)?(o.delete(p),st(h)):He(()=>new We(`Cannot send 'STEP_FINISHED' for step "${p}" that was not started`))}case R.RUN_STARTED:return d=!0,st(h);case R.RUN_FINISHED:{if(o.size>0){let p=Array.from(o.keys()).join(", ");return He(()=>new We(`Cannot send 'RUN_FINISHED' while steps are still active: ${p}`))}if(n.size>0){let p=Array.from(n.keys()).join(", ");return He(()=>new We(`Cannot send 'RUN_FINISHED' while text messages are still active: ${p}`))}if(r.size>0){let p=Array.from(r.keys()).join(", ");return He(()=>new We(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${p}`))}return s=!0,st(h)}case R.RUN_ERROR:return a=!0,st(h);case R.CUSTOM:return st(h);case R.THINKING_TEXT_MESSAGE_START:return l?u?He(()=>new We("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.")):(u=!0,st(h)):He(()=>new We("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first."));case R.THINKING_TEXT_MESSAGE_CONTENT:return u?st(h):He(()=>new We("Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first."));case R.THINKING_TEXT_MESSAGE_END:return u?(u=!1,st(h)):He(()=>new We("Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first."));case R.THINKING_START:return l?He(()=>new We("Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.")):(l=!0,st(h));case R.THINKING_END:return l?(l=!1,st(h)):He(()=>new We("Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first."));default:return st(h)}}))},Qg=(e,t)=>xg(()=>Aa(fetch(e,t))).pipe(wg(n=>{var r;if(!n.ok){let i=n.headers.get("content-type")||"";return Aa(n.text()).pipe(ir(o=>{let l=o;if(i.includes("application/json"))try{l=JSON.parse(o)}catch{}let u=new Error(`HTTP ${n.status}: ${typeof l=="string"?l:JSON.stringify(l)}`);return u.status=n.status,u.payload=l,He(()=>u)}))}let s={type:"headers",status:n.status,headers:n.headers},a=(r=n.body)==null?void 0:r.getReader();return a?new $t(i=>(i.next(s),(async()=>{try{for(;;){let{done:o,value:l}=await a.read();if(o)break;let u={type:"data",data:l};i.next(u)}i.complete()}catch(o){i.error(o)}})(),()=>{a.cancel().catch(o=>{if(o?.name!=="AbortError")throw o})})):He(()=>new Error("Failed to getReader() from response"))})),e_=e=>{let t=new Ar,n=new TextDecoder("utf-8",{fatal:!1}),r="";e.subscribe({next:a=>{if(a.type!=="headers"&&a.type==="data"&&a.data){let i=n.decode(a.data,{stream:!0});r+=i;let o=r.split(/\n\n/);r=o.pop()||"";for(let l of o)s(l)}},error:a=>t.error(a),complete:()=>{r&&(r+=n.decode(),s(r)),t.complete()}});function s(a){let i=a.split(`
`),o=[];for(let l of i)l.startsWith("data: ")&&o.push(l.slice(6));if(o.length>0)try{let l=o.join(`
`),u=JSON.parse(l);t.next(u)}catch(l){t.error(l)}}return t.asObservable()},t_=e=>{let t=new Ar,n=new Uint8Array(0);e.subscribe({next:s=>{if(s.type!=="headers"&&s.type==="data"&&s.data){let a=new Uint8Array(n.length+s.data.length);a.set(n,0),a.set(s.data,n.length),n=a,r()}},error:s=>t.error(s),complete:()=>{if(n.length>0)try{r()}catch{console.warn("Incomplete or invalid protocol buffer data at stream end")}t.complete()}});function r(){for(;n.length>=4;){let s=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<s)break;try{let a=n.slice(4,s),i=Bg(a);t.next(i),n=n.slice(s)}catch(a){let i=a instanceof Error?a.message:String(a);t.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return t.asObservable()},n_=e=>{let t=new Ar,n=new cd,r=!1;return e.subscribe({next:s=>{n.next(s),s.type==="headers"&&!r?(r=!0,s.headers.get("content-type")===Fg?t_(n).subscribe({next:a=>t.next(a),error:a=>t.error(a),complete:()=>t.complete()}):e_(n).subscribe({next:a=>{try{let i=Bc.parse(a);t.next(i)}catch(i){t.error(i)}},error:a=>{if(a?.name==="AbortError"){t.next({type:R.RUN_ERROR,rawEvent:a}),t.complete();return}return t.error(a)},complete:()=>t.complete()})):r||t.error(new Error("No headers event received before data events"))},error:s=>{n.error(s),t.error(s)},complete:()=>{n.complete()}}),t.asObservable()},ze=$c(["TextMessageStart","TextMessageContent","TextMessageEnd","ActionExecutionStart","ActionExecutionArgs","ActionExecutionEnd","ActionExecutionResult","AgentStateMessage","MetaEvent","RunStarted","RunFinished","RunError","NodeStarted","NodeFinished"]),r_=$c(["LangGraphInterruptEvent","PredictState","Exit"]),s_=Ve({type:X(ze.enum.TextMessageStart),messageId:L(),parentMessageId:L().optional(),role:L().optional()}),a_=Ve({type:X(ze.enum.TextMessageContent),messageId:L(),content:L()}),i_=Ve({type:X(ze.enum.TextMessageEnd),messageId:L()}),o_=Ve({type:X(ze.enum.ActionExecutionStart),actionExecutionId:L(),actionName:L(),parentMessageId:L().optional()}),l_=Ve({type:X(ze.enum.ActionExecutionArgs),actionExecutionId:L(),args:L()}),u_=Ve({type:X(ze.enum.ActionExecutionEnd),actionExecutionId:L()}),c_=Ve({type:X(ze.enum.ActionExecutionResult),actionName:L(),actionExecutionId:L(),result:L()}),d_=Ve({type:X(ze.enum.AgentStateMessage),threadId:L(),agentName:L(),nodeName:L(),runId:L(),active:Ii(),role:L(),state:L(),running:Ii()}),f_=Ve({type:X(ze.enum.MetaEvent),name:r_,value:Lt()}),v_=Ve({type:X(ze.enum.RunError),message:L(),code:L().optional()});Ua("type",[s_,a_,i_,o_,l_,u_,c_,d_,f_,v_]);Ve({id:L(),role:L(),content:L(),parentMessageId:L().optional()});Ve({id:L(),name:L(),arguments:Lt(),parentMessageId:L().optional()});Ve({id:L(),result:Lt(),actionExecutionId:L(),actionName:L()});var h_=e=>{if(typeof e=="string")return e;if(!Array.isArray(e))return;let t=e.filter(n=>n.type==="text").map(n=>n.text).filter(n=>n.length>0);if(t.length!==0)return t.join(`
`)},p_=(e,t,n)=>r=>{let s={},a=!0,i=!0,o="",l=null,u=null,d=[],f={},h=v=>{typeof v=="object"&&v!==null&&("messages"in v&&delete v.messages,s=v)};return r.pipe(ir(v=>{switch(v.type){case R.TEXT_MESSAGE_START:{let p=v;return[{type:ze.enum.TextMessageStart,messageId:p.messageId,role:p.role}]}case R.TEXT_MESSAGE_CONTENT:{let p=v;return[{type:ze.enum.TextMessageContent,messageId:p.messageId,content:p.delta}]}case R.TEXT_MESSAGE_END:{let p=v;return[{type:ze.enum.TextMessageEnd,messageId:p.messageId}]}case R.TOOL_CALL_START:{let p=v;return d.push({id:p.toolCallId,type:"function",function:{name:p.toolCallName,arguments:""}}),i=!0,f[p.toolCallId]=p.toolCallName,[{type:ze.enum.ActionExecutionStart,actionExecutionId:p.toolCallId,actionName:p.toolCallName,parentMessageId:p.parentMessageId}]}case R.TOOL_CALL_ARGS:{let p=v,b=d.find(S=>S.id===p.toolCallId);if(!b)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${p.toolCallId}'`),[];b.function.arguments+=p.delta;let m=!1;if(u){let S=u.find(k=>k.tool==b.function.name);if(S)try{let k=JSON.parse(dd(b.function.arguments));S.tool_argument&&S.tool_argument in k?(h(or(At({},s),{[S.state_key]:k[S.tool_argument]})),m=!0):S.tool_argument||(h(or(At({},s),{[S.state_key]:k})),m=!0)}catch{}}return[{type:ze.enum.ActionExecutionArgs,actionExecutionId:p.toolCallId,args:p.delta},...m?[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]:[]]}case R.TOOL_CALL_END:{let p=v;return[{type:ze.enum.ActionExecutionEnd,actionExecutionId:p.toolCallId}]}case R.TOOL_CALL_RESULT:{let p=v;return[{type:ze.enum.ActionExecutionResult,actionExecutionId:p.toolCallId,result:p.content,actionName:f[p.toolCallId]||"unknown"}]}case R.RAW:return[];case R.CUSTOM:{let p=v;switch(p.name){case"Exit":a=!1;break;case"PredictState":u=p.value;break}return[{type:ze.enum.MetaEvent,name:p.name,value:p.value}]}case R.STATE_SNAPSHOT:return h(v.snapshot),[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}];case R.STATE_DELTA:{let p=Yr(s,v.delta,!0,!1);return p?(h(p.newDocument),[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]):[]}case R.MESSAGES_SNAPSHOT:return l=v.messages,[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(At(At({},s),l?{messages:l}:{})),active:!0}];case R.RUN_STARTED:return[];case R.RUN_FINISHED:return l&&(s.messages=l),Object.keys(s).length===0?[]:[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(At(At({},s),l?{messages:g_(l)}:{})),active:!1}];case R.RUN_ERROR:{let p=v;return[{type:ze.enum.RunError,message:p.message,code:p.code}]}case R.STEP_STARTED:return o=v.stepName,d=[],u=null,[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!0}];case R.STEP_FINISHED:return d=[],u=null,[{type:ze.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!1}];default:return[]}}))};function g_(e){var t;let n=[];for(let r of e)if(r.role==="assistant"||r.role==="user"||r.role==="system"){let s=h_(r.content);if(s){let a={id:r.id,role:r.role,content:s};n.push(a)}if(r.role==="assistant"&&r.toolCalls&&r.toolCalls.length>0)for(let a of r.toolCalls){let i={id:a.id,name:a.function.name,arguments:JSON.parse(a.function.arguments),parentMessageId:r.id};n.push(i)}}else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"&&(t=i.toolCalls)!=null&&t.length){for(let o of i.toolCalls)if(o.id===r.toolCallId){s=o.function.name;break}}let a={id:r.id,result:r.content,actionExecutionId:r.toolCallId,actionName:s};n.push(a)}return n}var ca=e=>t=>{let n,r,s,a=()=>{if(!n||s!=="text")throw new Error("No text message to close");let l={type:R.TEXT_MESSAGE_END,messageId:n.messageId};return s=void 0,n=void 0,e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_END",JSON.stringify(l)),l},i=()=>{if(!r||s!=="tool")throw new Error("No tool call to close");let l={type:R.TOOL_CALL_END,toolCallId:r.toolCallId};return s=void 0,r=void 0,e&&console.debug("[TRANSFORM]: TOOL_CALL_END",JSON.stringify(l)),l},o=()=>s==="text"?[a()]:s==="tool"?[i()]:[];return t.pipe(ir(l=>{switch(l.type){case R.TEXT_MESSAGE_START:case R.TEXT_MESSAGE_CONTENT:case R.TEXT_MESSAGE_END:case R.TOOL_CALL_START:case R.TOOL_CALL_ARGS:case R.TOOL_CALL_END:case R.TOOL_CALL_RESULT:case R.STATE_SNAPSHOT:case R.STATE_DELTA:case R.MESSAGES_SNAPSHOT:case R.CUSTOM:case R.RUN_STARTED:case R.RUN_FINISHED:case R.RUN_ERROR:case R.STEP_STARTED:case R.STEP_FINISHED:case R.THINKING_START:case R.THINKING_END:case R.THINKING_TEXT_MESSAGE_START:case R.THINKING_TEXT_MESSAGE_CONTENT:case R.THINKING_TEXT_MESSAGE_END:return[...o(),l];case R.RAW:case R.ACTIVITY_SNAPSHOT:case R.ACTIVITY_DELTA:return[l];case R.TEXT_MESSAGE_CHUNK:let u=l,d=[];if((s!=="text"||u.messageId!==void 0&&u.messageId!==n?.messageId)&&d.push(...o()),s!=="text"){if(u.messageId===void 0)throw new Error("First TEXT_MESSAGE_CHUNK must have a messageId");n={messageId:u.messageId},s="text";let v={type:R.TEXT_MESSAGE_START,messageId:u.messageId,role:u.role||"assistant"};d.push(v),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_START",JSON.stringify(v))}if(u.delta!==void 0){let v={type:R.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:u.delta};d.push(v),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_CONTENT",JSON.stringify(v))}return d;case R.TOOL_CALL_CHUNK:let f=l,h=[];if((s!=="tool"||f.toolCallId!==void 0&&f.toolCallId!==r?.toolCallId)&&h.push(...o()),s!=="tool"){if(f.toolCallId===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallId");if(f.toolCallName===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallName");r={toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId},s="tool";let v={type:R.TOOL_CALL_START,toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId};h.push(v),e&&console.debug("[TRANSFORM]: TOOL_CALL_START",JSON.stringify(v))}if(f.delta!==void 0){let v={type:R.TOOL_CALL_ARGS,toolCallId:r.toolCallId,delta:f.delta};h.push(v),e&&console.debug("[TRANSFORM]: TOOL_CALL_ARGS",JSON.stringify(v))}return h}return l.type,[]}),Di(()=>{o()}))},Sd=class{runNext(t,n){return n.run(t).pipe(ca(!1))}runNextWithState(t,n){let r=Le(t.messages||[]),s=Le(t.state||{}),a=new cd;return bd(t,a,n,[]).subscribe(i=>{i.messages!==void 0&&(r=i.messages),i.state!==void 0&&(s=i.state)}),this.runNext(t,n).pipe(ld(async i=>(a.next(i),await new Promise(o=>setTimeout(o,0)),{event:i,messages:Le(r),state:Le(s)})))}},__=class extends Sd{constructor(t){super(),this.fn=t}run(t,n){return this.fn(t,n)}};function m_(e){let t=e.content;if(Array.isArray(t)){let n=t.filter(r=>typeof r=="object"&&r!==null&&"type"in r&&r.type==="text"&&typeof r.text=="string").map(r=>r.text).join("");return or(At({},e),{content:n})}return typeof t=="string"?e:or(At({},e),{content:""})}var y_=class extends Sd{run(t,n){let r=t,{parentRunId:s}=r,a=Wg(r,["parentRunId"]),i=or(At({},a),{messages:a.messages.map(m_)});return this.runNext(i,n)}},b_={version:"0.0.42"},S_=class{constructor({agentId:t,description:n,threadId:r,initialMessages:s,initialState:a,debug:i}={}){this.debug=!1,this.subscribers=[],this.isRunning=!1,this.middlewares=[],this.agentId=t,this.description=n??"",this.threadId=r??os(),this.messages=Le(s??[]),this.state=Le(a??{}),this.debug=i??!1,Zg(this.maxVersion,"0.0.39")<=0&&this.middlewares.unshift(new y_)}get maxVersion(){return b_.version}subscribe(t){return this.subscribers.push(t),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==t)}}}use(...t){let n=t.map(r=>typeof r=="function"?new __(r):r);return this.middlewares.push(...n),this}async runAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:os();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new Ar;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=al(()=>this.middlewares.length===0?this.run(s):this.middlewares.reduceRight((f,h)=>({run:v=>h.run(v,f)}),this).run(s),ca(this.debug),ii(this.debug),f=>f.pipe(ll(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),Li(f=>(this.isRunning=!1,this.onError(s,f,o))),Di(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await ul(u(st(null)));let d=Le(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:d}}finally{this.isRunning=!1}}connect(t){throw new rl}async connectAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:os();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new Ar;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=al(()=>this.connect(s),ca(this.debug),ii(this.debug),f=>f.pipe(ll(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),Li(f=>(this.isRunning=!1,f instanceof rl?ud:this.onError(s,f,o))),Di(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await ul(u(st(null)));let d=Le(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:d}}finally{this.isRunning=!1}}abortRun(){}async detachActiveRun(){var t,n;if(!this.activeRunDetach$)return;let r=(t=this.activeRunCompletionPromise)!=null?t:Promise.resolve();this.activeRunDetach$.next(),(n=this.activeRunDetach$)==null||n.complete(),await r}apply(t,n,r){return bd(t,n,this,r)}processApplyEvents(t,n,r){return n.pipe(Eg(s=>{s.messages&&(this.messages=s.messages,r.forEach(a=>{var i;(i=a.onMessagesChanged)==null||i.call(a,{messages:this.messages,state:this.state,agent:this,input:t})})),s.state&&(this.state=s.state,r.forEach(a=>{var i;(i=a.onStateChanged)==null||i.call(a,{state:this.state,messages:this.messages,agent:this,input:t})}))}))}prepareRunAgentInput(t){var n,r,s;let a=Le(this.messages).filter(i=>i.role!=="activity");return{threadId:this.threadId,runId:t?.runId||os(),tools:Le((n=t?.tools)!=null?n:[]),context:Le((r=t?.context)!=null?r:[]),forwardedProps:Le((s=t?.forwardedProps)!=null?s:{}),state:Le(this.state),messages:a}}async onInitialize(t,n){let r=await Ze(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunInitialized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages&&(this.messages=r.messages,t.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state&&(this.state=r.state,t.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}onError(t,n,r){return Aa(Ze(r,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFailed)==null?void 0:o.call(s,{error:n,messages:a,state:i,agent:this,input:t})})).pipe($i(s=>{let a=s;if((a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,r.forEach(i=>{var o;(o=i.onMessagesChanged)==null||o.call(i,{messages:this.messages,state:this.state,agent:this,input:t})})),a.state!==void 0&&(this.state=a.state,r.forEach(i=>{var o;(o=i.onStateChanged)==null||o.call(i,{state:this.state,messages:this.messages,agent:this,input:t})}))),a.stopPropagation!==!0)throw console.error("Agent execution failed:",n),n;return{}}))}async onFinalize(t,n){let r=await Ze(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFinalized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages!==void 0&&(this.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state!==void 0&&(this.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}clone(){let t=Object.create(Object.getPrototypeOf(this));return t.agentId=this.agentId,t.description=this.description,t.threadId=this.threadId,t.messages=Le(this.messages),t.state=Le(this.state),t.debug=this.debug,t.isRunning=this.isRunning,t.subscribers=[...this.subscribers],t.middlewares=[...this.middlewares],t}addMessage(t){this.messages.push(t),(async()=>{var n,r,s;for(let a of this.subscribers)await((n=a.onNewMessage)==null?void 0:n.call(a,{message:t,messages:this.messages,state:this.state,agent:this}));if(t.role==="assistant"&&t.toolCalls)for(let a of t.toolCalls)for(let i of this.subscribers)await((r=i.onNewToolCall)==null?void 0:r.call(i,{toolCall:a,messages:this.messages,state:this.state,agent:this}));for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(t){this.messages.push(...t),(async()=>{var n,r,s;for(let a of t){for(let i of this.subscribers)await((n=i.onNewMessage)==null?void 0:n.call(i,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role==="assistant"&&a.toolCalls)for(let i of a.toolCalls)for(let o of this.subscribers)await((r=o.onNewToolCall)==null?void 0:r.call(o,{toolCall:i,messages:this.messages,state:this.state,agent:this}))}for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(t){this.messages=Le(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onMessagesChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}setState(t){this.state=Le(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onStateChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(t){var n;this.agentId=(n=this.agentId)!=null?n:os();let r=this.prepareRunAgentInput(t);return(this.middlewares.length===0?this.run(r):this.middlewares.reduceRight((s,a)=>({run:i=>a.run(i,s)}),this).run(r)).pipe(ca(this.debug),ii(this.debug),p_(this.threadId,r.runId,this.agentId),s=>s.pipe($i(a=>(this.debug&&console.debug("[LEGACY]:",JSON.stringify(a)),a))))}},Kl=class extends S_{constructor(e){var t;super(e),this.abortController=new AbortController,this.url=e.url,this.headers=Le((t=e.headers)!=null?t:{})}requestInit(e){return{method:"POST",headers:or(At({},this.headers),{"Content-Type":"application/json",Accept:"text/event-stream"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,t){var n;return this.abortController=(n=e?.abortController)!=null?n:new AbortController,super.runAgent(e,t)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let t=Qg(this.url,this.requestInit(e));return n_(t)}clone(){var e;let t=super.clone();t.url=this.url,t.headers=Le((e=this.headers)!=null?e:{});let n=new AbortController,r=this.abortController.signal;return r.aborted&&n.abort(r.reason),t.abortController=n,t}};class k_{constructor(t){this.stores=t}eventSource=null;agentMsgId=null;aguiSubscription=null;aguiMessageMap=new Map;aguiMappedPlaceholder=!1;aguiRunId=null;aguiSessionId=null;aguiCompleted=!1;aguiToolCalls=new Map;sseToolCalls=new Map;sseMessageMap=new Map;sseMappedPlaceholder=!1;start(t,n,r,s,a,i="sse"){if(this.close(),i==="agui"){this.startAgui(t,n,r,s,a);return}const o=this.stores.chatStore.addAgentMessage();this.agentMsgId=o.id;const l=new URL("/chat/stream",window.location.origin);l.searchParams.set("query",t),l.searchParams.set("session_id",n),Object.keys(r).length&&l.searchParams.set("tool_context",JSON.stringify(r)),Object.keys(s).length&&l.searchParams.set("llm_context",JSON.stringify(s)),this.eventSource=new EventSource(l.toString()),["chunk","artifact_chunk","artifact_stored","llm_stream_chunk","step","event","state_update","tool_call_start","tool_call_args","tool_call_end","done","error"].forEach(d=>{this.eventSource.addEventListener(d,f=>{this.handleEvent(d,f,a)})}),this.eventSource.onerror=()=>{const d=this.findAgentMsg();d&&this.stores.chatStore.updateMessage(d.id,{isStreaming:!1}),a.onError("Connection lost"),this.close()}}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.agentMsgId=null,this.aguiSubscription&&(this.aguiSubscription.unsubscribe(),this.aguiSubscription=null),this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1,this.aguiToolCalls.clear(),this.sseToolCalls.clear(),this.sseMessageMap.clear(),this.sseMappedPlaceholder=!1}findAgentMsg(){return this.agentMsgId?this.stores.chatStore.findMessage(this.agentMsgId):void 0}handleEvent(t,n,r){const s=eo(n.data);if(!s)return;const a=this.findAgentMsg();if(a)switch(t){case"chunk":case"llm_stream_chunk":this.handleChunk(a,s,t);break;case"artifact_chunk":this.handleArtifactChunk(s);break;case"artifact_stored":this.handleArtifactStored(s);break;case"step":case"event":this.handleStepEvent(a,s,t);break;case"state_update":this.handleStateUpdate(s);break;case"tool_call_start":this.handleSseToolCallStart(s);break;case"tool_call_args":this.handleSseToolCallArgs(s);break;case"tool_call_end":this.handleSseToolCallEnd(s);break;case"done":this.handleDone(a,s,r);break;case"error":this.handleError(a,s,r);break}}handleStateUpdate(t){if(this.stores.tasksStore.applyUpdate(t),t.update_type==="NOTIFICATION"){const r=t.content,s=Jl(r?.severity),a=String(r?.body??""),i=String(r?.title??""),o=i?`${i}: ${a}`:a,l=r?.actions,u=Array.isArray(l)?l.filter(d=>d&&typeof d=="object").map(d=>({id:String(d.id??""),label:String(d.label??"Action"),payload:d.payload})).filter(d=>d.id):void 0;this.stores.notificationsStore.add(o||"Notification",s,u)}}ensureSseMessage(t){if(!t)return this.agentMsgId??"";const n=this.sseMessageMap.get(t);if(n)return n;if(!this.sseMappedPlaceholder&&this.agentMsgId)return this.sseMappedPlaceholder=!0,this.sseMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.sseMessageMap.set(t,r.id),r.id}handleSseToolCallStart(t){const n=t.tool_call_id,r=t.tool_name,s=t.message_id;if(n&&r){const a=s?this.ensureSseMessage(s):this.agentMsgId??void 0;this.sseToolCalls.set(n,{name:r,args:"",messageId:a})}this.stores.eventsStore.addEvent(t,"tool_call_start")}handleSseToolCallArgs(t){const n=t.tool_call_id,r=t.delta;if(n&&r){const s=this.sseToolCalls.get(n);s&&(s.args+=r)}this.stores.eventsStore.addEvent(t,"tool_call_args")}handleSseToolCallEnd(t){const n=t.tool_call_id;if(n){const r=this.sseToolCalls.get(n);r&&(this.handleInteractiveToolCall(n,r.name,r.args,r.messageId),this.sseToolCalls.delete(n))}this.stores.eventsStore.addEvent(t,"tool_call_end")}handleChunk(t,n,r){const s=n.message_id,a=s?this.ensureSseMessage(s):t.id,i=this.stores.chatStore.findMessage(a)??t,o=n.channel??"thinking",l=n.phase??(r==="chunk"?"observation":void 0),u=n.text??"",d=!!n.done;if(o==="thinking"&&l==="action"){this.stores.chatStore.updateMessage(i.id,{isThinking:!d});return}if(o==="thinking"){u?this.stores.chatStore.updateMessage(i.id,{observations:`${i.observations??""}${u}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(i.id,{isThinking:!1});return}if(o==="revision"){const f={isThinking:!1,isStreaming:!0};i.revisionStreamActive||(f.revisionStreamActive=!0,f.text=""),u&&(f.text=`${i.revisionStreamActive?i.text:""}${u}`),this.stores.chatStore.updateMessage(i.id,f);return}if(o==="answer"){const f=i.answerActionSeq??Ur,h=n.action_seq;if(f===Ur){this.stores.chatStore.updateMessage(i.id,{answerStreamDone:d,isStreaming:!d,isThinking:!1});return}if(h!==void 0&&h!==f){this.stores.chatStore.updateMessage(i.id,{isThinking:!1});return}const v={isThinking:!1,isStreaming:!d};u&&(v.text=`${i.text}${u}`),d&&(v.answerStreamDone=!0),this.stores.chatStore.updateMessage(i.id,v);return}u?this.stores.chatStore.updateMessage(i.id,{observations:`${i.observations??""}${u}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(i.id,{isThinking:!1})}handleArtifactChunk(t){const n=Yl(t);if(n.artifact_type==="ui_component"){this.stores.interactionsStore.addArtifactChunk(n,{message_id:this.agentMsgId??void 0}),this.stores.eventsStore.addEvent(t,"artifact_chunk");return}const r=n.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(r,n.chunk),this.stores.eventsStore.addEvent(t,"artifact_chunk")}handleArtifactStored(t){const n=w_(t);n&&this.stores.artifactsStore.addArtifact(n),this.stores.eventsStore.addEvent(t,"artifact_stored")}handleStepEvent(t,n,r){const s=n.event;if(s==="step_start"){const a=n.action_seq;this.stores.chatStore.updateMessage(t.id,{answerActionSeq:typeof a=="number"?a:Ur})}if(s==="tool_call_start"){const a=n.tool_call_id,i=n.tool_name,o=n.args_json;a&&i&&this.handleInteractiveToolCall(a,i,o??"",this.agentMsgId??void 0)}this.stores.eventsStore.addEvent(n,r)}handleDone(t,n,r){const s=n.pause,a=n.trace_id??null;if(s){this.handlePause(t,n,s,a,r);return}const i=n.answer_action_seq,o=t.answerActionSeq??Ur;o!==Ur&&(i===void 0||i===o)&&n.answer&&typeof n.answer=="string"&&this.stores.chatStore.updateMessage(t.id,{text:n.answer}),this.stores.chatStore.updateMessage(t.id,{isStreaming:!1,isThinking:!1}),r.onDone(a),this.close()}handlePause(t,n,r,s,a){const i=Pn(r.payload)??{},o=Be(i.auth_url)||Be(i.url)||"",l=Be(i.provider)||"",u=Be(r.reason)||"pause",d=Be(r.resume_token),f=Be(i.component),h=Pn(i.props);f&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Be(i.tool)??"ui_pause",component:f,props:h,message_id:t.id,resume_token:d,created_at:Date.now()}):d&&this.stores.interactionsStore.updatePendingInteraction({resume_token:d});let v=`Planner paused (${u})`;l&&(v+=` for ${l}`),o&&(v+=`
[Open auth link](${o})`),d&&!f&&(v+=`
Resume token: \`${d}\``),this.stores.chatStore.updateMessage(t.id,{pause:{reason:u,payload:i,resume_token:d},traceId:s??void 0,text:v,isStreaming:!1,isThinking:!1}),a.onDone(s),this.close()}handleError(t,n,r){const s=n.error??"Unexpected error";this.stores.chatStore.updateMessage(t.id,{text:s,isStreaming:!1,isThinking:!1}),r.onError(s),this.close()}handleInteractiveToolCall(t,n,r,s){const a=this.mapInteractiveComponent(n);if(!a)return;let i={};if(r)try{const o=JSON.parse(r);o&&typeof o=="object"&&(i=o)}catch{i={}}this.stores.interactionsStore.setPendingInteraction({tool_call_id:t,tool_name:n,component:a,props:i,message_id:s,created_at:Date.now()})}mapInteractiveComponent(t){return t==="ui_form"?"form":t==="ui_confirm"?"confirm":t==="ui_select_option"?"select_option":null}startAgui(t,n,r,s,a){const i=this.buildHistory();!i.some(v=>v.role==="user"&&this.hasTextContent(v.content))&&t.trim()&&i.push({id:`msg_${Date.now()}`,role:"user",content:t});const l=this.stores.chatStore.addAgentMessage();this.agentMsgId=l.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const u=new URL("/agui/agent",window.location.origin),d={threadId:n,runId:`run_${Date.now()}`,messages:i,tools:[],context:[],state:{},forwardedProps:{penguiflow:{llm_context:s,tool_context:r}}};this.aguiRunId=d.runId,this.aguiSessionId=n,console.log("[AG-UI] Sending request:",JSON.stringify(d,null,2));const h=new Kl({url:u.toString()}).run(d);this.aguiSubscription=h.subscribe({next:v=>this.handleAguiEvent(v,a),error:v=>{const p=this.findAgentMsg();p&&this.stores.chatStore.updateMessage(p.id,{isStreaming:!1}),a.onError(v.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}resumeAgui(t,n,r,s,a){if(!t.resume_token){a.onError("Resume token missing");return}this.close();const i=this.stores.chatStore.addAgentMessage();this.agentMsgId=i.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const o=new URL("/agui/resume",window.location.origin),l={resume_token:t.resume_token,thread_id:r,run_id:`run_${Date.now()}`,tool_name:t.tool_name,component:t.component,result:n,tool_context:s};this.aguiRunId=l.run_id,this.aguiSessionId=r;const d=new Kl({url:o.toString()}).run(l);this.aguiSubscription=d.subscribe({next:f=>this.handleAguiEvent(f,a),error:f=>{const h=this.findAgentMsg();h&&this.stores.chatStore.updateMessage(h.id,{isStreaming:!1}),a.onError(f.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}handleAguiEvent(t,n){const r=t;switch(console.log("[AG-UI] Received event:",r.type,r),r.type){case R.RUN_STARTED:{const s=r;this.aguiRunId=s.runId??this.aguiRunId;return}case R.RUN_FINISHED:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onDone(s.runId??this.aguiRunId),this.aguiCompleted=!0;return}case R.RUN_ERROR:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onError(s.message||"Run error"),this.aguiCompleted=!0;return}case R.TEXT_MESSAGE_START:{const s=r;if(s.role!=="assistant")return;this.ensureAguiMessage(s.messageId);return}case R.TEXT_MESSAGE_CONTENT:{const s=r,a=this.ensureAguiMessage(s.messageId),i=this.stores.chatStore.findMessage(a);i&&s.delta&&this.stores.chatStore.updateMessage(i.id,{text:`${i.text}${s.delta}`,isStreaming:!0});return}case R.TEXT_MESSAGE_END:{const s=r,a=this.ensureAguiMessage(s.messageId);this.stores.chatStore.updateMessage(a,{isStreaming:!1});return}case R.TOOL_CALL_START:{const s=r,a=s.toolCallId,i=s.toolCallName,o=s.parentMessageId,l=o?this.ensureAguiMessage(o):this.agentMsgId??void 0;this.aguiToolCalls.set(a,{name:i,args:"",messageId:l}),this.stores.eventsStore.addEvent({tool_call_id:a,tool_call_name:i},"tool_call_start");return}case R.TOOL_CALL_ARGS:{const s=r,a=s.toolCallId,i=this.aguiToolCalls.get(a);i&&(i.args+=s.delta??""),this.stores.eventsStore.addEvent({tool_call_id:a,delta:s.delta},"tool_call_args");return}case R.TOOL_CALL_END:{const a=r.toolCallId,i=this.aguiToolCalls.get(a);i&&(this.handleInteractiveToolCall(a,i.name,i.args,i.messageId),this.aguiToolCalls.delete(a)),this.stores.eventsStore.addEvent({tool_call_id:a},"tool_call_end");return}case R.TOOL_CALL_RESULT:{const s=r,a=s.toolCallId;this.stores.eventsStore.addEvent({tool_call_id:a,content:s.content},"tool_call_result");return}case R.CUSTOM:{const s=r,a=s.name,i=s.value,o=Pn(i);if(a==="state_update"&&o&&(this.stores.tasksStore.applyUpdate(o),o.update_type==="NOTIFICATION")){const d=o.content,f=Jl(d?.severity),h=String(d?.body??""),v=String(d?.title??""),p=v?`${v}: ${h}`:h,b=d?.actions,m=Array.isArray(b)?b.filter(S=>S&&typeof S=="object").map(S=>({id:String(S.id??""),label:String(S.label??"Action"),payload:S.payload})).filter(S=>S.id):void 0;this.stores.notificationsStore.add(p||"Notification",f,m)}if(a==="artifact_stored"&&o){const u=Pn(o.artifact),d=u?E_(u,this.aguiRunId,this.aguiSessionId):null;d&&this.stores.artifactsStore.addArtifact(d)}if(a==="artifact_chunk"&&o){const u=Yl(o);if(u.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(u,{message_id:this.agentMsgId??void 0});else{const d=u.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(d,u.chunk)}}if(a==="thinking"&&o){const u=this.findAgentMsg();if(u){const d=Be(o.text)??"";Be(o.phase)==="action"?this.stores.chatStore.updateMessage(u.id,{isThinking:!0}):d&&this.stores.chatStore.updateMessage(u.id,{observations:`${u.observations??""}${d}`,showObservations:!0,isThinking:!1})}}if(a==="revision"&&o){const u=this.findAgentMsg();if(u){const d=Be(o.text)??"",h={isThinking:!1,isStreaming:!(kd(o.done)??!1)};u.revisionStreamActive||(h.revisionStreamActive=!0,h.text=""),d&&(h.text=`${u.revisionStreamActive?u.text:""}${d}`),this.stores.chatStore.updateMessage(u.id,h)}}if(a==="pause"&&o){const u=this.findAgentMsg();u&&this.handlePause(u,{},o,this.aguiRunId,n);const d=Pn(o.payload),f=d?Be(d.component):void 0,h=d?Pn(d.props):void 0;d&&f&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Be(d.tool)??"ui_pause",component:f,props:h,message_id:this.agentMsgId??void 0,resume_token:Be(o.resume_token),created_at:Date.now()}):Be(o.resume_token)&&this.stores.interactionsStore.updatePendingInteraction({resume_token:Be(o.resume_token)}),this.aguiCompleted=!0}const l=o??{value:i};this.stores.eventsStore.addEvent(l,a);return}default:return}}ensureAguiMessage(t){const n=this.aguiMessageMap.get(t);if(n)return n;if(!this.aguiMappedPlaceholder&&this.agentMsgId)return this.aguiMappedPlaceholder=!0,this.aguiMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.aguiMessageMap.set(t,r.id),r.id}buildHistory(){console.log("[AG-UI] Building history from this.stores.chatStore.messages:",this.stores.chatStore.messages.length,"messages");const t=this.stores.chatStore.messages.filter(n=>n.role==="user"||n.role==="agent").map(n=>({id:n.id,role:n.role==="agent"?"assistant":"user",content:n.text}));return console.log("[AG-UI] Built history:",t),t}hasTextContent(t){return typeof t=="string"?t.trim().length>0:Array.isArray(t)?t.some(n=>typeof n=="object"&&n!==null&&"text"in n):!1}}function Pn(e){return!e||typeof e!="object"||Array.isArray(e)?null:e}function Be(e){return typeof e=="string"?e:void 0}function xs(e){return typeof e=="number"?e:void 0}function kd(e){return typeof e=="boolean"?e:void 0}function Jl(e){const t=typeof e=="string"?e:"info";return t==="info"||t==="success"||t==="warning"||t==="error"?t:"info"}function Yl(e){return{stream_id:Be(e.stream_id),seq:xs(e.seq),done:kd(e.done),artifact_type:Be(e.artifact_type),chunk:e.chunk,meta:Pn(e.meta)??void 0,ts:xs(e.ts)}}function w_(e){const t=Be(e.artifact_id),n=Be(e.mime_type),r=xs(e.size_bytes),s=Be(e.filename),a=Be(e.trace_id),i=Be(e.session_id),o=xs(e.ts);return!t||!n||r===void 0||!s||!a||!i||o===void 0?null:{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:Pn(e.source)??{},trace_id:a,session_id:i,ts:o}}function E_(e,t,n){if(!t||!n)return null;const r=Be(e.id),s=Be(e.mime_type),a=xs(e.size_bytes),i=Be(e.filename);return!r||!s||a===void 0||!i?null:{artifact_id:r,mime_type:s,size_bytes:a,filename:i,source:Pn(e.source)??{},trace_id:t,session_id:n,ts:Date.now()}}function x_(e){return new k_(e)}class T_{constructor(t){this.stores=t}eventSource=null;start(t,n){this.close();const r=new URL("/events",window.location.origin);r.searchParams.set("trace_id",t),r.searchParams.set("session_id",n),r.searchParams.set("follow","true"),this.eventSource=new EventSource(r.toString());const s=a=>{const i=eo(a.data);if(!i)return;const o=a.type||i.event||"";if(this.stores.eventsStore.shouldProcess(o)){if(o==="artifact_chunk"){const l=A_(i);if(l.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(l,{});else{const u=l.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(u,l.chunk)}}if(o==="artifact_stored"){const l=I_(i);l&&this.stores.artifactsStore.addArtifact(l)}o!=="llm_stream_chunk"&&this.stores.eventsStore.addEvent(i,o||"event")}};["event","step","chunk","llm_stream_chunk","artifact_chunk","artifact_stored"].forEach(a=>{this.eventSource.addEventListener(a,s)}),this.eventSource.onmessage=s,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}}function A_(e){const t=e.meta;return{stream_id:typeof e.stream_id=="string"?e.stream_id:void 0,seq:typeof e.seq=="number"?e.seq:void 0,done:typeof e.done=="boolean"?e.done:void 0,artifact_type:typeof e.artifact_type=="string"?e.artifact_type:void 0,chunk:e.chunk,meta:t&&typeof t=="object"&&!Array.isArray(t)?t:void 0,ts:typeof e.ts=="number"?e.ts:void 0}}function I_(e){const t=typeof e.artifact_id=="string"?e.artifact_id:null,n=typeof e.mime_type=="string"?e.mime_type:null,r=typeof e.size_bytes=="number"?e.size_bytes:null,s=typeof e.filename=="string"?e.filename:null,a=typeof e.trace_id=="string"?e.trace_id:null,i=typeof e.session_id=="string"?e.session_id:null,o=typeof e.ts=="number"?e.ts:null;if(!t||!n||r===null||!s||!a||!i||o===null)return null;const l=e.source;return{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:l&&typeof l=="object"&&!Array.isArray(l)?l:{},trace_id:a,session_id:i,ts:o}}function C_(e){return new T_(e)}async function N_(e,t,n,r){try{const a=await fetch("/steer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,task_id:t,event_type:"USER_MESSAGE",payload:{text:n,active_tasks:r},source:"user"})});return a.ok?(await a.json()).accepted:(console.error("Steering message failed:",a.statusText),!1)}catch(s){return console.error("Failed to send steering message:",s),!1}}class R_{constructor(t){this.stores=t}eventSource=null;lastUpdateId=null;activeSessionId=null;start(t){this.close(),this.activeSessionId!==t&&(this.lastUpdateId=null),this.activeSessionId=t,Nh(t).then(s=>{s&&this.stores.tasksStore.setTasks(s)});const n=new URL("/session/stream",window.location.origin);n.searchParams.set("session_id",t),this.lastUpdateId&&n.searchParams.set("since_id",this.lastUpdateId),this.eventSource=new EventSource(n.toString());const r=s=>{const a=eo(s.data);if(!a||a.update_type==null)return;const i=a;if(i.task_id){if(this.lastUpdateId=i.update_id??this.lastUpdateId,this.stores.tasksStore.applyUpdate(i),i.update_type==="RESULT"){const o=i.content;if(o&&typeof o=="object"&&!Array.isArray(o)&&!!o.proactive){const u=o.text??o.message??o.answer,d=L_(o.artifacts,i),f=o.group_id,h=o.background_task_id,v=f?"Background tasks update":"Background task update",p=u?String(u):`${v} ready.`,b=typeof h=="string"?` (task ${h.slice(0,8)})`:"",m=u?`${v}: ${p}${b}`:`${p}${b}`;this.stores.notificationsStore.add(m,"info");const S=u?String(u):f?"Background tasks completed.":"Background task completed.",k=this.stores.chatStore.addAgentMessage(),w=d.length?d.map(D_):void 0;if(this.stores.chatStore.updateMessage(k.id,{text:S,isStreaming:!1,isThinking:!1,answerStreamDone:!0,revisionStreamActive:!1,traceId:i.trace_id??void 0,artifacts:w}),d.length)for(const T of d)this.stores.artifactsStore.addArtifact(T)}}if(i.update_type==="NOTIFICATION"){const o=i.content;if(o&&typeof o=="object"&&!Array.isArray(o)){const l=M_(o.severity),u=String(o.body??""),d=String(o.title??""),f=d?`${d}: ${u}`:u,h=o.actions,v=Array.isArray(h)?h.filter(p=>p&&typeof p=="object").map(p=>({id:String(p.id??""),label:String(p.label??"Action"),payload:p.payload})).filter(p=>p.id):void 0;this.stores.notificationsStore.add(f||"Notification",l,v)}}}};this.eventSource.addEventListener("state_update",r),this.eventSource.onmessage=r,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.activeSessionId=null}}function O_(e){return new R_(e)}function $s(e){return!e||typeof e!="object"||Array.isArray(e)?null:e}function M_(e){const t=typeof e=="string"?e:"info";return t==="info"||t==="success"||t==="warning"||t==="error"?t:"info"}function Ds(e){return typeof e=="string"?e:void 0}function P_(e){return typeof e=="number"?e:void 0}function L_(e,t){if(!Array.isArray(e))return[];const n=[];for(const r of e){const s=$_(r,t);s&&n.push(s)}return n}function $_(e,t){const n=$s(e);if(!n)return null;const r=$s(n.artifact)??n,s=$s(r.artifact)??r,a=Ds(s.id)??Ds(s.artifact_id);if(!a)return null;const i=Ds(s.filename)??a,o=Ds(s.mime_type)??"application/octet-stream",l=P_(s.size_bytes)??0,u=$s(s.source)??{};return{artifact_id:a,mime_type:o,size_bytes:l,filename:i,source:u,trace_id:t.trace_id??"background",session_id:t.session_id,ts:Date.now()}}function D_(e){return{id:e.artifact_id,mime_type:e.mime_type??null,size_bytes:e.size_bytes??null,filename:e.filename??null,sha256:null,source:e.source??{}}}function _o(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Pr=_o();function wd(e){Pr=e}var _s={exec:()=>null};function Te(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(Ot.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}var U_=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Ot={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},z_=/^(?:[ \t]*(?:\n|$))+/,j_=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,G_=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ns=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,B_=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,mo=/(?:[*+-]|\d{1,9}[.)])/,Ed=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,xd=Te(Ed).replace(/bull/g,mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),F_=Te(Ed).replace(/bull/g,mo).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),yo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,V_=/^[^\n]+/,bo=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,q_=Te(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",bo).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),H_=Te(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,mo).getRegex(),Ga="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",So=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Z_=Te("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",So).replace("tag",Ga).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Td=Te(yo).replace("hr",Ns).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex(),X_=Te(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Td).getRegex(),ko={blockquote:X_,code:j_,def:q_,fences:G_,heading:B_,hr:Ns,html:Z_,lheading:xd,list:H_,newline:z_,paragraph:Td,table:_s,text:V_},Wl=Te("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ns).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex(),K_={...ko,lheading:F_,table:Wl,paragraph:Te(yo).replace("hr",Ns).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ga).getRegex()},J_={...ko,html:Te(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",So).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:_s,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:Te(yo).replace("hr",Ns).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xd).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Y_=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,W_=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ad=/^( {2,}|\\)\n(?!\s*$)/,Q_=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Ba=/[\p{P}\p{S}]/u,wo=/[\s\p{P}\p{S}]/u,Id=/[^\s\p{P}\p{S}]/u,em=Te(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,wo).getRegex(),Cd=/(?!~)[\p{P}\p{S}]/u,tm=/(?!~)[\s\p{P}\p{S}]/u,nm=/(?:[^\s\p{P}\p{S}]|~)/u,rm=Te(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",U_?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Nd=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,sm=Te(Nd,"u").replace(/punct/g,Ba).getRegex(),am=Te(Nd,"u").replace(/punct/g,Cd).getRegex(),Rd="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",im=Te(Rd,"gu").replace(/notPunctSpace/g,Id).replace(/punctSpace/g,wo).replace(/punct/g,Ba).getRegex(),om=Te(Rd,"gu").replace(/notPunctSpace/g,nm).replace(/punctSpace/g,tm).replace(/punct/g,Cd).getRegex(),lm=Te("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Id).replace(/punctSpace/g,wo).replace(/punct/g,Ba).getRegex(),um=Te(/\\(punct)/,"gu").replace(/punct/g,Ba).getRegex(),cm=Te(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),dm=Te(So).replace("(?:-->|$)","-->").getRegex(),fm=Te("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",dm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ca=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,vm=Te(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ca).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Od=Te(/^!?\[(label)\]\[(ref)\]/).replace("label",Ca).replace("ref",bo).getRegex(),Md=Te(/^!?\[(ref)\](?:\[\])?/).replace("ref",bo).getRegex(),hm=Te("reflink|nolink(?!\\()","g").replace("reflink",Od).replace("nolink",Md).getRegex(),Ql=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Eo={_backpedal:_s,anyPunctuation:um,autolink:cm,blockSkip:rm,br:Ad,code:W_,del:_s,emStrongLDelim:sm,emStrongRDelimAst:im,emStrongRDelimUnd:lm,escape:Y_,link:vm,nolink:Md,punctuation:em,reflink:Od,reflinkSearch:hm,tag:fm,text:Q_,url:_s},pm={...Eo,link:Te(/^!?\[(label)\]\((.*?)\)/).replace("label",Ca).getRegex(),reflink:Te(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ca).getRegex()},zi={...Eo,emStrongRDelimAst:om,emStrongLDelim:am,url:Te(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Ql).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:Te(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Ql).getRegex()},gm={...zi,br:Te(Ad).replace("{2,}","*").getRegex(),text:Te(zi.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Us={normal:ko,gfm:K_,pedantic:J_},ls={normal:Eo,gfm:zi,breaks:gm,pedantic:pm},_m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},eu=e=>_m[e];function On(e,t){if(t){if(Ot.escapeTest.test(e))return e.replace(Ot.escapeReplace,eu)}else if(Ot.escapeTestNoEncode.test(e))return e.replace(Ot.escapeReplaceNoEncode,eu);return e}function tu(e){try{e=encodeURI(e).replace(Ot.percentDecode,"%")}catch{return null}return e}function nu(e,t){let n=e.replace(Ot.findPipe,(a,i,o)=>{let l=!1,u=i;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(Ot.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(Ot.slashPipe,"|");return r}function us(e,t,n){let r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function mm(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function ru(e,t,n,r,s){let a=t.href,i=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:i,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function ym(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let s=r[1];return t.split(`
`).map(a=>{let i=a.match(n.other.beginningSpace);if(i===null)return a;let[o]=i;return o.length>=s.length?a.slice(s.length):a}).join(`
`)}var Na=class{options;rules;lexer;constructor(e){this.options=e||Pr}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:us(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=ym(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=us(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:us(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=us(t[0],`
`).split(`
`),r="",s="",a=[];for(;n.length>0;){let i=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),i=!0;else if(!i)o.push(n[l]);else break;n=n.slice(l);let u=o.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${u}`:u,s=s?`${s}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,a,!0),this.lexer.state.top=f,n.length===0)break;let h=a.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let v=h,p=v.raw+`
`+n.join(`
`),b=this.blockquote(p);a[a.length-1]=b,r=r.substring(0,r.length-v.raw.length)+b.raw,s=s.substring(0,s.length-v.text.length)+b.text;break}else if(h?.type==="list"){let v=h,p=v.raw+`
`+n.join(`
`),b=this.list(p);a[a.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-v.raw.length)+b.raw,n=p.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:a,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let a=this.rules.other.listItemRegex(n),i=!1;for(;e;){let l=!1,u="",d="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,b=>" ".repeat(3*b.length)),h=e.split(`
`,1)[0],v=!f.trim(),p=0;if(this.options.pedantic?(p=2,d=f.trimStart()):v?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,d=f.slice(p),p+=t[1].length),v&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),l=!0),!l){let b=this.rules.other.nextBulletRegex(p),m=this.rules.other.hrRegex(p),S=this.rules.other.fencesBeginRegex(p),k=this.rules.other.headingBeginRegex(p),w=this.rules.other.htmlBeginRegex(p);for(;e;){let T=e.split(`
`,1)[0],N;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),N=h):N=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||k.test(h)||w.test(h)||b.test(h)||m.test(h))break;if(N.search(this.rules.other.nonSpaceChar)>=p||!h.trim())d+=`
`+N.slice(p);else{if(v||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(f)||k.test(f)||m.test(f))break;d+=`
`+h}!v&&!h.trim()&&(v=!0),u+=T+`
`,e=e.substring(T.length+1),f=N.slice(p)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),s.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(d),loose:!1,text:d,tokens:[]}),s.raw+=u}let o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let d=this.lexer.inlineQueue.length-1;d>=0;d--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[d].src)){this.lexer.inlineQueue[d].src=this.lexer.inlineQueue[d].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(l.raw);if(u){let d={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};l.checked=d.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=d.raw+l.tokens[0].raw,l.tokens[0].text=d.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(d)):l.tokens.unshift({type:"paragraph",raw:d.raw,text:d.raw,tokens:[d]}):l.tokens.unshift(d)}}if(!s.loose){let u=l.tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));s.loose=d}}if(s.loose)for(let l of s.items){l.loose=!0;for(let u of l.tokens)u.type==="text"&&(u.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=nu(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?a.align.push("right"):this.rules.other.tableAlignCenter.test(i)?a.align.push("center"):this.rules.other.tableAlignLeft.test(i)?a.align.push("left"):a.align.push(null);for(let i=0;i<n.length;i++)a.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:a.align[i]});for(let i of s)a.rows.push(nu(i,a.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:a.align[l]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=us(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=mm(t[2],"()");if(a===-2)return;if(a>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(r);a&&(r=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),ru(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return ru(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,a,i,o=s,l=0,u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(i=[...a].length,r[3]||r[4]){o+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(o-=i,o>0)continue;i=Math.min(i,i+o+l);let d=[...r[0]][0].length,f=e.slice(0,s+r.index+d+i);if(Math.min(s,i)%2){let v=f.slice(1,-1);return{type:"em",raw:f,text:v,tokens:this.lexer.inlineTokens(v)}}let h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},vn=class ji{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Pr,this.options.tokenizer=this.options.tokenizer||new Na,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:Ot,block:Us.normal,inline:ls.normal};this.options.pedantic?(n.block=Us.pedantic,n.inline=ls.pedantic):this.options.gfm&&(n.block=Us.gfm,this.options.breaks?n.inline=ls.breaks:n.inline=ls.gfm),this.tokenizer.rules=n}static get rules(){return{block:Us,inline:ls}}static lex(t,n){return new ji(n).lex(t)}static lexInline(t,n){return new ji(n).inlineTokens(t)}lex(t){t=t.replace(Ot.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(Ot.tabCharGlobal,"    ").replace(Ot.spaceLine,""));t;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}let a=t;if(this.options.extensions?.startBlock){let i=1/0,o=t.slice(1),l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(a=t.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=a.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)a=s[2]?s[2].length:0,r=r.slice(0,s.index+a)+"["+"a".repeat(s[0].length-a-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,o="";for(;t;){i||(o=""),i=!1;let l;if(this.options.extensions?.inline?.some(d=>(l=d.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let d=n.at(-1);l.type==="text"&&d?.type==="text"?(d.raw+=l.raw,d.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,r,o)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let u=t;if(this.options.extensions?.startInline){let d=1/0,f=t.slice(1),h;this.options.extensions.startInline.forEach(v=>{h=v.call({lexer:this},f),typeof h=="number"&&h>=0&&(d=Math.min(d,h))}),d<1/0&&d>=0&&(u=t.substring(0,d+1))}if(l=this.tokenizer.inlineText(u)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),i=!0;let d=n.at(-1);d?.type==="text"?(d.raw+=l.raw,d.text+=l.text):n.push(l);continue}if(t){let d="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return n}},Ra=class{options;parser;constructor(e){this.options=e||Pr}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(Ot.notSpaceStart)?.[0],s=e.replace(Ot.endingNewline,"")+`
`;return r?'<pre><code class="language-'+On(r)+'">'+(n?s:On(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:On(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let i=0;i<e.items.length;i++){let o=e.items[i];r+=this.listitem(o)}let s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+r+"</"+s+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];n="";for(let i=0;i<a.length;i++)n+=this.tablecell(a[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${On(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=tu(e);if(s===null)return r;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+On(t)+'"'),a+=">"+r+"</a>",a}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=tu(e);if(s===null)return On(n);e=s;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${On(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:On(e.text)}},xo=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},hn=class Gi{options;renderer;textRenderer;constructor(t){this.options=t||Pr,this.options.renderer=this.options.renderer||new Ra,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new xo}static parse(t,n){return new Gi(n).parse(t)}static parseInline(t,n){return new Gi(n).parseInline(t)}parse(t){let n="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,o=this.options.extensions.renderers[i.type].call({parser:this},i);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=o||"";continue}}let a=s;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(t,n=this.renderer){let r="";for(let s=0;s<t.length;s++){let a=t[s];if(this.options.extensions?.renderers?.[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=o||"";continue}}let i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},ps=class{options;block;constructor(e){this.options=e||Pr}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?vn.lex:vn.lexInline}provideParser(){return this.block?hn.parse:hn.parseInline}},bm=class{defaults=_o();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=hn;Renderer=Ra;TextRenderer=xo;Lexer=vn;Tokenizer=Na;Hooks=ps;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let s=r;for(let a of s.header)n=n.concat(this.walkTokens(a.tokens,t));for(let a of s.rows)for(let i of a)n=n.concat(this.walkTokens(i.tokens,t));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{let i=s[a].flat(1/0);n=n.concat(this.walkTokens(i,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=t.renderers[s.name];a?t.renderers[s.name]=function(...i){let o=s.renderer.apply(this,i);return o===!1&&(o=a.apply(this,i)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){let s=this.defaults.renderer||new Ra(this.defaults);for(let a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let i=a,o=n.renderer[i],l=s[i];s[i]=(...u)=>{let d=o.apply(s,u);return d===!1&&(d=l.apply(s,u)),d||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new Na(this.defaults);for(let a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let i=a,o=n.tokenizer[i],l=s[i];s[i]=(...u)=>{let d=o.apply(s,u);return d===!1&&(d=l.apply(s,u)),d}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new ps;for(let a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let i=a,o=n.hooks[i],l=s[i];ps.passThroughHooks.has(a)?s[i]=u=>{if(this.defaults.async&&ps.passThroughHooksRespectAsync.has(a))return(async()=>{let f=await o.call(s,u);return l.call(s,f)})();let d=o.call(s,u);return l.call(s,d)}:s[i]=(...u)=>{if(this.defaults.async)return(async()=>{let f=await o.apply(s,u);return f===!1&&(f=await l.apply(s,u)),f})();let d=o.apply(s,u);return d===!1&&(d=l.apply(s,u)),d}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(i){let o=[];return o.push(a.call(this,i)),s&&(o=o.concat(s.call(this,i))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return vn.lex(e,t??this.defaults)}parser(e,t){return hn.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(t):t,o=await(s.hooks?await s.hooks.provideLexer():e?vn.lex:vn.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(o):o;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let u=await(s.hooks?await s.hooks.provideParser():e?hn.parse:hn.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(u):u})().catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let i=(s.hooks?s.hooks.provideLexer():e?vn.lex:vn.lexInline)(t,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let o=(s.hooks?s.hooks.provideParser():e?hn.parse:hn.parseInline)(i,s);return s.hooks&&(o=s.hooks.postprocess(o)),o}catch(i){return a(i)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+On(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Ir=new bm;function Re(e,t){return Ir.parse(e,t)}Re.options=Re.setOptions=function(e){return Ir.setOptions(e),Re.defaults=Ir.defaults,wd(Re.defaults),Re};Re.getDefaults=_o;Re.defaults=Pr;Re.use=function(...e){return Ir.use(...e),Re.defaults=Ir.defaults,wd(Re.defaults),Re};Re.walkTokens=function(e,t){return Ir.walkTokens(e,t)};Re.parseInline=Ir.parseInline;Re.Parser=hn;Re.parser=hn.parse;Re.Renderer=Ra;Re.TextRenderer=xo;Re.Lexer=vn;Re.lexer=vn.lex;Re.Tokenizer=Na;Re.Hooks=ps;Re.parse=Re;Re.options;Re.setOptions;Re.use;Re.walkTokens;Re.parseInline;hn.parse;vn.lex;Re.setOptions({breaks:!0,gfm:!0});function Pd(e){if(!e)return"";try{return Re.parse(e,{async:!1})}catch{return e}}let su=!1;function Sm(){su||typeof window>"u"||(su=!0,window.addEventListener("error",e=>{console.error("[playground-ui] Unhandled error:",e.error??e.message)}),window.addEventListener("unhandledrejection",e=>{console.error("[playground-ui] Unhandled rejection:",e.reason)}))}var km=E("<div><!></div>");function To(e,t){let n=dt(t,"position",3,"center"),r=dt(t,"class",3,"");var s=km(),a=g(s);It(a,()=>t.children??et),O(()=>ke(s,1,`column ${n()??""} ${r()??""}`,"svelte-1k9hy8f")),y(e,s)}var wm=E('<div class="page svelte-1g511ye"><!></div>');function Em(e,t){var n=wm(),r=g(n);It(r,()=>t.children??et),y(e,n)}function xm(e,t){To(e,{position:"left",children:(n,r)=>{var s=je(),a=re(s);It(a,()=>t.children??et),y(n,s)},$$slots:{default:!0}})}wf();var Tm=E("<div><!></div>");function Xn(e,t){let n=dt(t,"class",3,"");var r=Tm(),s=g(r);It(s,()=>t.children??et),O(()=>ke(r,1,`card ${n()??""}`,"svelte-4n6w97")),y(e,r)}var Am=E('<button type="button"> </button>'),Im=E('<div class="tabs svelte-1nusxqd"><!> <!></div>');function Cm(e,t){fe(t,!0);var n=Im(),r=g(n);Ue(r,17,()=>t.tabs,a=>a.id,(a,i)=>{var o=Am();let l;o.__click=()=>t.onchange?.(c(i).id);var u=g(o);O(()=>{l=ke(o,1,"tab svelte-1nusxqd",null,l,{active:t.active===c(i).id}),A(u,c(i).label)}),y(a,o)});var s=_(r,2);It(s,()=>t.right??et),y(e,n),ve()}Dt(["click"]);var Nm=E('<div class="icon svelte-12nvmli"> </div>'),Rm=E('<div class="subtitle svelte-12nvmli"> </div>'),Om=E('<div><!> <div class="title svelte-12nvmli"> </div> <!></div>');function Fa(e,t){let n=dt(t,"inline",3,!1);var r=Om();let s;var a=g(r);{var i=f=>{var h=Nm(),v=g(h);O(()=>A(v,t.icon)),y(f,h)};I(a,f=>{t.icon&&f(i)})}var o=_(a,2),l=g(o),u=_(o,2);{var d=f=>{var h=Rm(),v=g(h);O(()=>A(v,t.subtitle)),y(f,h)};I(u,f=>{t.subtitle&&f(d)})}O(()=>{s=ke(r,1,"empty svelte-12nvmli",null,s,{inline:n()}),A(l,t.title)}),y(e,r)}var Mm=E('<div class="error-row svelte-1bc74kj"> </div>'),Pm=E('<div class="errors svelte-1bc74kj"></div>');function Ld(e,t){fe(t,!0);var n=je(),r=re(n);{var s=a=>{var i=Pm();Ue(i,21,()=>t.errors,o=>o.id,(o,l)=>{var u=Mm(),d=g(u);O(()=>A(d,`Warning ${c(l).message??""}`)),y(o,u)}),y(a,i)};I(r,a=>{t.errors.length>0&&a(s)})}y(e,n),ve()}var Lm=E('<div class="label svelte-1hc9aln"> </div>'),$m=E('<div class="code-block svelte-1hc9aln"><!> <pre class="svelte-1hc9aln"> </pre></div>');function au(e,t){let n=dt(t,"maxHeight",3,"100px");const r=de(()=>typeof t.content=="string"?t.content:JSON.stringify(t.content,null,2));var s=$m(),a=g(s);{var i=u=>{var d=Lm(),f=g(d);O(()=>A(f,t.label)),y(u,d)};I(a,u=>{t.label&&u(i)})}var o=_(a,2),l=g(o);O(()=>{hi(o,`max-height: ${n()??""}`),A(l,c(r))}),y(e,s)}var Dm=E("<span><!></span>");function Mt(e,t){let n=dt(t,"variant",3,"default"),r=dt(t,"size",3,"default"),s=dt(t,"class",3,"");var a=Dm(),i=g(a);It(i,()=>t.children??et),O(()=>ke(a,1,`pill ${n()??""} ${r()??""} ${s()??""}`,"svelte-1qe3l4g")),y(e,a)}var Um=E("<span><!></span>");function zm(e,t){var n=Um(),r=g(n);{var s=a=>{var i=_t();O(()=>A(i,t.label)),y(a,i)};I(r,a=>{t.label&&a(s)})}O(()=>ke(n,1,`status-dot ${t.status??""}`,"svelte-1506mec")),y(e,n)}var jm=E('<button class="icon-btn svelte-w50x32"><!></button>');function Gm(e,t){var n=jm();n.__click=function(...s){t.onclick?.apply(this,s)};var r=g(n);It(r,()=>t.children??et),O(()=>at(n,"title",t.title)),y(e,n)}Dt(["click"]);var Bm=E('<div class="row space-between align-center svelte-1683ey6"><div><div class="title svelte-1683ey6"> </div> <div class="muted svelte-1683ey6"> </div></div> <!></div> <div class="badges svelte-1683ey6"></div> <div class="stats-row svelte-1683ey6"><div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">TOOLS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">FLOWS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">SVCS</div> <div class="stat-value svelte-1683ey6"> </div></div></div>',1);function iu(e,t){fe(t,!1);const n=ss();Ht(),Xn(e,{class:"project-card",children:(r,s)=>{var a=Bm(),i=re(a),o=g(i),l=g(o),u=g(l),d=_(l,2),f=g(d),h=_(o,2);Mt(h,{variant:"subtle",children:(z,$)=>{var P=_t();O(()=>A(P,n.meta.version||n.meta.template)),y(z,P)},$$slots:{default:!0}});var v=_(i,2);Ue(v,5,()=>n.meta.flags,Jr,(z,$)=>{Mt(z,{variant:"ghost",children:(P,F)=>{var U=_t();O(()=>A(U,c($))),y(P,U)},$$slots:{default:!0}})});var p=_(v,2),b=g(p),m=_(g(b),2),S=g(m),k=_(b,2),w=_(g(k),2),T=g(w),N=_(k,2),C=_(g(N),2),M=g(C);O(()=>{A(u,n.meta.name),A(f,n.meta.description),A(S,n.meta.tools),A(T,n.meta.flows),A(M,n.services.length)}),y(r,a)},$$slots:{default:!0}}),ve()}var Fm=E('<div class="tabs svelte-1t9psp2"><div class="tab active svelte-1t9psp2">Spec YAML</div> <div class="tab svelte-1t9psp2">Validation</div> <!></div> <pre class="spec-view svelte-1t9psp2"> </pre> <!>',1);function ou(e,t){fe(t,!0);const n=dh(),r=de(()=>n.status==="valid"?"Valid":n.status==="error"?"Errors":"Pending");Xn(e,{class:"spec-card",children:(s,a)=>{var i=Fm(),o=re(i),l=_(g(o),4);zm(l,{get status(){return n.status},get label(){return c(r)}});var u=_(o,2),d=g(u),f=_(u,2);Ld(f,{get errors(){return n.errors}}),O(()=>A(d,n.content)),y(s,i)},$$slots:{default:!0}}),ve()}Dt(["click"]);var Vm=E('<span class="dot active svelte-15dukw8"></span> ',1),qm=E('<div class="chat-header svelte-15dukw8"><!> <!></div>');function Hm(e,t){fe(t,!1);const n=ss();Ht();var r=qm(),s=g(r);Mt(s,{class:"header-pill",children:(i,o)=>{var l=Vm(),u=_(re(l));O(()=>A(u,` ${n.meta.name??""}`)),y(i,l)},$$slots:{default:!0}});var a=_(s,2);Mt(a,{variant:"ghost",children:(i,o)=>{var l=_t("DEV PLAYGROUND");y(i,l)},$$slots:{default:!0}}),y(e,r),ve()}var Zm=E('<details class="thinking-panel svelte-1xc7ue3"><summary class="thinking-summary svelte-1xc7ue3"> </summary> <div class="thinking-body svelte-1xc7ue3"><div class="markdown-content"><!></div></div></details>');function Xm(e,t){fe(t,!0);const n=u=>{const d=u.currentTarget;t.ontoggle?.(d.open)};var r=Zm(),s=g(r),a=g(s),i=_(s,2),o=g(i),l=g(o);sc(l,()=>Pd(t.observations)),O(()=>{r.open=t.open,A(a,t.isStreaming?"Thinking...":"Thought")}),Wf("toggle",r,n),y(e,r),ve()}var Km=E('<a class="pause-link svelte-sbh9b9" target="_blank" rel="noreferrer">Open authorization link</a>'),Jm=E('<div class="pause-token svelte-sbh9b9"> </div>'),Ym=E('<div class="pause-card svelte-sbh9b9"><div class="pause-title svelte-sbh9b9">Action required</div> <!> <!> <div class="pause-meta svelte-sbh9b9"> <!></div></div>');function Wm(e,t){fe(t,!0);const n=de(()=>t.pause.payload?.auth_url||t.pause.payload?.url||""),r=de(()=>t.pause.payload?.provider||"");var s=Ym(),a=_(g(s),2);{var i=v=>{var p=Km();O(()=>at(p,"href",c(n))),y(v,p)};I(a,v=>{c(n)&&v(i)})}var o=_(a,2);{var l=v=>{var p=Jm(),b=g(p);O(()=>A(b,`Resume token: ${t.pause.resume_token??""}`)),y(v,p)};I(o,v=>{t.pause.resume_token&&v(l)})}var u=_(o,2),d=g(u),f=_(d);{var h=v=>{var p=_t();O(()=>A(p,`- provider: ${c(r)??""}`)),y(v,p)};I(f,v=>{c(r)&&v(h)})}O(()=>A(d,`${t.pause.reason?`reason: ${t.pause.reason}`:"paused"} `)),y(e,s),ve()}var Qm=E('<div class="typing svelte-1gl9kj5"><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span></div>');function ey(e){var t=Qm();y(e,t)}const ty="modulepreload",ny=function(e){return"/"+e},lu={},rt=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");s=l(n.map(u=>{if(u=ny(u),u in lu)return;lu[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":ty,d||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),d)return new Promise((v,p)=>{h.addEventListener("load",v),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function Ao(e,t=[]){if(!e||typeof e!="object"||Array.isArray(e))return pa(new Error("Props must be an object."));const n=e;for(const r of t)if(!(r in n))return pa(new Error(`Missing required prop: ${r}`));return ro(n)}function ry(e,t){const n=e[t];return typeof n!="string"||!n.trim()?pa(new Error(`Invalid or missing string prop: ${t}`)):ro(e)}function sy(e,t){const n=e[t];return!n||typeof n!="object"||Array.isArray(n)?pa(new Error(`Invalid or missing object prop: ${t}`)):ro(e)}const ct=e=>Ao(e),ay=e=>{const t=Ao(e,["option"]);return t.ok?sy(t.data,"option"):t},iy=e=>{const t=Ao(e,["code"]);return t.ok?ry(t.data,"code"):t},oy={echarts:{load:()=>rt(()=>import("./ECharts-BBkaRltJ.js"),__vite__mapDeps([0,1])),validateProps:ay},mermaid:{load:()=>rt(()=>import("./Mermaid-BymvIKEV.js").then(e=>e.bA),__vite__mapDeps([2,3,4,5])),validateProps:iy},plotly:{load:()=>rt(()=>import("./Plotly-CCx5sBoC.js"),__vite__mapDeps([6,3,7])),validateProps:ct},datagrid:{load:()=>rt(()=>import("./DataGrid-bnp_ueOV.js"),__vite__mapDeps([8,9])),validateProps:ct},json:{load:()=>rt(()=>import("./Json-mUv6RMZ5.js"),__vite__mapDeps([10,11])),validateProps:ct},metric:{load:()=>rt(()=>import("./Metric-LyxAXz1J.js"),__vite__mapDeps([12,13])),validateProps:ct},markdown:{load:()=>rt(()=>import("./Markdown-BGfrotu-.js"),__vite__mapDeps([14,4,15,16,17])),validateProps:ct},code:{load:()=>rt(()=>import("./Code-CthstjSM.js"),__vite__mapDeps([18,19])),validateProps:ct},latex:{load:()=>rt(()=>import("./Latex-C_l7ODKx.js"),__vite__mapDeps([20,15,21,17])),validateProps:ct},callout:{load:()=>rt(()=>import("./Callout-IE8nu5-9.js"),__vite__mapDeps([22,14,4,15,16,17,23])),validateProps:ct},form:{load:()=>rt(()=>import("./Form-74YU3wNj.js"),__vite__mapDeps([24,25])),validateProps:ct},confirm:{load:()=>rt(()=>import("./Confirm-B63UY2g_.js"),__vite__mapDeps([26,14,4,15,16,17,27])),validateProps:ct},select_option:{load:()=>rt(()=>import("./SelectOption-B_0uPwtb.js"),__vite__mapDeps([28,29])),validateProps:ct},report:{load:()=>rt(()=>import("./Report-YbELa83v.js"),__vite__mapDeps([30,14,4,15,16,17,31])),validateProps:ct},grid:{load:()=>rt(()=>import("./Grid-DA-D4GmC.js"),__vite__mapDeps([32,33])),validateProps:ct},tabs:{load:()=>rt(()=>import("./Tabs-QpVhpYQi.js"),__vite__mapDeps([34,14,4,15,16,17,35])),validateProps:ct},accordion:{load:()=>rt(()=>import("./Accordion-Dl6wN9Vi.js"),__vite__mapDeps([36,14,4,15,16,17,37])),validateProps:ct},image:{load:()=>rt(()=>import("./Image-BkSVb7GW.js"),__vite__mapDeps([38,39])),validateProps:ct},html:{load:()=>rt(()=>import("./Html-B31GZ0RD.js"),__vite__mapDeps([40,41])),validateProps:ct},video:{load:()=>rt(()=>import("./Video-q97f_mwO.js"),__vite__mapDeps([42,43])),validateProps:ct},embed:{load:()=>rt(()=>import("./Embed-Ca9ERMMu.js"),__vite__mapDeps([44,45])),validateProps:ct}};var ly=E("<div><!></div>"),uy=E('<div class="artifact-error svelte-1ly7nl2"><strong> </strong> <pre class="svelte-1ly7nl2"> </pre></div>'),cy=E('<div class="renderer-loading svelte-1ly7nl2">Loading...</div>');function Bi(e,t){fe(t,!0);let n=dt(t,"props",19,()=>({})),r=dt(t,"onResult",3,void 0);const s=io(),a=de(()=>s.getComponent(t.component)),i=de(()=>c(a)?.interactive??!1),o=de(async()=>{const d=oy[t.component];if(!d)return{ok:!1,error:new Error(`Renderer not found: ${t.component}`)};try{const f=await d.load(),h=d.validateProps(n());return h.ok?{ok:!0,data:{Renderer:f.default,props:h.data}}:h}catch(f){return{ok:!1,error:qv(f,`Failed to load renderer: ${t.component}`)}}});var l=je(),u=re(l);av(u,()=>c(o),d=>{var f=cy();y(d,f)},(d,f)=>{var h=je(),v=re(h);{var p=m=>{const S=de(()=>c(f).data.Renderer);var k=ly();let w;var T=g(k);dv(T,()=>c(S),(N,C)=>{C(N,Tv(()=>c(f).data.props,{get onResult(){return r()}}))}),O(()=>{w=ke(k,1,"artifact svelte-1ly7nl2",null,w,{interactive:c(i)}),at(k,"data-component",t.component)}),y(m,k)},b=m=>{var S=uy(),k=g(S),w=g(k),T=_(k),N=_(T),C=g(N);O(M=>{A(w,`Failed to render ${t.component??""}:`),A(T,` ${c(f).error.message??""} `),A(C,M)},[()=>JSON.stringify(n(),null,2)]),y(m,S)};I(v,m=>{c(f).ok?m(p):m(b,!1)})}y(d,h)}),y(e,l),ve()}var dy=E('<span class="artifact-pill svelte-1dv1zra"> </span>'),fy=E('<span class="artifact-spinner svelte-1dv1zra"></span>'),vy=E('<button type="button" class="artifact-chip svelte-1dv1zra"><span class="artifact-icon svelte-1dv1zra"></span> <span class="artifact-name svelte-1dv1zra"> </span> <span class="artifact-meta svelte-1dv1zra"> <!></span> <!></button>'),hy=E('<div class="artifact-error svelte-1dv1zra" role="alert"> </div>'),py=E('<div class="message-artifacts svelte-1dv1zra"><div class="artifacts-label svelte-1dv1zra">Attachments</div> <div class="artifacts-list svelte-1dv1zra"></div> <!></div>'),gy=E('<div class="artifact-title svelte-1dv1zra"> </div>'),_y=E("<!> <!>",1),my=E('<div class="component-artifacts svelte-1dv1zra"></div>'),yy=E('<div class="component-interaction svelte-1dv1zra"><!></div>'),by=E('<span class="link svelte-1dv1zra"> </span>'),Sy=E('<div><div><!> <div class="markdown-content"><!></div> <!> <!> <!> <!> <!></div> <div class="meta-row svelte-1dv1zra"><span> </span> <!></div></div>');function ky(e,t){fe(t,!0);let n=dt(t,"message",7);const r=de(()=>n().role==="agent"&&n().observations&&n().observations.trim()!==""),s=ao(),a=ur();let i=G(null),o=G(null);const l=de(()=>s.artifacts.filter(j=>j.message_id===n().id)),u=de(()=>{const j=s.pendingInteraction;return!j||j.message_id!==n().id?null:j});async function d(j,te){if(x(i,j,!0),x(o,null),!a.sessionId){x(o,"Session not available."),x(i,null);return}try{await oo(j,a.sessionId,te??void 0)}catch(he){x(o,he instanceof Error?he.message:"Download failed.",!0)}finally{x(i,null)}}var f=Sy(),h=g(f),v=g(h);{var p=j=>{{let te=de(()=>n().showObservations??!1),he=de(()=>n().isStreaming??!1);Xm(j,{get observations(){return n().observations},get open(){return c(te)},get isStreaming(){return c(he)},ontoggle:pe=>{n().showObservations=pe}})}};I(v,j=>{c(r)&&j(p)})}var b=_(v,2),m=g(b);sc(m,()=>Pd(n().text));var S=_(b,2);{var k=j=>{var te=py(),he=_(g(te),2);Ue(he,21,()=>n().artifacts,ce=>ce.id,(ce,me)=>{var nt=vy();nt.__click=()=>d(c(me).id,c(me).filename);var ft=g(nt),ne=_(ft,2),xt=g(ne),vt=_(ne,2),W=g(vt),lt=_(W);{var on=ut=>{var Q=dy(),Ae=g(Q);O(ht=>A(Ae,ht),[()=>fc(c(me).mime_type)]),y(ut,Q)};I(lt,ut=>{c(me).mime_type&&ut(on)})}var ln=_(vt,2);{var _n=ut=>{var Q=fy();y(ut,Q)};I(ln,ut=>{c(i)===c(me).id&&ut(_n)})}O((ut,Q)=>{nt.disabled=c(i)===c(me).id,at(nt,"title",c(me).filename||c(me).id),at(ft,"data-type",ut),A(xt,c(me).filename||c(me).id),A(W,`${Q??""} `)},[()=>dc(c(me).mime_type),()=>cc(c(me).size_bytes)]),y(ce,nt)});var pe=_(he,2);{var Ke=ce=>{var me=hy(),nt=g(me);O(()=>A(nt,c(o))),y(ce,me)};I(pe,ce=>{c(o)&&ce(Ke)})}y(j,te)};I(S,j=>{n().role==="agent"&&n().artifacts?.length&&j(k)})}var w=_(S,2);{var T=j=>{var te=my();Ue(te,21,()=>c(l),he=>he.id,(he,pe)=>{var Ke=_y(),ce=re(Ke);{var me=ft=>{var ne=gy(),xt=g(ne);O(()=>A(xt,c(pe).title)),y(ft,ne)};I(ce,ft=>{c(pe).title&&ft(me)})}var nt=_(ce,2);Bi(nt,{get component(){return c(pe).component},get props(){return c(pe).props}}),y(he,Ke)}),y(j,te)};I(w,j=>{n().role==="agent"&&c(l).length>0&&j(T)})}var N=_(w,2);{var C=j=>{var te=yy(),he=g(te);Bi(he,{get component(){return c(u).component},get props(){return c(u).props},onResult:pe=>t.onInteractionResult?.(c(u),pe)}),y(j,te)};I(N,j=>{n().role==="agent"&&c(u)&&j(C)})}var M=_(N,2);{var z=j=>{Wm(j,{get pause(){return n().pause}})};I(M,j=>{n().pause&&j(z)})}var $=_(M,2);{var P=j=>{ey(j)};I($,j=>{(n().isStreaming||n().isThinking)&&j(P)})}var F=_(h,2),U=g(F),V=g(U),H=_(U,2);{var Y=j=>{var te=by(),he=g(te);O(()=>A(he,`#${n().traceId??""}`)),y(j,te)};I(H,j=>{n().traceId&&j(Y)})}O(j=>{ke(f,1,`message-row ${n().role==="agent"?"agent":"user"}`,"svelte-1dv1zra"),ke(h,1,`bubble ${n().role}`,"svelte-1dv1zra"),A(V,j)},[()=>Cv(n().ts)]),y(e,f),ve()}Dt(["click"]);var wy=E('<div class="chat-body svelte-mwyedf"><!></div>');function Ey(e,t){fe(t,!0);const n=_c();let r=dt(t,"chatBodyEl",15,null);var s=wy(),a=g(s);{var i=l=>{Fa(l,{icon:"*",title:"Ready to test agent behavior.",subtitle:"Type a message below to start a run."})},o=l=>{var u=je(),d=re(u);Ue(d,17,()=>n.messages,f=>f.id,(f,h)=>{ky(f,{get message(){return c(h)},get onInteractionResult(){return t.onInteractionResult}})}),y(l,u)};I(a,l=>{n.isEmpty?l(i):l(o,!1)})}Ss(s,l=>r(l),()=>r()),y(e,s),ve()}var xy=E('<div class="input-modes svelte-esbonz"><span class="mode-label svelte-esbonz">Mode</span> <div class="mode-toggle svelte-esbonz"><button type="button">New message</button> <button type="button">Steer task</button></div></div>'),Ty=E('<div class="steering-indicator svelte-esbonz"><span class="steering-dot svelte-esbonz"></span> Steering...</div>'),Ay=E('<div><!> <!> <div class="input-row svelte-esbonz"><textarea class="svelte-esbonz"></textarea> <button> </button></div></div>');function Iy(e,t){fe(t,!0);const n=_c(),r=ur(),s=wc();let a=G(!1);const i=de(()=>{const U=s.foregroundTaskId;return U?s.tasks.find(V=>V.task_id===U)??null:null}),o=de(()=>{if(!c(i))return!1;const U=s.foregroundStatus??c(i).status;return U==="RUNNING"||U==="PENDING"||U==="PAUSED"}),l=de(()=>s.backgroundTasks);let u=G("new"),d=G(!1);sr(()=>{if(!c(o)){x(u,"new"),x(d,!1);return}!c(d)&&!n.input.trim()&&x(u,"steer")});const f=de(()=>c(o)&&c(u)==="steer"),h=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),v())},v=async()=>{c(f)?await p():t.onsubmit()},p=async()=>{const U=n.input.trim();if(!U||!c(i))return;x(a,!0);const V=c(l).map(H=>({task_id:H.task_id,description:H.description||"",status:H.status,task_type:H.task_type,priority:H.priority??0}));try{await N_(r.sessionId,c(i).task_id,U,V)&&n.clearInput()}finally{setTimeout(()=>{x(a,!1)},300)}},b=de(()=>c(f)?!n.input.trim()||c(a):r.isSending||!n.input.trim()),m=U=>{x(u,U,!0),x(d,!0)};var S=Ay();let k;var w=g(S);{var T=U=>{var V=xy(),H=_(g(V),2),Y=g(H);let j;Y.__click=()=>m("new");var te=_(Y,2);let he;te.__click=()=>m("steer"),O(()=>{j=ke(Y,1,"mode-btn svelte-esbonz",null,j,{active:c(u)==="new"}),he=ke(te,1,"mode-btn svelte-esbonz",null,he,{active:c(u)==="steer"})}),y(U,V)};I(w,U=>{c(o)&&U(T)})}var N=_(w,2);{var C=U=>{var V=Ty();y(U,V)};I(N,U=>{c(a)&&U(C)})}var M=_(N,2),z=g(M);z.__keydown=h;var $=_(z,2);let P;$.__click=v;var F=g($);O(()=>{k=ke(S,1,"chat-input svelte-esbonz",null,k,{"steering-mode":c(f)}),at(z,"placeholder",c(f)?"Steer the agent with new instructions...":"Ask your agent something..."),P=ke($,1,"send-btn svelte-esbonz",null,P,{"steer-btn":c(f)}),$.disabled=c(b),at($,"title",c(f)?"Send steering instruction to running task":"Send message"),A(F,c(f)?"!":">")}),pr(z,()=>n.input,U=>n.input=U),y(e,S),ve()}Dt(["click","keydown"]);const $d=Symbol("agui");function Cy(e){qt($d,e)}function Dd(){const e=Yt($d);if(!e)throw new Error("AGUIProvider not found");return e}var Ny=E('<span class="dots svelte-z9q8sr">...</span>'),Ry=E('<div class="result svelte-z9q8sr"><div class="label svelte-z9q8sr">Result</div> <pre class="svelte-z9q8sr"> </pre></div>'),Oy=E('<div><div class="header svelte-z9q8sr"><span class="icon svelte-z9q8sr">tool</span> <strong class="svelte-z9q8sr"> </strong> <!></div> <pre class="args svelte-z9q8sr"> </pre> <!></div>');function My(e,t){fe(t,!1);const n=Bn();let r=dt(t,"toolCall",8);Gu(()=>Gt(r()),()=>{x(n,(()=>{try{return JSON.parse(r().arguments)}catch{return null}})())}),Bu(),Ht();var s=Oy();let a;var i=g(s),o=_(g(i),2),l=g(o),u=_(o,2);{var d=b=>{var m=Ny();y(b,m)};I(u,b=>{Gt(r()),Ie(()=>r().isStreaming)&&b(d)})}var f=_(i,2),h=g(f),v=_(f,2);{var p=b=>{var m=Ry(),S=_(g(m),2),k=g(S);O(()=>A(k,(Gt(r()),Ie(()=>r().result)))),y(b,m)};I(v,b=>{Gt(r()),Ie(()=>r().result)&&b(p)})}O(b=>{a=ke(s,1,"agui-tool-call svelte-z9q8sr",null,a,{streaming:r().isStreaming}),A(l,(Gt(r()),Ie(()=>r().name))),A(h,`${b??""}
  `)},[()=>(c(n),Gt(r()),Ie(()=>c(n)?JSON.stringify(c(n),null,2):r().arguments))]),y(e,s),ve()}var Py=E('<span class="cursor svelte-19eh49q">|</span>'),Ly=E('<div class="agui-tool-calls svelte-19eh49q"></div>'),$y=E('<div><div><div class="agui-role svelte-19eh49q"> </div> <div class="agui-message-content svelte-19eh49q"> <!></div> <!></div></div>');function Dy(e,t){fe(t,!1);let n=dt(t,"message",8);Ht();var r=$y(),s=g(r),a=g(s),i=g(a),o=_(a,2),l=g(o),u=_(l);{var d=v=>{var p=Py();y(v,p)};I(u,v=>{Gt(n()),Ie(()=>n().isStreaming)&&v(d)})}var f=_(o,2);{var h=v=>{var p=Ly();Ue(p,5,()=>(Gt(n()),Ie(()=>n().toolCalls)),b=>b.id,(b,m)=>{My(b,{get toolCall(){return c(m)}})}),y(v,p)};I(f,v=>{Gt(n()),Ie(()=>n().toolCalls.length>0)&&v(h)})}O(()=>{ke(r,1,(Gt(n()),Ie(()=>`agui-message-row ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),ke(s,1,(Gt(n()),Ie(()=>`agui-bubble ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),A(i,(Gt(n()),Ie(()=>n().role))),A(l,(Gt(n()),Ie(()=>n().content)))}),y(e,r),ve()}var Uy=E('<p class="agui-empty svelte-15on836">No messages yet</p>'),zy=E('<div class="agui-message-list svelte-15on836"><!> <!></div>');function jy(e,t){fe(t,!1);const n=()=>ds(a,"$messages",r),[r,s]=lc(),{messages:a}=Dd();let i=Bn();Gu(()=>(n(),c(i)),()=>{n().length&&c(i)&&requestAnimationFrame(()=>{c(i)&&Jn(i,c(i).scrollTop=c(i).scrollHeight)})}),Bu(),Ht();var o=zy(),l=g(o);Ue(l,1,n,f=>f.id,(f,h)=>{Dy(f,{get message(){return c(h)}})});var u=_(l,2);{var d=f=>{var h=je(),v=re(h);cv(v,t,"empty",{},p=>{var b=Uy();y(p,b)}),y(f,h)};I(u,f=>{n(),Ie(()=>n().length===0)&&f(d)})}Ss(o,f=>x(i,f),()=>c(i)),y(e,o),ve(),s()}var Gy=E("<li> </li>"),By=E('<section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Active Steps</h4> <ul class="svelte-rwecvr"></ul></section>'),Fy=E('<section class="error svelte-rwecvr"><h4 class="svelte-rwecvr">Error</h4> <pre class="svelte-rwecvr"> </pre></section>'),Vy=E('<details class="agui-debugger svelte-rwecvr"><summary class="svelte-rwecvr">AG-UI Debug <span> </span></summary> <div class="content svelte-rwecvr"><section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Thread / Run</h4> <code class="svelte-rwecvr"> </code></section> <!> <section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Agent State</h4> <pre class="svelte-rwecvr"> </pre></section> <!></div></details>');function qy(e,t){fe(t,!1);const n=()=>ds(u,"$status",i),r=()=>ds(l,"$state",i),s=()=>ds(f,"$activeSteps",i),a=()=>ds(d,"$agentState",i),[i,o]=lc(),{state:l,status:u,agentState:d,activeSteps:f}=Dd();let h=dt(t,"expanded",12,!1);Ht();var v=Vy(),p=g(v),b=_(g(p));let m;var S=g(b),k=_(p,2),w=g(k),T=_(g(w),2),N=g(T),C=_(w,2);{var M=V=>{var H=By(),Y=_(g(H),2);Ue(Y,5,s,Jr,(j,te)=>{var he=Gy(),pe=g(he);O(()=>A(pe,(c(te),Ie(()=>c(te).name)))),y(j,he)}),y(V,H)};I(C,V=>{s(),Ie(()=>s().length>0)&&V(M)})}var z=_(C,2),$=_(g(z),2),P=g($),F=_(z,2);{var U=V=>{var H=Fy(),Y=_(g(H),2),j=g(Y);O(te=>A(j,te),[()=>(r(),Ie(()=>JSON.stringify(r().error,null,2)))]),y(V,H)};I(F,V=>{r(),Ie(()=>r().error)&&V(U)})}O(V=>{m=ke(b,1,"status svelte-rwecvr",null,m,{running:n()==="running",error:n()==="error"}),A(S,n()),A(N,`${r(),Ie(()=>r().threadId??"â")??""} / ${r(),Ie(()=>r().runId??"â")??""}`),A(P,V)},[()=>(a(),Ie(()=>JSON.stringify(a(),null,2)))]),Sv("open","toggle",v,h,h),y(e,v),ve(),o()}var Hy=E('<div class="muted tiny svelte-asidmd"> </div>'),Zy=E('<div><div class="label svelte-asidmd"> </div> <!> <!></div>');function Dr(e,t){let n=dt(t,"full",3,!1);var r=Zy();let s;var a=g(r),i=g(a),o=_(a,2);It(o,()=>t.children??et);var l=_(o,2);{var u=d=>{var f=Hy(),h=g(f);O(()=>A(h,t.hint)),y(d,f)};I(l,d=>{t.hint&&d(u)})}O(()=>{s=ke(r,1,"setup-field svelte-asidmd",null,s,{full:n()}),A(i,t.label)}),y(e,r)}var Xy=E('<div class="row gap svelte-18icuuu"><input class="setup-input svelte-18icuuu"/> <button class="ghost-btn small svelte-18icuuu">New</button></div>'),Ky=E('<input class="setup-input svelte-18icuuu"/>'),Jy=E('<input class="setup-input svelte-18icuuu"/>'),Yy=E('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),Wy=E('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),Qy=E('<label class="toggle-row svelte-18icuuu"><input class="toggle-input svelte-18icuuu" type="checkbox"/> <span>Use AG-UI</span></label>'),eb=E('<div class="agui-preview svelte-18icuuu"><div class="agui-preview-title svelte-18icuuu">AG-UI Preview</div> <!> <!></div>'),tb=E('<div class="setup-body svelte-18icuuu"><div class="setup-grid svelte-18icuuu"><!> <!> <!> <!> <!> <!></div> <!> <!></div>');function nb(e,t){fe(t,!1);const n={messages:vr([{id:"preview-msg",role:"assistant",content:"AG-UI preview message with a tool call.",isStreaming:!1,toolCalls:[{id:"preview-call",name:"search",arguments:'{"query":"preview"}',isStreaming:!1,result:"ok"}]}]),state:vr({status:"idle",threadId:"preview-thread",runId:"preview-run",messages:[],agentState:{mode:"preview"},activeSteps:[],error:null}),status:vr("idle"),agentState:vr({mode:"preview"}),isRunning:vr(!1),error:vr(null),activeSteps:vr([]),sendMessage:async()=>{},cancel:()=>{},reset:()=>{}},r=Bn(ur()),s=Bn(hh()),a=Da(),i=so(),o=ao();Cy(n),Ht();var l=tb(),u=g(l),d=g(u);Dr(d,{label:"Session ID",hint:"Used to scope short-term memory and trajectory lookups.",children:(T,N)=>{var C=Xy(),M=g(C),z=_(M,2);z.__click=()=>{c(r).newSession(),a.clear(),i.clear(),o.clear()},pr(M,()=>c(r).sessionId,$=>Jn(r,c(r).sessionId=$)),y(T,C)},$$slots:{default:!0}});var f=_(d,2);Dr(f,{label:"Tenant ID",children:(T,N)=>{var C=Ky();pr(C,()=>c(s).tenantId,M=>Jn(s,c(s).tenantId=M)),y(T,C)},$$slots:{default:!0}});var h=_(f,2);Dr(h,{label:"User ID",children:(T,N)=>{var C=Jy();pr(C,()=>c(s).userId,M=>Jn(s,c(s).userId=M)),y(T,C)},$$slots:{default:!0}});var v=_(h,2);Dr(v,{label:"Tool Context (JSON)",hint:"Merged with tenant/user and injected as runtime tool_context.",full:!0,children:(T,N)=>{var C=Yy();at(C,"placeholder",'{"any_runtime_key": "value"}'),pr(C,()=>c(s).toolContextRaw,M=>Jn(s,c(s).toolContextRaw=M)),y(T,C)},$$slots:{default:!0}});var p=_(v,2);Dr(p,{label:"LLM Context (JSON)",hint:"Only used when the playground wraps a planner entry point.",full:!0,children:(T,N)=>{var C=Wy();at(C,"placeholder","{}"),pr(C,()=>c(s).llmContextRaw,M=>Jn(s,c(s).llmContextRaw=M)),y(T,C)},$$slots:{default:!0}});var b=_(p,2);Dr(b,{label:"Streaming Protocol",hint:"Enable AG-UI streaming for the playground.",full:!0,children:(T,N)=>{var C=Qy(),M=g(C);yv(M,()=>c(s).useAgui,z=>Jn(s,c(s).useAgui=z)),y(T,C)},$$slots:{default:!0}});var m=_(u,2);{var S=T=>{{let N=La(()=>[{id:"setup-err",message:c(s).error}]);Ld(T,{get errors(){return c(N)}})}};I(m,T=>{c(s).error&&T(S)})}var k=_(m,2);{var w=T=>{var N=eb(),C=_(g(N),2);jy(C,{});var M=_(C,2);qy(M,{}),y(T,N)};I(k,T=>{c(s).useAgui&&T(w)})}y(e,l),ve()}Dt(["click"]);var rb=E('<span class="badge active svelte-184tvz6">Active</span>'),sb=E('<span class="badge svelte-184tvz6">Disabled</span>'),ab=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6">Summary</h4> <div class="summary-text svelte-184tvz6"> </div></div>'),ib=E('<span class="digest-item svelte-184tvz6"> </span>'),ob=E('<span class="digest-item svelte-184tvz6"> </span>'),lb=E('<div class="turn-digest svelte-184tvz6"><!> <!></div>'),ub=E('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div> <!></div>'),cb=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list svelte-184tvz6"></div></div>'),db=E('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div></div>'),fb=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list pending svelte-184tvz6"></div></div>'),vb=E("<!> <!> <!>",1),hb=E('<div class="empty-section svelte-184tvz6">Short-term memory is not enabled or no conversation history exists.</div>'),pb=E('<div class="section-content svelte-184tvz6"><!></div>'),gb=E('<pre class="json-block svelte-184tvz6"> </pre>'),_b=E('<div class="empty-section svelte-184tvz6">No additional LLM context was injected (besides memory).</div>'),mb=E('<div class="section-content svelte-184tvz6"><!></div>'),yb=E('<span class="badge active svelte-184tvz6"> </span>'),bb=E('<span class="badge muted svelte-184tvz6">Consumed</span>'),Sb=E('<div class="result-summary svelte-184tvz6"> </div>'),kb=E("<span> </span>"),wb=E("<span> </span>"),Eb=E("<span> </span>"),xb=E("<span> </span>"),Tb=E('<pre class="json-block svelte-184tvz6"> </pre>'),Ab=E('<details class="result-details svelte-184tvz6"><summary class="svelte-184tvz6">Payload</summary> <pre class="json-block svelte-184tvz6"> </pre></details>'),Ib=E('<div class="background-result svelte-184tvz6"><div class="result-header svelte-184tvz6"><div class="result-title svelte-184tvz6"> </div> <div class="result-badges svelte-184tvz6"><span> </span> <!></div></div> <!> <div class="result-meta svelte-184tvz6"><!> <!> <!> <!></div> <!> <!></div>'),Cb=E('<div class="background-results svelte-184tvz6"></div>'),Nb=E('<div class="empty-section svelte-184tvz6">No background task results yet.</div>'),Rb=E('<div class="section-content svelte-184tvz6"><!></div>'),Ob=E('<pre class="json-block svelte-184tvz6"> </pre>'),Mb=E('<div class="empty-section svelte-184tvz6">No tool context was passed.</div>'),Pb=E('<div class="section-content svelte-184tvz6"><!></div>'),Lb=E('<section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Conversation Memory <!></span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">LLM Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Background Results <!></span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Tool Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section>',1),$b=E('<div class="context-body svelte-184tvz6"><!></div>');function Db(e,t){fe(t,!0);const n=Da();let r=G(!0),s=G(!0),a=G(!0),i=G(!1);const o=de(()=>{if(!n.llmContext)return null;const{conversation_memory:S,background_result:k,background_results:w,...T}=n.llmContext;return Object.keys(T).length>0?T:null}),l=de(()=>{const S=n.backgroundResults;return S?Object.values(S).sort((k,w)=>{const T=typeof k.completed_at=="number"?k.completed_at:0;return(typeof w.completed_at=="number"?w.completed_at:0)-T}):[]}),u=S=>{try{return JSON.stringify(S,null,2)}catch{return String(S)}},d=(S,k=100)=>S.length<=k?S:S.slice(0,k)+"...",f=S=>typeof S!="number"?"":new Date(S*1e3).toLocaleTimeString(),h=S=>{const k=S?.toLowerCase();return k==="failed"?"badge error":k==="completed"?"badge success":"badge"};var v=$b(),p=g(v);{var b=S=>{Fa(S,{icon:"*",title:"No context yet",subtitle:"Send a prompt to see injected context."})},m=S=>{var k=Lb(),w=re(k),T=g(w);T.__click=()=>x(r,!c(r));var N=g(T),C=_(g(N));{var M=Q=>{var Ae=rb();y(Q,Ae)},z=Q=>{var Ae=sb();y(Q,Ae)};I(C,Q=>{n.hasMemory?Q(M):Q(z,!1)})}var $=_(N,2);let P;var F=_(T,2);{var U=Q=>{var Ae=pb(),ht=g(Ae);{var Wt=Ee=>{var qe=vb(),Ut=re(qe);{var Ne=pt=>{var mt=ab(),zt=_(g(mt),2),cn=g(zt);O(()=>A(cn,n.conversationMemory.summary)),y(pt,mt)};I(Ut,pt=>{n.conversationMemory.summary&&pt(Ne)})}var un=_(Ut,2);{var Kn=pt=>{var mt=cb(),zt=g(mt),cn=g(zt),ie=_(zt,2);Ue(ie,21,()=>n.conversationMemory.recent_turns,Jr,(ye,xe,gt)=>{var Tt=ub(),Zt=g(Tt);Zt.textContent=`Turn ${gt+1}`;var jt=_(Zt,2),en=_(g(jt),2),ee=g(en),oe=_(jt,2),Oe=_(g(oe),2),Me=g(Oe),Je=_(oe,2);{var Ct=yt=>{var Nt=lb(),le=g(Nt);{var _e=it=>{var dn=ib(),Nn=g(dn);O(fr=>A(Nn,`Tools: ${fr??""}`),[()=>c(xe).trajectory_digest.tools_invoked.join(", ")]),y(it,dn)};I(le,it=>{c(xe).trajectory_digest.tools_invoked?.length&&it(_e)})}var Ye=_(le,2);{var Ge=it=>{var dn=ob(),Nn=g(dn);O(fr=>A(Nn,`Obs: ${fr??""}`),[()=>d(c(xe).trajectory_digest.observations_summary,80)]),y(it,dn)};I(Ye,it=>{c(xe).trajectory_digest.observations_summary&&it(Ge)})}y(yt,Nt)};I(Je,yt=>{c(xe).trajectory_digest&&yt(Ct)})}O((yt,Nt)=>{A(ee,yt),A(Me,Nt)},[()=>d(c(xe).user,150),()=>d(c(xe).assistant,150)]),y(ye,Tt)}),O(()=>A(cn,`Recent Turns (${n.conversationMemory.recent_turns.length??""})`)),y(pt,mt)};I(un,pt=>{n.conversationMemory.recent_turns?.length&&pt(Kn)})}var Cn=_(un,2);{var dr=pt=>{var mt=fb(),zt=g(mt),cn=g(zt),ie=_(zt,2);Ue(ie,21,()=>n.conversationMemory.pending_turns,Jr,(ye,xe,gt)=>{var Tt=db(),Zt=g(Tt);Zt.textContent=`Pending ${gt+1}`;var jt=_(Zt,2),en=_(g(jt),2),ee=g(en),oe=_(jt,2),Oe=_(g(oe),2),Me=g(Oe);O((Je,Ct)=>{A(ee,Je),A(Me,Ct)},[()=>d(c(xe).user,100),()=>d(c(xe).assistant,100)]),y(ye,Tt)}),O(()=>A(cn,`Pending Turns (${n.conversationMemory.pending_turns.length??""})`)),y(pt,mt)};I(Cn,pt=>{n.conversationMemory.pending_turns?.length&&pt(dr)})}y(Ee,qe)},Qt=Ee=>{var qe=hb();y(Ee,qe)};I(ht,Ee=>{n.conversationMemory?Ee(Wt):Ee(Qt,!1)})}y(Q,Ae)};I(F,Q=>{c(r)&&Q(U)})}var V=_(w,2),H=g(V);H.__click=()=>x(s,!c(s));var Y=_(g(H),2);let j;var te=_(H,2);{var he=Q=>{var Ae=mb(),ht=g(Ae);{var Wt=Ee=>{var qe=gb(),Ut=g(qe);O(Ne=>A(Ut,Ne),[()=>u(c(o))]),y(Ee,qe)},Qt=Ee=>{var qe=_b();y(Ee,qe)};I(ht,Ee=>{c(o)?Ee(Wt):Ee(Qt,!1)})}y(Q,Ae)};I(te,Q=>{c(s)&&Q(he)})}var pe=_(V,2),Ke=g(pe);Ke.__click=()=>x(a,!c(a));var ce=g(Ke),me=_(g(ce));{var nt=Q=>{var Ae=yb(),ht=g(Ae);O(()=>A(ht,c(l).length)),y(Q,Ae)};I(me,Q=>{c(l).length>0&&Q(nt)})}var ft=_(ce,2);let ne;var xt=_(Ke,2);{var vt=Q=>{var Ae=Rb(),ht=g(Ae);{var Wt=Ee=>{var qe=Cb();Ue(qe,21,()=>c(l),Ut=>Ut.task_id,(Ut,Ne)=>{var un=Ib(),Kn=g(un),Cn=g(Kn),dr=g(Cn),pt=_(Cn,2),mt=g(pt),zt=g(mt),cn=_(mt,2);{var ie=le=>{var _e=bb();y(le,_e)};I(cn,le=>{c(Ne).consumed&&le(ie)})}var ye=_(Kn,2);{var xe=le=>{var _e=Sb(),Ye=g(_e);O(()=>A(Ye,c(Ne).summary)),y(le,_e)};I(ye,le=>{c(Ne).summary&&le(xe)})}var gt=_(ye,2),Tt=g(gt);{var Zt=le=>{var _e=kb(),Ye=g(_e);O(Ge=>A(Ye,`Group ${Ge??""}`),[()=>c(Ne).group_id.slice(0,8)]),y(le,_e)};I(Tt,le=>{c(Ne).group_id&&le(Zt)})}var jt=_(Tt,2);{var en=le=>{var _e=wb(),Ye=g(_e);O(Ge=>A(Ye,Ge),[()=>f(c(Ne).completed_at)]),y(le,_e)};I(jt,le=>{c(Ne).completed_at&&le(en)})}var ee=_(jt,2);{var oe=le=>{var _e=Eb(),Ye=g(_e);O(()=>A(Ye,`${c(Ne).artifacts.length??""} artifacts`)),y(le,_e)};I(ee,le=>{c(Ne).artifacts?.length&&le(oe)})}var Oe=_(ee,2);{var Me=le=>{var _e=xb(),Ye=g(_e);O(Ge=>A(Ye,`${Ge??""} facts`),[()=>Object.keys(c(Ne).facts).length]),y(le,_e)};I(Oe,le=>{c(Ne).facts&&Object.keys(c(Ne).facts).length>0&&le(Me)})}var Je=_(gt,2);{var Ct=le=>{var _e=Tb(),Ye=g(_e);O(Ge=>A(Ye,Ge),[()=>u(c(Ne).facts)]),y(le,_e)};I(Je,le=>{c(Ne).facts&&Object.keys(c(Ne).facts).length>0&&le(Ct)})}var yt=_(Je,2);{var Nt=le=>{var _e=Ab(),Ye=_(g(_e),2),Ge=g(Ye);O(it=>A(Ge,it),[()=>u(c(Ne).payload)]),y(le,_e)};I(yt,le=>{c(Ne).payload!=null&&le(Nt)})}O((le,_e,Ye)=>{A(dr,`Task ${le??""}`),ke(mt,1,_e,"svelte-184tvz6"),A(zt,Ye)},[()=>c(Ne).task_id.slice(0,8),()=>vv(h(c(Ne).status)),()=>(c(Ne).status??"completed").toUpperCase()]),y(Ut,un)}),y(Ee,qe)},Qt=Ee=>{var qe=Nb();y(Ee,qe)};I(ht,Ee=>{c(l).length>0?Ee(Wt):Ee(Qt,!1)})}y(Q,Ae)};I(xt,Q=>{c(a)&&Q(vt)})}var W=_(pe,2),lt=g(W);lt.__click=()=>x(i,!c(i));var on=_(g(lt),2);let ln;var _n=_(lt,2);{var ut=Q=>{var Ae=Pb(),ht=g(Ae);{var Wt=Ee=>{var qe=Ob(),Ut=g(qe);O(Ne=>A(Ut,Ne),[()=>u(n.toolContext)]),y(Ee,qe)},Qt=Ee=>{var qe=Mb();y(Ee,qe)};I(ht,Ee=>{n.toolContext&&Object.keys(n.toolContext).length>0?Ee(Wt):Ee(Qt,!1)})}y(Q,Ae)};I(_n,Q=>{c(i)&&Q(ut)})}O(()=>{at(T,"aria-expanded",c(r)),P=ke($,1,"chevron svelte-184tvz6",null,P,{expanded:c(r)}),at(H,"aria-expanded",c(s)),j=ke(Y,1,"chevron svelte-184tvz6",null,j,{expanded:c(s)}),at(Ke,"aria-expanded",c(a)),ne=ke(ft,1,"chevron svelte-184tvz6",null,ne,{expanded:c(a)}),at(lt,"aria-expanded",c(i)),ln=ke(on,1,"chevron svelte-184tvz6",null,ln,{expanded:c(i)})}),y(S,k)};I(p,S=>{n.hasContext?S(m,!1):S(b)})}y(e,v),ve()}Dt(["click"]);var Ub=E('<button><span class="name svelte-al447k"> </span> <span class="meta svelte-al447k"> </span></button>'),zb=E('<div class="error svelte-al447k"> </div>'),jb=E('<div class="empty svelte-al447k">Fix payload to preview.</div>'),Gb=E('<header class="svelte-al447k"><div><h2 class="svelte-al447k"> </h2> <p class="svelte-al447k"> </p></div> <div class="actions svelte-al447k"><button class="svelte-al447k">Use Example</button> <button class="svelte-al447k">Use Last Artifact</button> <button class="svelte-al447k">Reset</button></div></header> <div class="detail-grid svelte-al447k"><div class="schema svelte-al447k"><h4 class="svelte-al447k">Props Schema</h4> <pre class="svelte-al447k"> </pre></div> <div class="example svelte-al447k"><h4 class="svelte-al447k">Example</h4> <pre class="svelte-al447k"> </pre></div></div> <div class="editor svelte-al447k"><h4 class="svelte-al447k">Payload</h4> <textarea class="svelte-al447k"></textarea> <!></div> <div class="preview svelte-al447k"><h4 class="svelte-al447k">Preview</h4> <!></div>',1),Bb=E('<div class="empty svelte-al447k">No registry loaded.</div>'),Fb=E('<div class="component-lab svelte-al447k"><aside class="component-list svelte-al447k"><h3 class="svelte-al447k">Components</h3> <div class="component-scroll svelte-al447k"></div></aside> <section class="component-detail svelte-al447k"><!></section></div>');function Vb(e,t){fe(t,!0);const n=io(),r=ao(),s=de(()=>Object.values(n.components||{})),a=de(()=>[...c(s)].sort((M,z)=>`${M.category}-${M.name}`.localeCompare(`${z.category}-${z.name}`)));let i=G(null),o=G("");sr(()=>{if(!c(i)&&c(a).length){const[M]=c(a);M&&x(i,M.name,!0)}}),sr(()=>{if(c(i)&&!c(o)){const z=n.getComponent(c(i))?.example?.props??{};x(o,JSON.stringify({component:c(i),props:z},null,2),!0)}});const l=de(()=>c(i)?n.getComponent(c(i)):void 0),u=de(()=>{try{const M=JSON.parse(c(o));return!M||typeof M!="object"?{preview:null,error:"Payload must be a JSON object."}:!M.component||!M.props?{preview:null,error:"Payload must include component and props keys."}:{preview:M,error:null}}catch(M){return{preview:null,error:M instanceof Error?M.message:"Invalid JSON."}}}),d=de(()=>c(u).preview),f=de(()=>c(u).error);function h(){c(l)&&x(o,JSON.stringify({component:c(l).name,props:c(l).example?.props??{}},null,2),!0)}function v(){const M=r.lastArtifact;M&&x(o,JSON.stringify({component:M.component,props:M.props},null,2),!0)}function p(){x(o,"")}function b(M){x(i,M,!0),x(o,"")}var m=Fb(),S=g(m),k=_(g(S),2);Ue(k,21,()=>c(a),Jr,(M,z)=>{var $=Ub();$.__click=()=>b(c(z).name);var P=g($),F=g(P),U=_(P,2),V=g(U);O(()=>{ke($,1,`component-item ${c(i)===c(z).name?"active":""}`,"svelte-al447k"),A(F,c(z).name),A(V,`${c(z).category??""}${c(z).interactive?" â¢ interactive":""}`)}),y(M,$)});var w=_(S,2),T=g(w);{var N=M=>{var z=Gb(),$=re(z),P=g($),F=g(P),U=g(F),V=_(F,2),H=g(V),Y=_(P,2),j=g(Y);j.__click=h;var te=_(j,2);te.__click=v;var he=_(te,2);he.__click=p;var pe=_($,2),Ke=g(pe),ce=_(g(Ke),2),me=g(ce),nt=_(Ke,2),ft=_(g(nt),2),ne=g(ft),xt=_(pe,2),vt=_(g(xt),2),W=_(vt,2);{var lt=Q=>{var Ae=zb(),ht=g(Ae);O(()=>A(ht,c(f))),y(Q,Ae)};I(W,Q=>{c(f)&&Q(lt)})}var on=_(xt,2),ln=_(g(on),2);{var _n=Q=>{Bi(Q,{get component(){return c(d).component},get props(){return c(d).props}})},ut=Q=>{var Ae=jb();y(Q,Ae)};I(ln,Q=>{c(d)?Q(_n):Q(ut,!1)})}O((Q,Ae)=>{A(U,c(l).name),A(H,c(l).description),te.disabled=!r.lastArtifact,A(me,Q),A(ne,Ae)},[()=>JSON.stringify(c(l).propsSchema,null,2),()=>JSON.stringify(c(l).example?.props??{},null,2)]),pr(vt,()=>c(o),Q=>x(o,Q)),y(M,z)},C=M=>{var z=Bb();y(M,z)};I(T,M=>{c(l)?M(N):M(C,!1)})}y(e,m),ve()}Dt(["click"]);var qb=E("<!> <!>",1),Hb=E("<!> <!> <!>",1);function Ud(e,t){fe(t,!0);let n=dt(t,"chatBodyEl",15,null),r=G("chat");const s=io(),a=de(()=>{const l=[{id:"chat",label:"Chat"},{id:"setup",label:"Setup"},{id:"context",label:"Context"}];return s.enabled&&l.push({id:"components",label:"Components"}),l});var o={switchToSetup:()=>{x(r,"setup")}};return Xn(e,{class:"chat-card",children:(l,u)=>{var d=Hb(),f=re(d);Hm(f,{});var h=_(f,2);Cm(h,{get tabs(){return c(a)},get active(){return c(r)},onchange:m=>{x(r,m,!0)}});var v=_(h,2);{var p=m=>{nb(m,{})},b=m=>{var S=je(),k=re(S);{var w=N=>{Db(N,{})},T=N=>{var C=je(),M=re(C);{var z=P=>{Vb(P,{})},$=P=>{var F=qb(),U=re(F);Ey(U,{get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(H){n(H)}});var V=_(U,2);Iy(V,{get onsubmit(){return t.onSendChat}}),y(P,F)};I(M,P=>{c(r)==="components"?P(z):P($,!1)},!0)}y(N,C)};I(k,N=>{c(r)==="context"?N(w):N(T,!1)},!0)}y(m,S)};I(v,m=>{c(r)==="setup"?m(p):m(b,!1)})}y(l,d)},$$slots:{default:!0}}),ve(o)}var Zb=E('<details class="svelte-1pjwbaq"><summary class="svelte-1pjwbaq">Details</summary> <!> <!></details>');function Xb(e,t){var n=Zb(),r=_(g(n),2);{var s=o=>{au(o,{label:"args",get content(){return t.args}})};I(r,o=>{t.args&&o(s)})}var a=_(r,2);{var i=o=>{au(o,{label:"result",get content(){return t.result}})};I(a,o=>{t.result&&o(i)})}y(e,n)}var Kb=E('<div class="thought svelte-kirucq"> </div>'),Jb=E('<div class="timeline-item svelte-kirucq"><div class="line svelte-kirucq"></div> <div></div> <div class="timeline-body svelte-kirucq"><div class="row space-between align-center svelte-kirucq"><div class="step-name svelte-kirucq"> </div> <!></div> <!> <!></div></div>');function Yb(e,t){fe(t,!0);var n=Jb(),r=_(g(n),2),s=_(r,2),a=g(s),i=g(a),o=g(i),l=_(i,2);{var u=v=>{Mt(v,{variant:"subtle",size:"small",children:(p,b)=>{var m=_t();O(()=>A(m,`${t.step.latencyMs??""} ms`)),y(p,m)},$$slots:{default:!0}})};I(l,v=>{t.step.latencyMs&&v(u)})}var d=_(a,2);{var f=v=>{var p=Kb(),b=g(p);O(()=>A(b,`"${t.step.thought??""}"`)),y(v,p)};I(d,v=>{t.step.thought&&v(f)})}var h=_(d,2);Xb(h,{get args(){return t.step.args},get result(){return t.step.result}}),O(()=>{ke(r,1,`dot ${t.step.status??""}`,"svelte-kirucq"),A(o,t.step.name)}),y(e,n),ve()}var Wb=E('<div class="timeline svelte-a305uj"></div>');function Qb(e,t){var n=Wb();Ue(n,21,()=>t.steps,r=>r.id,(r,s)=>{Yb(r,{get step(){return c(s)}})}),y(e,n)}var e0=E('<div class="trajectory-header svelte-a3gaf7"><div class="title-small svelte-a3gaf7">Execution Trajectory</div> <!></div> <!>',1);function zd(e,t){fe(t,!1);const n=ur(),r=Da();Ht(),Xn(e,{class:"trajectory-card",children:(s,a)=>{var i=e0(),o=re(i),l=_(g(o),2);{var u=v=>{Mt(v,{variant:"subtle",size:"small",children:(p,b)=>{var m=_t();O(S=>A(m,`trace ${S??""}`),[()=>n.activeTraceId.slice(0,8)]),y(p,m)},$$slots:{default:!0}})};I(l,v=>{n.activeTraceId&&v(u)})}var d=_(o,2);{var f=v=>{Fa(v,{inline:!0,title:"No trajectory yet",subtitle:"Send a prompt to see steps."})},h=v=>{var p=je(),b=re(p);iv(b,()=>n.activeTraceId,m=>{Qb(m,{get steps(){return r.steps}})}),y(v,p)};I(d,v=>{r.isEmpty?v(f):v(h,!1)})}y(s,i)},$$slots:{default:!0}}),ve()}var t0=E("<!> <!>",1);function n0(e,t){fe(t,!0);let n=dt(t,"chatBodyEl",15,null),r;var a={switchToSetup:()=>{r?.switchToSetup()}};return To(e,{position:"center",children:(i,o)=>{var l=t0(),u=re(l);Ss(Ud(u,{get onSendChat(){return t.onSendChat},get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(f){n(f)}}),f=>r=f,()=>r);var d=_(u,2);zd(d,{}),y(i,l)},$$slots:{default:!0}}),ve(a)}var r0=E('<div class="events-header svelte-1d58ppa"><div class="title-small svelte-1d58ppa">Planner Events</div> <div class="icon-row svelte-1d58ppa"><!> <select class="filter svelte-1d58ppa"><option>All</option><option>step</option><option>event</option><option>chunk</option><option>artifact_chunk</option></select></div></div>');function s0(e,t){fe(t,!1);const n=Bn(so());Ht();var r=r0(),s=_(g(r),2),a=g(s);Gm(a,{onclick:()=>{Jn(n,c(n).paused=!c(n).paused)},children:(h,v)=>{var p=_t();O(()=>A(p,c(n).paused?">":"||")),y(h,p)}});var i=_(a,2);i.__change=h=>{const v=h.currentTarget.value;c(n).setFilter(v||null)};var o=g(i);o.value=o.__value="";var l=_(o);l.value=l.__value="step";var u=_(l);u.value=u.__value="event";var d=_(u);d.value=d.__value="chunk";var f=_(d);f.value=f.__value="artifact_chunk",y(e,r),ve()}Dt(["change"]);var a0=E('<div class="event-desc svelte-1tjxgju"> </div>'),i0=E('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Args:</span> </div>'),o0=E('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Result:</span> </div>'),l0=E('<div><div class="event-icon svelte-1tjxgju"> </div> <div class="event-main svelte-1tjxgju"><div class="event-header svelte-1tjxgju"><span class="event-name svelte-1tjxgju"> </span> <!></div> <!> <!> <!></div> <!></div>');function u0(e,t){fe(t,!0);let n=dt(t,"alt",3,!1);const r={step:{icon:"â¶",variant:"ghost"},tool_call:{icon:"ð§",variant:"subtle"},artifact:{icon:"ð",variant:"subtle"},other:{icon:"â¢",variant:"ghost"}};let s=de(()=>r[t.event.type]??r.other);function a($){return $?$<1e3?`${$.toFixed(0)}ms`:`${($/1e3).toFixed(2)}s`:""}var i=l0();let o;var l=g(i),u=g(l),d=_(l,2),f=g(d),h=g(f),v=g(h),p=_(h,2);{var b=$=>{Mt($,{variant:"subtle",size:"small",children:(P,F)=>{var U=_t("tool");y(P,U)},$$slots:{default:!0}})},m=$=>{var P=je(),F=re(P);{var U=V=>{Mt(V,{variant:"subtle",size:"small",children:(H,Y)=>{var j=_t("artifact");y(H,j)},$$slots:{default:!0}})};I(F,V=>{t.event.type==="artifact"&&V(U)},!0)}y($,P)};I(p,$=>{t.event.type==="tool_call"?$(b):$(m,!1)})}var S=_(f,2);{var k=$=>{var P=a0(),F=g(P);O(()=>A(F,t.event.description)),y($,P)};I(S,$=>{t.event.description&&$(k)})}var w=_(S,2);{var T=$=>{var P=i0(),F=_(g(P));O(()=>A(F,` ${t.event.args??""}`)),y($,P)};I(w,$=>{t.event.type==="tool_call"&&t.event.args&&$(T)})}var N=_(w,2);{var C=$=>{var P=o0(),F=_(g(P));O(()=>A(F,` ${t.event.result??""}`)),y($,P)};I(N,$=>{t.event.type==="tool_call"&&t.event.result&&$(C)})}var M=_(d,2);{var z=$=>{Mt($,{variant:"subtle",size:"small",children:(P,F)=>{var U=_t();O(V=>A(U,V),[()=>a(t.event.duration_ms)]),y(P,U)},$$slots:{default:!0}})};I(M,$=>{t.event.duration_ms&&$(z)})}O(()=>{o=ke(i,1,"event-row svelte-1tjxgju",null,o,{alt:n()}),A(u,c(s).icon),A(v,t.event.name)}),y(e,i),ve()}var c0=E('<div class="events-body svelte-f0vs81"><!></div>');function d0(e,t){fe(t,!0);const n=so();let r=de(()=>n.displayEvents);var s=c0(),a=g(s);{var i=l=>{Fa(l,{inline:!0,title:"No events yet",subtitle:"Events will appear during runs."})},o=l=>{var u=je(),d=re(u);Ue(d,19,()=>c(r),f=>f.id,(f,h,v)=>{{let p=de(()=>c(v)%2===0);u0(f,{get event(){return c(h)},get alt(){return c(p)}})}}),y(l,u)};I(a,l=>{c(r).length===0?l(i):l(o,!1)})}y(e,s),ve()}var f0=E('<div class="artifact-row svelte-ko4yy5"><!> <pre class="svelte-ko4yy5"> </pre></div>'),v0=E('<div class="section svelte-ko4yy5"><div class="title-small svelte-ko4yy5">Artifact Streams</div> <!></div>');function h0(e,t){fe(t,!1);const n=Da();Ht();var r=je(),s=re(r);{var a=i=>{var o=v0(),l=_(g(o),2);Ue(l,1,()=>Object.entries(n.artifactStreams),([u,d])=>u,(u,d)=>{var f=de(()=>Yd(c(d),2));let h=()=>c(f)[0],v=()=>c(f)[1];var p=f0(),b=g(p);Mt(b,{variant:"ghost",size:"small",children:(k,w)=>{var T=_t();O(()=>A(T,h())),y(k,T)},$$slots:{default:!0}});var m=_(b,2),S=g(m);O(k=>A(S,k),[()=>JSON.stringify(v()[v().length-1],null,2)]),y(u,p)}),y(i,o)};I(s,i=>{n.hasArtifacts&&i(a)})}y(e,r),ve()}var p0=E("<!> <!> <!>",1);function jd(e){Xn(e,{class:"events-card",children:(t,n)=>{var r=p0(),s=re(r);s0(s,{});var a=_(s,2);d0(a,{});var i=_(a,2);h0(i,{}),y(t,r)},$$slots:{default:!0}})}var g0=E('<span class="spinner svelte-tbolst"></span>'),_0=ev('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12L3 7L4.4 5.55L7 8.15V1H9V8.15L11.6 5.55L13 7L8 12Z" fill="currentColor"></path><path d="M2 14V11H4V13H12V11H14V14C14 14.55 13.55 15 13 15H3C2.45 15 2 14.55 2 14Z" fill="currentColor"></path></svg>'),m0=E('<span class="artifact-error svelte-tbolst" role="alert"> </span>'),y0=E('<div class="artifact-item svelte-tbolst"><div class="artifact-info svelte-tbolst"><span class="artifact-icon svelte-tbolst"></span> <div class="artifact-details svelte-tbolst"><span class="artifact-name svelte-tbolst"> </span> <span class="artifact-meta svelte-tbolst"> <!></span></div></div> <button type="button" class="download-btn svelte-tbolst"><!></button> <!></div>');function b0(e,t){fe(t,!0);const n=ur();let r=G(!1),s=G(null);async function a(){x(r,!0),x(s,null);try{await oo(t.artifact.id,n.sessionId,t.artifact.filename??void 0)}catch(C){x(s,C instanceof Error?C.message:"Download failed",!0)}finally{x(r,!1)}}var i=y0(),o=g(i),l=g(o),u=_(l,2),d=g(u),f=g(d),h=_(d,2),v=g(h),p=_(v);{var b=C=>{Mt(C,{size:"small",variant:"subtle",children:(M,z)=>{var $=_t();O(P=>A($,P),[()=>fc(t.artifact.mime_type)]),y(M,$)},$$slots:{default:!0}})};I(p,C=>{t.artifact.mime_type&&C(b)})}var m=_(o,2);m.__click=a;var S=g(m);{var k=C=>{var M=g0();y(C,M)},w=C=>{var M=_0();y(C,M)};I(S,C=>{c(r)?C(k):C(w,!1)})}var T=_(m,2);{var N=C=>{var M=m0(),z=g(M);O(()=>A(z,c(s))),y(C,M)};I(T,C=>{c(s)&&C(N)})}O((C,M)=>{at(l,"data-type",C),at(d,"title",t.artifact.filename||t.artifact.id),A(f,t.artifact.filename||t.artifact.id),A(v,`${M??""} `),at(m,"title",c(r)?"Downloading...":"Download"),m.disabled=c(r),at(m,"aria-label",c(r)?"Downloading":`Download ${t.artifact.filename||"artifact"}`)},[()=>dc(t.artifact.mime_type),()=>cc(t.artifact.size_bytes)]),y(e,i),ve()}Dt(["click"]);var S0=E('<span class="count-badge svelte-1cjy38f"> </span>'),k0=E('<span class="spinner svelte-1cjy38f"></span> Downloading...',1),w0=E('<button type="button" class="download-all-btn svelte-1cjy38f"><!></button>'),E0=E('<p class="no-artifacts svelte-1cjy38f">No artifacts yet. Artifacts will appear here when tools generate downloadable files.</p>'),x0=E('<div class="artifacts-list svelte-1cjy38f"></div>'),T0=E('<div class="artifacts-header svelte-1cjy38f"><h3 class="artifacts-title svelte-1cjy38f">Artifacts <!></h3> <!></div> <div class="artifacts-body svelte-1cjy38f"><!></div>',1);function Gd(e,t){fe(t,!0);let n=G(!1);const r=Wv(),s=ur();async function a(){x(n,!0);for(const i of r.list)try{await oo(i.id,s.sessionId,i.filename??void 0),await new Promise(o=>setTimeout(o,300))}catch{}x(n,!1)}Xn(e,{class:"artifacts-card",children:(i,o)=>{var l=T0(),u=re(l),d=g(u),f=_(g(d));{var h=w=>{var T=S0(),N=g(T);O(()=>A(N,r.count)),y(w,T)};I(f,w=>{r.count>0&&w(h)})}var v=_(d,2);{var p=w=>{var T=w0();T.__click=a;var N=g(T);{var C=z=>{var $=k0();y(z,$)},M=z=>{var $=_t("Download All");y(z,$)};I(N,z=>{c(n)?z(C):z(M,!1)})}O(()=>{T.disabled=c(n),at(T,"aria-label",c(n)?"Downloading all artifacts":"Download all artifacts")}),y(w,T)};I(v,w=>{r.count>1&&w(p)})}var b=_(u,2),m=g(b);{var S=w=>{var T=E0();y(w,T)},k=w=>{var T=x0();Ue(T,21,()=>r.list,N=>N.id,(N,C)=>{b0(N,{get artifact(){return c(C)}})}),y(w,T)};I(m,w=>{r.count===0?w(S):w(k,!1)})}y(i,l)},$$slots:{default:!0}}),ve()}Dt(["click"]);var A0=E('<span class="count-badge svelte-1l2utx3"> </span>'),I0=E('<span class="foreground-indicator svelte-1l2utx3"><span class="running-dot svelte-1l2utx3"></span> Active</span>'),C0=E('<p class="no-tasks svelte-1l2utx3">No active tasks yet.</p>'),N0=E('<span class="task-time svelte-1l2utx3"> </span>'),R0=E('<span class="svelte-1l2utx3"> </span>'),O0=E('<div class="task-progress svelte-1l2utx3"><div class="progress-meta svelte-1l2utx3"><span class="svelte-1l2utx3"> </span> <!></div> <div class="progress-bar svelte-1l2utx3"><div class="progress-bar-fill svelte-1l2utx3"></div></div></div>'),M0=E('<div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Trace:</span> <span class="detail-value mono svelte-1l2utx3"> </span></div>'),P0=E('<div class="detail-row error svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Error:</span> <span class="detail-value svelte-1l2utx3"> </span></div>'),L0=E('<div class="task-result svelte-1l2utx3"><div class="task-result-title svelte-1l2utx3">Result</div> <div class="task-result-body svelte-1l2utx3"> </div></div>'),$0=E('<div class="task-details svelte-1l2utx3"><!> <div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Priority:</span> <span class="detail-value svelte-1l2utx3"> </span></div> <!> <!></div>'),D0=E('<button type="button" class="task-btn danger svelte-1l2utx3">Cancel</button>'),U0=E('<button type="button" class="task-btn svelte-1l2utx3">Pause</button>'),z0=E('<button type="button" class="task-btn primary svelte-1l2utx3">Resume</button>'),j0=E('<button type="button" class="task-btn primary svelte-1l2utx3">Apply</button>'),G0=E('<div role="button" tabindex="0"><div class="task-main svelte-1l2utx3"><div class="task-header-row svelte-1l2utx3"><div class="task-title svelte-1l2utx3"> </div> <!></div> <div class="task-meta svelte-1l2utx3"><span class="task-id svelte-1l2utx3"> </span> <!></div> <!> <!></div> <div class="task-actions svelte-1l2utx3"><!> <!> <!> <!></div></div>'),B0=E('<div class="tasks-section svelte-1l2utx3"><div class="section-header svelte-1l2utx3"><span class="section-label svelte-1l2utx3">Foreground</span></div> <div class="tasks-list svelte-1l2utx3"></div></div>'),F0=E('<span class="section-count svelte-1l2utx3"> </span>'),V0=E('<span class="task-priority svelte-1l2utx3"> </span>'),q0=E('<span class="task-time svelte-1l2utx3"> </span>'),H0=E('<span class="svelte-1l2utx3"> </span>'),Z0=E('<div class="task-progress svelte-1l2utx3"><div class="progress-meta svelte-1l2utx3"><span class="svelte-1l2utx3"> </span> <!></div> <div class="progress-bar svelte-1l2utx3"><div class="progress-bar-fill svelte-1l2utx3"></div></div></div>'),X0=E('<div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Trace:</span> <span class="detail-value mono svelte-1l2utx3"> </span></div>'),K0=E('<div class="detail-row error svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Error:</span> <span class="detail-value svelte-1l2utx3"> </span></div>'),J0=E('<div class="task-result svelte-1l2utx3"><div class="task-result-title svelte-1l2utx3">Result</div> <div class="task-result-body svelte-1l2utx3"> </div></div>'),Y0=E('<div class="task-details svelte-1l2utx3"><!> <div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Priority:</span> <span class="detail-value svelte-1l2utx3"> </span></div> <!> <!></div>'),W0=E('<button type="button" class="task-btn danger svelte-1l2utx3">X</button>'),Q0=E('<button type="button" class="task-btn svelte-1l2utx3">||</button>'),eS=E('<button type="button" class="task-btn primary svelte-1l2utx3">></button>'),tS=E('<button type="button" class="task-btn primary svelte-1l2utx3">Apply</button>'),nS=E('<div role="button" tabindex="0"><div class="task-main svelte-1l2utx3"><div class="task-header-row svelte-1l2utx3"><div class="task-title svelte-1l2utx3"> </div> <!></div> <div class="task-meta svelte-1l2utx3"><span class="task-id svelte-1l2utx3"> </span> <!> <!></div> <!> <!></div> <div class="task-actions svelte-1l2utx3"><div class="priority-controls svelte-1l2utx3"><button type="button" class="task-btn small svelte-1l2utx3" aria-label="Increase task priority">+</button> <button type="button" class="task-btn small svelte-1l2utx3" aria-label="Decrease task priority">-</button></div> <!> <!> <!> <!></div></div>'),rS=E('<div class="tasks-section svelte-1l2utx3"><div class="section-header svelte-1l2utx3"><span class="section-label svelte-1l2utx3">Background</span> <!></div> <div class="tasks-list svelte-1l2utx3"></div></div>'),sS=E("<!> <!>",1),aS=E('<div class="tasks-header svelte-1l2utx3"><h3 class="tasks-title svelte-1l2utx3">Tasks <!></h3> <!></div> <div class="tasks-body svelte-1l2utx3"><!></div>',1);function Bd(e,t){fe(t,!0);const n=wc(),r=ur();let s=G(null);const a=de(()=>n.tasks.filter(k=>k.task_type==="FOREGROUND")),i=de(()=>n.tasks.filter(k=>k.task_type==="BACKGROUND")),o=de(()=>c(a).some(k=>k.status==="RUNNING")),l=de(()=>c(i).filter(k=>k.status==="RUNNING"||k.status==="PENDING"||k.status==="PAUSED").length);function u(k){return`status-${k.toLowerCase()}`}function d(k){x(s,c(s)===k?null:k,!0)}async function f(k,w){w.stopPropagation(),await Ps(r.sessionId,k,"CANCEL",{reason:"user_cancelled"})}async function h(k,w){w.stopPropagation(),await Ps(r.sessionId,k,"PAUSE",{})}async function v(k,w){w.stopPropagation(),await Ps(r.sessionId,k,"RESUME",{})}async function p(k,w,T){T.stopPropagation();const C=n.tasks.find(M=>M.task_id===k)?.priority??0;await Ps(r.sessionId,k,"PRIORITIZE",{priority:C+w})}async function b(k,w,T){if(T.stopPropagation(),await Nc(r.sessionId,w,"apply")){const C=n.tasks.find(M=>M.task_id===k);C&&(C.patch_id=null)}}function m(k){return!k?.total||k.total<=0||k.current==null?null:Math.min(100,Math.max(0,Math.round(k.current/k.total*100)))}function S(k){return k?new Date(k).toLocaleTimeString():""}Xn(e,{class:"tasks-card",children:(k,w)=>{var T=aS(),N=re(T),C=g(N),M=_(g(C));{var z=Y=>{var j=A0(),te=g(j);O(()=>A(te,n.count)),y(Y,j)};I(M,Y=>{n.count>0&&Y(z)})}var $=_(C,2);{var P=Y=>{var j=I0();y(Y,j)};I($,Y=>{c(o)&&Y(P)})}var F=_(N,2),U=g(F);{var V=Y=>{var j=C0();y(Y,j)},H=Y=>{var j=sS(),te=re(j);{var he=ce=>{var me=B0(),nt=_(g(me),2);Ue(nt,21,()=>c(a),ft=>ft.task_id,(ft,ne)=>{var xt=G0();let vt;xt.__click=()=>d(c(ne).task_id),xt.__keydown=ie=>ie.key==="Enter"&&d(c(ne).task_id);var W=g(xt),lt=g(W),on=g(lt),ln=g(on),_n=_(on,2);{let ie=de(()=>u(c(ne).status));Mt(_n,{variant:"ghost",size:"small",get class(){return c(ie)},children:(ye,xe)=>{var gt=_t();O(()=>A(gt,c(ne).status)),y(ye,gt)},$$slots:{default:!0}})}var ut=_(lt,2),Q=g(ut),Ae=g(Q),ht=_(Q,2);{var Wt=ie=>{var ye=N0(),xe=g(ye);O(gt=>A(xe,gt),[()=>S(c(ne).updated_at)]),y(ie,ye)};I(ht,ie=>{c(ne).updated_at&&ie(Wt)})}var Qt=_(ut,2);{var Ee=ie=>{var ye=O0(),xe=g(ye),gt=g(xe),Tt=g(gt),Zt=_(gt,2);{var jt=oe=>{var Oe=R0(),Me=g(Oe);O(Je=>A(Me,`${Je??""}%`),[()=>m(c(ne).progress)]),y(oe,Oe)};I(Zt,oe=>{m(c(ne).progress)&&oe(jt)})}var en=_(xe,2),ee=g(en);O(oe=>{A(Tt,c(ne).progress.label??"Progress"),hi(ee,oe)},[()=>`width: ${m(c(ne).progress)??0}%`]),y(ie,ye)};I(Qt,ie=>{c(ne).progress&&ie(Ee)})}var qe=_(Qt,2);{var Ut=ie=>{var ye=$0(),xe=g(ye);{var gt=Me=>{var Je=M0(),Ct=_(g(Je),2),yt=g(Ct);O(Nt=>A(yt,`${Nt??""}...`),[()=>c(ne).trace_id.slice(0,12)]),y(Me,Je)};I(xe,Me=>{c(ne).trace_id&&Me(gt)})}var Tt=_(xe,2),Zt=_(g(Tt),2),jt=g(Zt),en=_(Tt,2);{var ee=Me=>{var Je=P0(),Ct=_(g(Je),2),yt=g(Ct);O(()=>A(yt,c(ne).error)),y(Me,Je)};I(en,Me=>{c(ne).error&&Me(ee)})}var oe=_(en,2);{var Oe=Me=>{var Je=L0(),Ct=_(g(Je),2),yt=g(Ct);O((Nt,le)=>A(yt,`${Nt??""}${le??""}`),[()=>JSON.stringify(c(ne).result).slice(0,240),()=>JSON.stringify(c(ne).result).length>240?"...":""]),y(Me,Je)};I(oe,Me=>{c(ne).result&&Me(Oe)})}O(()=>A(jt,c(ne).priority)),y(ie,ye)};I(qe,ie=>{c(s)===c(ne).task_id&&ie(Ut)})}var Ne=_(W,2),un=g(Ne);{var Kn=ie=>{var ye=D0();ye.__click=xe=>f(c(ne).task_id,xe),y(ie,ye)};I(un,ie=>{(c(ne).status==="RUNNING"||c(ne).status==="PAUSED")&&ie(Kn)})}var Cn=_(un,2);{var dr=ie=>{var ye=U0();ye.__click=xe=>h(c(ne).task_id,xe),y(ie,ye)};I(Cn,ie=>{c(ne).status==="RUNNING"&&ie(dr)})}var pt=_(Cn,2);{var mt=ie=>{var ye=z0();ye.__click=xe=>v(c(ne).task_id,xe),y(ie,ye)};I(pt,ie=>{c(ne).status==="PAUSED"&&ie(mt)})}var zt=_(pt,2);{var cn=ie=>{var ye=j0();ye.__click=xe=>b(c(ne).task_id,c(ne).patch_id,xe),y(ie,ye)};I(zt,ie=>{c(ne).patch_id&&ie(cn)})}O((ie,ye)=>{vt=ke(xt,1,"task-row svelte-1l2utx3",null,vt,{expanded:c(s)===c(ne).task_id,"task-running":c(ne).status==="RUNNING"}),A(ln,ie),A(Ae,ye)},[()=>c(ne).description??`Task ${c(ne).task_id.slice(0,8)}`,()=>c(ne).task_id.slice(0,8)]),y(ft,xt)}),y(ce,me)};I(te,ce=>{c(a).length>0&&ce(he)})}var pe=_(te,2);{var Ke=ce=>{var me=rS(),nt=g(me),ft=_(g(nt),2);{var ne=vt=>{var W=F0(),lt=g(W);O(()=>A(lt,`${c(l)??""} active`)),y(vt,W)};I(ft,vt=>{c(l)>0&&vt(ne)})}var xt=_(nt,2);Ue(xt,21,()=>c(i),vt=>vt.task_id,(vt,W)=>{var lt=nS();let on;lt.__click=()=>d(c(W).task_id),lt.__keydown=ee=>ee.key==="Enter"&&d(c(W).task_id);var ln=g(lt),_n=g(ln),ut=g(_n),Q=g(ut),Ae=_(ut,2);{let ee=de(()=>u(c(W).status));Mt(Ae,{variant:"ghost",size:"small",get class(){return c(ee)},children:(oe,Oe)=>{var Me=_t();O(()=>A(Me,c(W).status)),y(oe,Me)},$$slots:{default:!0}})}var ht=_(_n,2),Wt=g(ht),Qt=g(Wt),Ee=_(Wt,2);{var qe=ee=>{var oe=V0(),Oe=g(oe);O(()=>A(Oe,`P${c(W).priority??""}`)),y(ee,oe)};I(Ee,ee=>{c(W).priority!==0&&ee(qe)})}var Ut=_(Ee,2);{var Ne=ee=>{var oe=q0(),Oe=g(oe);O(Me=>A(Oe,Me),[()=>S(c(W).updated_at)]),y(ee,oe)};I(Ut,ee=>{c(W).updated_at&&ee(Ne)})}var un=_(ht,2);{var Kn=ee=>{var oe=Z0(),Oe=g(oe),Me=g(Oe),Je=g(Me),Ct=_(Me,2);{var yt=_e=>{var Ye=H0(),Ge=g(Ye);O(it=>A(Ge,`${it??""}%`),[()=>m(c(W).progress)]),y(_e,Ye)};I(Ct,_e=>{m(c(W).progress)&&_e(yt)})}var Nt=_(Oe,2),le=g(Nt);O(_e=>{A(Je,c(W).progress.label??"Progress"),hi(le,_e)},[()=>`width: ${m(c(W).progress)??0}%`]),y(ee,oe)};I(un,ee=>{c(W).progress&&ee(Kn)})}var Cn=_(un,2);{var dr=ee=>{var oe=Y0(),Oe=g(oe);{var Me=Ge=>{var it=X0(),dn=_(g(it),2),Nn=g(dn);O(fr=>A(Nn,`${fr??""}...`),[()=>c(W).trace_id.slice(0,12)]),y(Ge,it)};I(Oe,Ge=>{c(W).trace_id&&Ge(Me)})}var Je=_(Oe,2),Ct=_(g(Je),2),yt=g(Ct),Nt=_(Je,2);{var le=Ge=>{var it=K0(),dn=_(g(it),2),Nn=g(dn);O(()=>A(Nn,c(W).error)),y(Ge,it)};I(Nt,Ge=>{c(W).error&&Ge(le)})}var _e=_(Nt,2);{var Ye=Ge=>{var it=J0(),dn=_(g(it),2),Nn=g(dn);O((fr,qd)=>A(Nn,`${fr??""}${qd??""}`),[()=>JSON.stringify(c(W).result).slice(0,240),()=>JSON.stringify(c(W).result).length>240?"...":""]),y(Ge,it)};I(_e,Ge=>{c(W).result&&Ge(Ye)})}O(()=>A(yt,c(W).priority)),y(ee,oe)};I(Cn,ee=>{c(s)===c(W).task_id&&ee(dr)})}var pt=_(ln,2),mt=g(pt),zt=g(mt);zt.__click=ee=>p(c(W).task_id,1,ee);var cn=_(zt,2);cn.__click=ee=>p(c(W).task_id,-1,ee);var ie=_(mt,2);{var ye=ee=>{var oe=W0();oe.__click=Oe=>f(c(W).task_id,Oe),y(ee,oe)};I(ie,ee=>{(c(W).status==="RUNNING"||c(W).status==="PAUSED")&&ee(ye)})}var xe=_(ie,2);{var gt=ee=>{var oe=Q0();oe.__click=Oe=>h(c(W).task_id,Oe),y(ee,oe)};I(xe,ee=>{c(W).status==="RUNNING"&&ee(gt)})}var Tt=_(xe,2);{var Zt=ee=>{var oe=eS();oe.__click=Oe=>v(c(W).task_id,Oe),y(ee,oe)};I(Tt,ee=>{c(W).status==="PAUSED"&&ee(Zt)})}var jt=_(Tt,2);{var en=ee=>{var oe=tS();oe.__click=Oe=>b(c(W).task_id,c(W).patch_id,Oe),y(ee,oe)};I(jt,ee=>{c(W).patch_id&&ee(en)})}O((ee,oe)=>{on=ke(lt,1,"task-row svelte-1l2utx3",null,on,{expanded:c(s)===c(W).task_id,"task-running":c(W).status==="RUNNING","task-paused":c(W).status==="PAUSED"}),A(Q,ee),A(Qt,oe)},[()=>c(W).description??`Task ${c(W).task_id.slice(0,8)}`,()=>c(W).task_id.slice(0,8)]),y(vt,lt)}),y(ce,me)};I(pe,ce=>{c(i).length>0&&ce(Ke)})}y(Y,j)};I(U,Y=>{n.count===0?Y(V):Y(H,!1)})}y(k,T)},$$slots:{default:!0}}),ve()}Dt(["click","keydown"]);var iS=E('<p class="no-notifications svelte-1a2fxqj">No notifications yet.</p>'),oS=E('<button type="button" class="notification-btn svelte-1a2fxqj"> </button>'),lS=E('<div class="notification-actions svelte-1a2fxqj"></div>'),uS=E('<div><div class="notification-message svelte-1a2fxqj"> </div> <time class="notification-time svelte-1a2fxqj"> </time> <!> <button type="button" class="notification-dismiss svelte-1a2fxqj" aria-label="Dismiss notification">Dismiss</button></div>'),cS=E('<div class="notifications-list svelte-1a2fxqj"></div>'),dS=E('<div class="notifications-header svelte-1a2fxqj"><h3 class="notifications-title svelte-1a2fxqj">Notifications</h3></div> <div class="notifications-body svelte-1a2fxqj"><!></div>',1);function Fd(e,t){fe(t,!1);const n=Eh(),r=ur();function s(i){return`level-${i}`}async function a(i){if(i.id==="apply_context_patch"){const o=i.payload?.patch_id;o&&await Nc(r.sessionId,o,"apply")}}Ht(),Xn(e,{class:"notifications-card",children:(i,o)=>{var l=dS(),u=_(re(l),2),d=g(u);{var f=v=>{var p=iS();y(v,p)},h=v=>{var p=cS();Ue(p,5,()=>n.items,b=>b.id,(b,m)=>{var S=uS(),k=g(S),w=g(k),T=_(k,2),N=g(T),C=_(T,2);{var M=$=>{var P=lS();Ue(P,5,()=>c(m).actions,Jr,(F,U)=>{var V=oS();V.__click=()=>a(c(U));var H=g(V);O(()=>A(H,c(U).label)),y(F,V)}),y($,P)};I(C,$=>{c(m).actions&&c(m).actions.length>0&&$(M)})}var z=_(C,2);z.__click=()=>n.remove(c(m).id),O(($,P,F)=>{ke(S,1,`notification-row ${$??""}`,"svelte-1a2fxqj"),A(w,c(m).message),at(T,"datetime",P),A(N,F)},[()=>s(c(m).level),()=>new Date(c(m).ts).toISOString(),()=>new Date(c(m).ts).toLocaleTimeString()]),y(b,S)}),y(v,p)};I(d,v=>{n.items.length===0?v(f):v(h,!1)})}y(i,l)},$$slots:{default:!0}}),ve()}Dt(["click"]);var fS=E("<!> <!> <!> <!>",1);function vS(e){To(e,{position:"right",children:(t,n)=>{var r=fS(),s=re(r);Fd(s,{});var a=_(s,2);jd(a);var i=_(a,2);Bd(i,{});var o=_(i,2);Gd(o,{}),y(t,r)},$$slots:{default:!0}})}var hS=E('<div class="tile svelte-9qt9q6"><div class="tile-label svelte-9qt9q6"> </div> <div class="tile-value svelte-9qt9q6"> </div></div>'),pS=E('<div class="section svelte-9qt9q6"><div class="section-label svelte-9qt9q6">Planner Config</div> <div class="tile-grid svelte-9qt9q6"></div></div>');function gS(e,t){fe(t,!1);const n=ss();Ht();var r=pS(),s=_(g(r),2);Ue(s,5,()=>n.plannerConfig,a=>a.label,(a,i)=>{var o=hS(),l=g(o),u=g(l),d=_(l,2),f=g(d);O(()=>{A(u,c(i).label),A(f,c(i).value)}),y(a,o)}),y(e,r),ve()}var _S=E('<div class="service-row svelte-k5f3xe"><div><div class="service-name svelte-k5f3xe"> </div> <div class="muted tiny svelte-k5f3xe"> </div></div> <!></div>');function mS(e,t){fe(t,!0);var n=_S(),r=g(n),s=g(r),a=g(s),i=_(s,2),o=g(i),l=_(r,2);{let u=de(()=>t.service.status==="enabled"?"subtle":"ghost");Mt(l,{get variant(){return c(u)},size:"small",children:(d,f)=>{var h=_t();O(()=>A(h,t.service.status)),y(d,h)},$$slots:{default:!0}})}O(()=>{A(a,t.service.name),A(o,t.service.url||"not configured")}),y(e,n),ve()}var yS=E('<div class="section svelte-1eltd2"><div class="section-label svelte-1eltd2">Services</div> <!></div>');function bS(e,t){fe(t,!1);const n=ss();Ht();var r=yS(),s=_(g(r),2);Ue(s,1,()=>n.services,a=>a.name,(a,i)=>{mS(a,{get service(){return c(i)}})}),y(e,r),ve()}var SS=E('<div class="tool-row svelte-8lkzhn"><div><div class="tool-name svelte-8lkzhn"> </div> <div class="muted tiny svelte-8lkzhn"> </div></div> <div class="tag-row svelte-8lkzhn"></div></div>');function kS(e,t){fe(t,!0);var n=SS(),r=g(n),s=g(r),a=g(s),i=_(s,2),o=g(i),l=_(r,2);Ue(l,23,()=>t.tool.tags,(u,d)=>`${t.tool.name}-${d}`,(u,d)=>{Mt(u,{variant:"ghost",size:"small",children:(f,h)=>{var v=_t();O(()=>A(v,c(d))),y(f,v)},$$slots:{default:!0}})}),O(()=>{A(a,t.tool.name),A(o,t.tool.desc)}),y(e,n),ve()}var wS=E('<div class="section svelte-njx06l"><div class="section-label svelte-njx06l">Tool Catalog</div> <!></div>');function ES(e,t){fe(t,!1);const n=ss();Ht();var r=wS(),s=_(g(r),2);Ue(s,1,()=>n.catalog,a=>a.name,(a,i)=>{kS(a,{get tool(){return c(i)}})}),y(e,r),ve()}var xS=E('<div class="title-small svelte-kxiy41">Config & Catalog</div> <!> <!> <!>',1);function uu(e){Xn(e,{class:"config-card",children:(t,n)=>{var r=xS(),s=_(re(r),2);gS(s,{});var a=_(s,2);bS(a,{});var i=_(a,2);ES(i,{}),y(t,r)},$$slots:{default:!0}})}var TS=E('<button type="button"> </button>'),AS=E('<div class="drawer svelte-1g84vkc"><div class="drawer-tabs svelte-1g84vkc"></div> <div class="drawer-content svelte-1g84vkc"><!></div></div>'),IS=E('<button type="button" class="backdrop svelte-1g84vkc" aria-label="Close menu"></button>'),CS=E('<header class="mobile-header svelte-1g84vkc"><div class="header-bar svelte-1g84vkc"><button type="button" class="menu-btn svelte-1g84vkc" aria-label="Toggle menu"><span><span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span></span></button> <h1 class="agent-name svelte-1g84vkc"> </h1> <div class="header-spacer svelte-1g84vkc"></div></div> <!></header> <!>',1);function NS(e,t){fe(t,!0);const n=ss();let r=G(!1),s=G("info");const a=[{id:"info",label:"Info"},{id:"spec",label:"Spec"},{id:"config",label:"Config"}],i=()=>{x(r,!1)};var o=CS(),l=re(o),u=g(l),d=g(u);d.__click=()=>x(r,!c(r));var f=g(d);let h;var v=_(d,2),p=g(v),b=_(u,2);{var m=w=>{var T=AS(),N=g(T);Ue(N,21,()=>a,P=>P.id,(P,F)=>{var U=TS();let V;U.__click=()=>x(s,c(F).id,!0);var H=g(U);O(()=>{V=ke(U,1,"drawer-tab svelte-1g84vkc",null,V,{active:c(s)===c(F).id}),A(H,c(F).label)}),y(P,U)});var C=_(N,2),M=g(C);{var z=P=>{var F=je(),U=re(F);It(U,()=>t.infoContent??et),y(P,F)},$=P=>{var F=je(),U=re(F);{var V=Y=>{var j=je(),te=re(j);It(te,()=>t.specContent??et),y(Y,j)},H=Y=>{var j=je(),te=re(j);It(te,()=>t.configContent??et),y(Y,j)};I(U,Y=>{c(s)==="spec"?Y(V):Y(H,!1)},!0)}y(P,F)};I(M,P=>{c(s)==="info"?P(z):P($,!1)})}y(w,T)};I(b,w=>{c(r)&&w(m)})}var S=_(l,2);{var k=w=>{var T=IS();T.__click=i,y(w,T)};I(S,w=>{c(r)&&w(k)})}O(()=>{h=ke(f,1,"hamburger svelte-1g84vkc",null,h,{open:c(r)}),A(p,n.meta.name)}),y(e,o),ve()}Dt(["click"]);var RS=E('<button type="button"> </button>'),OS=E('<div class="panel-tabs svelte-1wcjmjk"></div> <div class="panel-content svelte-1wcjmjk"><!></div>',1),MS=E('<div><button type="button" class="toggle-bar svelte-1wcjmjk"><div class="toggle-handle svelte-1wcjmjk"></div> <span class="toggle-label svelte-1wcjmjk"> </span></button> <!></div>');function PS(e,t){let n=G(!1),r=G("trajectory");const s=[{id:"trajectory",label:"Steps"},{id:"events",label:"Events"},{id:"artifacts",label:"Artifacts"},{id:"tasks",label:"Tasks"},{id:"notifications",label:"Alerts"}];var a=MS();let i;var o=g(a);o.__click=()=>x(n,!c(n));var l=_(g(o),2),u=g(l),d=_(o,2);{var f=h=>{var v=OS(),p=re(v);Ue(p,21,()=>s,w=>w.id,(w,T)=>{var N=RS();let C;N.__click=()=>x(r,c(T).id,!0);var M=g(N);O(()=>{C=ke(N,1,"panel-tab svelte-1wcjmjk",null,C,{active:c(r)===c(T).id}),A(M,c(T).label)}),y(w,N)});var b=_(p,2),m=g(b);{var S=w=>{var T=je(),N=re(T);It(N,()=>t.trajectoryContent??et),y(w,T)},k=w=>{var T=je(),N=re(T);{var C=z=>{var $=je(),P=re($);It(P,()=>t.eventsContent??et),y(z,$)},M=z=>{var $=je(),P=re($);{var F=V=>{var H=je(),Y=re(H);It(Y,()=>t.artifactsContent??et),y(V,H)},U=V=>{var H=je(),Y=re(H);{var j=he=>{var pe=je(),Ke=re(pe);It(Ke,()=>t.tasksContent??et),y(he,pe)},te=he=>{var pe=je(),Ke=re(pe);{var ce=me=>{var nt=je(),ft=re(nt);It(ft,()=>t.notificationsContent??et),y(me,nt)};I(Ke,me=>{c(r)==="notifications"&&me(ce)},!0)}y(he,pe)};I(Y,he=>{c(r)==="tasks"?he(j):he(te,!1)},!0)}y(V,H)};I(P,V=>{c(r)==="artifacts"?V(F):V(U,!1)},!0)}y(z,$)};I(N,z=>{c(r)==="events"?z(C):z(M,!1)},!0)}y(w,T)};I(m,w=>{c(r)==="trajectory"?w(S):w(k,!1)})}y(h,v)};I(d,h=>{c(n)&&h(f)})}O(()=>{i=ke(a,1,"bottom-panel svelte-1wcjmjk",null,i,{open:c(n)}),at(o,"aria-label",c(n)?"Hide details panel":"Show details panel"),at(o,"aria-expanded",c(n)),A(u,c(n)?"Hide Details":"Show Details")}),y(e,a)}Dt(["click"]);var LS=E('<div class="mobile-layout svelte-1n46o8q"><!> <main class="mobile-main svelte-1n46o8q"><!></main> <!></div>'),$S=E("<!> <!> <!>",1),DS=E("<!> <!> <!>",1);function US(e,t){fe(t,!0);const n=xh(),{sessionStore:r,chatStore:s,trajectoryStore:a,agentStore:i,specStore:o,setupStore:l,componentRegistryStore:u,interactionsStore:d}=n,f=x_(n),h=C_(n),v=O_(n);let p=G(null),b=G(void 0),m=G(void 0),S=G(!1);const k=()=>{x(S,window.innerWidth<=1200)};sr(()=>{s.messages.length;const P=s.messages.find(F=>F.isStreaming);P&&`${P.text}${P.observations??""}`,c(p)&&requestAnimationFrame(()=>{c(p)&&(c(p).scrollTop=c(p).scrollHeight)})}),uc(()=>(k(),window.addEventListener("resize",k),w(),()=>{window.removeEventListener("resize",k),f.close(),h.close(),v.close()})),sr(()=>{const P=r.sessionId;P&&v.start(P)});const w=async()=>{const[P,F,U]=await Promise.all([Ah(),Ch(),Ih()]);P&&i.setFromResponse(P),F&&o.setFromSpecData(F),U&&u.setFromPayload(U)},T=()=>{const P=s.input.trim();if(!P||r.isSending)return;l.clearError();const F=l.parseContexts();if(!F){c(S)?c(m)?.switchToSetup():c(b)?.switchToSetup();return}const{toolContext:U,llmContext:V}=F;r.isSending=!0,a.clearArtifacts(),d.clearPendingInteraction(),s.addUserMessage(P),s.clearInput(),f.start(P,r.sessionId,U,V,{onDone:async H=>{if(r.activeTraceId=H,H){const Y=await Zo(H,r.sessionId);Y&&r.activeTraceId===H&&a.setFromPayload(Y),h.start(H,r.sessionId)}r.isSending=!1},onError:()=>{r.isSending=!1}},l.useAgui?"agui":"sse")},N=(P,F)=>{if(!l.useAgui){l.error="Interactive components require AG-UI streaming.";return}if(!P.resume_token){l.error="Cannot submit: session expired or interrupted. Please resend your message.",d.clearPendingInteraction();return}const U=l.parseContexts();if(!U){c(S)?c(m)?.switchToSetup():c(b)?.switchToSetup();return}const{toolContext:V}=U;r.isSending=!0,a.clearArtifacts(),d.clearPendingInteraction(),f.resumeAgui(P,F,r.sessionId,V,{onDone:async H=>{if(r.activeTraceId=H,H){const Y=await Zo(H,r.sessionId);Y&&r.activeTraceId===H&&a.setFromPayload(Y),h.start(H,r.sessionId)}r.isSending=!1},onError:H=>{l.error=H||"Failed to submit response. Please try again.",r.isSending=!1}})};var C=je(),M=re(C);{var z=P=>{var F=LS(),U=g(F);NS(U,{infoContent:pe=>{iu(pe,{})},specContent:pe=>{ou(pe,{})},configContent:pe=>{uu(pe)},$$slots:{infoContent:!0,specContent:!0,configContent:!0}});var V=_(U,2),H=g(V);Ss(Ud(H,{onSendChat:T,onInteractionResult:N,get chatBodyEl(){return c(p)},set chatBodyEl(j){x(p,j,!0)}}),j=>x(m,j,!0),()=>c(m));var Y=_(V,2);PS(Y,{trajectoryContent:ce=>{zd(ce,{})},eventsContent:ce=>{jd(ce)},artifactsContent:ce=>{Gd(ce,{})},tasksContent:ce=>{Bd(ce,{})},notificationsContent:ce=>{Fd(ce,{})}}),y(P,F)},$=P=>{Em(P,{children:(F,U)=>{var V=DS(),H=re(V);xm(H,{children:(te,he)=>{var pe=$S(),Ke=re(pe);iu(Ke,{});var ce=_(Ke,2);ou(ce,{});var me=_(ce,2);uu(me),y(te,pe)}});var Y=_(H,2);Ss(n0(Y,{onSendChat:T,onInteractionResult:N,get chatBodyEl(){return c(p)},set chatBodyEl(te){x(p,te,!0)}}),te=>x(b,te,!0),()=>c(b));var j=_(Y,2);vS(j),y(F,V)}})};I(M,P=>{c(S)?P(z):P($,!1)})}y(e,C),ve()}Sm();const Vd=document.getElementById("app");if(!Vd)throw new Error("Missing #app element");tv(US,{target:Vd});export{re as A,sc as B,vv as C,je as D,qv as E,at as F,Bi as G,uc as H,Re as I,Ji as J,Pe as K,Bf as L,zs as M,cu as N,jS as O,Lf as P,Is as Q,Wf as R,yv as S,BS as T,Ss as U,FS as V,rt as _,dt as a,Xe as b,de as c,x as d,g as e,E as f,c as g,_ as h,I as i,Ue as j,hi as k,ke as l,A as m,y as n,Jr as o,fe as p,GS as q,ve as r,G as s,O as t,sr as u,os as v,pr as w,Dt as x,Yd as y,_t as z};
