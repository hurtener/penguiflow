const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ECharts-Dh3KIvYc.js","assets/ECharts-SUlEdAZf.css","assets/Mermaid-CWJqpUQX.js","assets/_commonjsHelpers-CqkleIqs.js","assets/purify.es-HRjpPm7y.js","assets/Mermaid-D_q-5SJ2.css","assets/Plotly-vGI5WD-H.js","assets/Plotly-BnH91lxL.css","assets/DataGrid-DC8HLCGy.js","assets/DataGrid-CnGdOVL9.css","assets/Json-JGXZ_HdN.js","assets/Json-BfbC447w.css","assets/Metric-CvwFpWxL.js","assets/Metric-BR7LGQoy.css","assets/Markdown-CH3hBE82.js","assets/katex-XbL3y5x-.js","assets/Markdown-CElcD4b8.css","assets/katex-DvXFAOB1.css","assets/Code-D8rGw3BA.js","assets/Code-CS6X8G3Y.css","assets/Latex-7r3LdLVU.js","assets/Latex-De3SCfkv.css","assets/Callout-3vTLDmOr.js","assets/Callout-B-wLDEhr.css","assets/Form-C7vfJIgg.js","assets/Form-eWoJO6O2.css","assets/Confirm-Dsrz5MWk.js","assets/Confirm-YhSN8Zxn.css","assets/SelectOption-DelcoAu1.js","assets/SelectOption-CEnDdoyK.css","assets/Report-D-9m3M9a.js","assets/Report-DYNw1-yU.css","assets/Grid-BDH12miG.js","assets/Grid-Cg7MxYKJ.css","assets/Tabs-BOpSrxIb.js","assets/Tabs-BoGLw0iN.css","assets/Accordion-GmEbV2pm.js","assets/Accordion-2qjp3LnE.css","assets/Image-cbs3k3Pu.js","assets/Image-CbfbhndX.css","assets/Html-CLqx3OV7.js","assets/Html-CBo-9Zlq.css","assets/Video-BcP9aOAb.js","assets/Video-CRk6YMQD.css","assets/Embed-DGhuMqp_.js","assets/Embed-fxz_xzQf.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Ba=!1;var Bl=Array.isArray,_d=Array.prototype.indexOf,Si=Array.from,Gl=Object.defineProperty,un=Object.getOwnPropertyDescriptor,Fl=Object.getOwnPropertyDescriptors,yd=Object.prototype,bd=Array.prototype,Ei=Object.getPrototypeOf,ao=Object.isExtensible;function Sr(e){return typeof e=="function"}const $e=()=>{};function wd(e){return typeof e?.then=="function"}function Sd(e){return e()}function Ga(e){for(var t=0;t<e.length;t++)e[t]()}function Vl(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}function Ed(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const qe=2,ki=4,Ys=8,kd=1<<24,en=16,tn=32,zn=64,Ws=128,xt=512,Ve=1024,ot=2048,Dt=4096,ct=8192,Ht=16384,xi=32768,vn=65536,io=1<<17,Hl=1<<18,dr=1<<19,ql=1<<20,Rn=32768,Fa=1<<21,Ti=1<<22,cn=1<<23,Rt=Symbol("$state"),Zl=Symbol("legacy props"),xd=Symbol(""),Jn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ai(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Td(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ad(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Id(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Cd(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Nd(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Rd(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Od(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Md(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Pd(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Ld(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Xl=1,Kl=2,Jl=4,Dd=8,$d=16,Ud=1,zd=2,jd=4,Bd=8,Gd=16,Fd=1,Vd=2,Fe=Symbol(),Hd="http://www.w3.org/1999/xhtml";function Qb(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function qd(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Yl(e){return e===this.v}function Wl(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ql(e){return!Wl(e,this.v)}let fr=!1,Zd=!1;function Xd(){fr=!0}let pe=null;function nr(e){pe=e}function Tt(e){return eu().get(e)}function ft(e,t){return eu().set(e,t),t}function ee(e,t=!1,n){pe={p:pe,i:!1,c:null,e:null,s:e,x:null,l:fr&&!t?{s:null,u:null,$:[]}:null}}function te(e){var t=pe,n=t.e;if(n!==null){t.e=null;for(var r of n)mu(r)}return e!==void 0&&(t.x=e),t.i=!0,pe=t.p,e??{}}function jn(){return!fr||pe!==null&&pe.l===null}function eu(e){return pe===null&&Ai(),pe.c??=new Map(Kd(pe)||void 0)}function Kd(e){let t=e.p;for(;t!==null;){const n=t.c;if(n!==null)return n;t=t.p}return null}let Tn=[];function tu(){var e=Tn;Tn=[],Ga(e)}function Kt(e){if(Tn.length===0&&!Wn){var t=Tn;queueMicrotask(()=>{t===Tn&&tu()})}Tn.push(e)}function Jd(){for(;Tn.length>0;)tu()}function nu(e){var t=ue;if(t===null)return re.f|=cn,e;if((t.f&xi)===0){if((t.f&Ws)===0)throw e;t.b.error(e)}else rr(e,t)}function rr(e,t){for(;t!==null;){if((t.f&Ws)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Qr=new Set;let de=null,ss=null,_t=null,gt=[],Qs=null,Va=!1,Wn=!1;class kt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){gt=[],ss=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#i(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(ss=this,de=null,oo(n.render_effects),oo(n.effects),ss=null,this.#l?.resolve()),_t=null}#i(t,n){t.f^=Ve;for(var r=t.first;r!==null;){var s=r.f,a=(s&(tn|zn))!==0,i=a&&(s&Ve)!==0,o=i||(s&ct)!==0||this.skipped_effects.has(r);if((r.f&Ws)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){a?r.f^=Ve:(s&ki)!==0?n.effects.push(r):vr(r)&&((r.f&en)!==0&&n.block_effects.push(r),ar(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&ot)!==0?this.#a:this.#s).push(n),this.#u(n.deps),He(n,Ve)}#u(t){if(t!==null)for(const n of t)(n.f&qe)===0||(n.f&Rn)===0||(n.f^=Rn,this.#u(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&cn)===0&&(this.current.set(t,t.v),_t?.set(t,t.v))}activate(){de=this,this.apply()}deactivate(){de===this&&(de=null,_t=null)}flush(){if(this.activate(),gt.length>0){if(su(),de!==null&&de!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#c(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#d()}#d(){if(Qr.size>1){this.previous.clear();var t=_t,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of Qr){if(a===this){n=!1;continue}const i=[];for(const[l,u]of this.current){if(a.current.has(l))if(n&&u!==a.current.get(l))a.current.set(l,u);else continue;i.push(l)}if(i.length===0)continue;const o=[...a.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=gt;gt=[];const l=new Set,u=new Map;for(const c of i)au(c,o,l,u);if(gt.length>0){de=a,a.apply();for(const c of gt)a.#i(c,r);a.deactivate()}gt=s}}de=null,_t=t}this.committed=!0,Qr.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#a)He(t,ot),On(t);for(const t of this.#s)He(t,Dt),On(t);this.#a=[],this.#s=[],this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=Vl()).promise}static ensure(){if(de===null){const t=de=new kt;Qr.add(de),Wn||kt.enqueue(()=>{de===t&&t.flush()})}return de}static enqueue(t){Kt(t)}apply(){}}function ru(e){var t=Wn;Wn=!0;try{for(var n;;){if(Jd(),gt.length===0&&(de?.flush(),gt.length===0))return Qs=null,n;su()}}finally{Wn=t}}function su(){var e=An;Va=!0;var t=null;try{var n=0;for(Ns(!0);gt.length>0;){var r=kt.ensure();if(n++>1e3){var s,a;Yd()}r.process(gt),dn.clear()}}finally{Va=!1,Ns(e),Qs=null}}function Yd(){try{Nd()}catch(e){rr(e,Qs)}}let Ft=null;function oo(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(Ht|ct))===0&&vr(r)&&(Ft=new Set,ar(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Eu(r):r.fn=null),Ft?.size>0)){dn.clear();for(const s of Ft){if((s.f&(Ht|ct))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Ft.has(i)&&(Ft.delete(i),a.push(i)),i=i.parent;for(let o=a.length-1;o>=0;o--){const l=a[o];(l.f&(Ht|ct))===0&&ar(l)}}Ft.clear()}}Ft=null}}function au(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&qe)!==0?au(s,t,n,r):(a&(Ti|en))!==0&&(a&ot)===0&&iu(s,t,r)&&(He(s,ot),On(s))}}function iu(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&qe)!==0&&iu(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function On(e){for(var t=Qs=e;t.parent!==null;){t=t.parent;var n=t.f;if(Va&&t===ue&&(n&en)!==0&&(n&Hl)===0)return;if((n&(zn|tn))!==0){if((n&Ve)===0)return;t.f^=Ve}}gt.push(t)}function Wd(e){let t=0,n=Jt(0),r;return()=>{Lr()&&(v(n),mn(()=>(t===0&&(r=le(()=>e(()=>Or(n)))),t+=1,()=>{Kt(()=>{t-=1,t===0&&(r?.(),r=void 0,Or(n))})})))}}var Qd=vn|dr|Ws;function ef(e,t,n){new tf(e,t,n)}class tf{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#u=null;#c=null;#d=0;#f=0;#h=!1;#v=null;#y=Wd(()=>(this.#v=Jt(this.#d),()=>{this.#v=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=ue.b,this.#e=!!this.#n.pending,this.#a=Bn(()=>{ue.b=this;{var s=this.#m();try{this.#s=mt(()=>r(s))}catch(a){this.error(a)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#c?.remove()}},Qd)}#b(){try{this.#s=mt(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#w(){const t=this.#n.pending;t&&(this.#i=mt(()=>t(this.#t)),kt.enqueue(()=>{var n=this.#m();this.#s=this.#p(()=>(kt.ensure(),mt(()=>this.#l(n)))),this.#f>0?this.#g():(Qn(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#m(){var t=this.#t;return this.#e&&(this.#c=Wt(),this.#t.before(this.#c),t=this.#c),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var n=ue,r=re,s=pe;Mt(this.#a),st(this.#a),nr(this.#a.ctx);try{return t()}catch(a){return nu(a),null}finally{Mt(n),st(r),nr(s)}}#g(){const t=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),Tu(this.#s,this.#u)),this.#i===null&&(this.#i=mt(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#i&&Qn(this.#i,()=>{this.#i=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(t){this.#_(t),this.#d+=t,this.#v&&qt(this.#v,this.#d)}get_effect_pending(){return this.#y(),v(this.#v)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#h||!n&&!r)throw t;this.#s&&(at(this.#s),this.#s=null),this.#i&&(at(this.#i),this.#i=null),this.#o&&(at(this.#o),this.#o=null);var s=!1,a=!1;const i=()=>{if(s){qd();return}s=!0,a&&Ld(),kt.ensure(),this.#d=0,this.#o!==null&&Qn(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#h=!1,mt(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var o=re;try{st(null),a=!0,n?.(t,i),a=!1}catch(l){rr(l,this.#a&&this.#a.parent)}finally{st(o)}r&&Kt(()=>{this.#o=this.#p(()=>{kt.ensure(),this.#h=!0;try{return mt(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return rr(l,this.#a.parent),null}finally{this.#h=!1}})})}}function nf(e,t,n,r){const s=jn()?Fr:ea;if(n.length===0&&e.length===0){r(t.map(s));return}var a=de,i=ue,o=ou();function l(){Promise.all(n.map(u=>rf(u))).then(u=>{o();try{r([...t.map(s),...u])}catch(c){(i.f&Ht)===0&&rr(c,i)}a?.deactivate(),Pr()}).catch(u=>{rr(u,i)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{a?.deactivate(),Pr()}}):l()}function ou(){var e=ue,t=re,n=pe,r=de;return function(a=!0){Mt(e),st(t),nr(n),a&&r?.activate()}}function Pr(){Mt(null),st(null),nr(null)}function Fr(e){var t=qe|ot,n=re!==null&&(re.f&qe)!==0?re:null;return ue!==null&&(ue.f|=dr),{ctx:pe,deps:null,effects:null,equals:Yl,f:t,fn:e,reactions:null,rv:0,v:Fe,wv:0,parent:n??ue,ac:null}}function rf(e,t){let n=ue;n===null&&Td();var r=n.b,s=void 0,a=Jt(Fe),i=!re,o=new Map;return pf(()=>{var l=Vl();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{u===de&&u.committed&&u.deactivate(),Pr()})}catch(h){l.reject(h),Pr()}var u=de;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),o.get(u)?.reject(Jn),o.delete(u),o.set(u,l)}const d=(h,f=void 0)=>{if(u.activate(),f)f!==Jn&&(a.f|=cn,qt(a,f));else{(a.f&cn)!==0&&(a.f^=cn),qt(a,h);for(const[p,m]of o){if(o.delete(p),p===u)break;m.reject(Jn)}}i&&(r.update_pending_count(-1),u.decrement(c))};l.promise.then(d,h=>d(null,h||"unknown"))}),Hr(()=>{for(const l of o.values())l.reject(Jn)}),new Promise(l=>{function u(c){function d(){c===s?l(a):u(s)}c.then(d,d)}u(s)})}function ye(e){const t=Fr(e);return Au(t),t}function ea(e){const t=Fr(e);return t.equals=Ql,t}function lu(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)at(t[n])}}function sf(e){for(var t=e.parent;t!==null;){if((t.f&qe)===0)return(t.f&Ht)===0?t:null;t=t.parent}return null}function Ii(e){var t,n=ue;Mt(sf(e));try{e.f&=~Rn,lu(e),t=Ru(e)}finally{Mt(n)}return t}function uu(e){var t=Ii(e);if(e.equals(t)||(de?.is_fork||(e.v=t),e.wv=Cu()),!Gn)if(_t!==null)(Lr()||de?.is_fork)&&_t.set(e,t);else{var n=(e.f&xt)===0?Dt:Ve;He(e,n)}}let Ha=new Set;const dn=new Map;let cu=!1;function Jt(e,t){var n={f:0,v:e,reactions:null,equals:Yl,rv:0,wv:0};return n}function G(e,t){const n=Jt(e);return Au(n),n}function Yt(e,t=!1,n=!0){const r=Jt(e);return t||(r.equals=Ql),fr&&n&&pe!==null&&pe.l!==null&&(pe.l.s??=[]).push(r),r}function sn(e,t){return x(e,le(()=>v(e))),t}function x(e,t,n=!1){re!==null&&(!Nt||(re.f&io)!==0)&&jn()&&(re.f&(qe|en|Ti|io))!==0&&!Zt?.includes(e)&&Pd();let r=n?Me(t):t;return qt(e,r)}function qt(e,t){if(!e.equals(t)){var n=e.v;Gn?dn.set(e,t):dn.set(e,n),e.v=t;var r=kt.ensure();r.capture(e,n),(e.f&qe)!==0&&((e.f&ot)!==0&&Ii(e),He(e,(e.f&xt)!==0?Ve:Dt)),e.wv=Cu(),du(e,ot),jn()&&ue!==null&&(ue.f&Ve)!==0&&(ue.f&(tn|zn))===0&&(pt===null?mf([e]):pt.push(e)),!r.is_fork&&Ha.size>0&&!cu&&af()}return t}function af(){cu=!1;var e=An;Ns(!0);const t=Array.from(Ha);try{for(const n of t)(n.f&Ve)!==0&&He(n,Dt),vr(n)&&ar(n)}finally{Ns(e)}Ha.clear()}function Or(e){x(e,e.v+1)}function du(e,t){var n=e.reactions;if(n!==null)for(var r=jn(),s=n.length,a=0;a<s;a++){var i=n[a],o=i.f;if(!(!r&&i===ue)){var l=(o&ot)===0;if(l&&He(i,t),(o&qe)!==0){var u=i;_t?.delete(u),(o&Rn)===0&&(o&xt&&(i.f|=Rn),du(u,Dt))}else l&&((o&en)!==0&&Ft!==null&&Ft.add(i),On(i))}}}function Me(e){if(typeof e!="object"||e===null||Rt in e)return e;const t=Ei(e);if(t!==yd&&t!==bd)return e;var n=new Map,r=Bl(e),s=G(0),a=In,i=o=>{if(In===a)return o();var l=re,u=In;st(null),vo(a);var c=o();return st(l),vo(u),c};return r&&n.set("length",G(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Od();var c=n.get(l);return c===void 0?c=i(()=>{var d=G(u.value);return n.set(l,d),d}):x(c,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const c=i(()=>G(Fe));n.set(l,c),Or(s)}}else x(u,Fe),Or(s);return!0},get(o,l,u){if(l===Rt)return e;var c=n.get(l),d=l in o;if(c===void 0&&(!d||un(o,l)?.writable)&&(c=i(()=>{var f=Me(d?o[l]:Fe),p=G(f);return p}),n.set(l,c)),c!==void 0){var h=v(c);return h===Fe?void 0:h}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=v(c))}else if(u===void 0){var d=n.get(l),h=d?.v;if(d!==void 0&&h!==Fe)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(o,l){if(l===Rt)return!0;var u=n.get(l),c=u!==void 0&&u.v!==Fe||Reflect.has(o,l);if(u!==void 0||ue!==null&&(!c||un(o,l)?.writable)){u===void 0&&(u=i(()=>{var h=c?Me(o[l]):Fe,f=G(h);return f}),n.set(l,u));var d=v(u);if(d===Fe)return!1}return c},set(o,l,u,c){var d=n.get(l),h=l in o;if(r&&l==="length")for(var f=u;f<d.v;f+=1){var p=n.get(f+"");p!==void 0?x(p,Fe):f in o&&(p=i(()=>G(Fe)),n.set(f+"",p))}if(d===void 0)(!h||un(o,l)?.writable)&&(d=i(()=>G(void 0)),x(d,Me(u)),n.set(l,d));else{h=d.v!==Fe;var m=i(()=>Me(u));x(d,m)}var g=Reflect.getOwnPropertyDescriptor(o,l);if(g?.set&&g.set.call(c,u),!h){if(r&&typeof l=="string"){var S=n.get("length"),E=Number(l);Number.isInteger(E)&&E>=S.v&&x(S,E+1)}Or(s)}return!0},ownKeys(o){v(s);var l=Reflect.ownKeys(o).filter(d=>{var h=n.get(d);return h===void 0||h.v!==Fe});for(var[u,c]of n)c.v!==Fe&&!(u in o)&&l.push(u);return l},setPrototypeOf(){Md()}})}function lo(e){try{if(e!==null&&typeof e=="object"&&Rt in e)return e[Rt]}catch{}return e}function of(e,t){return Object.is(lo(e),lo(t))}var uo,fu,vu,hu;function lf(){if(uo===void 0){uo=window,fu=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;vu=un(t,"firstChild").get,hu=un(t,"nextSibling").get,ao(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),ao(n)&&(n.__t=void 0)}}function Wt(e=""){return document.createTextNode(e)}function Ct(e){return vu.call(e)}function Vr(e){return hu.call(e)}function _(e,t){return Ct(e)}function W(e,t=!1){{var n=Ct(e);return n instanceof Comment&&n.data===""?Vr(n):n}}function y(e,t=1,n=!1){let r=e;for(;t--;)r=Vr(r);return r}function uf(e){e.textContent=""}function pu(){return!1}let co=!1;function cf(){co||(co=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function ta(e){var t=re,n=ue;st(null),Mt(null);try{return e()}finally{st(t),Mt(n)}}function Ci(e,t,n,r=n){e.addEventListener(t,()=>ta(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),cf()}function gu(e){ue===null&&(re===null&&Cd(),Id()),Gn&&Ad()}function df(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function $t(e,t,n){var r=ue;r!==null&&(r.f&ct)!==0&&(e|=ct);var s={ctx:pe,deps:null,nodes:null,f:e|ot|xt,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{ar(s),s.f|=xi}catch(o){throw at(s),o}else t!==null&&On(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&dr)===0&&(a=a.first,(e&en)!==0&&(e&vn)!==0&&a!==null&&(a.f|=vn)),a!==null&&(a.parent=r,r!==null&&df(a,r),re!==null&&(re.f&qe)!==0&&(e&zn)===0)){var i=re;(i.effects??=[]).push(a)}return s}function Lr(){return re!==null&&!Nt}function Hr(e){const t=$t(Ys,null,!1);return He(t,Ve),t.teardown=e,t}function sr(e){gu();var t=ue.f,n=!re&&(t&tn)!==0&&(t&xi)===0;if(n){var r=pe;(r.e??=[]).push(e)}else return mu(e)}function mu(e){return $t(ki|ql,e,!1)}function ff(e){return gu(),$t(Ys|ql,e,!0)}function vf(e){kt.ensure();const t=$t(zn|dr,e,!0);return(n={})=>new Promise(r=>{n.outro?Qn(t,()=>{at(t),r(void 0)}):(at(t),r(void 0))})}function hf(e){return $t(ki,e,!1)}function _u(e,t){var n=pe,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=mn(()=>{e(),!r.ran&&(r.ran=!0,le(t))})}function yu(){var e=pe;mn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&Ve)!==0&&He(n,Dt),vr(n)&&ar(n),t.ran=!1}})}function pf(e){return $t(Ti|dr,e,!0)}function mn(e,t=0){return $t(Ys|t,e,!0)}function D(e,t=[],n=[],r=[]){nf(r,t,n,s=>{$t(Ys,()=>e(...s.map(v)),!0)})}function Bn(e,t=0){var n=$t(en|t,e,!0);return n}function mt(e){return $t(tn|dr,e,!0)}function bu(e){var t=e.teardown;if(t!==null){const n=Gn,r=re;fo(!0),st(null);try{t.call(null)}finally{fo(n),st(r)}}}function wu(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&ta(()=>{s.abort(Jn)});var r=n.next;(n.f&zn)!==0?n.parent=null:at(n,t),n=r}}function gf(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&tn)===0&&at(t),t=n}}function at(e,t=!0){var n=!1;(t||(e.f&Hl)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Su(e.nodes.start,e.nodes.end),n=!0),wu(e,t&&!n),Rs(e,0),He(e,Ht);var r=e.nodes&&e.nodes.t;if(r!==null)for(const a of r)a.stop();bu(e);var s=e.parent;s!==null&&s.first!==null&&Eu(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Su(e,t){for(;e!==null;){var n=e===t?null:Vr(e);e.remove(),e=n}}function Eu(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Qn(e,t,n=!0){var r=[];Ni(e,r,!0),ku(r,()=>{n&&at(e),t&&t()})}function ku(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Ni(e,t,n){if((e.f&ct)===0){e.f^=ct;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&vn)!==0||(s.f&tn)!==0&&(e.f&en)!==0;Ni(s,t,i?n:!1),s=a}}}function Ri(e){xu(e,!0)}function xu(e,t){if((e.f&ct)!==0){e.f^=ct,(e.f&Ve)===0&&(He(e,ot),On(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&vn)!==0||(n.f&tn)!==0;xu(n,s?t:!1),n=r}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function Tu(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:Vr(n);t.append(n),n=s}}let An=!1;function Ns(e){An=e}let Gn=!1;function fo(e){Gn=e}let re=null,Nt=!1;function st(e){re=e}let ue=null;function Mt(e){ue=e}let Zt=null;function Au(e){re!==null&&(Zt===null?Zt=[e]:Zt.push(e))}let Je=null,lt=0,pt=null;function mf(e){pt=e}let Iu=1,Dr=0,In=Dr;function vo(e){In=e}function Cu(){return++Iu}function vr(e){var t=e.f;if((t&ot)!==0)return!0;if(t&qe&&(e.f&=~Rn),(t&Dt)!==0){var n=e.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(vr(a)&&uu(a),a.wv>e.wv)return!0}(t&xt)!==0&&_t===null&&He(e,Ve)}return!1}function Nu(e,t,n=!0){var r=e.reactions;if(r!==null&&!Zt?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&qe)!==0?Nu(a,t,!1):t===a&&(n?He(a,ot):(a.f&Ve)!==0&&He(a,Dt),On(a))}}function Ru(e){var t=Je,n=lt,r=pt,s=re,a=Zt,i=pe,o=Nt,l=In,u=e.f;Je=null,lt=0,pt=null,re=(u&(tn|zn))===0?e:null,Zt=null,nr(e.ctx),Nt=!1,In=++Dr,e.ac!==null&&(ta(()=>{e.ac.abort(Jn)}),e.ac=null);try{e.f|=Fa;var c=e.fn,d=c(),h=e.deps;if(Je!==null){var f;if(Rs(e,lt),h!==null&&lt>0)for(h.length=lt+Je.length,f=0;f<Je.length;f++)h[lt+f]=Je[f];else e.deps=h=Je;if(Lr()&&(e.f&xt)!==0)for(f=lt;f<h.length;f++)(h[f].reactions??=[]).push(e)}else h!==null&&lt<h.length&&(Rs(e,lt),h.length=lt);if(jn()&&pt!==null&&!Nt&&h!==null&&(e.f&(qe|Dt|ot))===0)for(f=0;f<pt.length;f++)Nu(pt[f],e);return s!==null&&s!==e&&(Dr++,pt!==null&&(r===null?r=pt:r.push(...pt))),(e.f&cn)!==0&&(e.f^=cn),d}catch(p){return nu(p)}finally{e.f^=Fa,Je=t,lt=n,pt=r,re=s,Zt=a,nr(i),Nt=o,In=l}}function _f(e,t){let n=t.reactions;if(n!==null){var r=_d.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&qe)!==0&&(Je===null||!Je.includes(t))&&(He(t,Dt),(t.f&xt)!==0&&(t.f^=xt,t.f&=~Rn),lu(t),Rs(t,0))}function Rs(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)_f(e,n[r])}function ar(e){var t=e.f;if((t&Ht)===0){He(e,Ve);var n=ue,r=An;ue=e,An=!0;try{(t&(en|kd))!==0?gf(e):wu(e),bu(e);var s=Ru(e);e.teardown=typeof s=="function"?s:null,e.wv=Iu;var a;Ba&&Zd&&(e.f&ot)!==0&&e.deps}finally{An=r,ue=n}}}async function yf(){await Promise.resolve(),ru()}function v(e){var t=e.f,n=(t&qe)!==0;if(re!==null&&!Nt){var r=ue!==null&&(ue.f&Ht)!==0;if(!r&&!Zt?.includes(e)){var s=re.deps;if((re.f&Fa)!==0)e.rv<Dr&&(e.rv=Dr,Je===null&&s!==null&&s[lt]===e?lt++:Je===null?Je=[e]:Je.includes(e)||Je.push(e));else{(re.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[re]:a.includes(re)||a.push(re)}}}if(Gn){if(dn.has(e))return dn.get(e);if(n){var i=e,o=i.v;return((i.f&Ve)===0&&i.reactions!==null||Mu(i))&&(o=Ii(i)),dn.set(i,o),o}}else n&&(!_t?.has(e)||de?.is_fork&&!Lr())&&(i=e,vr(i)&&uu(i),An&&Lr()&&(i.f&xt)===0&&Ou(i));if(_t?.has(e))return _t.get(e);if((e.f&cn)!==0)throw e.v;return e.v}function Ou(e){if(e.deps!==null){e.f^=xt;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&qe)!==0&&(t.f&xt)===0&&Ou(t)}}function Mu(e){if(e.v===Fe)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(dn.has(t)||(t.f&qe)!==0&&Mu(t))return!0;return!1}function le(e){var t=Nt;try{return Nt=!0,e()}finally{Nt=t}}const bf=-7169;function He(e,t){e.f=e.f&bf|t}function rt(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Rt in e)qa(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Rt in n&&qa(n)}}}function qa(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{qa(e[r],t)}catch{}const n=Ei(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=Fl(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const wf=["touchstart","touchmove"];function Sf(e){return wf.includes(e)}const Pu=new Set,Za=new Set;function Ef(e,t,n,r={}){function s(a){if(r.capture||Tr.call(t,a),!a.cancelBubble)return ta(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Kt(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function kf(e,t,n,r,s){var a={capture:r,passive:s},i=Ef(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Hr(()=>{t.removeEventListener(e,i,a)})}function yt(e){for(var t=0;t<e.length;t++)Pu.add(e[t]);for(var n of Za)n(e)}let ho=null;function Tr(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;ho=e;var i=0,o=ho===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(i=l)}if(a=s[i]||e.target,a!==t){Gl(e,"currentTarget",{configurable:!0,get(){return a||n}});var c=re,d=ue;st(null),Mt(null);try{for(var h,f=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var m=a["__"+r];m!=null&&(!a.disabled||e.target===a)&&m.call(a,e)}catch(g){h?f.push(g):h=g}if(e.cancelBubble||p===t||p===null)break;a=p}if(h){for(let g of f)queueMicrotask(()=>{throw g});throw h}}finally{e.__root=t,delete e.currentTarget,st(c),Mt(d)}}}function Oi(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function ir(e,t){var n=ue;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function T(e,t){var n=(t&Fd)!==0,r=(t&Vd)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Oi(a?e:"<!>"+e),n||(s=Ct(s)));var i=r||fu?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=Ct(i),l=i.lastChild;ir(o,l)}else ir(i,i);return i}}function xf(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var i=Oi(s),o=Ct(i);a=Ct(o)}var l=a.cloneNode(!0);return ir(l,l),l}}function Tf(e,t){return xf(e,t,"svg")}function Xe(e=""){{var t=Wt(e+"");return ir(t,t),t}}function Pe(){var e=document.createDocumentFragment(),t=document.createComment(""),n=Wt();return e.append(t,n),ir(t,n),e}function w(e,t){e!==null&&e.before(t)}function L(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function Af(e,t){return If(e,t)}const Hn=new Map;function If(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:i=!0}){lf();var o=new Set,l=d=>{for(var h=0;h<d.length;h++){var f=d[h];if(!o.has(f)){o.add(f);var p=Sf(f);t.addEventListener(f,Tr,{passive:p});var m=Hn.get(f);m===void 0?(document.addEventListener(f,Tr,{passive:p}),Hn.set(f,1)):Hn.set(f,m+1)}}};l(Si(Pu)),Za.add(l);var u=void 0,c=vf(()=>{var d=n??t.appendChild(Wt());return ef(d,{pending:()=>{}},h=>{if(a){ee({});var f=pe;f.c=a}s&&(r.$$events=s),u=e(h,r)||{},a&&te()}),()=>{for(var h of o){t.removeEventListener(h,Tr);var f=Hn.get(h);--f===0?(document.removeEventListener(h,Tr),Hn.delete(h)):Hn.set(h,f)}Za.delete(l),d!==n&&d.parentNode?.removeChild(d)}});return Cf.set(u,c),u}let Cf=new WeakMap;class qr{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#a=()=>{var t=de;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Ri(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const o=this.#r.get(i);o&&(at(o.effect),this.#r.delete(i))}for(const[a,i]of this.#t){if(a===n||this.#n.has(a))continue;const o=()=>{if(Array.from(this.#e.values()).includes(a)){var u=document.createDocumentFragment();Tu(i,u),u.append(Wt()),this.#r.set(a,{effect:i,fragment:u})}else at(i);this.#n.delete(a),this.#t.delete(a)};this.#l||!r?(this.#n.add(a),Qn(i,o,!1)):o()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(at(s.effect),this.#r.delete(r))};ensure(t,n){var r=de,s=pu();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(s){var a=document.createDocumentFragment(),i=Wt();a.append(i),this.#r.set(t,{effect:mt(()=>n(i)),fragment:a})}else this.#t.set(t,mt(()=>n(this.anchor)));if(this.#e.set(r,t),s){for(const[o,l]of this.#t)o===t?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===t?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}const Nf=0,ka=1;function Rf(e,t,n,r,s){var a=jn(),i=Fe,o=a?Jt(i):Yt(i,!1,!1),l=a?Jt(i):Yt(i,!1,!1),u=new qr(e);Bn(()=>{var c=t(),d=!1;if(wd(c)){var h=ou(),f=!1;const p=m=>{if(!d){f=!0,h(!1),kt.ensure();try{m()}finally{Pr(),Wn||ru()}}};c.then(m=>{p(()=>{qt(o,m),u.ensure(ka,r&&(g=>r(g,o)))})},m=>{p(()=>{if(qt(l,m),u.ensure(ka,s&&(g=>s(g,l))),!s)throw l.v})}),Kt(()=>{f||p(()=>{u.ensure(Nf,n)})})}else qt(o,c),u.ensure(ka,r&&(p=>r(p,o)));return()=>{d=!0}})}function $(e,t,n=!1){var r=new qr(e),s=n?vn:0;function a(i,o){r.ensure(i,o)}Bn(()=>{var i=!1;t((o,l=!0)=>{i=!0,a(l,o)}),i||a(!1,null)},s)}function Of(e,t,n){var r=new qr(e),s=!jn();Bn(()=>{var a=t();s&&a!==null&&typeof a=="object"&&(a={}),r.ensure(a,n)})}function $r(e,t){return t}function Mf(e,t,n){for(var r=[],s=t.length,a=0;a<s;a++)Ni(t[a].e,r,!0);ku(r,()=>{var i=r.length===0&&n!==null;if(i){var o=n,l=o.parentNode;uf(l),l.append(o),e.items.clear(),wt(e,t[0].prev,t[s-1].next)}for(var u=0;u<s;u++){var c=t[u];i||(e.items.delete(c.k),wt(e,c.prev,c.next)),at(c.e,!i)}e.first===t[0]&&(e.first=t[0].prev)})}function Le(e,t,n,r,s,a=null){var i=e,o=new Map,l=null,u=(t&Jl)!==0,c=(t&Xl)!==0,d=(t&Kl)!==0;if(u){var h=e;i=h.appendChild(Wt())}var f=null,p=ea(()=>{var k=n();return Bl(k)?k:k==null?[]:Si(k)}),m,g=!0;function S(){Pf(b,m,i,t,r),f!==null&&(m.length===0?(f.fragment?(i.before(f.fragment),f.fragment=null):Ri(f.effect),E.first=f.effect):Qn(f.effect,()=>{f=null}))}var E=Bn(()=>{m=v(p);for(var k=m.length,N=new Set,C=de,O=null,U=pu(),R=0;R<k;R+=1){var A=m[R],B=r(A,R),F=g?null:o.get(B);F?(c&&qt(F.v,A),d&&qt(F.i,R),U&&C.skipped_effects.delete(F.e)):(F=Lf(g?i:null,O,A,B,R,s,t,n),g&&(F.o=!0,O===null?l=F:O.next=F,O=F),o.set(B,F)),N.add(B)}if(k===0&&a&&!f)if(g)f={fragment:null,effect:mt(()=>a(i))};else{var H=document.createDocumentFragment(),ne=Wt();H.append(ne),f={fragment:H,effect:mt(()=>a(ne))}}if(!g)if(U){for(const[fe,oe]of o)N.has(fe)||C.skipped_effects.add(oe.e);C.oncommit(S),C.ondiscard(()=>{})}else S();v(p)}),b={effect:E,items:o,first:l};g=!1}function Pf(e,t,n,r,s){var a=(r&Dd)!==0,i=t.length,o=e.items,l=e.first,u,c=null,d,h=[],f=[],p,m,g,S;if(a)for(S=0;S<i;S+=1)p=t[S],m=s(p,S),g=o.get(m),g.o&&(g.e.nodes?.a?.measure(),(d??=new Set).add(g));for(S=0;S<i;S+=1){if(p=t[S],m=s(p,S),g=o.get(m),e.first??=g,!g.o){g.o=!0;var E=c?c.next:l;wt(e,c,g),wt(e,g,E),xa(g,E,n),c=g,h=[],f=[],l=c.next;continue}if((g.e.f&ct)!==0&&(Ri(g.e),a&&(g.e.nodes?.a?.unfix(),(d??=new Set).delete(g))),g!==l){if(u!==void 0&&u.has(g)){if(h.length<f.length){var b=f[0],k;c=b.prev;var N=h[0],C=h[h.length-1];for(k=0;k<h.length;k+=1)xa(h[k],b,n);for(k=0;k<f.length;k+=1)u.delete(f[k]);wt(e,N.prev,C.next),wt(e,c,N),wt(e,C,b),l=b,c=C,S-=1,h=[],f=[]}else u.delete(g),xa(g,l,n),wt(e,g.prev,g.next),wt(e,g,c===null?e.first:c.next),wt(e,c,g),c=g;continue}for(h=[],f=[];l!==null&&l!==g;)(l.e.f&ct)===0&&(u??=new Set).add(l),f.push(l),l=l.next;if(l===null)continue;g=l}h.push(g),c=g,l=g.next}let O=o.size>i;if(l!==null||u!==void 0){for(var U=u===void 0?[]:Si(u);l!==null;)(l.e.f&ct)===0&&U.push(l),l=l.next;var R=U.length;if(O=o.size-R>i,R>0){var A=(r&Jl)!==0&&i===0?n:null;if(a){for(S=0;S<R;S+=1)U[S].e.nodes?.a?.measure();for(S=0;S<R;S+=1)U[S].e.nodes?.a?.fix()}Mf(e,U,A)}}if(O)for(const B of o.values())B.o||(wt(e,c,B),c=B);e.effect.last=c&&c.e,a&&Kt(()=>{if(d!==void 0)for(g of d)g.e.nodes?.a?.apply()})}function Lf(e,t,n,r,s,a,i,o){var l=(i&Xl)!==0,u=(i&$d)===0,c=l?u?Yt(n,!1,!1):Jt(n):n,d=(i&Kl)===0?s:Jt(s),h={i:d,v:c,k:r,e:null,o:!1,prev:t,next:null};if(e===null){var f=document.createDocumentFragment();f.append(e=Wt())}return h.e=mt(()=>a(e,c,d,o)),t!==null&&(t.next=h),h}function xa(e,t,n){if(e.e.nodes)for(var r=e.next?e.next.e.nodes.start:n,s=t?t.e.nodes.start:n,a=e.e.nodes.start;a!==null&&a!==r;){var i=Vr(a);s.before(a),a=i}}function wt(e,t,n){t===null?(e.first=n,e.effect.first=n&&n.e):(t.e.next&&(t.e.next.prev=null),t.next=n,t.e.next=n&&n.e),n!==null&&(n.e.prev&&(n.e.prev.next=null),n.prev=t,n.e.prev=t&&t.e)}function Lu(e,t,n=!1,r=!1,s=!1){var a=e,i="";D(()=>{var o=ue;if(i!==(i=t()??"")&&(o.nodes!==null&&(Su(o.nodes.start,o.nodes.end),o.nodes=null),i!=="")){var l=i+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=Oi(l);if((n||r)&&(u=Ct(u)),ir(Ct(u),u.lastChild),n||r)for(;Ct(u);)a.before(Ct(u));else a.before(u)}})}function Df(e,t,n,r,s){var a=t.$$slots?.[n],i=!1;a===!0&&(a=t[n],i=!0),a===void 0?s!==null&&s(e):a(e,i?()=>r:r)}function it(e,t,...n){var r=new qr(e);Bn(()=>{const s=t()??null;r.ensure(s,s&&(a=>s(a,...n)))},vn)}function $f(e,t,n){var r=new qr(e);Bn(()=>{var s=t()??null;r.ensure(s,s&&(a=>n(a,s)))},vn)}function Du(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=Du(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Uf(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=Du(e))&&(r&&(r+=" "),r+=t);return r}function e0(e){return typeof e=="object"?Uf(e):e??""}const po=[...` 	
\r\fÂ \v\uFEFF`];function zf(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,i=0;(i=r.indexOf(s,i))>=0;){var o=i+a;(i===0||po.includes(r[i-1]))&&(o===r.length||po.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function go(e,t=!1){var n=t?" !important;":";",r="";for(var s in e){var a=e[s];a!=null&&a!==""&&(r+=" "+s+": "+a+n)}return r}function Ta(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function jf(e,t){if(t){var n="",r,s;if(Array.isArray(t)?(r=t[0],s=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,i=0,o=!1,l=[];r&&l.push(...Object.keys(r).map(Ta)),s&&l.push(...Object.keys(s).map(Ta));var u=0,c=-1;const m=e.length;for(var d=0;d<m;d++){var h=e[d];if(o?h==="/"&&e[d-1]==="*"&&(o=!1):a?a===h&&(a=!1):h==="/"&&e[d+1]==="*"?o=!0:h==='"'||h==="'"?a=h:h==="("?i++:h===")"&&i--,!o&&a===!1&&i===0){if(h===":"&&c===-1)c=d;else if(h===";"||d===m-1){if(c!==-1){var f=Ta(e.substring(u,c).trim());if(!l.includes(f)){h!==";"&&d++;var p=e.substring(u,d).trim();n+=" "+p+";"}}u=d+1,c=-1}}}}return r&&(n+=go(r)),s&&(n+=go(s,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function we(e,t,n,r,s,a){var i=e.__className;if(i!==n||i===void 0){var o=zf(n,r,a);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(a&&s!==a)for(var l in a){var u=!!a[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return a}function Aa(e,t={},n,r){for(var s in n){var a=n[s];t[s]!==a&&(n[s]==null?e.style.removeProperty(s):e.style.setProperty(s,a,r))}}function Bf(e,t,n,r){var s=e.__style;if(s!==t){var a=jf(t,r);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}else r&&(Array.isArray(r)?(Aa(e,n?.[0],r[0]),Aa(e,n?.[1],r[1],"important")):Aa(e,n,r));return r}const Gf=Symbol("is custom element"),Ff=Symbol("is html");function t0(e,t){var n=$u(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function Ye(e,t,n,r){var s=$u(e);s[t]!==(s[t]=n)&&(t==="loading"&&(e[xd]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Vf(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function $u(e){return e.__attributes??={[Gf]:e.nodeName.includes("-"),[Ff]:e.namespaceURI===Hd}}var mo=new Map;function Vf(e){var t=e.getAttribute("is")||e.nodeName,n=mo.get(t);if(n)return n;mo.set(t,n=[]);for(var r,s=e,a=Element.prototype;a!==s;){r=Fl(s);for(var i in r)r[i].set&&n.push(i);s=Ei(s)}return n}function xn(e,t,n=t){var r=new WeakSet;Ci(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=Ca(e)?Na(a):a,n(a),de!==null&&r.add(de),await yf(),a!==(a=t())){var i=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=a??"",o!==null){var u=e.value.length;i===o&&o===l&&u>l?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=i,e.selectionEnd=Math.min(o,u))}}}),le(t)==null&&e.value&&(n(Ca(e)?Na(e.value):e.value),de!==null&&r.add(de)),mn(()=>{var s=t();if(e===document.activeElement){var a=ss??de;if(r.has(a))return}Ca(e)&&s===Na(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}const Ia=new Set;function n0(e,t,n,r,s=r){var a=n.getAttribute("type")==="checkbox",i=e;if(t!==null)for(var o of t)i=i[o]??=[];i.push(n),Ci(n,"change",()=>{var l=n.__value;a&&(l=qf(i,l,n.checked)),s(l)},()=>s(a?[]:null)),mn(()=>{var l=r();a?(l=l||[],n.checked=l.includes(n.__value)):n.checked=of(n.__value,l)}),Hr(()=>{var l=i.indexOf(n);l!==-1&&i.splice(l,1)}),Ia.has(i)||(Ia.add(i),Kt(()=>{i.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Ia.delete(i)})),Kt(()=>{})}function Hf(e,t,n=t){Ci(e,"change",r=>{var s=r?e.defaultChecked:e.checked;n(s)}),le(t)==null&&n(e.checked),mn(()=>{var r=t();e.checked=!!r})}function qf(e,t,n){for(var r=new Set,s=0;s<e.length;s+=1)e[s].checked&&r.add(e[s].__value);return n||r.delete(t),Array.from(r)}function Ca(e){var t=e.type;return t==="number"||t==="range"}function Na(e){return e===""?null:+e}function _o(e,t){return e===t||e?.[Rt]===t}function Ur(e={},t,n,r){return hf(()=>{var s,a;return mn(()=>{s=a,a=[],le(()=>{e!==n(...a)&&(t(e,...a),s&&_o(n(...s),e)&&t(null,...s))})}),()=>{Kt(()=>{a&&_o(n(...a),e)&&t(null,...a)})}}),e}function Zf(e,t,n,r,s){var a=()=>{r(n[e])};n.addEventListener(t,a),s?mn(()=>{n[e]=s()}):a(),(n===document.body||n===window||n===document)&&Hr(()=>{n.removeEventListener(t,a)})}function vt(e=!1){const t=pe,n=t.l.u;if(!n)return;let r=()=>rt(t.s);if(e){let s=0,a={};const i=Fr(()=>{let o=!1;const l=t.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&s++,s});r=()=>v(i)}n.b.length&&ff(()=>{yo(t,r),Ga(n.b)}),sr(()=>{const s=le(()=>n.m.map(Sd));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&sr(()=>{yo(t,r),Ga(n.a)})}function yo(e,t){if(e.l.s)for(const n of e.l.s)v(n);t()}function Uu(e,t,n){if(e==null)return t(void 0),$e;const r=le(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const qn=[];function En(e,t){return{subscribe:Xf(e,t).subscribe}}function Xf(e,t=$e){let n=null;const r=new Set;function s(o){if(Wl(e,o)&&(e=o,n)){const l=!qn.length;for(const u of r)u[1](),qn.push(u,e);if(l){for(let u=0;u<qn.length;u+=2)qn[u][0](qn[u+1]);qn.length=0}}}function a(o){s(o(e))}function i(o,l=$e){const u=[o,l];return r.add(u),r.size===1&&(n=t(s,a)||$e),o(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:i}}function Kf(e){let t;return Uu(e,n=>t=n)(),t}let es=!1,Xa=Symbol();function Ar(e,t,n){const r=n[t]??={store:null,source:Yt(void 0),unsubscribe:$e};if(r.store!==e&&!(Xa in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=$e;else{var s=!0;r.unsubscribe=Uu(e,a=>{s?r.source.v=a:x(r.source,a)}),s=!1}return e&&Xa in n?Kf(e):v(r.source)}function zu(){const e={};function t(){Hr(()=>{for(var n in e)e[n].unsubscribe();Gl(e,Xa,{enumerable:!1,value:!0})})}return[e,t]}function Jf(e){var t=es;try{return es=!1,[e(),es]}finally{es=t}}const Yf={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Sr(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];Sr(s)&&(s=s());const a=un(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Sr(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=un(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===Rt||t===Zl)return!1;for(let n of e.props)if(Sr(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(Sr(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function Wf(...e){return new Proxy({props:e},Yf)}function je(e,t,n,r){var s=!fr||(n&zd)!==0,a=(n&Bd)!==0,i=(n&Gd)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?le(r):r),o),c;if(a){var d=Rt in e||Zl in e;c=un(e,t)?.set??(d&&t in e?b=>e[t]=b:void 0)}var h,f=!1;a?[h,f]=Jf(()=>e[t]):h=e[t],h===void 0&&r!==void 0&&(h=u(),c&&(s&&Rd(),c(h)));var p;if(s?p=()=>{var b=e[t];return b===void 0?u():(l=!0,b)}:p=()=>{var b=e[t];return b!==void 0&&(o=void 0),b===void 0?o:b},s&&(n&jd)===0)return p;if(c){var m=e.$$legacy;return(function(b,k){return arguments.length>0?((!s||!k||m||f)&&c(k?p():b),b):p()})}var g=!1,S=((n&Ud)!==0?Fr:ea)(()=>(g=!1,p()));a&&v(S);var E=ue;return(function(b,k){if(arguments.length>0){const N=k?v(S):s&&a?Me(b):b;return x(S,N),g=!0,o!==void 0&&(o=N),b}return Gn&&g||(E.f&Ht)!==0?S.v:v(S)})}function ju(e){pe===null&&Ai(),fr&&pe.l!==null?Qf(pe).m.push(e):sr(()=>{const t=le(e);if(typeof t=="function")return t})}function r0(e){pe===null&&Ai(),ju(()=>()=>le(e))}function Qf(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const ev="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(ev);const tv=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),er=()=>crypto.randomUUID(),Bu=e=>{try{return JSON.parse(e)}catch{return null}},bo=(e,t)=>{const{label:n}=t,r=e.trim();if(!r)return{};let s;try{s=JSON.parse(r)}catch{throw new Error(`${n} must be valid JSON.`)}if(s===null||Array.isArray(s)||typeof s!="object")throw new Error(`${n} must be a JSON object.`);return s},Xn=-1,wo=200;function nv(e){return e?e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`:"Unknown size"}function rv(e){return e?e.startsWith("image/")?"image":e==="application/pdf"?"pdf":e.includes("spreadsheet")||e.includes("excel")?"spreadsheet":e.includes("presentation")||e.includes("powerpoint")?"presentation":"file":"file"}function sv(e){if(!e)return"file";const t=e.split("/");return t[1]??t[0]??"file"}var av=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),iv=Object.prototype.hasOwnProperty;function Ka(e,t){return iv.call(e,t)}function Ja(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var s in e)Ka(e,s)&&r.push(s);return r}function ut(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function Ya(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function kn(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Gu(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Wa(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Wa(e[t]))return!0}else if(typeof e=="object"){for(var r=Ja(e),s=r.length,a=0;a<s;a++)if(Wa(e[r[a]]))return!0}}return!1}function So(e,t){var n=[e];for(var r in t){var s=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof s<"u"&&n.push(r+": "+s)}return n.join(`
`)}var Fu=(function(e){av(t,e);function t(n,r,s,a,i){var o=this.constructor,l=e.call(this,So(n,{name:r,index:s,operation:a,tree:i}))||this;return l.name=r,l.index=s,l.operation=a,l.tree=i,Object.setPrototypeOf(l,o.prototype),l.message=So(n,{name:r,index:s,operation:a,tree:i}),l}return t})(Error),Ce=Fu,ov=ut,Yn={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=Os(n,this.path);r&&(r=ut(r));var s=Cn(n,{op:"remove",path:this.from}).removed;return Cn(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=Os(n,this.from);return Cn(n,{op:"add",path:this.path,value:ut(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:zr(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},lv={add:function(e,t,n){return Ya(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Yn.move,copy:Yn.copy,test:Yn.test,_get:Yn._get};function Os(e,t){if(t=="")return e;var n={op:"_get",path:t};return Cn(e,n),n.value}function Cn(e,t,n,r,s,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):Ms(t,0)),t.path===""){var i={newDocument:e};if(t.op==="add")return i.newDocument=t.value,i;if(t.op==="replace")return i.newDocument=t.value,i.removed=e,i;if(t.op==="move"||t.op==="copy")return i.newDocument=Os(e,t.from),t.op==="move"&&(i.removed=e),i;if(t.op==="test"){if(i.test=zr(e,t.value),i.test===!1)throw new Ce("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i.newDocument=e,i}else{if(t.op==="remove")return i.removed=e,i.newDocument=null,i;if(t.op==="_get")return t.value=e,i;if(n)throw new Ce("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return i}}else{r||(e=ut(e));var o=t.path||"",l=o.split("/"),u=e,c=1,d=l.length,h=void 0,f=void 0,p=void 0;for(typeof n=="function"?p=n:p=Ms;;){if(f=l[c],f&&f.indexOf("~")!=-1&&(f=Gu(f)),s&&(f=="__proto__"||f=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[f]===void 0?h=l.slice(0,c).join("/"):c==d-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(u)){if(f==="-")f=u.length;else{if(n&&!Ya(f))throw new Ce("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);Ya(f)&&(f=~~f)}if(c>=d){if(n&&t.op==="add"&&f>u.length)throw new Ce("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var i=lv[t.op].call(t,u,f,e);if(i.test===!1)throw new Ce("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}}else if(c>=d){var i=Yn[t.op].call(t,u,f,e);if(i.test===!1)throw new Ce("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}if(u=u[f],n&&c<d&&(!u||typeof u!="object"))throw new Ce("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function or(e,t,n,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),n&&!Array.isArray(t))throw new Ce("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=ut(e));for(var a=new Array(t.length),i=0,o=t.length;i<o;i++)a[i]=Cn(e,t[i],n,!0,s,i),e=a[i].newDocument;return a.newDocument=e,a}function uv(e,t,n){var r=Cn(e,t);if(r.test===!1)throw new Ce("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function Ms(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Ce("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Yn[e.op]){if(typeof e.path!="string")throw new Ce("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Ce('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Ce("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Ce("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Wa(e.value))throw new Ce("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var s=e.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new Ce("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Ce("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var i={op:"_get",path:e.from,value:void 0},o=Vu([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Ce("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Ce("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Vu(e,t,n){try{if(!Array.isArray(e))throw new Ce("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)or(ut(t),ut(e),n||!0);else{n=n||Ms;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(s){if(s instanceof Ce)return s;throw s}}function zr(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),s,a,i;if(n&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!zr(e[s],t[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(a=o.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!t.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!zr(e[i],t[i]))return!1;return!0}return e!==e&&t!==t}const cv=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Ce,_areEquals:zr,applyOperation:Cn,applyPatch:or,applyReducer:uv,deepClone:ov,getValueByPointer:Os,validate:Vu,validator:Ms},Symbol.toStringTag,{value:"Module"}));var Mi=new WeakMap,dv=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),fv=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function vv(e){return Mi.get(e)}function hv(e,t){return e.observers.get(t)}function pv(e,t){e.observers.delete(t.callback)}function gv(e,t){t.unobserve()}function mv(e,t){var n=[],r,s=vv(e);if(!s)s=new dv(e),Mi.set(e,s);else{var a=hv(s,t);r=a&&a.observer}if(r)return r;if(r={},s.value=ut(e),t){r.callback=t,r.next=null;var i=function(){Qa(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){Qa(r),clearTimeout(r.next),pv(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},s.observers.set(t,new fv(t,r)),r}function Qa(e,t){t===void 0&&(t=!1);var n=Mi.get(e.object);Pi(n.value,e.object,e.patches,"",t),e.patches.length&&or(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function Pi(e,t,n,r,s){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=Ja(t),i=Ja(e),o=!1,l=i.length-1;l>=0;l--){var u=i[l],c=e[u];if(Ka(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var d=t[u];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?Pi(c,d,n,r+"/"+kn(u),s):c!==d&&(s&&n.push({op:"test",path:r+"/"+kn(u),value:ut(c)}),n.push({op:"replace",path:r+"/"+kn(u),value:ut(d)}))}else Array.isArray(e)===Array.isArray(t)?(s&&n.push({op:"test",path:r+"/"+kn(u),value:ut(c)}),n.push({op:"remove",path:r+"/"+kn(u)}),o=!0):(s&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!Ka(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+kn(u),value:ut(t[u])})}}}function _v(e,t,n){n===void 0&&(n=!1);var r=[];return Pi(e,t,r,"",n),r}const yv=Object.freeze(Object.defineProperty({__proto__:null,compare:_v,generate:Qa,observe:mv,unobserve:gv},Symbol.toStringTag,{value:"Module"}));Object.assign({},cv,yv,{JsonPatchError:Fu,deepClone:ut,escapePathComponent:kn,unescapePathComponent:Gu});function Li(e){return{ok:!0,data:e}}function Ps(e){return{ok:!1,error:e}}function bv(e,t="Unknown error"){return e instanceof Error?e:typeof e=="string"&&e.trim()?new Error(e):new Error(t)}const Hu=Symbol("chat-store");function wv(){let e=G(Me([])),t=G("");return{get messages(){return v(e)},get input(){return v(t)},set input(n){x(t,n,!0)},get isEmpty(){return v(e).length===0},addUserMessage(n){const r={id:er(),role:"user",text:n,ts:Date.now()};return v(e).push(r),r},addAgentMessage(){const n={id:er(),role:"agent",text:"",observations:"",showObservations:!1,isStreaming:!0,isThinking:!1,answerStreamDone:!1,revisionStreamActive:!1,answerActionSeq:Xn,ts:Date.now()};return v(e).push(n),n},findMessage(n){return v(e).find(r=>r.id===n)},updateMessage(n,r){const s=v(e).find(a=>a.id===n);s&&Object.assign(s,r)},clearInput(){x(t,"")},clear(){x(e,[],!0),x(t,"")}}}function Sv(e=wv()){return ft(Hu,e),e}function qu(){return Tt(Hu)}const Zu=Symbol("session-store");function Ev(){let e=G(Me(er())),t=G(null),n=G(!1);return{get sessionId(){return v(e)},set sessionId(r){x(e,r,!0)},get activeTraceId(){return v(t)},set activeTraceId(r){x(t,r,!0)},get isSending(){return v(n)},set isSending(r){x(n,r,!0)},reset(){x(e,er(),!0),x(t,null),x(n,!1)},newSession(){x(e,er(),!0),x(t,null)}}}function kv(e=Ev()){return ft(Zu,e),e}function Zr(){return Tt(Zu)}const Xu=Symbol("artifacts-store");function xv(){let e=G(Me(new Map));return{get artifacts(){return v(e)},get list(){return Array.from(v(e).values())},get count(){return v(e).size},has(t){return v(e).has(t)},get(t){return v(e).get(t)},addArtifact(t){const n={id:t.artifact_id,mime_type:t.mime_type,size_bytes:t.size_bytes,filename:t.filename,sha256:null,source:t.source},r=new Map(v(e));r.set(t.artifact_id,n),x(e,r,!0)},remove(t){if(!v(e).has(t))return!1;const n=new Map(v(e));return n.delete(t),x(e,n,!0),!0},clear(){x(e,new Map,!0)}}}function Tv(e=xv()){return ft(Xu,e),e}function Av(){return Tt(Xu)}const Ku=Symbol("agent-store"),Eo={name:"loading_agent",description:"",template:"",version:"",flags:[],tools:0,flows:0};function Iv(){let e=G(Me({...Eo})),t=G(Me([])),n=G(Me([])),r=G(Me([]));return{get meta(){return v(e)},get plannerConfig(){return v(t)},get services(){return v(n)},get catalog(){return v(r)},setFromResponse(s){const a=s.agent??{};x(e,{name:a.name??"agent",description:a.description??"",template:a.template??"",version:a.version??"",flags:a.flags??[],tools:(s.tools??[]).length,flows:(s.flows??[]).length},!0),x(t,s.planner&&Object.keys(s.planner).length?Object.entries(s.planner).map(([i,o])=>({label:i,value:o})):[],!0),x(n,s.services?.map(i=>({name:i.name,status:i.enabled?"enabled":"disabled",url:i.url??null}))??[],!0),x(r,s.tools?.map(i=>({name:i.name,desc:i.description,tags:i.tags??[]}))??[],!0)},reset(){x(e,{...Eo},!0),x(t,[],!0),x(n,[],!0),x(r,[],!0)}}}function Cv(e=Iv()){return ft(Ku,e),e}function hr(){return Tt(Ku)}const Ju=Symbol("events-store"),Nv=new Set(["thinking","revision","tool_call_start","tool_call_args","tool_call_end","tool_call_result","llm_stream_chunk"]),Rv=new Set(["step","step_start","step_complete"]);function Ov(){let e=G(Me([])),t=G(Me(new Set)),n=G(!1),r=G(Me(new Map));function s(){const a=[],i=new Set;for(const o of v(e)){const l=o.event?.toLowerCase()??"";if(!Nv.has(l)){if(Rv.has(l)||l==="event"){(l==="step_complete"||o.latency_ms)&&a.push({id:o.id,type:"step",name:o.node??"step",description:o.thought?ts(o.thought,100):void 0,duration_ms:o.latency_ms,ts:o.ts??Date.now()});continue}if(l==="artifact_stored"||l==="artifact_chunk"){a.push({id:o.id,type:"artifact",name:o.artifact_id??"artifact",description:o.mime_type??void 0,ts:o.ts??Date.now()});continue}a.push({id:o.id,type:"other",name:l,description:o.thought?ts(o.thought,80):void 0,ts:o.ts??Date.now()})}}for(const[o,l]of v(r))l.endTs&&!i.has(o)&&(a.push({id:`tc_${o}`,type:"tool_call",name:l.name,args:l.args?ts(l.args,100):void 0,result:l.result?ts(l.result,100):void 0,duration_ms:l.endTs-l.startTs,ts:l.startTs}),i.add(o));return a.sort((o,l)=>l.ts-o.ts),a}return{get events(){return v(e)},get displayEvents(){return s()},get filter(){return v(t)},get paused(){return v(n)},set paused(a){x(n,a,!0)},get isEmpty(){return v(e).length===0},setFilter(a){a?x(t,new Set([a]),!0):x(t,new Set,!0)},addEvent(a,i){const o=a.tool_call_id,l=i.toLowerCase();if(o){if(l==="tool_call_start")v(r).set(o,{id:o,name:a.tool_call_name??"tool",args:"",result:"",startTs:Date.now()});else if(l==="tool_call_args"){const d=v(r).get(o);d&&(d.args+=a.delta??"")}else if(l==="tool_call_result"){const d=v(r).get(o);d&&(d.result=a.content??"")}else if(l==="tool_call_end"){const d=v(r).get(o);d&&(d.endTs=Date.now())}}const u=`${a.event??""}|${a.node??""}|${a.ts??""}`;if(!v(e).some(d=>`${d.event??""}|${d.node??""}|${d.ts??""}`===u)){const d={id:er(),event:i,...a};v(e).unshift(d),v(e).length>wo&&(v(e).length=wo)}},shouldProcess(a){return v(n)?!1:v(t).size===0?!0:v(t).has(a)},clear(){x(e,[],!0),x(r,new Map,!0)}}}function ts(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}function Mv(e=Ov()){return ft(Ju,e),e}function Di(){return Tt(Ju)}const Yu=Symbol("trajectory-store");function Pv(){let e=G(Me([])),t=G(Me({})),n=G(null),r=G(null),s=G(null),a=G(null),i=G(null);return{get steps(){return v(e)},get artifactStreams(){return v(t)},get query(){return v(n)},get llmContext(){return v(r)},get toolContext(){return v(s)},get traceId(){return v(a)},get sessionId(){return v(i)},get isEmpty(){return v(e).length===0},get hasArtifacts(){return Object.keys(v(t)).length>0},get hasContext(){return v(a)!=null||v(r)!=null||v(s)!=null},get conversationMemory(){return v(r)?.conversation_memory??null},get hasMemory(){return v(r)?.conversation_memory!=null},setFromPayload(o){const l=o?.steps??[];x(e,l.map((u,c)=>{const d=u.action??{};return{id:`step-${c}`,name:d.next_node??d.plan?.[0]?.node??"step",thought:d.thought,args:d.args,result:u.observation,latencyMs:u.latency_ms??void 0,reflectionScore:u.metadata?.reflection?.score??void 0,status:u.error?"error":"ok"}}),!0),x(n,o?.query??null,!0),x(r,o?.llm_context??null,!0),x(s,o?.tool_context??null,!0),x(a,o?.trace_id??null,!0),x(i,o?.session_id??null,!0)},addArtifactChunk(o,l){const u=v(t)[o]??[];v(t)[o]=[...u,l]},clearArtifacts(){x(t,{},!0)},clear(){x(e,[],!0),x(t,{},!0),x(n,null),x(r,null),x(s,null),x(a,null),x(i,null)}}}function Lv(e=Pv()){return ft(Yu,e),e}function na(){return Tt(Yu)}const Wu=Symbol("spec-store");function Dv(){let e=G(""),t=G("pending"),n=G(Me([]));return{get content(){return v(e)},set content(r){x(e,r,!0)},get status(){return v(t)},set status(r){x(t,r,!0)},get errors(){return v(n)},get isValid(){return v(t)==="valid"},get hasErrors(){return v(n).length>0},setFromSpecData(r){x(e,r.content,!0),x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`err-${a}`,message:s.message,line:s.line})),!0)},setValidationResult(r){x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`val-err-${a}`,message:s.message,line:s.line})),!0)},setGenerationErrors(r){x(t,"error"),x(n,r.map((s,a)=>({id:`gen-err-${a}`,message:s.message,line:s.line})),!0)},markValid(){x(t,"valid"),x(n,[],!0)},reset(){x(e,""),x(t,"pending"),x(n,[],!0)}}}function $v(e=Dv()){return ft(Wu,e),e}function Uv(){return Tt(Wu)}const Qu=Symbol("setup-store");function zv(){let e=G("playground-tenant"),t=G("playground-user"),n=G("{}"),r=G("{}"),s=G(null),a=G(!1);return{get tenantId(){return v(e)},set tenantId(i){x(e,i,!0)},get userId(){return v(t)},set userId(i){x(t,i,!0)},get toolContextRaw(){return v(n)},set toolContextRaw(i){x(n,i,!0)},get llmContextRaw(){return v(r)},set llmContextRaw(i){x(r,i,!0)},get error(){return v(s)},set error(i){x(s,i,!0)},get useAgui(){return v(a)},set useAgui(i){x(a,i,!0)},parseContexts(){try{const i=bo(v(n),{label:"Tool context"}),o={tenant_id:v(e),user_id:v(t),...i},l=bo(v(r),{label:"LLM context"});return x(s,null),{toolContext:o,llmContext:l}}catch(i){return x(s,i instanceof Error?i.message:"Invalid setup configuration.",!0),null}},clearError(){x(s,null)},reset(){x(e,"playground-tenant"),x(t,"playground-user"),x(n,"{}"),x(r,"{}"),x(s,null),x(a,!1)}}}function jv(e=zv()){return ft(Qu,e),e}function Bv(){return Tt(Qu)}const ec=Symbol("interactions-store");function Gv(){let e=G(Me([])),t=G(null),n=G(null);function r(o,{message_id:l}={}){if(o.artifact_type!=="ui_component"||!o.chunk||typeof o.chunk!="object")return;const u=o.chunk,c=typeof u.component=="string"?u.component:void 0,d=u.props||{};if(!c)return;const h={id:(typeof u.id=="string"?u.id:void 0)||`ui_${Date.now()}`,component:c,props:d,title:typeof u.title=="string"?u.title:void 0,message_id:l??(typeof o.meta?.message_id=="string"?o.meta.message_id:void 0),seq:o.seq??0,ts:o.ts??Date.now(),meta:o.meta??{}};x(e,[...v(e),h],!0),x(n,h,!0)}function s(o){x(t,o,!0)}function a(o){v(t)&&x(t,{...v(t),...o},!0)}function i(){x(t,null)}return{get artifacts(){return v(e)},get pendingInteraction(){return v(t)},get lastArtifact(){return v(n)},addArtifactChunk:r,setPendingInteraction:s,updatePendingInteraction:a,clearPendingInteraction:i,clear(){x(e,[],!0),x(t,null),x(n,null)}}}function Fv(e=Gv()){return ft(ec,e),e}function $i(){return Tt(ec)}const tc=Symbol("component-registry-store");function Vv(){let e=G(null),t=G(null);return{get registry(){return v(e)},get error(){return v(t)},get enabled(){return v(e)?.enabled??!1},get components(){return v(e)?.components??{}},get version(){return v(e)?.version??""},get allowlist(){return v(e)?.allowlist??[]},setFromPayload(n){x(e,n,!0),x(t,null)},setError(n){x(t,n,!0)},getComponent(n){return v(e)?.components?.[n]},reset(){x(e,null),x(t,null)}}}function Hv(e=Vv()){return ft(tc,e),e}function Ui(){return Tt(tc)}const qv=Symbol("layout-store");function Zv(){let e=G(!1),t=G(!1);return{get isMobile(){return v(e)},set isMobile(n){x(e,n,!0)},get sidebarOpen(){return v(t)},set sidebarOpen(n){x(t,n,!0)},setMobile(n){x(e,n,!0),n||x(t,!1)},toggleSidebar(){x(t,!v(t))},reset(){x(e,!1),x(t,!1)}}}function Xv(e=Zv()){return ft(qv,e),e}const Kv=Symbol("notifications-store");function Jv(){let e=G(Me([]));return{get items(){return v(e)},add(t,n="info"){const r={id:`note_${Date.now()}_${Math.random().toString(16).slice(2)}`,message:t,level:n,ts:Date.now()};return x(e,[r,...v(e)],!0),r},remove(t){x(e,v(e).filter(n=>n.id!==t),!0)},clear(){x(e,[],!0)}}}function Yv(e=Jv()){return ft(Kv,e),e}function Wv(){return{chatStore:Sv(),sessionStore:kv(),artifactsStore:Tv(),agentStore:Cv(),eventsStore:Mv(),trajectoryStore:Lv(),specStore:$v(),setupStore:jv(),interactionsStore:Fv(),componentRegistryStore:Hv(),layoutStore:Xv(),notificationsStore:Yv()}}const Xr="";class ko extends Error{constructor(t,n,r){super(t),this.statusCode=n,this.details=r,this.name="ApiError"}}async function ra(e,t){try{const n=t?await fetch(e,t):await fetch(e);return n.ok?{ok:!0,data:await n.json()}:{ok:!1,error:new ko(n.statusText||"Request failed",n.status)}}catch(n){return{ok:!1,error:new ko("Network error",0,n)}}}function Qv(e){if(!e)return null;const n=e.match(/filename="(.+?)"/)?.[1];if(n)return n;const s=e.match(/filename=([^;\s]+)/)?.[1];return s||null}async function eh(){const e=await ra(`${Xr}/ui/meta`);return e.ok?e.data:(console.error("meta load failed",e.error),null)}async function th(){const e=await ra(`${Xr}/ui/components`);return e.ok?e.data:(console.error("component registry load failed",e.error),null)}async function nh(){const e=await ra(`${Xr}/ui/spec`);return e.ok?e.data:(console.error("spec load failed",e.error),null)}async function xo(e,t){const n=await ra(`${Xr}/trajectory/${e}?session_id=${encodeURIComponent(t)}`);return n.ok?n.data:(console.error("trajectory fetch failed",n.error),null)}async function nc(e,t,n){const r=await fetch(`${Xr}/artifacts/${e}`,{headers:{"X-Session-ID":t}});if(!r.ok)throw new Error(`Download failed: ${r.status} ${r.statusText}`);const s=await r.blob(),a=r.headers.get("Content-Disposition"),i=n||Qv(a)||`artifact-${e}`,o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}var se;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},e.getValidEnumValues=s=>{const a=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return e.objectValues(i)},e.objectValues=s=>e.objectKeys(s).map(function(a){return s[a]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},e.find=(s,a)=>{for(const i of s)if(a(i))return i},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(se||(se={}));var To;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(To||(To={}));const j=se.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),an=e=>{switch(typeof e){case"undefined":return j.undefined;case"string":return j.string;case"number":return Number.isNaN(e)?j.nan:j.number;case"boolean":return j.boolean;case"function":return j.function;case"bigint":return j.bigint;case"symbol":return j.symbol;case"object":return Array.isArray(e)?j.array:e===null?j.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?j.promise:typeof Map<"u"&&e instanceof Map?j.map:typeof Set<"u"&&e instanceof Set?j.set:typeof Date<"u"&&e instanceof Date?j.date:j.object;default:return j.unknown}},P=se.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Qt extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(t){if(!(t instanceof Qt))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,se.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Qt.create=e=>new Qt(e);const ei=(e,t)=>{let n;switch(e.code){case P.invalid_type:e.received===j.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case P.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,se.jsonStringifyReplacer)}`;break;case P.unrecognized_keys:n=`Unrecognized key(s) in object: ${se.joinValues(e.keys,", ")}`;break;case P.invalid_union:n="Invalid input";break;case P.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${se.joinValues(e.options)}`;break;case P.invalid_enum_value:n=`Invalid enum value. Expected ${se.joinValues(e.options)}, received '${e.received}'`;break;case P.invalid_arguments:n="Invalid function arguments";break;case P.invalid_return_type:n="Invalid function return type";break;case P.invalid_date:n="Invalid date";break;case P.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:se.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case P.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case P.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case P.custom:n="Invalid input";break;case P.invalid_intersection_types:n="Intersection results could not be merged";break;case P.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case P.not_finite:n="Number must be finite";break;default:n=t.defaultError,se.assertNever(e)}return{message:n}};let rh=ei;function sh(){return rh}const ah=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:t,defaultError:o}).message;return{...s,path:a,message:o}};function z(e,t){const n=sh(),r=ah({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===ei?void 0:ei].filter(s=>!!s)});e.common.issues.push(r)}class Qe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return K;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return Qe.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return K;a.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:t.value,value:r}}}const K=Object.freeze({status:"aborted"}),Ir=e=>({status:"dirty",value:e}),bt=e=>({status:"valid",value:e}),Ao=e=>e.status==="aborted",Io=e=>e.status==="dirty",lr=e=>e.status==="valid",Ls=e=>typeof Promise<"u"&&e instanceof Promise;var V;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(V||(V={}));class Pt{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Co=(e,t)=>{if(lr(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Qt(e.common.issues);return this._error=n,this._error}}};function Y(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(i,o)=>{const{message:l}=e;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Q{get description(){return this._def.description}_getType(t){return an(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:an(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Qe,ctx:{common:t.parent.common,data:t.data,parsedType:an(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Ls(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:an(t)},s=this._parseSync({data:t,path:r.path,parent:r});return Co(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:an(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return lr(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>lr(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:an(t)},s=this._parse({data:t,path:r.path,parent:r}),a=await(Ls(s)?s:Promise.resolve(s));return Co(r,a)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=t(s),o=()=>a.addIssue({code:P.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Ln({schema:this,typeName:J.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Xt.create(this,this._def)}nullable(){return Dn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ot.create(this)}promise(){return Gs.create(this,this._def)}or(t){return $s.create([this,t],this._def)}and(t){return Us.create(this,t,this._def)}transform(t){return new Ln({...Y(this._def),schema:this,typeName:J.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Fs({...Y(this._def),innerType:this,defaultValue:n,typeName:J.ZodDefault})}brand(){return new ic({typeName:J.ZodBranded,type:this,...Y(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Vs({...Y(this._def),innerType:this,catchValue:n,typeName:J.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return ji.create(this,t)}readonly(){return Hs.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ih=/^c[^\s-]{8,}$/i,oh=/^[0-9a-z]+$/,lh=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uh=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ch=/^[a-z0-9_-]{21}$/i,dh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,fh=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,hh="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ra;const ph=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,gh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,mh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,_h=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,yh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,rc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",wh=new RegExp(`^${rc}$`);function sc(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Sh(e){return new RegExp(`^${sc(e)}$`)}function Eh(e){let t=`${rc}T${sc(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function kh(e,t){return!!((t==="v4"||!t)&&ph.test(e)||(t==="v6"||!t)&&mh.test(e))}function xh(e,t){if(!dh.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Th(e,t){return!!((t==="v4"||!t)&&gh.test(e)||(t==="v6"||!t)&&_h.test(e))}class Vt extends Q{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==j.string){const a=this._getOrReturnCtx(t);return z(a,{code:P.invalid_type,expected:j.string,received:a.parsedType}),K}const r=new Qe;let s;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:P.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:P.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=t.data.length>a.value,o=t.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(t,s),i?z(s,{code:P.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&z(s,{code:P.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")vh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"email",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Ra||(Ra=new RegExp(hh,"u")),Ra.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"emoji",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")uh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"uuid",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")ch.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"nanoid",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")ih.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cuid",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")oh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cuid2",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")lh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"ulid",code:P.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),z(s,{validation:"url",code:P.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"regex",code:P.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?Eh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?wh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Sh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:P.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?fh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"duration",code:P.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?kh(t.data,a.version)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"ip",code:P.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?xh(t.data,a.alg)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"jwt",code:P.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?Th(t.data,a.version)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cidr",code:P.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?yh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"base64",code:P.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?bh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"base64url",code:P.invalid_string,message:a.message}),r.dirty()):se.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:P.invalid_string,...V.errToObj(r)})}_addCheck(t){return new Vt({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...V.errToObj(t)})}url(t){return this._addCheck({kind:"url",...V.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...V.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...V.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...V.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...V.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...V.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...V.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...V.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...V.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...V.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...V.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...V.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...V.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...V.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...V.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...V.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...V.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...V.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...V.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...V.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...V.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...V.errToObj(n)})}nonempty(t){return this.min(1,V.errToObj(t))}trim(){return new Vt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Vt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Vt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Vt.create=e=>new Vt({checks:[],typeName:J.ZodString,coerce:e?.coerce??!1,...Y(e)});function Ah(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(e.toFixed(s).replace(".","")),i=Number.parseInt(t.toFixed(s).replace(".",""));return a%i/10**s}class ur extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==j.number){const a=this._getOrReturnCtx(t);return z(a,{code:P.invalid_type,expected:j.number,received:a.parsedType}),K}let r;const s=new Qe;for(const a of this._def.checks)a.kind==="int"?se.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),z(r,{code:P.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?Ah(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),z(r,{code:P.not_finite,message:a.message}),s.dirty()):se.assertNever(a);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,V.toString(n))}gt(t,n){return this.setLimit("min",t,!1,V.toString(n))}lte(t,n){return this.setLimit("max",t,!0,V.toString(n))}lt(t,n){return this.setLimit("max",t,!1,V.toString(n))}setLimit(t,n,r,s){return new ur({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:V.toString(s)}]})}_addCheck(t){return new ur({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:V.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:V.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:V.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:V.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:V.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:V.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:V.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:V.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:V.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&se.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}ur.create=e=>new ur({checks:[],typeName:J.ZodNumber,coerce:e?.coerce||!1,...Y(e)});class jr extends Q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==j.bigint)return this._getInvalidInput(t);let r;const s=new Qe;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),z(r,{code:P.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):se.assertNever(a);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return z(n,{code:P.invalid_type,expected:j.bigint,received:n.parsedType}),K}gte(t,n){return this.setLimit("min",t,!0,V.toString(n))}gt(t,n){return this.setLimit("min",t,!1,V.toString(n))}lte(t,n){return this.setLimit("max",t,!0,V.toString(n))}lt(t,n){return this.setLimit("max",t,!1,V.toString(n))}setLimit(t,n,r,s){return new jr({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:V.toString(s)}]})}_addCheck(t){return new jr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:V.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:V.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:V.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:V.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:V.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}jr.create=e=>new jr({checks:[],typeName:J.ZodBigInt,coerce:e?.coerce??!1,...Y(e)});class ti extends Q{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==j.boolean){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.boolean,received:r.parsedType}),K}return bt(t.data)}}ti.create=e=>new ti({typeName:J.ZodBoolean,coerce:e?.coerce||!1,...Y(e)});class Ds extends Q{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==j.date){const a=this._getOrReturnCtx(t);return z(a,{code:P.invalid_type,expected:j.date,received:a.parsedType}),K}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return z(a,{code:P.invalid_date}),K}const r=new Qe;let s;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:P.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:P.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):se.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ds({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:V.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:V.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Ds.create=e=>new Ds({checks:[],coerce:e?.coerce||!1,typeName:J.ZodDate,...Y(e)});class No extends Q{_parse(t){if(this._getType(t)!==j.symbol){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.symbol,received:r.parsedType}),K}return bt(t.data)}}No.create=e=>new No({typeName:J.ZodSymbol,...Y(e)});class ni extends Q{_parse(t){if(this._getType(t)!==j.undefined){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.undefined,received:r.parsedType}),K}return bt(t.data)}}ni.create=e=>new ni({typeName:J.ZodUndefined,...Y(e)});class ri extends Q{_parse(t){if(this._getType(t)!==j.null){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.null,received:r.parsedType}),K}return bt(t.data)}}ri.create=e=>new ri({typeName:J.ZodNull,...Y(e)});class si extends Q{constructor(){super(...arguments),this._any=!0}_parse(t){return bt(t.data)}}si.create=e=>new si({typeName:J.ZodAny,...Y(e)});class Ro extends Q{constructor(){super(...arguments),this._unknown=!0}_parse(t){return bt(t.data)}}Ro.create=e=>new Ro({typeName:J.ZodUnknown,...Y(e)});class hn extends Q{_parse(t){const n=this._getOrReturnCtx(t);return z(n,{code:P.invalid_type,expected:j.never,received:n.parsedType}),K}}hn.create=e=>new hn({typeName:J.ZodNever,...Y(e)});class Oo extends Q{_parse(t){if(this._getType(t)!==j.undefined){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.void,received:r.parsedType}),K}return bt(t.data)}}Oo.create=e=>new Oo({typeName:J.ZodVoid,...Y(e)});class Ot extends Q{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==j.array)return z(n,{code:P.invalid_type,expected:j.array,received:n.parsedType}),K;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&(z(n,{code:i?P.too_big:P.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(z(n,{code:P.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(z(n,{code:P.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new Pt(n,i,n.path,o)))).then(i=>Qe.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new Pt(n,i,n.path,o)));return Qe.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new Ot({...this._def,minLength:{value:t,message:V.toString(n)}})}max(t,n){return new Ot({...this._def,maxLength:{value:t,message:V.toString(n)}})}length(t,n){return new Ot({...this._def,exactLength:{value:t,message:V.toString(n)}})}nonempty(t){return this.min(1,t)}}Ot.create=(e,t)=>new Ot({type:e,minLength:null,maxLength:null,exactLength:null,typeName:J.ZodArray,...Y(t)});function Kn(e){if(e instanceof De){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Xt.create(Kn(r))}return new De({...e._def,shape:()=>t})}else return e instanceof Ot?new Ot({...e._def,type:Kn(e.element)}):e instanceof Xt?Xt.create(Kn(e.unwrap())):e instanceof Dn?Dn.create(Kn(e.unwrap())):e instanceof Mn?Mn.create(e.items.map(t=>Kn(t))):e}class De extends Q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=se.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==j.object){const u=this._getOrReturnCtx(t);return z(u,{code:P.invalid_type,expected:j.object,received:u.parsedType}),K}const{status:r,ctx:s}=this._processInputParams(t),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof hn&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const c=a[u],d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Pt(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof hn){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(z(s,{code:P.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Pt(s,d,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,h=await c.value;u.push({key:d,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>Qe.mergeObjectSync(r,u)):Qe.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return V.errToObj,new De({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:V.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new De({...this._def,unknownKeys:"strip"})}passthrough(){return new De({...this._def,unknownKeys:"passthrough"})}extend(t){return new De({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new De({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:J.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new De({...this._def,catchall:t})}pick(t){const n={};for(const r of se.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new De({...this._def,shape:()=>n})}omit(t){const n={};for(const r of se.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new De({...this._def,shape:()=>n})}deepPartial(){return Kn(this)}partial(t){const n={};for(const r of se.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new De({...this._def,shape:()=>n})}required(t){const n={};for(const r of se.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Xt;)a=a._def.innerType;n[r]=a}return new De({...this._def,shape:()=>n})}keyof(){return ac(se.objectKeys(this.shape))}}De.create=(e,t)=>new De({shape:()=>e,unknownKeys:"strip",catchall:hn.create(),typeName:J.ZodObject,...Y(t)});De.strictCreate=(e,t)=>new De({shape:()=>e,unknownKeys:"strict",catchall:hn.create(),typeName:J.ZodObject,...Y(t)});De.lazycreate=(e,t)=>new De({shape:e,unknownKeys:"strip",catchall:hn.create(),typeName:J.ZodObject,...Y(t)});class $s extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new Qt(o.ctx.common.issues));return z(n,{code:P.invalid_union,unionErrors:i}),K}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new Qt(l));return z(n,{code:P.invalid_union,unionErrors:o}),K}}get options(){return this._def.options}}$s.create=(e,t)=>new $s({options:e,typeName:J.ZodUnion,...Y(t)});const Bt=e=>e instanceof ii?Bt(e.schema):e instanceof Ln?Bt(e.innerType()):e instanceof js?[e.value]:e instanceof Pn?e.options:e instanceof Bs?se.objectValues(e.enum):e instanceof Fs?Bt(e._def.innerType):e instanceof ni?[void 0]:e instanceof ri?[null]:e instanceof Xt?[void 0,...Bt(e.unwrap())]:e instanceof Dn?[null,...Bt(e.unwrap())]:e instanceof ic||e instanceof Hs?Bt(e.unwrap()):e instanceof Vs?Bt(e._def.innerType):[];class zi extends Q{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==j.object)return z(n,{code:P.invalid_type,expected:j.object,received:n.parsedType}),K;const r=this.discriminator,s=n.data[r],a=this.optionsMap.get(s);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(z(n,{code:P.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),K)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const a of n){const i=Bt(a.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,a)}}return new zi({typeName:J.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Y(r)})}}function ai(e,t){const n=an(e),r=an(t);if(e===t)return{valid:!0,data:e};if(n===j.object&&r===j.object){const s=se.objectKeys(t),a=se.objectKeys(e).filter(o=>s.indexOf(o)!==-1),i={...e,...t};for(const o of a){const l=ai(e[o],t[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===j.array&&r===j.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let a=0;a<e.length;a++){const i=e[a],o=t[a],l=ai(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===j.date&&r===j.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Us extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(a,i)=>{if(Ao(a)||Ao(i))return K;const o=ai(a.value,i.value);return o.valid?((Io(a)||Io(i))&&n.dirty(),{status:n.value,value:o.data}):(z(r,{code:P.invalid_intersection_types}),K)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Us.create=(e,t,n)=>new Us({left:e,right:t,typeName:J.ZodIntersection,...Y(n)});class Mn extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==j.array)return z(r,{code:P.invalid_type,expected:j.array,received:r.parsedType}),K;if(r.data.length<this._def.items.length)return z(r,{code:P.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),K;!this._def.rest&&r.data.length>this._def.items.length&&(z(r,{code:P.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Pt(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>Qe.mergeArray(n,i)):Qe.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new Mn({...this._def,rest:t})}}Mn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Mn({items:e,typeName:J.ZodTuple,rest:null,...Y(t)})};class zs extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==j.object)return z(r,{code:P.invalid_type,expected:j.object,received:r.parsedType}),K;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in r.data)s.push({key:a._parse(new Pt(r,o,r.path,o)),value:i._parse(new Pt(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Qe.mergeObjectAsync(n,s):Qe.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Q?new zs({keyType:t,valueType:n,typeName:J.ZodRecord,...Y(r)}):new zs({keyType:Vt.create(),valueType:t,typeName:J.ZodRecord,...Y(n)})}}class Mo extends Q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==j.map)return z(r,{code:P.invalid_type,expected:j.map,received:r.parsedType}),K;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new Pt(r,o,r.path,[u,"key"])),value:a._parse(new Pt(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return K;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return K;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}Mo.create=(e,t,n)=>new Mo({valueType:t,keyType:e,typeName:J.ZodMap,...Y(n)});class Br extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==j.set)return z(r,{code:P.invalid_type,expected:j.set,received:r.parsedType}),K;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(z(r,{code:P.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(z(r,{code:P.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const c of l){if(c.status==="aborted")return K;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new Pt(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(t,n){return new Br({...this._def,minSize:{value:t,message:V.toString(n)}})}max(t,n){return new Br({...this._def,maxSize:{value:t,message:V.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Br.create=(e,t)=>new Br({valueType:e,minSize:null,maxSize:null,typeName:J.ZodSet,...Y(t)});class ii extends Q{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}ii.create=(e,t)=>new ii({getter:e,typeName:J.ZodLazy,...Y(t)});class js extends Q{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return z(n,{received:n.data,code:P.invalid_literal,expected:this._def.value}),K}return{status:"valid",value:t.data}}get value(){return this._def.value}}js.create=(e,t)=>new js({value:e,typeName:J.ZodLiteral,...Y(t)});function ac(e,t){return new Pn({values:e,typeName:J.ZodEnum,...Y(t)})}class Pn extends Q{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return z(n,{expected:se.joinValues(r),received:n.parsedType,code:P.invalid_type}),K}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return z(n,{received:n.data,code:P.invalid_enum_value,options:r}),K}return bt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Pn.create(t,{...this._def,...n})}exclude(t,n=this._def){return Pn.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Pn.create=ac;class Bs extends Q{_parse(t){const n=se.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==j.string&&r.parsedType!==j.number){const s=se.objectValues(n);return z(r,{expected:se.joinValues(s),received:r.parsedType,code:P.invalid_type}),K}if(this._cache||(this._cache=new Set(se.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=se.objectValues(n);return z(r,{received:r.data,code:P.invalid_enum_value,options:s}),K}return bt(t.data)}get enum(){return this._def.values}}Bs.create=(e,t)=>new Bs({values:e,typeName:J.ZodNativeEnum,...Y(t)});class Gs extends Q{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==j.promise&&n.common.async===!1)return z(n,{code:P.invalid_type,expected:j.promise,received:n.parsedType}),K;const r=n.parsedType===j.promise?n.data:Promise.resolve(n.data);return bt(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Gs.create=(e,t)=>new Gs({type:e,typeName:J.ZodPromise,...Y(t)});class Ln extends Q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===J.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,a={addIssue:i=>{z(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return K;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?K:l.status==="dirty"||n.value==="dirty"?Ir(l.value):l});{if(n.value==="aborted")return K;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?K:o.status==="dirty"||n.value==="dirty"?Ir(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?K:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?K:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!lr(i))return K;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>lr(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):K);se.assertNever(s)}}Ln.create=(e,t,n)=>new Ln({schema:e,typeName:J.ZodEffects,effect:t,...Y(n)});Ln.createWithPreprocess=(e,t,n)=>new Ln({schema:t,effect:{type:"preprocess",transform:e},typeName:J.ZodEffects,...Y(n)});class Xt extends Q{_parse(t){return this._getType(t)===j.undefined?bt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Xt.create=(e,t)=>new Xt({innerType:e,typeName:J.ZodOptional,...Y(t)});class Dn extends Q{_parse(t){return this._getType(t)===j.null?bt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Dn.create=(e,t)=>new Dn({innerType:e,typeName:J.ZodNullable,...Y(t)});class Fs extends Q{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===j.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Fs.create=(e,t)=>new Fs({innerType:e,typeName:J.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Y(t)});class Vs extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ls(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Qt(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Qt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Vs.create=(e,t)=>new Vs({innerType:e,typeName:J.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Y(t)});class Po extends Q{_parse(t){if(this._getType(t)!==j.nan){const r=this._getOrReturnCtx(t);return z(r,{code:P.invalid_type,expected:j.nan,received:r.parsedType}),K}return{status:"valid",value:t.data}}}Po.create=e=>new Po({typeName:J.ZodNaN,...Y(e)});class ic extends Q{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ji extends Q{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?K:a.status==="dirty"?(n.dirty(),Ir(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?K:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new ji({in:t,out:n,typeName:J.ZodPipeline})}}class Hs extends Q{_parse(t){const n=this._def.innerType._parse(t),r=s=>(lr(s)&&(s.value=Object.freeze(s.value)),s);return Ls(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Hs.create=(e,t)=>new Hs({innerType:e,typeName:J.ZodReadonly,...Y(t)});var J;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(J||(J={}));const M=Vt.create,Ih=ur.create,oi=ti.create,et=si.create;hn.create;const fn=Ot.create,Se=De.create,Bi=$s.create,sa=zi.create;Us.create;Mn.create;const oc=zs.create,q=js.create,lc=Pn.create,Ch=Bs.create;Gs.create;Xt.create;Dn.create;var Nh=Se({name:M(),arguments:M()}),Rh=Se({id:M(),type:q("function"),function:Nh}),aa=Se({id:M(),role:M(),content:M().optional(),name:M().optional()}),Oh=Se({type:q("text"),text:M()}),uc=Se({type:q("binary"),mimeType:M(),id:M().optional(),url:M().optional(),data:M().optional(),filename:M().optional()}),cc=(e,t)=>{!e.id&&!e.url&&!e.data&&t.addIssue({code:P.custom,message:"BinaryInputContent requires at least one of id, url, or data.",path:["id"]})};uc.superRefine((e,t)=>{cc(e,t)});var Mh=sa("type",[Oh,uc]),Ph=Mh.superRefine((e,t)=>{e.type==="binary"&&cc(e,t)}),Lh=aa.extend({role:q("developer"),content:M()}),Dh=aa.extend({role:q("system"),content:M()}),$h=aa.extend({role:q("assistant"),content:M().optional(),toolCalls:fn(Rh).optional()}),Uh=aa.extend({role:q("user"),content:Bi([M(),fn(Ph)])}),zh=Se({id:M(),content:M(),role:q("tool"),toolCallId:M(),error:M().optional()}),jh=Se({id:M(),role:q("activity"),activityType:M(),content:oc(et())}),dc=sa("role",[Lh,Dh,$h,Uh,zh,jh]);Bi([q("developer"),q("system"),q("assistant"),q("user"),q("tool"),q("activity")]);var Bh=Se({description:M(),value:M()}),Gh=Se({name:M(),description:M(),parameters:et()}),Fh=Se({threadId:M(),runId:M(),parentRunId:M().optional(),state:et(),messages:fn(dc),tools:fn(Gh),context:fn(Bh),forwardedProps:et()}),Vh=et(),Ie=class extends Error{constructor(e){super(e)}},Lo=class extends Ie{constructor(){super("Connect not implemented. This method is not supported by the current agent.")}},fc=Bi([q("developer"),q("system"),q("assistant"),q("user")]),I=(e=>(e.TEXT_MESSAGE_START="TEXT_MESSAGE_START",e.TEXT_MESSAGE_CONTENT="TEXT_MESSAGE_CONTENT",e.TEXT_MESSAGE_END="TEXT_MESSAGE_END",e.TEXT_MESSAGE_CHUNK="TEXT_MESSAGE_CHUNK",e.THINKING_TEXT_MESSAGE_START="THINKING_TEXT_MESSAGE_START",e.THINKING_TEXT_MESSAGE_CONTENT="THINKING_TEXT_MESSAGE_CONTENT",e.THINKING_TEXT_MESSAGE_END="THINKING_TEXT_MESSAGE_END",e.TOOL_CALL_START="TOOL_CALL_START",e.TOOL_CALL_ARGS="TOOL_CALL_ARGS",e.TOOL_CALL_END="TOOL_CALL_END",e.TOOL_CALL_CHUNK="TOOL_CALL_CHUNK",e.TOOL_CALL_RESULT="TOOL_CALL_RESULT",e.THINKING_START="THINKING_START",e.THINKING_END="THINKING_END",e.STATE_SNAPSHOT="STATE_SNAPSHOT",e.STATE_DELTA="STATE_DELTA",e.MESSAGES_SNAPSHOT="MESSAGES_SNAPSHOT",e.ACTIVITY_SNAPSHOT="ACTIVITY_SNAPSHOT",e.ACTIVITY_DELTA="ACTIVITY_DELTA",e.RAW="RAW",e.CUSTOM="CUSTOM",e.RUN_STARTED="RUN_STARTED",e.RUN_FINISHED="RUN_FINISHED",e.RUN_ERROR="RUN_ERROR",e.STEP_STARTED="STEP_STARTED",e.STEP_FINISHED="STEP_FINISHED",e))(I||{}),be=Se({type:Ch(I),timestamp:Ih().optional(),rawEvent:et().optional()}),Hh=be.extend({type:q("TEXT_MESSAGE_START"),messageId:M(),role:fc.default("assistant")}),vc=be.extend({type:q("TEXT_MESSAGE_CONTENT"),messageId:M(),delta:M().refine(e=>e.length>0,"Delta must not be an empty string")}),qh=be.extend({type:q("TEXT_MESSAGE_END"),messageId:M()}),Zh=be.extend({type:q("TEXT_MESSAGE_CHUNK"),messageId:M().optional(),role:fc.optional(),delta:M().optional()}),Xh=be.extend({type:q("THINKING_TEXT_MESSAGE_START")}),Kh=vc.omit({messageId:!0,type:!0}).extend({type:q("THINKING_TEXT_MESSAGE_CONTENT")}),Jh=be.extend({type:q("THINKING_TEXT_MESSAGE_END")}),Yh=be.extend({type:q("TOOL_CALL_START"),toolCallId:M(),toolCallName:M(),parentMessageId:M().optional()}),Wh=be.extend({type:q("TOOL_CALL_ARGS"),toolCallId:M(),delta:M()}),Qh=be.extend({type:q("TOOL_CALL_END"),toolCallId:M()}),ep=be.extend({messageId:M(),type:q("TOOL_CALL_RESULT"),toolCallId:M(),content:M(),role:q("tool").optional()}),tp=be.extend({type:q("TOOL_CALL_CHUNK"),toolCallId:M().optional(),toolCallName:M().optional(),parentMessageId:M().optional(),delta:M().optional()}),np=be.extend({type:q("THINKING_START"),title:M().optional()}),rp=be.extend({type:q("THINKING_END")}),sp=be.extend({type:q("STATE_SNAPSHOT"),snapshot:Vh}),ap=be.extend({type:q("STATE_DELTA"),delta:fn(et())}),ip=be.extend({type:q("MESSAGES_SNAPSHOT"),messages:fn(dc)}),op=be.extend({type:q("ACTIVITY_SNAPSHOT"),messageId:M(),activityType:M(),content:oc(et()),replace:oi().optional().default(!0)}),lp=be.extend({type:q("ACTIVITY_DELTA"),messageId:M(),activityType:M(),patch:fn(et())}),up=be.extend({type:q("RAW"),event:et(),source:M().optional()}),cp=be.extend({type:q("CUSTOM"),name:M(),value:et()}),dp=be.extend({type:q("RUN_STARTED"),threadId:M(),runId:M(),parentRunId:M().optional(),input:Fh.optional()}),fp=be.extend({type:q("RUN_FINISHED"),threadId:M(),runId:M(),result:et().optional()}),vp=be.extend({type:q("RUN_ERROR"),message:M(),code:M().optional()}),hp=be.extend({type:q("STEP_STARTED"),stepName:M()}),pp=be.extend({type:q("STEP_FINISHED"),stepName:M()}),hc=sa("type",[Hh,vc,qh,Zh,np,rp,Xh,Kh,Jh,Yh,Wh,Qh,tp,ep,sp,ap,ip,op,lp,up,cp,dp,fp,vp,hp,pp]);function Ne(e){return typeof e=="function"}function gp(e){return Ne(e?.lift)}function Ut(e){return function(t){if(gp(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var li=function(e,t){return li=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},li(e,t)};function pr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");li(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function mp(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(c){try{u(r.next(c))}catch(d){i(d)}}function l(c){try{u(r.throw(c))}catch(d){i(d)}}function u(c){c.done?a(c.value):s(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function pc(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(c){u=[6,c],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function cr(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ui(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,a=[],i;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(o){i={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function ci(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function tr(e){return this instanceof tr?(this.v=e,this):new tr(e)}function _p(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(f){return function(p){return Promise.resolve(p).then(f,d)}}function o(f,p){r[f]&&(s[f]=function(m){return new Promise(function(g,S){a.push([f,m,g,S])>1||l(f,m)})},p&&(s[f]=p(s[f])))}function l(f,p){try{u(r[f](p))}catch(m){h(a[0][3],m)}}function u(f){f.value instanceof tr?Promise.resolve(f.value.v).then(c,d):h(a[0][2],f)}function c(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function yp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof cr=="function"?cr(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(i){return new Promise(function(o,l){i=e[a](i),s(o,l,i.done,i.value)})}}function s(a,i,o,l){Promise.resolve(l).then(function(u){a({value:u,done:o})},i)}}var gc=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function mc(e){return Ne(e?.then)}function Gi(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Oa=Gi(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function di(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ia=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=cr(i),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(m){t={error:m}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}else i.remove(this);var c=this.initialTeardown;if(Ne(c))try{c()}catch(m){a=m instanceof Oa?m.errors:[m]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var h=cr(d),f=h.next();!f.done;f=h.next()){var p=f.value;try{Do(p)}catch(m){a=a??[],m instanceof Oa?a=ci(ci([],ui(a)),ui(m.errors)):a.push(m)}}}catch(m){r={error:m}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(a)throw new Oa(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Do(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&di(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&di(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),_c=ia.EMPTY;function yc(e){return e instanceof ia||e&&"closed"in e&&Ne(e.remove)&&Ne(e.add)&&Ne(e.unsubscribe)}function Do(e){Ne(e)?e():e.unsubscribe()}var bp={Promise:void 0},wp={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,ci([e,t],ui(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function bc(e){wp.setTimeout(function(){throw e})}function fi(){}function as(e){e()}var Fi=(function(e){pr(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,yc(n)&&n.add(r)):r.destination=kp,r}return t.create=function(n,r,s){return new vi(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(ia),Sp=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){ns(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){ns(r)}else ns(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){ns(n)}},e})(),vi=(function(e){pr(t,e);function t(n,r,s){var a=e.call(this)||this,i;return Ne(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,a.destination=new Sp(i),a}return t})(Fi);function ns(e){bc(e)}function Ep(e){throw e}var kp={closed:!0,next:fi,error:Ep,complete:fi},Vi=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Hi(e){return e}function $o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return wc(e)}function wc(e){return e.length===0?Hi:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var tt=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,a=Tp(t)?t:new vi(t,n,r);return as(function(){var i=s,o=i.operator,l=i.source;a.add(o?o.call(a,l):l?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=Uo(n),new n(function(s,a){var i=new vi({next:function(o){try{t(o)}catch(l){a(l),i.unsubscribe()}},error:a,complete:s});r.subscribe(i)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[Vi]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return wc(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=Uo(t),new t(function(r,s){var a;n.subscribe(function(i){return a=i},function(i){return s(i)},function(){return r(a)})})},e.create=function(t){return new e(t)},e})();function Uo(e){var t;return(t=e??bp.Promise)!==null&&t!==void 0?t:Promise}function xp(e){return e&&Ne(e.next)&&Ne(e.error)&&Ne(e.complete)}function Tp(e){return e&&e instanceof Fi||xp(e)&&yc(e)}function Sc(e){return Ne(e[Vi])}function Ec(e){return Symbol.asyncIterator&&Ne(e?.[Symbol.asyncIterator])}function kc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ap(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var xc=Ap();function Tc(e){return Ne(e?.[xc])}function Ac(e){return _p(this,arguments,function(){var n,r,s,a;return pc(this,function(i){switch(i.label){case 0:n=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,tr(n.read())];case 3:return r=i.sent(),s=r.value,a=r.done,a?[4,tr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,tr(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Ic(e){return Ne(e?.getReader)}function nn(e){if(e instanceof tt)return e;if(e!=null){if(Sc(e))return Ip(e);if(gc(e))return Cp(e);if(mc(e))return Np(e);if(Ec(e))return Cc(e);if(Tc(e))return Rp(e);if(Ic(e))return Op(e)}throw kc(e)}function Ip(e){return new tt(function(t){var n=e[Vi]();if(Ne(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Cp(e){return new tt(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Np(e){return new tt(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,bc)})}function Rp(e){return new tt(function(t){var n,r;try{for(var s=cr(e),a=s.next();!a.done;a=s.next()){var i=a.value;if(t.next(i),t.closed)return}}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t.complete()})}function Cc(e){return new tt(function(t){Mp(e,t).catch(function(n){return t.error(n)})})}function Op(e){return Cc(Ac(e))}function Mp(e,t){var n,r,s,a;return mp(this,void 0,void 0,function(){var i,o;return pc(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=yp(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Lt(e,t,n,r,s){return new Pp(e,t,n,r,s)}var Pp=(function(e){pr(t,e);function t(n,r,s,a,i,o){var l=e.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(Fi),Nc={now:function(){return(Nc.delegate||Date).now()},delegate:void 0};function Lp(e){return e&&Ne(e.schedule)}function Dp(e){return e[e.length-1]}function $p(e){return Lp(Dp(e))?e.pop():void 0}function Nn(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var a=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!s)return a}function hi(e){return Ut(function(t,n){var r=null,s=!1,a;r=t.subscribe(Lt(n,void 0,void 0,function(i){a=nn(e(i,hi(e)(t))),r?(r.unsubscribe(),r=null,a.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,a.subscribe(n))})}function Rc(e,t){return t===void 0&&(t=0),Ut(function(n,r){n.subscribe(Lt(r,function(s){return Nn(r,e,function(){return r.next(s)},t)},function(){return Nn(r,e,function(){return r.complete()},t)},function(s){return Nn(r,e,function(){return r.error(s)},t)}))})}function Oc(e,t){return t===void 0&&(t=0),Ut(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Up(e,t){return nn(e).pipe(Oc(t),Rc(t))}function zp(e,t){return nn(e).pipe(Oc(t),Rc(t))}function jp(e,t){return new tt(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function Bp(e,t){return new tt(function(n){var r;return Nn(n,t,function(){r=e[xc](),Nn(n,t,function(){var s,a,i;try{s=r.next(),a=s.value,i=s.done}catch(o){n.error(o);return}i?n.complete():n.next(a)},0,!0)}),function(){return Ne(r?.return)&&r.return()}})}function Mc(e,t){if(!e)throw new Error("Iterable cannot be null");return new tt(function(n){Nn(n,t,function(){var r=e[Symbol.asyncIterator]();Nn(n,t,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function Gp(e,t){return Mc(Ac(e),t)}function Fp(e,t){if(e!=null){if(Sc(e))return Up(e,t);if(gc(e))return jp(e,t);if(mc(e))return zp(e,t);if(Ec(e))return Mc(e,t);if(Tc(e))return Bp(e,t);if(Ic(e))return Gp(e,t)}throw kc(e)}function qs(e,t){return t?Fp(e,t):nn(e)}function pi(e,t){return Ut(function(n,r){var s=0;n.subscribe(Lt(r,function(a){r.next(e.call(t,a,s++))}))})}function Vp(e,t,n,r,s,a,i,o){var l=[],u=0,c=0,d=!1,h=function(){d&&!l.length&&!u&&t.complete()},f=function(m){return u<r?p(m):l.push(m)},p=function(m){u++;var g=!1;nn(n(m,c++)).subscribe(Lt(t,function(S){t.next(S)},function(){g=!0},void 0,function(){if(g)try{u--;for(var S=function(){var E=l.shift();i||p(E)};l.length&&u<r;)S();h()}catch(E){t.error(E)}}))};return e.subscribe(Lt(t,f,function(){d=!0,h()})),function(){}}function pn(e,t,n){return n===void 0&&(n=1/0),Ne(t)?pn(function(r,s){return pi(function(a,i){return t(r,a,s,i)})(nn(e(r,s)))},n):(typeof t=="number"&&(n=t),Ut(function(r,s){return Vp(r,s,e,n)}))}function Hp(e){return e===void 0&&(e=1/0),pn(Hi,e)}function Pc(e,t){return Ne(t)?pn(e,t,1):pn(e,1)}var qp=Gi(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),$n=(function(e){pr(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new zo(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new qp},t.prototype.next=function(n){var r=this;as(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=cr(r.currentObservers),o=i.next();!o.done;o=i.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;as(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;as(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,a=s.hasError,i=s.isStopped,o=s.observers;return a||i?_c:(this.currentObservers=null,o.push(n),new ia(function(){r.currentObservers=null,di(o,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,a=r.thrownError,i=r.isStopped;s?n.error(a):i&&n.complete()},t.prototype.asObservable=function(){var n=new tt;return n.source=this,n},t.create=function(n,r){return new zo(n,r)},t})(tt),zo=(function(e){pr(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:_c},t})($n);function Zp(e){return Ut(function(t,n){var r=!1;t.subscribe(Lt(n,function(s){r=!0,n.next(s)},function(){r||n.next(e),n.complete()}))})}var Lc=new tt(function(e){return e.complete()});function Oe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=$p(e);return qs(e,n)}function ke(e,t){var n=Ne(e)?e:function(){return e},r=function(s){return s.error(n())};return new tt(r)}var Xp=Gi(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function gi(e){return Ut(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}var Dc=(function(e){pr(t,e);function t(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Nc);var a=e.call(this)||this;return a._bufferSize=n,a._windowTime=r,a._timestampProvider=s,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,n),a._windowTime=Math.max(1,r),a}return t.prototype.next=function(n){var r=this,s=r.isStopped,a=r._buffer,i=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(a.push(n),!i&&a.push(o.now()+l)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,a=s._infiniteTimeWindow,i=s._buffer,o=i.slice(),l=0;l<o.length&&!n.closed;l+=a?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},t.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,a=n._buffer,i=n._infiniteTimeWindow,o=(i?1:2)*r;if(r<1/0&&o<a.length&&a.splice(0,a.length-o),!i){for(var l=s.now(),u=0,c=1;c<a.length&&a[c]<=l;c+=2)u=c;u&&a.splice(0,u+1)}},t})($n);function Kp(e,t){return Ut(function(n,r){var s=null,a=0,i=!1,o=function(){return i&&!s&&r.complete()};n.subscribe(Lt(r,function(l){s?.unsubscribe();var u=0,c=a++;nn(e(l,c)).subscribe(s=Lt(r,function(d){return r.next(t?t(l,d,c,u++):d)},function(){s=null,o()}))},function(){i=!0,o()}))})}function jo(e){return Ut(function(t,n){nn(e).subscribe(Lt(n,function(){return n.complete()},fi)),!n.closed&&t.subscribe(n)})}function Jp(e,t,n){var r=Ne(e)||t||n?{next:e,error:t,complete:n}:e;return r?Ut(function(s,a){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var o=!0;s.subscribe(Lt(a,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),a.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),a.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),a.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Hi}function Bo(e,t){return new Promise(function(n,r){var s=!1,a;e.subscribe({next:function(i){a=i,s=!0},error:r,complete:function(){s?n(a):r(new Xp)}})})}function Yp(e){return new tt(function(t){nn(e()).subscribe(t)})}const Ge=[];for(let e=0;e<256;++e)Ge.push((e+256).toString(16).slice(1));function Wp(e,t=0){return(Ge[e[t+0]]+Ge[e[t+1]]+Ge[e[t+2]]+Ge[e[t+3]]+"-"+Ge[e[t+4]]+Ge[e[t+5]]+"-"+Ge[e[t+6]]+Ge[e[t+7]]+"-"+Ge[e[t+8]]+Ge[e[t+9]]+"-"+Ge[e[t+10]]+Ge[e[t+11]]+Ge[e[t+12]]+Ge[e[t+13]]+Ge[e[t+14]]+Ge[e[t+15]]).toLowerCase()}let Ma;const Qp=new Uint8Array(16);function eg(){if(!Ma){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ma=crypto.getRandomValues.bind(crypto)}return Ma(Qp)}const tg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Go={randomUUID:tg};function Er(e,t,n){if(Go.randomUUID&&!e)return Go.randomUUID();e=e||{};const r=e.random??e.rng?.()??eg();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Wp(r)}function Fo(e){return` \r
	`.indexOf(e)>=0}function $c(e){for(var t=["topLevel"],n=0,r,s,a,i=function(E){return t.push(E)},o=function(E){return t[t.length-1]=E},l=function(E){r==null&&(r=n,s=t.length,a=E)},u=function(E){E===a&&(r=void 0,s=void 0,a=void 0)},c=function(){return t.pop()},d=function(){return n--},h=function(E){if("0"<=E&&E<="9"){i("number");return}switch(E){case'"':i("string");return;case"-":i("numberNeedsDigit");return;case"t":i("true");return;case"f":i("false");return;case"n":i("null");return;case"[":i("arrayNeedsValue");return;case"{":i("objectNeedsKey");return}},f=e.length;n<f;n++){var p=e[n];switch(t[t.length-1]){case"topLevel":h(p);break;case"string":switch(p){case'"':c();break;case"\\":l("stringEscape"),i("stringEscaped");break}break;case"stringEscaped":p==="u"?i("stringUnicode"):(u("stringEscape"),c());break;case"stringUnicode":n-e.lastIndexOf("u",n)===4&&(u("stringEscape"),c());break;case"number":p==="."?o("numberNeedsDigit"):p==="e"||p==="E"?o("numberNeedsExponent"):(p<"0"||p>"9")&&(d(),c());break;case"numberNeedsDigit":o("number");break;case"numberNeedsExponent":o(p==="+"||p==="-"?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(p<"a"||p>"z")&&(d(),c());break;case"arrayNeedsValue":p==="]"?c():Fo(p)||(u("collectionItem"),o("arrayNeedsComma"),h(p));break;case"arrayNeedsComma":p==="]"?c():p===","&&(l("collectionItem"),o("arrayNeedsValue"));break;case"objectNeedsKey":p==="}"?c():p==='"'&&(l("collectionItem"),o("objectNeedsColon"),i("string"));break;case"objectNeedsColon":p===":"&&o("objectNeedsValue");break;case"objectNeedsValue":Fo(p)||(u("collectionItem"),o("objectNeedsComma"),h(p));break;case"objectNeedsComma":p==="}"?c():p===","&&(l("collectionItem"),o("objectNeedsKey"));break}}s!=null&&(t.length=s);for(var m=[r!=null?e.slice(0,r):e],g=function(E){return m.push(E.slice(e.length-e.lastIndexOf(E[0])))},S=t.length-1;S>=0;S--)switch(t[S]){case"string":m.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":m.push("0");break;case"true":g("true");break;case"false":g("false");break;case"null":g("null");break;case"arrayNeedsValue":case"arrayNeedsComma":m.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":m.push("}");break}return m.join("")}function ng(){let e=0,t=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,(n&128)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Pa(e,t,n){for(let a=0;a<28;a=a+7){const i=e>>>a,o=!(!(i>>>7)&&t==0),l=(o?i|128:i)&255;if(n.push(l),!o)return}const r=e>>>28&15|(t&7)<<4,s=t>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let a=3;a<31;a=a+7){const i=t>>>a,o=!!(i>>>7),l=(o?i|128:i)&255;if(n.push(l),!o)return}n.push(t>>>31&1)}}const is=4294967296;function Vo(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function a(i,o){const l=Number(e.slice(i,o));s*=n,r=r*n+l,r>=is&&(s=s+(r/is|0),r=r%is)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?zc(r,s):qi(r,s)}function rg(e,t){let n=qi(e,t);const r=n.hi&2147483648;r&&(n=zc(n.lo,n.hi));const s=Uc(n.lo,n.hi);return r?"-"+s:s}function Uc(e,t){if({lo:e,hi:t}=sg(e,t),t<=2097151)return String(is*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,s=t>>16&65535;let a=n+r*6777216+s*6710656,i=r+s*8147497,o=s*2;const l=1e7;return a>=l&&(i+=Math.floor(a/l),a%=l),i>=l&&(o+=Math.floor(i/l),i%=l),o.toString()+Ho(i)+Ho(a)}function sg(e,t){return{lo:e>>>0,hi:t>>>0}}function qi(e,t){return{lo:e|0,hi:t|0}}function zc(e,t){return t=~t,e?e=~e+1:t+=1,qi(e,t)}const Ho=e=>{const t=String(e);return"0000000".slice(t.length)+t};function qo(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function ag(){let e=this.buf[this.pos++],t=e&127;if((e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,(e&128)==0)return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;(e&128)!==0&&n<10;n++)e=this.buf[this.pos++];if((e&128)!=0)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var Zo={};const It=ig();function ig(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof Zo!="object"||Zo.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>r||o<n)throw new Error(`invalid int64: ${i}`);return o},uParse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>a||o<s)throw new Error(`invalid uint64: ${i}`);return o},enc(i){return e.setBigInt64(0,this.parse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(i){return e.setBigInt64(0,this.uParse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigInt64(0,!0)},uDec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),Xo(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),Ko(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),Xo(n),Vo(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),Ko(n),Vo(n)},dec(n,r){return rg(n,r)},uDec(n,r){return Uc(n,r)}}}function Xo(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function Ko(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const La=Symbol.for("@bufbuild/protobuf/text-encoding");function jc(){if(globalThis[La]==null){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[La]={encodeUtf8(n){return e.encode(n)},decodeUtf8(n){return t.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[La]}var on;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(on||(on={}));const og=34028234663852886e22,lg=-34028234663852886e22,ug=4294967295,cg=2147483647,dg=-2147483648;class he{constructor(t=jc().encodeUtf8){this.encodeUtf8=t,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let t=0;for(let s=0;s<this.chunks.length;s++)t+=this.chunks[s].length;let n=new Uint8Array(t),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(Jo(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return Da(t),qo(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.encodeUtf8(t);return this.uint32(n.byteLength),this.raw(n)}float(t){fg(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){Jo(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){Da(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return Da(t),t=(t<<1^t>>31)>>>0,qo(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=It.enc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=It.uEnc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(t){let n=It.enc(t);return Pa(n.lo,n.hi,this.buf),this}sint64(t){const n=It.enc(t),r=n.hi>>31,s=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Pa(s,a,this.buf),this}uint64(t){const n=It.uEnc(t);return Pa(n.lo,n.hi,this.buf),this}}class Z{constructor(t,n=jc().decodeUtf8){this.decodeUtf8=n,this.varint64=ng,this.uint32=ag,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength)}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t,n){let r=this.pos;switch(t){case on.Varint:for(;this.buf[this.pos++]&128;);break;case on.Bit64:this.pos+=4;case on.Bit32:this.pos+=4;break;case on.LengthDelimited:let s=this.uint32();this.pos+=s;break;case on.StartGroup:for(;;){const[a,i]=this.tag();if(i===on.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(i,a)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return It.dec(...this.varint64())}uint64(){return It.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,It.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return It.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return It.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.decodeUtf8(this.bytes())}}function Da(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>cg||e<dg)throw new Error("invalid int32: "+e)}function Jo(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>ug||e<0)throw new Error("invalid uint32: "+e)}function fg(e){if(typeof e=="string"){const t=e;if(e=Number(e),Number.isNaN(e)&&t!=="NaN")throw new Error("invalid float32: "+t)}else if(typeof e!="number")throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>og||e<lg))throw new Error("invalid float32: "+e)}function $a(){return{fields:{}}}var Cr={encode(e,t=new he){return Object.entries(e.fields).forEach(([n,r])=>{r!==void 0&&mi.encode({key:n,value:r},t.uint32(10).fork()).join()}),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=$a();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;const i=mi.decode(n,n.uint32());i.value!==void 0&&(s.fields[i.key]=i.value);continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Cr.fromPartial(e??{})},fromPartial(e){var t;const n=$a();return n.fields=Object.entries((t=e.fields)!=null?t:{}).reduce((r,[s,a])=>(a!==void 0&&(r[s]=a),r),{}),n},wrap(e){const t=$a();if(e!==void 0)for(const n of Object.keys(e))t.fields[n]=e[n];return t},unwrap(e){const t={};if(e.fields)for(const n of Object.keys(e.fields))t[n]=e.fields[n];return t}};function Yo(){return{key:"",value:void 0}}var mi={encode(e,t=new he){return e.key!==""&&t.uint32(10).string(e.key),e.value!==void 0&&ae.encode(ae.wrap(e.value),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Yo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.key=n.string();continue}case 2:{if(a!==18)break;s.value=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return mi.fromPartial(e??{})},fromPartial(e){var t,n;const r=Yo();return r.key=(t=e.key)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function Ua(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}var ae={encode(e,t=new he){return e.nullValue!==void 0&&t.uint32(8).int32(e.nullValue),e.numberValue!==void 0&&t.uint32(17).double(e.numberValue),e.stringValue!==void 0&&t.uint32(26).string(e.stringValue),e.boolValue!==void 0&&t.uint32(32).bool(e.boolValue),e.structValue!==void 0&&Cr.encode(Cr.wrap(e.structValue),t.uint32(42).fork()).join(),e.listValue!==void 0&&Nr.encode(Nr.wrap(e.listValue),t.uint32(50).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Ua();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.nullValue=n.int32();continue}case 2:{if(a!==17)break;s.numberValue=n.double();continue}case 3:{if(a!==26)break;s.stringValue=n.string();continue}case 4:{if(a!==32)break;s.boolValue=n.bool();continue}case 5:{if(a!==42)break;s.structValue=Cr.unwrap(Cr.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.listValue=Nr.unwrap(Nr.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ae.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i;const o=Ua();return o.nullValue=(t=e.nullValue)!=null?t:void 0,o.numberValue=(n=e.numberValue)!=null?n:void 0,o.stringValue=(r=e.stringValue)!=null?r:void 0,o.boolValue=(s=e.boolValue)!=null?s:void 0,o.structValue=(a=e.structValue)!=null?a:void 0,o.listValue=(i=e.listValue)!=null?i:void 0,o},wrap(e){const t=Ua();if(e===null)t.nullValue=0;else if(typeof e=="boolean")t.boolValue=e;else if(typeof e=="number")t.numberValue=e;else if(typeof e=="string")t.stringValue=e;else if(globalThis.Array.isArray(e))t.listValue=e;else if(typeof e=="object")t.structValue=e;else if(typeof e<"u")throw new globalThis.Error("Unsupported any value type: "+typeof e);return t},unwrap(e){if(e.stringValue!==void 0)return e.stringValue;if(e?.numberValue!==void 0)return e.numberValue;if(e?.boolValue!==void 0)return e.boolValue;if(e?.structValue!==void 0)return e.structValue;if(e?.listValue!==void 0)return e.listValue;if(e?.nullValue!==void 0)return null}};function za(){return{values:[]}}var Nr={encode(e,t=new he){for(const n of e.values)ae.encode(ae.wrap(n),t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=za();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.values.push(ae.unwrap(ae.decode(n,n.uint32())));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Nr.fromPartial(e??{})},fromPartial(e){var t;const n=za();return n.values=((t=e.values)==null?void 0:t.map(r=>r))||[],n},wrap(e){const t=za();return t.values=e??[],t},unwrap(e){return e?.hasOwnProperty("values")&&globalThis.Array.isArray(e.values)?e.values:e}},Bc=(e=>(e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.REPLACE=2]="REPLACE",e[e.MOVE=3]="MOVE",e[e.COPY=4]="COPY",e[e.TEST=5]="TEST",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Bc||{});function Wo(){return{op:0,path:"",from:void 0,value:void 0}}var os={encode(e,t=new he){return e.op!==0&&t.uint32(8).int32(e.op),e.path!==""&&t.uint32(18).string(e.path),e.from!==void 0&&t.uint32(26).string(e.from),e.value!==void 0&&ae.encode(ae.wrap(e.value),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Wo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.op=n.int32();continue}case 2:{if(a!==18)break;s.path=n.string();continue}case 3:{if(a!==26)break;s.from=n.string();continue}case 4:{if(a!==34)break;s.value=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return os.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=Wo();return a.op=(t=e.op)!=null?t:0,a.path=(n=e.path)!=null?n:"",a.from=(r=e.from)!=null?r:void 0,a.value=(s=e.value)!=null?s:void 0,a}};function Qo(){return{id:"",type:"",function:void 0}}var ls={encode(e,t=new he){return e.id!==""&&t.uint32(10).string(e.id),e.type!==""&&t.uint32(18).string(e.type),e.function!==void 0&&us.encode(e.function,t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Qo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.type=n.string();continue}case 3:{if(a!==26)break;s.function=us.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ls.fromPartial(e??{})},fromPartial(e){var t,n;const r=Qo();return r.id=(t=e.id)!=null?t:"",r.type=(n=e.type)!=null?n:"",r.function=e.function!==void 0&&e.function!==null?us.fromPartial(e.function):void 0,r}};function el(){return{name:"",arguments:""}}var us={encode(e,t=new he){return e.name!==""&&t.uint32(10).string(e.name),e.arguments!==""&&t.uint32(18).string(e.arguments),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=el();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.name=n.string();continue}case 2:{if(a!==18)break;s.arguments=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return us.fromPartial(e??{})},fromPartial(e){var t,n;const r=el();return r.name=(t=e.name)!=null?t:"",r.arguments=(n=e.arguments)!=null?n:"",r}};function tl(){return{id:"",role:"",content:void 0,name:void 0,toolCalls:[],toolCallId:void 0,error:void 0}}var cs={encode(e,t=new he){e.id!==""&&t.uint32(10).string(e.id),e.role!==""&&t.uint32(18).string(e.role),e.content!==void 0&&t.uint32(26).string(e.content),e.name!==void 0&&t.uint32(34).string(e.name);for(const n of e.toolCalls)ls.encode(n,t.uint32(42).fork()).join();return e.toolCallId!==void 0&&t.uint32(50).string(e.toolCallId),e.error!==void 0&&t.uint32(58).string(e.error),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=tl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.role=n.string();continue}case 3:{if(a!==26)break;s.content=n.string();continue}case 4:{if(a!==34)break;s.name=n.string();continue}case 5:{if(a!==42)break;s.toolCalls.push(ls.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.toolCallId=n.string();continue}case 7:{if(a!==58)break;s.error=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return cs.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i,o;const l=tl();return l.id=(t=e.id)!=null?t:"",l.role=(n=e.role)!=null?n:"",l.content=(r=e.content)!=null?r:void 0,l.name=(s=e.name)!=null?s:void 0,l.toolCalls=((a=e.toolCalls)==null?void 0:a.map(u=>ls.fromPartial(u)))||[],l.toolCallId=(i=e.toolCallId)!=null?i:void 0,l.error=(o=e.error)!=null?o:void 0,l}},Gc=(e=>(e[e.TEXT_MESSAGE_START=0]="TEXT_MESSAGE_START",e[e.TEXT_MESSAGE_CONTENT=1]="TEXT_MESSAGE_CONTENT",e[e.TEXT_MESSAGE_END=2]="TEXT_MESSAGE_END",e[e.TOOL_CALL_START=3]="TOOL_CALL_START",e[e.TOOL_CALL_ARGS=4]="TOOL_CALL_ARGS",e[e.TOOL_CALL_END=5]="TOOL_CALL_END",e[e.STATE_SNAPSHOT=6]="STATE_SNAPSHOT",e[e.STATE_DELTA=7]="STATE_DELTA",e[e.MESSAGES_SNAPSHOT=8]="MESSAGES_SNAPSHOT",e[e.RAW=9]="RAW",e[e.CUSTOM=10]="CUSTOM",e[e.RUN_STARTED=11]="RUN_STARTED",e[e.RUN_FINISHED=12]="RUN_FINISHED",e[e.RUN_ERROR=13]="RUN_ERROR",e[e.STEP_STARTED=14]="STEP_STARTED",e[e.STEP_FINISHED=15]="STEP_FINISHED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(Gc||{});function nl(){return{type:0,timestamp:void 0,rawEvent:void 0}}var X={encode(e,t=new he){return e.type!==0&&t.uint32(8).int32(e.type),e.timestamp!==void 0&&t.uint32(16).int64(e.timestamp),e.rawEvent!==void 0&&ae.encode(ae.wrap(e.rawEvent),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=nl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.type=n.int32();continue}case 2:{if(a!==16)break;s.timestamp=vg(n.int64());continue}case 3:{if(a!==26)break;s.rawEvent=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return X.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=nl();return s.type=(t=e.type)!=null?t:0,s.timestamp=(n=e.timestamp)!=null?n:void 0,s.rawEvent=(r=e.rawEvent)!=null?r:void 0,s}};function rl(){return{baseEvent:void 0,messageId:"",role:void 0}}var ds={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=rl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ds.fromPartial(e??{})},fromPartial(e){var t,n;const r=rl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.role=(n=e.role)!=null?n:void 0,r}};function sl(){return{baseEvent:void 0,messageId:"",delta:""}}var fs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=sl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return fs.fromPartial(e??{})},fromPartial(e){var t,n;const r=sl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function al(){return{baseEvent:void 0,messageId:""}}var vs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=al();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return vs.fromPartial(e??{})},fromPartial(e){var t;const n=al();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.messageId=(t=e.messageId)!=null?t:"",n}};function il(){return{baseEvent:void 0,toolCallId:"",toolCallName:"",parentMessageId:void 0}}var hs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.toolCallName!==""&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=il();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return hs.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=il();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.toolCallId=(t=e.toolCallId)!=null?t:"",s.toolCallName=(n=e.toolCallName)!=null?n:"",s.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,s}};function ol(){return{baseEvent:void 0,toolCallId:"",delta:""}}var ps={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ol();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ps.fromPartial(e??{})},fromPartial(e){var t,n;const r=ol();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.toolCallId=(t=e.toolCallId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function ll(){return{baseEvent:void 0,toolCallId:""}}var gs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ll();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return gs.fromPartial(e??{})},fromPartial(e){var t;const n=ll();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.toolCallId=(t=e.toolCallId)!=null?t:"",n}};function ul(){return{baseEvent:void 0,snapshot:void 0}}var ms={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.snapshot!==void 0&&ae.encode(ae.wrap(e.snapshot),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ul();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.snapshot=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ms.fromPartial(e??{})},fromPartial(e){var t;const n=ul();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.snapshot=(t=e.snapshot)!=null?t:void 0,n}};function cl(){return{baseEvent:void 0,delta:[]}}var _s={encode(e,t=new he){e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.delta)os.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=cl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.delta.push(os.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return _s.fromPartial(e??{})},fromPartial(e){var t;const n=cl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.delta=((t=e.delta)==null?void 0:t.map(r=>os.fromPartial(r)))||[],n}};function dl(){return{baseEvent:void 0,messages:[]}}var ys={encode(e,t=new he){e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.messages)cs.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=dl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messages.push(cs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ys.fromPartial(e??{})},fromPartial(e){var t;const n=dl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.messages=((t=e.messages)==null?void 0:t.map(r=>cs.fromPartial(r)))||[],n}};function fl(){return{baseEvent:void 0,event:void 0,source:void 0}}var bs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.event!==void 0&&ae.encode(ae.wrap(e.event),t.uint32(18).fork()).join(),e.source!==void 0&&t.uint32(26).string(e.source),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=fl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.event=ae.unwrap(ae.decode(n,n.uint32()));continue}case 3:{if(a!==26)break;s.source=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return bs.fromPartial(e??{})},fromPartial(e){var t,n;const r=fl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.event=(t=e.event)!=null?t:void 0,r.source=(n=e.source)!=null?n:void 0,r}};function vl(){return{baseEvent:void 0,name:"",value:void 0}}var ws={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.name!==""&&t.uint32(18).string(e.name),e.value!==void 0&&ae.encode(ae.wrap(e.value),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=vl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.name=n.string();continue}case 3:{if(a!==26)break;s.value=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ws.fromPartial(e??{})},fromPartial(e){var t,n;const r=vl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.name=(t=e.name)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function hl(){return{baseEvent:void 0,threadId:"",runId:""}}var Ss={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=hl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ss.fromPartial(e??{})},fromPartial(e){var t,n;const r=hl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.threadId=(t=e.threadId)!=null?t:"",r.runId=(n=e.runId)!=null?n:"",r}};function pl(){return{baseEvent:void 0,threadId:"",runId:"",result:void 0}}var Es={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),e.result!==void 0&&ae.encode(ae.wrap(e.result),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=pl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}case 4:{if(a!==34)break;s.result=ae.unwrap(ae.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Es.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=pl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.threadId=(t=e.threadId)!=null?t:"",s.runId=(n=e.runId)!=null?n:"",s.result=(r=e.result)!=null?r:void 0,s}};function gl(){return{baseEvent:void 0,code:void 0,message:""}}var ks={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.code!==void 0&&t.uint32(18).string(e.code),e.message!==""&&t.uint32(26).string(e.message),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=gl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.code=n.string();continue}case 3:{if(a!==26)break;s.message=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ks.fromPartial(e??{})},fromPartial(e){var t,n;const r=gl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,r.code=(t=e.code)!=null?t:void 0,r.message=(n=e.message)!=null?n:"",r}};function ml(){return{baseEvent:void 0,stepName:""}}var xs={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ml();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return xs.fromPartial(e??{})},fromPartial(e){var t;const n=ml();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function _l(){return{baseEvent:void 0,stepName:""}}var Ts={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=_l();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ts.fromPartial(e??{})},fromPartial(e){var t;const n=_l();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function yl(){return{baseEvent:void 0,messageId:void 0,role:void 0,delta:void 0}}var As={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==void 0&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),e.delta!==void 0&&t.uint32(34).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=yl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}case 4:{if(a!==34)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return As.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=yl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,s.messageId=(t=e.messageId)!=null?t:void 0,s.role=(n=e.role)!=null?n:void 0,s.delta=(r=e.delta)!=null?r:void 0,s}};function bl(){return{baseEvent:void 0,toolCallId:void 0,toolCallName:void 0,parentMessageId:void 0,delta:void 0}}var Is={encode(e,t=new he){return e.baseEvent!==void 0&&X.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==void 0&&t.uint32(18).string(e.toolCallId),e.toolCallName!==void 0&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),e.delta!==void 0&&t.uint32(42).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=bl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=X.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}case 5:{if(a!==42)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Is.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=bl();return a.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?X.fromPartial(e.baseEvent):void 0,a.toolCallId=(t=e.toolCallId)!=null?t:void 0,a.toolCallName=(n=e.toolCallName)!=null?n:void 0,a.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,a.delta=(s=e.delta)!=null?s:void 0,a}};function wl(){return{textMessageStart:void 0,textMessageContent:void 0,textMessageEnd:void 0,toolCallStart:void 0,toolCallArgs:void 0,toolCallEnd:void 0,stateSnapshot:void 0,stateDelta:void 0,messagesSnapshot:void 0,raw:void 0,custom:void 0,runStarted:void 0,runFinished:void 0,runError:void 0,stepStarted:void 0,stepFinished:void 0,textMessageChunk:void 0,toolCallChunk:void 0}}var Fc={encode(e,t=new he){return e.textMessageStart!==void 0&&ds.encode(e.textMessageStart,t.uint32(10).fork()).join(),e.textMessageContent!==void 0&&fs.encode(e.textMessageContent,t.uint32(18).fork()).join(),e.textMessageEnd!==void 0&&vs.encode(e.textMessageEnd,t.uint32(26).fork()).join(),e.toolCallStart!==void 0&&hs.encode(e.toolCallStart,t.uint32(34).fork()).join(),e.toolCallArgs!==void 0&&ps.encode(e.toolCallArgs,t.uint32(42).fork()).join(),e.toolCallEnd!==void 0&&gs.encode(e.toolCallEnd,t.uint32(50).fork()).join(),e.stateSnapshot!==void 0&&ms.encode(e.stateSnapshot,t.uint32(58).fork()).join(),e.stateDelta!==void 0&&_s.encode(e.stateDelta,t.uint32(66).fork()).join(),e.messagesSnapshot!==void 0&&ys.encode(e.messagesSnapshot,t.uint32(74).fork()).join(),e.raw!==void 0&&bs.encode(e.raw,t.uint32(82).fork()).join(),e.custom!==void 0&&ws.encode(e.custom,t.uint32(90).fork()).join(),e.runStarted!==void 0&&Ss.encode(e.runStarted,t.uint32(98).fork()).join(),e.runFinished!==void 0&&Es.encode(e.runFinished,t.uint32(106).fork()).join(),e.runError!==void 0&&ks.encode(e.runError,t.uint32(114).fork()).join(),e.stepStarted!==void 0&&xs.encode(e.stepStarted,t.uint32(122).fork()).join(),e.stepFinished!==void 0&&Ts.encode(e.stepFinished,t.uint32(130).fork()).join(),e.textMessageChunk!==void 0&&As.encode(e.textMessageChunk,t.uint32(138).fork()).join(),e.toolCallChunk!==void 0&&Is.encode(e.toolCallChunk,t.uint32(146).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=wl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.textMessageStart=ds.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.textMessageContent=fs.decode(n,n.uint32());continue}case 3:{if(a!==26)break;s.textMessageEnd=vs.decode(n,n.uint32());continue}case 4:{if(a!==34)break;s.toolCallStart=hs.decode(n,n.uint32());continue}case 5:{if(a!==42)break;s.toolCallArgs=ps.decode(n,n.uint32());continue}case 6:{if(a!==50)break;s.toolCallEnd=gs.decode(n,n.uint32());continue}case 7:{if(a!==58)break;s.stateSnapshot=ms.decode(n,n.uint32());continue}case 8:{if(a!==66)break;s.stateDelta=_s.decode(n,n.uint32());continue}case 9:{if(a!==74)break;s.messagesSnapshot=ys.decode(n,n.uint32());continue}case 10:{if(a!==82)break;s.raw=bs.decode(n,n.uint32());continue}case 11:{if(a!==90)break;s.custom=ws.decode(n,n.uint32());continue}case 12:{if(a!==98)break;s.runStarted=Ss.decode(n,n.uint32());continue}case 13:{if(a!==106)break;s.runFinished=Es.decode(n,n.uint32());continue}case 14:{if(a!==114)break;s.runError=ks.decode(n,n.uint32());continue}case 15:{if(a!==122)break;s.stepStarted=xs.decode(n,n.uint32());continue}case 16:{if(a!==130)break;s.stepFinished=Ts.decode(n,n.uint32());continue}case 17:{if(a!==138)break;s.textMessageChunk=As.decode(n,n.uint32());continue}case 18:{if(a!==146)break;s.toolCallChunk=Is.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Fc.fromPartial(e??{})},fromPartial(e){const t=wl();return t.textMessageStart=e.textMessageStart!==void 0&&e.textMessageStart!==null?ds.fromPartial(e.textMessageStart):void 0,t.textMessageContent=e.textMessageContent!==void 0&&e.textMessageContent!==null?fs.fromPartial(e.textMessageContent):void 0,t.textMessageEnd=e.textMessageEnd!==void 0&&e.textMessageEnd!==null?vs.fromPartial(e.textMessageEnd):void 0,t.toolCallStart=e.toolCallStart!==void 0&&e.toolCallStart!==null?hs.fromPartial(e.toolCallStart):void 0,t.toolCallArgs=e.toolCallArgs!==void 0&&e.toolCallArgs!==null?ps.fromPartial(e.toolCallArgs):void 0,t.toolCallEnd=e.toolCallEnd!==void 0&&e.toolCallEnd!==null?gs.fromPartial(e.toolCallEnd):void 0,t.stateSnapshot=e.stateSnapshot!==void 0&&e.stateSnapshot!==null?ms.fromPartial(e.stateSnapshot):void 0,t.stateDelta=e.stateDelta!==void 0&&e.stateDelta!==null?_s.fromPartial(e.stateDelta):void 0,t.messagesSnapshot=e.messagesSnapshot!==void 0&&e.messagesSnapshot!==null?ys.fromPartial(e.messagesSnapshot):void 0,t.raw=e.raw!==void 0&&e.raw!==null?bs.fromPartial(e.raw):void 0,t.custom=e.custom!==void 0&&e.custom!==null?ws.fromPartial(e.custom):void 0,t.runStarted=e.runStarted!==void 0&&e.runStarted!==null?Ss.fromPartial(e.runStarted):void 0,t.runFinished=e.runFinished!==void 0&&e.runFinished!==null?Es.fromPartial(e.runFinished):void 0,t.runError=e.runError!==void 0&&e.runError!==null?ks.fromPartial(e.runError):void 0,t.stepStarted=e.stepStarted!==void 0&&e.stepStarted!==null?xs.fromPartial(e.stepStarted):void 0,t.stepFinished=e.stepFinished!==void 0&&e.stepFinished!==null?Ts.fromPartial(e.stepFinished):void 0,t.textMessageChunk=e.textMessageChunk!==void 0&&e.textMessageChunk!==null?As.fromPartial(e.textMessageChunk):void 0,t.toolCallChunk=e.toolCallChunk!==void 0&&e.toolCallChunk!==null?Is.fromPartial(e.toolCallChunk):void 0,t}};function vg(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function hg(e){var t;const n=Fc.decode(e),r=Object.values(n).find(s=>s!==void 0);if(!r)throw new Error("Invalid event");if(r.type=Gc[r.baseEvent.type],r.timestamp=r.baseEvent.timestamp,r.rawEvent=r.baseEvent.rawEvent,r.type===I.MESSAGES_SNAPSHOT)for(const s of r.messages){const a=s;((t=a.toolCalls)==null?void 0:t.length)===0&&(a.toolCalls=void 0)}if(r.type===I.STATE_DELTA)for(const s of r.delta)s.op=Bc[s.op].toLowerCase(),Object.keys(s).forEach(a=>{s[a]===void 0&&delete s[a]});return Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),hc.parse(r)}var pg="application/vnd.ag-ui.event+proto";const gg=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Sl=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");const t=e.match(gg);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},El=e=>e==="*"||e==="x"||e==="X",kl=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},mg=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],_g=(e,t)=>{if(El(e)||El(t))return 0;const[n,r]=mg(kl(e),kl(t));return n>r?1:n<r?-1:0},xl=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const r=_g(e[n]||"0",t[n]||"0");if(r!==0)return r}return 0},yg=(e,t)=>{const n=Sl(e),r=Sl(t),s=n.pop(),a=r.pop(),i=xl(n,r);return i!==0?i:s&&a?xl(s.split("."),a.split(".")):s||a?s?-1:1:0};var bg={},wg=Object.defineProperty,Sg=Object.defineProperties,Eg=Object.getOwnPropertyDescriptors,Zs=Object.getOwnPropertySymbols,Vc=Object.prototype.hasOwnProperty,Hc=Object.prototype.propertyIsEnumerable,Tl=(e,t,n)=>t in e?wg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ze=(e,t)=>{for(var n in t||(t={}))Vc.call(t,n)&&Tl(e,n,t[n]);if(Zs)for(var n of Zs(t))Hc.call(t,n)&&Tl(e,n,t[n]);return e},gn=(e,t)=>Sg(e,Eg(t)),kg=(e,t)=>{var n={};for(var r in e)Vc.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Zs)for(var r of Zs(e))t.indexOf(r)<0&&Hc.call(e,r)&&(n[r]=e[r]);return n},ve=e=>{if(typeof structuredClone=="function")return structuredClone(e);try{return JSON.parse(JSON.stringify(e))}catch{return Ze({},e)}};async function xe(e,t,n,r){let s=t,a=n,i;for(let o of e)try{let l=await r(o,ve(s),ve(a));if(l===void 0)continue;if(l.messages!==void 0&&(s=l.messages),l.state!==void 0&&(a=l.state),i=l.stopPropagation,i===!0)break}catch(l){bg.JEST_WORKER_ID!==void 0||console.error("Subscriber error:",l);continue}return Ze(Ze(Ze({},JSON.stringify(s)!==JSON.stringify(t)?{messages:s}:{}),JSON.stringify(a)!==JSON.stringify(n)?{state:a}:{}),i!==void 0?{stopPropagation:i}:{})}var qc=(e,t,n,r)=>{let s=ve(n.messages),a=ve(e.state),i={},o=u=>{u.messages!==void 0&&(s=u.messages,i.messages=u.messages),u.state!==void 0&&(a=u.state,i.state=u.state)},l=()=>{let u=ve(i);return i={},u.messages!==void 0||u.state!==void 0?Oe(u):Lc};return t.pipe(Pc(async u=>{var c,d,h,f;let p=await xe(r,s,a,(m,g,S)=>{var E;return(E=m.onEvent)==null?void 0:E.call(m,{event:u,agent:n,input:e,messages:g,state:S})});if(o(p),p.stopPropagation===!0)return l();switch(u.type){case I.TEXT_MESSAGE_START:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onTextMessageStartEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:g,role:S="assistant"}=u,E={id:g,role:S,content:""};s.push(E),o({messages:s})}return l()}case I.TEXT_MESSAGE_CONTENT:{let{messageId:m,delta:g}=u,S=s.find(b=>b.id===m);if(!S)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${m}'`),l();let E=await xe(r,s,a,(b,k,N)=>{var C;return(C=b.onTextMessageContentEvent)==null?void 0:C.call(b,{event:u,messages:k,state:N,agent:n,input:e,textMessageBuffer:typeof S.content=="string"?S.content:""})});if(o(E),E.stopPropagation!==!0){let b=typeof S.content=="string"?S.content:"";S.content=`${b}${g}`,o({messages:s})}return l()}case I.TEXT_MESSAGE_END:{let{messageId:m}=u,g=s.find(E=>E.id===m);if(!g)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${m}'`),l();let S=await xe(r,s,a,(E,b,k)=>{var N;return(N=E.onTextMessageEndEvent)==null?void 0:N.call(E,{event:u,messages:b,state:k,agent:n,input:e,textMessageBuffer:typeof g.content=="string"?g.content:""})});return o(S),await Promise.all(r.map(E=>{var b;(b=E.onNewMessage)==null||b.call(E,{message:g,messages:s,state:a,agent:n,input:e})})),l()}case I.TOOL_CALL_START:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onToolCallStartEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{toolCallId:g,toolCallName:S,parentMessageId:E}=u,b;E&&s.length>0&&s[s.length-1].id===E?b=s[s.length-1]:(b={id:E||g,role:"assistant",toolCalls:[]},s.push(b)),b.toolCalls!=null||(b.toolCalls=[]),b.toolCalls.push({id:g,type:"function",function:{name:S,arguments:""}}),o({messages:s})}return l()}case I.TOOL_CALL_ARGS:{let{toolCallId:m,delta:g}=u,S=s.find(k=>{var N;return(N=k.toolCalls)==null?void 0:N.some(C=>C.id===m)});if(!S)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${m}'`),l();let E=S.toolCalls.find(k=>k.id===m);if(!E)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${m}'`),l();let b=await xe(r,s,a,(k,N,C)=>{var O;let U=E.function.arguments,R=E.function.name,A={};try{A=$c(U)}catch{}return(O=k.onToolCallArgsEvent)==null?void 0:O.call(k,{event:u,messages:N,state:C,agent:n,input:e,toolCallBuffer:U,toolCallName:R,partialToolCallArgs:A})});return o(b),b.stopPropagation!==!0&&(E.function.arguments+=g,o({messages:s})),l()}case I.TOOL_CALL_END:{let{toolCallId:m}=u,g=s.find(b=>{var k;return(k=b.toolCalls)==null?void 0:k.some(N=>N.id===m)});if(!g)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${m}'`),l();let S=g.toolCalls.find(b=>b.id===m);if(!S)return console.warn(`TOOL_CALL_END: No tool call found with ID '${m}'`),l();let E=await xe(r,s,a,(b,k,N)=>{var C;let O=S.function.arguments,U=S.function.name,R={};try{R=JSON.parse(O)}catch{}return(C=b.onToolCallEndEvent)==null?void 0:C.call(b,{event:u,messages:k,state:N,agent:n,input:e,toolCallName:U,toolCallArgs:R})});return o(E),await Promise.all(r.map(b=>{var k;(k=b.onNewToolCall)==null||k.call(b,{toolCall:S,messages:s,state:a,agent:n,input:e})})),l()}case I.TOOL_CALL_RESULT:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onToolCallResultEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:g,toolCallId:S,content:E,role:b}=u,k={id:g,toolCallId:S,role:b||"tool",content:E};s.push(k),await Promise.all(r.map(N=>{var C;(C=N.onNewMessage)==null||C.call(N,{message:k,messages:s,state:a,agent:n,input:e})})),o({messages:s})}return l()}case I.STATE_SNAPSHOT:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onStateSnapshotEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{snapshot:g}=u;a=g,o({state:a})}return l()}case I.STATE_DELTA:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onStateDeltaEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{delta:g}=u;try{a=or(a,g,!0,!1).newDocument,o({state:a})}catch(S){let E=S instanceof Error?S.message:String(S);console.warn(`Failed to apply state patch:
Current state: ${JSON.stringify(a,null,2)}
Patch operations: ${JSON.stringify(g,null,2)}
Error: ${E}`)}}return l()}case I.MESSAGES_SNAPSHOT:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onMessagesSnapshotEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messages:g}=u;s=g,o({messages:s})}return l()}case I.ACTIVITY_SNAPSHOT:{let m=u,g=s.findIndex(N=>N.id===m.messageId),S=g>=0?s[g]:void 0,E=S?.role==="activity"?S:void 0,b=(c=m.replace)!=null?c:!0,k=await xe(r,s,a,(N,C,O)=>{var U;return(U=N.onActivitySnapshotEvent)==null?void 0:U.call(N,{event:m,messages:C,state:O,agent:n,input:e,activityMessage:E,existingMessage:S})});if(o(k),k.stopPropagation!==!0){let N={id:m.messageId,role:"activity",activityType:m.activityType,content:ve(m.content)},C;g===-1?(s.push(N),C=N):E?b&&(s[g]=gn(Ze({},E),{activityType:m.activityType,content:ve(m.content)})):b&&(s[g]=N,C=N),o({messages:s}),C&&await Promise.all(r.map(O=>{var U;return(U=O.onNewMessage)==null?void 0:U.call(O,{message:C,messages:s,state:a,agent:n,input:e})}))}return l()}case I.ACTIVITY_DELTA:{let m=u,g=s.findIndex(k=>k.id===m.messageId);if(g===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${m.messageId}' to apply patch`),l();let S=s[g];if(S.role!=="activity")return console.warn(`ACTIVITY_DELTA: Message '${m.messageId}' is not an activity message`),l();let E=S,b=await xe(r,s,a,(k,N,C)=>{var O;return(O=k.onActivityDeltaEvent)==null?void 0:O.call(k,{event:m,messages:N,state:C,agent:n,input:e,activityMessage:E})});if(o(b),b.stopPropagation!==!0)try{let k=ve((d=E.content)!=null?d:{}),N=or(k,(h=m.patch)!=null?h:[],!0,!1).newDocument;s[g]=gn(Ze({},E),{content:ve(N),activityType:m.activityType}),o({messages:s})}catch(k){let N=k instanceof Error?k.message:String(k);console.warn(`Failed to apply activity patch for '${m.messageId}': ${N}`)}return l()}case I.RAW:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onRawEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});return o(m),l()}case I.CUSTOM:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onCustomEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});return o(m),l()}case I.RUN_STARTED:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onRunStartedEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let g=u;if((f=g.input)!=null&&f.messages){for(let S of g.input.messages)s.find(E=>E.id===S.id)||s.push(S);o({messages:s})}}return l()}case I.RUN_FINISHED:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onRunFinishedEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e,result:u.result})});return o(m),l()}case I.RUN_ERROR:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onRunErrorEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});return o(m),l()}case I.STEP_STARTED:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onStepStartedEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});return o(m),l()}case I.STEP_FINISHED:{let m=await xe(r,s,a,(g,S,E)=>{var b;return(b=g.onStepFinishedEvent)==null?void 0:b.call(g,{event:u,messages:S,state:E,agent:n,input:e})});return o(m),l()}case I.TEXT_MESSAGE_CHUNK:throw new Error("TEXT_MESSAGE_CHUNK must be tranformed before being applied");case I.TOOL_CALL_CHUNK:throw new Error("TOOL_CALL_CHUNK must be tranformed before being applied");case I.THINKING_START:return l();case I.THINKING_END:return l();case I.THINKING_TEXT_MESSAGE_START:return l();case I.THINKING_TEXT_MESSAGE_CONTENT:return l();case I.THINKING_TEXT_MESSAGE_END:return l()}return u.type,l()}),Hp(),r.length>0?Zp({}):u=>u)},ja=e=>t=>{let n=new Map,r=new Map,s=!1,a=!1,i=!1,o=new Map,l=!1,u=!1,c=!1,d=()=>{n.clear(),r.clear(),o.clear(),l=!1,u=!1,s=!1,a=!1,c=!0};return t.pipe(pn(h=>{let f=h.type;if(e&&console.debug("[VERIFY]:",JSON.stringify(h)),a)return ke(()=>new Ie(`Cannot send event type '${f}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(s&&f!==I.RUN_ERROR&&f!==I.RUN_STARTED)return ke(()=>new Ie(`Cannot send event type '${f}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(i){if(f===I.RUN_STARTED){if(c&&!s)return ke(()=>new Ie("Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run."));s&&d()}}else if(i=!0,f!==I.RUN_STARTED&&f!==I.RUN_ERROR)return ke(()=>new Ie("First event must be 'RUN_STARTED'"));switch(f){case I.TEXT_MESSAGE_START:{let p=h.messageId;return n.has(p)?ke(()=>new Ie(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${p}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(p,!0),Oe(h))}case I.TEXT_MESSAGE_CONTENT:{let p=h.messageId;return n.has(p)?Oe(h):ke(()=>new Ie(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${p}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case I.TEXT_MESSAGE_END:{let p=h.messageId;return n.has(p)?(n.delete(p),Oe(h)):ke(()=>new Ie(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${p}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case I.TOOL_CALL_START:{let p=h.toolCallId;return r.has(p)?ke(()=>new Ie(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${p}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(r.set(p,!0),Oe(h))}case I.TOOL_CALL_ARGS:{let p=h.toolCallId;return r.has(p)?Oe(h):ke(()=>new Ie(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${p}'. Start a tool call with 'TOOL_CALL_START' first.`))}case I.TOOL_CALL_END:{let p=h.toolCallId;return r.has(p)?(r.delete(p),Oe(h)):ke(()=>new Ie(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${p}'. A 'TOOL_CALL_START' event must be sent first.`))}case I.STEP_STARTED:{let p=h.stepName;return o.has(p)?ke(()=>new Ie(`Step "${p}" is already active for 'STEP_STARTED'`)):(o.set(p,!0),Oe(h))}case I.STEP_FINISHED:{let p=h.stepName;return o.has(p)?(o.delete(p),Oe(h)):ke(()=>new Ie(`Cannot send 'STEP_FINISHED' for step "${p}" that was not started`))}case I.RUN_STARTED:return c=!0,Oe(h);case I.RUN_FINISHED:{if(o.size>0){let p=Array.from(o.keys()).join(", ");return ke(()=>new Ie(`Cannot send 'RUN_FINISHED' while steps are still active: ${p}`))}if(n.size>0){let p=Array.from(n.keys()).join(", ");return ke(()=>new Ie(`Cannot send 'RUN_FINISHED' while text messages are still active: ${p}`))}if(r.size>0){let p=Array.from(r.keys()).join(", ");return ke(()=>new Ie(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${p}`))}return s=!0,Oe(h)}case I.RUN_ERROR:return a=!0,Oe(h);case I.CUSTOM:return Oe(h);case I.THINKING_TEXT_MESSAGE_START:return l?u?ke(()=>new Ie("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.")):(u=!0,Oe(h)):ke(()=>new Ie("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first."));case I.THINKING_TEXT_MESSAGE_CONTENT:return u?Oe(h):ke(()=>new Ie("Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first."));case I.THINKING_TEXT_MESSAGE_END:return u?(u=!1,Oe(h)):ke(()=>new Ie("Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first."));case I.THINKING_START:return l?ke(()=>new Ie("Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.")):(l=!0,Oe(h));case I.THINKING_END:return l?(l=!1,Oe(h)):ke(()=>new Ie("Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first."));default:return Oe(h)}}))},xg=(e,t)=>Yp(()=>qs(fetch(e,t))).pipe(Kp(n=>{var r;if(!n.ok){let i=n.headers.get("content-type")||"";return qs(n.text()).pipe(pn(o=>{let l=o;if(i.includes("application/json"))try{l=JSON.parse(o)}catch{}let u=new Error(`HTTP ${n.status}: ${typeof l=="string"?l:JSON.stringify(l)}`);return u.status=n.status,u.payload=l,ke(()=>u)}))}let s={type:"headers",status:n.status,headers:n.headers},a=(r=n.body)==null?void 0:r.getReader();return a?new tt(i=>(i.next(s),(async()=>{try{for(;;){let{done:o,value:l}=await a.read();if(o)break;let u={type:"data",data:l};i.next(u)}i.complete()}catch(o){i.error(o)}})(),()=>{a.cancel().catch(o=>{if(o?.name!=="AbortError")throw o})})):ke(()=>new Error("Failed to getReader() from response"))})),Tg=e=>{let t=new $n,n=new TextDecoder("utf-8",{fatal:!1}),r="";e.subscribe({next:a=>{if(a.type!=="headers"&&a.type==="data"&&a.data){let i=n.decode(a.data,{stream:!0});r+=i;let o=r.split(/\n\n/);r=o.pop()||"";for(let l of o)s(l)}},error:a=>t.error(a),complete:()=>{r&&(r+=n.decode(),s(r)),t.complete()}});function s(a){let i=a.split(`
`),o=[];for(let l of i)l.startsWith("data: ")&&o.push(l.slice(6));if(o.length>0)try{let l=o.join(`
`),u=JSON.parse(l);t.next(u)}catch(l){t.error(l)}}return t.asObservable()},Ag=e=>{let t=new $n,n=new Uint8Array(0);e.subscribe({next:s=>{if(s.type!=="headers"&&s.type==="data"&&s.data){let a=new Uint8Array(n.length+s.data.length);a.set(n,0),a.set(s.data,n.length),n=a,r()}},error:s=>t.error(s),complete:()=>{if(n.length>0)try{r()}catch{console.warn("Incomplete or invalid protocol buffer data at stream end")}t.complete()}});function r(){for(;n.length>=4;){let s=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<s)break;try{let a=n.slice(4,s),i=hg(a);t.next(i),n=n.slice(s)}catch(a){let i=a instanceof Error?a.message:String(a);t.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return t.asObservable()},Ig=e=>{let t=new $n,n=new Dc,r=!1;return e.subscribe({next:s=>{n.next(s),s.type==="headers"&&!r?(r=!0,s.headers.get("content-type")===pg?Ag(n).subscribe({next:a=>t.next(a),error:a=>t.error(a),complete:()=>t.complete()}):Tg(n).subscribe({next:a=>{try{let i=hc.parse(a);t.next(i)}catch(i){t.error(i)}},error:a=>{if(a?.name==="AbortError"){t.next({type:I.RUN_ERROR,rawEvent:a}),t.complete();return}return t.error(a)},complete:()=>t.complete()})):r||t.error(new Error("No headers event received before data events"))},error:s=>{n.error(s),t.error(s)},complete:()=>{n.complete()}}),t.asObservable()},_e=lc(["TextMessageStart","TextMessageContent","TextMessageEnd","ActionExecutionStart","ActionExecutionArgs","ActionExecutionEnd","ActionExecutionResult","AgentStateMessage","MetaEvent","RunStarted","RunFinished","RunError","NodeStarted","NodeFinished"]),Cg=lc(["LangGraphInterruptEvent","PredictState","Exit"]),Ng=Se({type:q(_e.enum.TextMessageStart),messageId:M(),parentMessageId:M().optional(),role:M().optional()}),Rg=Se({type:q(_e.enum.TextMessageContent),messageId:M(),content:M()}),Og=Se({type:q(_e.enum.TextMessageEnd),messageId:M()}),Mg=Se({type:q(_e.enum.ActionExecutionStart),actionExecutionId:M(),actionName:M(),parentMessageId:M().optional()}),Pg=Se({type:q(_e.enum.ActionExecutionArgs),actionExecutionId:M(),args:M()}),Lg=Se({type:q(_e.enum.ActionExecutionEnd),actionExecutionId:M()}),Dg=Se({type:q(_e.enum.ActionExecutionResult),actionName:M(),actionExecutionId:M(),result:M()}),$g=Se({type:q(_e.enum.AgentStateMessage),threadId:M(),agentName:M(),nodeName:M(),runId:M(),active:oi(),role:M(),state:M(),running:oi()}),Ug=Se({type:q(_e.enum.MetaEvent),name:Cg,value:et()}),zg=Se({type:q(_e.enum.RunError),message:M(),code:M().optional()});sa("type",[Ng,Rg,Og,Mg,Pg,Lg,Dg,$g,Ug,zg]);Se({id:M(),role:M(),content:M(),parentMessageId:M().optional()});Se({id:M(),name:M(),arguments:et(),parentMessageId:M().optional()});Se({id:M(),result:et(),actionExecutionId:M(),actionName:M()});var jg=e=>{if(typeof e=="string")return e;if(!Array.isArray(e))return;let t=e.filter(n=>n.type==="text").map(n=>n.text).filter(n=>n.length>0);if(t.length!==0)return t.join(`
`)},Bg=(e,t,n)=>r=>{let s={},a=!0,i=!0,o="",l=null,u=null,c=[],d={},h=f=>{typeof f=="object"&&f!==null&&("messages"in f&&delete f.messages,s=f)};return r.pipe(pn(f=>{switch(f.type){case I.TEXT_MESSAGE_START:{let p=f;return[{type:_e.enum.TextMessageStart,messageId:p.messageId,role:p.role}]}case I.TEXT_MESSAGE_CONTENT:{let p=f;return[{type:_e.enum.TextMessageContent,messageId:p.messageId,content:p.delta}]}case I.TEXT_MESSAGE_END:{let p=f;return[{type:_e.enum.TextMessageEnd,messageId:p.messageId}]}case I.TOOL_CALL_START:{let p=f;return c.push({id:p.toolCallId,type:"function",function:{name:p.toolCallName,arguments:""}}),i=!0,d[p.toolCallId]=p.toolCallName,[{type:_e.enum.ActionExecutionStart,actionExecutionId:p.toolCallId,actionName:p.toolCallName,parentMessageId:p.parentMessageId}]}case I.TOOL_CALL_ARGS:{let p=f,m=c.find(S=>S.id===p.toolCallId);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${p.toolCallId}'`),[];m.function.arguments+=p.delta;let g=!1;if(u){let S=u.find(E=>E.tool==m.function.name);if(S)try{let E=JSON.parse($c(m.function.arguments));S.tool_argument&&S.tool_argument in E?(h(gn(Ze({},s),{[S.state_key]:E[S.tool_argument]})),g=!0):S.tool_argument||(h(gn(Ze({},s),{[S.state_key]:E})),g=!0)}catch{}}return[{type:_e.enum.ActionExecutionArgs,actionExecutionId:p.toolCallId,args:p.delta},...g?[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]:[]]}case I.TOOL_CALL_END:{let p=f;return[{type:_e.enum.ActionExecutionEnd,actionExecutionId:p.toolCallId}]}case I.TOOL_CALL_RESULT:{let p=f;return[{type:_e.enum.ActionExecutionResult,actionExecutionId:p.toolCallId,result:p.content,actionName:d[p.toolCallId]||"unknown"}]}case I.RAW:return[];case I.CUSTOM:{let p=f;switch(p.name){case"Exit":a=!1;break;case"PredictState":u=p.value;break}return[{type:_e.enum.MetaEvent,name:p.name,value:p.value}]}case I.STATE_SNAPSHOT:return h(f.snapshot),[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}];case I.STATE_DELTA:{let p=or(s,f.delta,!0,!1);return p?(h(p.newDocument),[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]):[]}case I.MESSAGES_SNAPSHOT:return l=f.messages,[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(Ze(Ze({},s),l?{messages:l}:{})),active:!0}];case I.RUN_STARTED:return[];case I.RUN_FINISHED:return l&&(s.messages=l),Object.keys(s).length===0?[]:[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(Ze(Ze({},s),l?{messages:Gg(l)}:{})),active:!1}];case I.RUN_ERROR:{let p=f;return[{type:_e.enum.RunError,message:p.message,code:p.code}]}case I.STEP_STARTED:return o=f.stepName,c=[],u=null,[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!0}];case I.STEP_FINISHED:return c=[],u=null,[{type:_e.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!1}];default:return[]}}))};function Gg(e){var t;let n=[];for(let r of e)if(r.role==="assistant"||r.role==="user"||r.role==="system"){let s=jg(r.content);if(s){let a={id:r.id,role:r.role,content:s};n.push(a)}if(r.role==="assistant"&&r.toolCalls&&r.toolCalls.length>0)for(let a of r.toolCalls){let i={id:a.id,name:a.function.name,arguments:JSON.parse(a.function.arguments),parentMessageId:r.id};n.push(i)}}else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"&&(t=i.toolCalls)!=null&&t.length){for(let o of i.toolCalls)if(o.id===r.toolCallId){s=o.function.name;break}}let a={id:r.id,result:r.content,actionExecutionId:r.toolCallId,actionName:s};n.push(a)}return n}var Cs=e=>t=>{let n,r,s,a=()=>{if(!n||s!=="text")throw new Error("No text message to close");let l={type:I.TEXT_MESSAGE_END,messageId:n.messageId};return s=void 0,n=void 0,e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_END",JSON.stringify(l)),l},i=()=>{if(!r||s!=="tool")throw new Error("No tool call to close");let l={type:I.TOOL_CALL_END,toolCallId:r.toolCallId};return s=void 0,r=void 0,e&&console.debug("[TRANSFORM]: TOOL_CALL_END",JSON.stringify(l)),l},o=()=>s==="text"?[a()]:s==="tool"?[i()]:[];return t.pipe(pn(l=>{switch(l.type){case I.TEXT_MESSAGE_START:case I.TEXT_MESSAGE_CONTENT:case I.TEXT_MESSAGE_END:case I.TOOL_CALL_START:case I.TOOL_CALL_ARGS:case I.TOOL_CALL_END:case I.TOOL_CALL_RESULT:case I.STATE_SNAPSHOT:case I.STATE_DELTA:case I.MESSAGES_SNAPSHOT:case I.CUSTOM:case I.RUN_STARTED:case I.RUN_FINISHED:case I.RUN_ERROR:case I.STEP_STARTED:case I.STEP_FINISHED:case I.THINKING_START:case I.THINKING_END:case I.THINKING_TEXT_MESSAGE_START:case I.THINKING_TEXT_MESSAGE_CONTENT:case I.THINKING_TEXT_MESSAGE_END:return[...o(),l];case I.RAW:case I.ACTIVITY_SNAPSHOT:case I.ACTIVITY_DELTA:return[l];case I.TEXT_MESSAGE_CHUNK:let u=l,c=[];if((s!=="text"||u.messageId!==void 0&&u.messageId!==n?.messageId)&&c.push(...o()),s!=="text"){if(u.messageId===void 0)throw new Error("First TEXT_MESSAGE_CHUNK must have a messageId");n={messageId:u.messageId},s="text";let f={type:I.TEXT_MESSAGE_START,messageId:u.messageId,role:u.role||"assistant"};c.push(f),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_START",JSON.stringify(f))}if(u.delta!==void 0){let f={type:I.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:u.delta};c.push(f),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_CONTENT",JSON.stringify(f))}return c;case I.TOOL_CALL_CHUNK:let d=l,h=[];if((s!=="tool"||d.toolCallId!==void 0&&d.toolCallId!==r?.toolCallId)&&h.push(...o()),s!=="tool"){if(d.toolCallId===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallId");if(d.toolCallName===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallName");r={toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId},s="tool";let f={type:I.TOOL_CALL_START,toolCallId:d.toolCallId,toolCallName:d.toolCallName,parentMessageId:d.parentMessageId};h.push(f),e&&console.debug("[TRANSFORM]: TOOL_CALL_START",JSON.stringify(f))}if(d.delta!==void 0){let f={type:I.TOOL_CALL_ARGS,toolCallId:r.toolCallId,delta:d.delta};h.push(f),e&&console.debug("[TRANSFORM]: TOOL_CALL_ARGS",JSON.stringify(f))}return h}return l.type,[]}),gi(()=>{o()}))},Zc=class{runNext(t,n){return n.run(t).pipe(Cs(!1))}runNextWithState(t,n){let r=ve(t.messages||[]),s=ve(t.state||{}),a=new Dc;return qc(t,a,n,[]).subscribe(i=>{i.messages!==void 0&&(r=i.messages),i.state!==void 0&&(s=i.state)}),this.runNext(t,n).pipe(Pc(async i=>(a.next(i),await new Promise(o=>setTimeout(o,0)),{event:i,messages:ve(r),state:ve(s)})))}},Fg=class extends Zc{constructor(t){super(),this.fn=t}run(t,n){return this.fn(t,n)}};function Vg(e){let t=e.content;if(Array.isArray(t)){let n=t.filter(r=>typeof r=="object"&&r!==null&&"type"in r&&r.type==="text"&&typeof r.text=="string").map(r=>r.text).join("");return gn(Ze({},e),{content:n})}return typeof t=="string"?e:gn(Ze({},e),{content:""})}var Hg=class extends Zc{run(t,n){let r=t,{parentRunId:s}=r,a=kg(r,["parentRunId"]),i=gn(Ze({},a),{messages:a.messages.map(Vg)});return this.runNext(i,n)}},qg={version:"0.0.42"},Zg=class{constructor({agentId:t,description:n,threadId:r,initialMessages:s,initialState:a,debug:i}={}){this.debug=!1,this.subscribers=[],this.isRunning=!1,this.middlewares=[],this.agentId=t,this.description=n??"",this.threadId=r??Er(),this.messages=ve(s??[]),this.state=ve(a??{}),this.debug=i??!1,yg(this.maxVersion,"0.0.39")<=0&&this.middlewares.unshift(new Hg)}get maxVersion(){return qg.version}subscribe(t){return this.subscribers.push(t),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==t)}}}use(...t){let n=t.map(r=>typeof r=="function"?new Fg(r):r);return this.middlewares.push(...n),this}async runAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:Er();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(d=>d.id)),o=[{onRunFinishedEvent:d=>{a=d.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new $n;let l;this.activeRunCompletionPromise=new Promise(d=>{l=d});let u=$o(()=>this.middlewares.length===0?this.run(s):this.middlewares.reduceRight((d,h)=>({run:f=>h.run(f,d)}),this).run(s),Cs(this.debug),ja(this.debug),d=>d.pipe(jo(this.activeRunDetach$)),d=>this.apply(s,d,o),d=>this.processApplyEvents(s,d,o),hi(d=>(this.isRunning=!1,this.onError(s,d,o))),gi(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await Bo(u(Oe(null)));let c=ve(this.messages).filter(d=>!i.has(d.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}connect(t){throw new Lo}async connectAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:Er();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(d=>d.id)),o=[{onRunFinishedEvent:d=>{a=d.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new $n;let l;this.activeRunCompletionPromise=new Promise(d=>{l=d});let u=$o(()=>this.connect(s),Cs(this.debug),ja(this.debug),d=>d.pipe(jo(this.activeRunDetach$)),d=>this.apply(s,d,o),d=>this.processApplyEvents(s,d,o),hi(d=>(this.isRunning=!1,d instanceof Lo?Lc:this.onError(s,d,o))),gi(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await Bo(u(Oe(null)));let c=ve(this.messages).filter(d=>!i.has(d.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}abortRun(){}async detachActiveRun(){var t,n;if(!this.activeRunDetach$)return;let r=(t=this.activeRunCompletionPromise)!=null?t:Promise.resolve();this.activeRunDetach$.next(),(n=this.activeRunDetach$)==null||n.complete(),await r}apply(t,n,r){return qc(t,n,this,r)}processApplyEvents(t,n,r){return n.pipe(Jp(s=>{s.messages&&(this.messages=s.messages,r.forEach(a=>{var i;(i=a.onMessagesChanged)==null||i.call(a,{messages:this.messages,state:this.state,agent:this,input:t})})),s.state&&(this.state=s.state,r.forEach(a=>{var i;(i=a.onStateChanged)==null||i.call(a,{state:this.state,messages:this.messages,agent:this,input:t})}))}))}prepareRunAgentInput(t){var n,r,s;let a=ve(this.messages).filter(i=>i.role!=="activity");return{threadId:this.threadId,runId:t?.runId||Er(),tools:ve((n=t?.tools)!=null?n:[]),context:ve((r=t?.context)!=null?r:[]),forwardedProps:ve((s=t?.forwardedProps)!=null?s:{}),state:ve(this.state),messages:a}}async onInitialize(t,n){let r=await xe(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunInitialized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages&&(this.messages=r.messages,t.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state&&(this.state=r.state,t.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}onError(t,n,r){return qs(xe(r,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFailed)==null?void 0:o.call(s,{error:n,messages:a,state:i,agent:this,input:t})})).pipe(pi(s=>{let a=s;if((a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,r.forEach(i=>{var o;(o=i.onMessagesChanged)==null||o.call(i,{messages:this.messages,state:this.state,agent:this,input:t})})),a.state!==void 0&&(this.state=a.state,r.forEach(i=>{var o;(o=i.onStateChanged)==null||o.call(i,{state:this.state,messages:this.messages,agent:this,input:t})}))),a.stopPropagation!==!0)throw console.error("Agent execution failed:",n),n;return{}}))}async onFinalize(t,n){let r=await xe(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFinalized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages!==void 0&&(this.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state!==void 0&&(this.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}clone(){let t=Object.create(Object.getPrototypeOf(this));return t.agentId=this.agentId,t.description=this.description,t.threadId=this.threadId,t.messages=ve(this.messages),t.state=ve(this.state),t.debug=this.debug,t.isRunning=this.isRunning,t.subscribers=[...this.subscribers],t.middlewares=[...this.middlewares],t}addMessage(t){this.messages.push(t),(async()=>{var n,r,s;for(let a of this.subscribers)await((n=a.onNewMessage)==null?void 0:n.call(a,{message:t,messages:this.messages,state:this.state,agent:this}));if(t.role==="assistant"&&t.toolCalls)for(let a of t.toolCalls)for(let i of this.subscribers)await((r=i.onNewToolCall)==null?void 0:r.call(i,{toolCall:a,messages:this.messages,state:this.state,agent:this}));for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(t){this.messages.push(...t),(async()=>{var n,r,s;for(let a of t){for(let i of this.subscribers)await((n=i.onNewMessage)==null?void 0:n.call(i,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role==="assistant"&&a.toolCalls)for(let i of a.toolCalls)for(let o of this.subscribers)await((r=o.onNewToolCall)==null?void 0:r.call(o,{toolCall:i,messages:this.messages,state:this.state,agent:this}))}for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(t){this.messages=ve(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onMessagesChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}setState(t){this.state=ve(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onStateChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(t){var n;this.agentId=(n=this.agentId)!=null?n:Er();let r=this.prepareRunAgentInput(t);return(this.middlewares.length===0?this.run(r):this.middlewares.reduceRight((s,a)=>({run:i=>a.run(i,s)}),this).run(r)).pipe(Cs(this.debug),ja(this.debug),Bg(this.threadId,r.runId,this.agentId),s=>s.pipe(pi(a=>(this.debug&&console.debug("[LEGACY]:",JSON.stringify(a)),a))))}},Al=class extends Zg{constructor(e){var t;super(e),this.abortController=new AbortController,this.url=e.url,this.headers=ve((t=e.headers)!=null?t:{})}requestInit(e){return{method:"POST",headers:gn(Ze({},this.headers),{"Content-Type":"application/json",Accept:"text/event-stream"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,t){var n;return this.abortController=(n=e?.abortController)!=null?n:new AbortController,super.runAgent(e,t)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let t=xg(this.url,this.requestInit(e));return Ig(t)}clone(){var e;let t=super.clone();t.url=this.url,t.headers=ve((e=this.headers)!=null?e:{});let n=new AbortController,r=this.abortController.signal;return r.aborted&&n.abort(r.reason),t.abortController=n,t}};class Xg{constructor(t){this.stores=t}eventSource=null;agentMsgId=null;aguiSubscription=null;aguiMessageMap=new Map;aguiMappedPlaceholder=!1;aguiRunId=null;aguiSessionId=null;aguiCompleted=!1;aguiToolCalls=new Map;start(t,n,r,s,a,i="sse"){if(this.close(),i==="agui"){this.startAgui(t,n,r,s,a);return}const o=this.stores.chatStore.addAgentMessage();this.agentMsgId=o.id;const l=new URL("/chat/stream",window.location.origin);l.searchParams.set("query",t),l.searchParams.set("session_id",n),Object.keys(r).length&&l.searchParams.set("tool_context",JSON.stringify(r)),Object.keys(s).length&&l.searchParams.set("llm_context",JSON.stringify(s)),this.eventSource=new EventSource(l.toString()),["chunk","artifact_chunk","artifact_stored","llm_stream_chunk","step","event","done","error"].forEach(c=>{this.eventSource.addEventListener(c,d=>{this.handleEvent(c,d,a)})}),this.eventSource.onerror=()=>{const c=this.findAgentMsg();c&&this.stores.chatStore.updateMessage(c.id,{isStreaming:!1}),a.onError("Connection lost"),this.close()}}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.agentMsgId=null,this.aguiSubscription&&(this.aguiSubscription.unsubscribe(),this.aguiSubscription=null),this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1,this.aguiToolCalls.clear()}findAgentMsg(){return this.agentMsgId?this.stores.chatStore.findMessage(this.agentMsgId):void 0}handleEvent(t,n,r){const s=Bu(n.data);if(!s)return;const a=this.findAgentMsg();if(a)switch(t){case"chunk":case"llm_stream_chunk":this.handleChunk(a,s,t);break;case"artifact_chunk":this.handleArtifactChunk(s);break;case"artifact_stored":this.handleArtifactStored(s);break;case"step":case"event":this.handleStepEvent(a,s,t);break;case"done":this.handleDone(a,s,r);break;case"error":this.handleError(a,s,r);break}}handleChunk(t,n,r){const s=n.channel??"thinking",a=n.phase??(r==="chunk"?"observation":void 0),i=n.text??"",o=!!n.done;if(s==="thinking"&&a==="action"){this.stores.chatStore.updateMessage(t.id,{isThinking:!o});return}if(s==="thinking"){i?this.stores.chatStore.updateMessage(t.id,{observations:`${t.observations??""}${i}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(t.id,{isThinking:!1});return}if(s==="revision"){const l={isThinking:!1,isStreaming:!0};t.revisionStreamActive||(l.revisionStreamActive=!0,l.text=""),i&&(l.text=`${t.revisionStreamActive?t.text:""}${i}`),this.stores.chatStore.updateMessage(t.id,l);return}if(s==="answer"){const l=t.answerActionSeq??Xn,u=n.action_seq;if(l===Xn){this.stores.chatStore.updateMessage(t.id,{answerStreamDone:o,isStreaming:!o,isThinking:!1});return}if(u!==void 0&&u!==l){this.stores.chatStore.updateMessage(t.id,{isThinking:!1});return}const c={isThinking:!1,isStreaming:!o};i&&(c.text=`${t.text}${i}`),o&&(c.answerStreamDone=!0),this.stores.chatStore.updateMessage(t.id,c);return}i?this.stores.chatStore.updateMessage(t.id,{observations:`${t.observations??""}${i}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(t.id,{isThinking:!1})}handleArtifactChunk(t){const n=Il(t);if(n.artifact_type==="ui_component"){this.stores.interactionsStore.addArtifactChunk(n,{message_id:this.agentMsgId??void 0}),this.stores.eventsStore.addEvent(t,"artifact_chunk");return}const r=n.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(r,n.chunk),this.stores.eventsStore.addEvent(t,"artifact_chunk")}handleArtifactStored(t){const n=Kg(t);n&&this.stores.artifactsStore.addArtifact(n),this.stores.eventsStore.addEvent(t,"artifact_stored")}handleStepEvent(t,n,r){const s=n.event;if(s==="step_start"){const a=n.action_seq;this.stores.chatStore.updateMessage(t.id,{answerActionSeq:typeof a=="number"?a:Xn})}if(s==="tool_call_start"){const a=n.tool_call_id,i=n.tool_name,o=n.args_json;a&&i&&this.handleInteractiveToolCall(a,i,o??"",this.agentMsgId??void 0)}this.stores.eventsStore.addEvent(n,r)}handleDone(t,n,r){const s=n.pause,a=n.trace_id??null;if(s){this.handlePause(t,n,s,a,r);return}const i=n.answer_action_seq,o=t.answerActionSeq??Xn;o!==Xn&&(i===void 0||i===o)&&n.answer&&typeof n.answer=="string"&&this.stores.chatStore.updateMessage(t.id,{text:n.answer}),this.stores.chatStore.updateMessage(t.id,{isStreaming:!1,isThinking:!1}),r.onDone(a),this.close()}handlePause(t,n,r,s,a){const i=ln(r.payload)??{},o=Te(i.auth_url)||Te(i.url)||"",l=Te(i.provider)||"",u=Te(r.reason)||"pause",c=Te(r.resume_token);c&&this.stores.interactionsStore.updatePendingInteraction({resume_token:c});let d=`Planner paused (${u})`;l&&(d+=` for ${l}`),o&&(d+=`
[Open auth link](${o})`),c&&(d+=`
Resume token: \`${c}\``),this.stores.chatStore.updateMessage(t.id,{pause:{reason:u,payload:i,resume_token:c},traceId:s??void 0,text:d,isStreaming:!1,isThinking:!1}),a.onDone(s),this.close()}handleError(t,n,r){const s=n.error??"Unexpected error";this.stores.chatStore.updateMessage(t.id,{text:s,isStreaming:!1,isThinking:!1}),r.onError(s),this.close()}handleInteractiveToolCall(t,n,r,s){const a=this.mapInteractiveComponent(n);if(!a)return;let i={};if(r)try{const o=JSON.parse(r);o&&typeof o=="object"&&(i=o)}catch{i={}}this.stores.interactionsStore.setPendingInteraction({tool_call_id:t,tool_name:n,component:a,props:i,message_id:s,created_at:Date.now()})}mapInteractiveComponent(t){return t==="ui_form"?"form":t==="ui_confirm"?"confirm":t==="ui_select_option"?"select_option":null}startAgui(t,n,r,s,a){const i=this.buildHistory();!i.some(f=>f.role==="user"&&this.hasTextContent(f.content))&&t.trim()&&i.push({id:`msg_${Date.now()}`,role:"user",content:t});const l=this.stores.chatStore.addAgentMessage();this.agentMsgId=l.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const u=new URL("/agui/agent",window.location.origin),c={threadId:n,runId:`run_${Date.now()}`,messages:i,tools:[],context:[],state:{},forwardedProps:{penguiflow:{llm_context:s,tool_context:r}}};this.aguiRunId=c.runId,this.aguiSessionId=n,console.log("[AG-UI] Sending request:",JSON.stringify(c,null,2));const h=new Al({url:u.toString()}).run(c);this.aguiSubscription=h.subscribe({next:f=>this.handleAguiEvent(f,a),error:f=>{const p=this.findAgentMsg();p&&this.stores.chatStore.updateMessage(p.id,{isStreaming:!1}),a.onError(f.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}resumeAgui(t,n,r,s,a){if(!t.resume_token){a.onError("Resume token missing");return}this.close();const i=this.stores.chatStore.addAgentMessage();this.agentMsgId=i.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const o=new URL("/agui/resume",window.location.origin),l={resume_token:t.resume_token,thread_id:r,run_id:`run_${Date.now()}`,tool_name:t.tool_name,component:t.component,result:n,tool_context:s};this.aguiRunId=l.run_id,this.aguiSessionId=r;const c=new Al({url:o.toString()}).run(l);this.aguiSubscription=c.subscribe({next:d=>this.handleAguiEvent(d,a),error:d=>{const h=this.findAgentMsg();h&&this.stores.chatStore.updateMessage(h.id,{isStreaming:!1}),a.onError(d.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}handleAguiEvent(t,n){const r=t;switch(console.log("[AG-UI] Received event:",r.type,r),r.type){case I.RUN_STARTED:{const s=r;this.aguiRunId=s.runId??this.aguiRunId;return}case I.RUN_FINISHED:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onDone(s.runId??this.aguiRunId),this.aguiCompleted=!0;return}case I.RUN_ERROR:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onError(s.message||"Run error"),this.aguiCompleted=!0;return}case I.TEXT_MESSAGE_START:{const s=r;if(s.role!=="assistant")return;this.ensureAguiMessage(s.messageId);return}case I.TEXT_MESSAGE_CONTENT:{const s=r,a=this.ensureAguiMessage(s.messageId),i=this.stores.chatStore.findMessage(a);i&&s.delta&&this.stores.chatStore.updateMessage(i.id,{text:`${i.text}${s.delta}`,isStreaming:!0});return}case I.TEXT_MESSAGE_END:{const s=r,a=this.ensureAguiMessage(s.messageId);this.stores.chatStore.updateMessage(a,{isStreaming:!1});return}case I.TOOL_CALL_START:{const s=r,a=s.toolCallId,i=s.toolCallName,o=s.parentMessageId,l=o?this.ensureAguiMessage(o):this.agentMsgId??void 0;this.aguiToolCalls.set(a,{name:i,args:"",messageId:l}),this.stores.eventsStore.addEvent({tool_call_id:a,tool_call_name:i},"tool_call_start");return}case I.TOOL_CALL_ARGS:{const s=r,a=s.toolCallId,i=this.aguiToolCalls.get(a);i&&(i.args+=s.delta??""),this.stores.eventsStore.addEvent({tool_call_id:a,delta:s.delta},"tool_call_args");return}case I.TOOL_CALL_END:{const a=r.toolCallId,i=this.aguiToolCalls.get(a);i&&(this.handleInteractiveToolCall(a,i.name,i.args,i.messageId),this.aguiToolCalls.delete(a)),this.stores.eventsStore.addEvent({tool_call_id:a},"tool_call_end");return}case I.TOOL_CALL_RESULT:{const s=r,a=s.toolCallId;this.stores.eventsStore.addEvent({tool_call_id:a,content:s.content},"tool_call_result");return}case I.CUSTOM:{const s=r,a=s.name,i=s.value,o=ln(i);if(a==="artifact_stored"&&o){const u=ln(o.artifact),c=u?Jg(u,this.aguiRunId,this.aguiSessionId):null;c&&this.stores.artifactsStore.addArtifact(c)}if(a==="artifact_chunk"&&o){const u=Il(o);if(u.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(u,{message_id:this.agentMsgId??void 0});else{const c=u.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(c,u.chunk)}}if(a==="thinking"&&o){const u=this.findAgentMsg();if(u){const c=Te(o.text)??"";Te(o.phase)==="action"?this.stores.chatStore.updateMessage(u.id,{isThinking:!0}):c&&this.stores.chatStore.updateMessage(u.id,{observations:`${u.observations??""}${c}`,showObservations:!0,isThinking:!1})}}if(a==="revision"&&o){const u=this.findAgentMsg();if(u){const c=Te(o.text)??"",h={isThinking:!1,isStreaming:!(Xc(o.done)??!1)};u.revisionStreamActive||(h.revisionStreamActive=!0,h.text=""),c&&(h.text=`${u.revisionStreamActive?u.text:""}${c}`),this.stores.chatStore.updateMessage(u.id,h)}}if(a==="pause"&&o){const u=this.findAgentMsg();u&&this.handlePause(u,{},o,this.aguiRunId,n);const c=ln(o.payload),d=c?Te(c.component):void 0,h=c?ln(c.props):void 0;c&&d&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Te(c.tool)??"ui_pause",component:d,props:h,message_id:this.agentMsgId??void 0,resume_token:Te(o.resume_token),created_at:Date.now()}):Te(o.resume_token)&&this.stores.interactionsStore.updatePendingInteraction({resume_token:Te(o.resume_token)}),this.aguiCompleted=!0}const l=o??{value:i};this.stores.eventsStore.addEvent(l,a);return}default:return}}ensureAguiMessage(t){const n=this.aguiMessageMap.get(t);if(n)return n;if(!this.aguiMappedPlaceholder&&this.agentMsgId)return this.aguiMappedPlaceholder=!0,this.aguiMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.aguiMessageMap.set(t,r.id),r.id}buildHistory(){console.log("[AG-UI] Building history from this.stores.chatStore.messages:",this.stores.chatStore.messages.length,"messages");const t=this.stores.chatStore.messages.filter(n=>n.role==="user"||n.role==="agent").map(n=>({id:n.id,role:n.role==="agent"?"assistant":"user",content:n.text}));return console.log("[AG-UI] Built history:",t),t}hasTextContent(t){return typeof t=="string"?t.trim().length>0:Array.isArray(t)?t.some(n=>typeof n=="object"&&n!==null&&"text"in n):!1}}function ln(e){return!e||typeof e!="object"||Array.isArray(e)?null:e}function Te(e){return typeof e=="string"?e:void 0}function Gr(e){return typeof e=="number"?e:void 0}function Xc(e){return typeof e=="boolean"?e:void 0}function Il(e){return{stream_id:Te(e.stream_id),seq:Gr(e.seq),done:Xc(e.done),artifact_type:Te(e.artifact_type),chunk:e.chunk,meta:ln(e.meta)??void 0,ts:Gr(e.ts)}}function Kg(e){const t=Te(e.artifact_id),n=Te(e.mime_type),r=Gr(e.size_bytes),s=Te(e.filename),a=Te(e.trace_id),i=Te(e.session_id),o=Gr(e.ts);return!t||!n||r===void 0||!s||!a||!i||o===void 0?null:{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:ln(e.source)??{},trace_id:a,session_id:i,ts:o}}function Jg(e,t,n){if(!t||!n)return null;const r=Te(e.id),s=Te(e.mime_type),a=Gr(e.size_bytes),i=Te(e.filename);return!r||!s||a===void 0||!i?null:{artifact_id:r,mime_type:s,size_bytes:a,filename:i,source:ln(e.source)??{},trace_id:t,session_id:n,ts:Date.now()}}function Yg(e){return new Xg(e)}class Wg{constructor(t){this.stores=t}eventSource=null;start(t,n){this.close();const r=new URL("/events",window.location.origin);r.searchParams.set("trace_id",t),r.searchParams.set("session_id",n),r.searchParams.set("follow","true"),this.eventSource=new EventSource(r.toString());const s=a=>{const i=Bu(a.data);if(!i)return;const o=a.type||i.event||"";if(this.stores.eventsStore.shouldProcess(o)){if(o==="artifact_chunk"){const l=Qg(i);if(l.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(l,{});else{const u=l.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(u,l.chunk)}}if(o==="artifact_stored"){const l=em(i);l&&this.stores.artifactsStore.addArtifact(l)}o!=="llm_stream_chunk"&&this.stores.eventsStore.addEvent(i,o||"event")}};["event","step","chunk","llm_stream_chunk","artifact_chunk","artifact_stored"].forEach(a=>{this.eventSource.addEventListener(a,s)}),this.eventSource.onmessage=s,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}}function Qg(e){const t=e.meta;return{stream_id:typeof e.stream_id=="string"?e.stream_id:void 0,seq:typeof e.seq=="number"?e.seq:void 0,done:typeof e.done=="boolean"?e.done:void 0,artifact_type:typeof e.artifact_type=="string"?e.artifact_type:void 0,chunk:e.chunk,meta:t&&typeof t=="object"&&!Array.isArray(t)?t:void 0,ts:typeof e.ts=="number"?e.ts:void 0}}function em(e){const t=typeof e.artifact_id=="string"?e.artifact_id:null,n=typeof e.mime_type=="string"?e.mime_type:null,r=typeof e.size_bytes=="number"?e.size_bytes:null,s=typeof e.filename=="string"?e.filename:null,a=typeof e.trace_id=="string"?e.trace_id:null,i=typeof e.session_id=="string"?e.session_id:null,o=typeof e.ts=="number"?e.ts:null;if(!t||!n||r===null||!s||!a||!i||o===null)return null;const l=e.source;return{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:l&&typeof l=="object"&&!Array.isArray(l)?l:{},trace_id:a,session_id:i,ts:o}}function tm(e){return new Wg(e)}function Zi(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Fn=Zi();function Kc(e){Fn=e}var Mr={exec:()=>null};function ie(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(We.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}var nm=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),We={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},rm=/^(?:[ \t]*(?:\n|$))+/,sm=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,am=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Kr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,im=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Xi=/(?:[*+-]|\d{1,9}[.)])/,Jc=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Yc=ie(Jc).replace(/bull/g,Xi).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),om=ie(Jc).replace(/bull/g,Xi).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ki=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,lm=/^[^\n]+/,Ji=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,um=ie(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ji).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),cm=ie(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Xi).getRegex(),oa="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Yi=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,dm=ie("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Yi).replace("tag",oa).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Wc=ie(Ki).replace("hr",Kr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oa).getRegex(),fm=ie(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Wc).getRegex(),Wi={blockquote:fm,code:sm,def:um,fences:am,heading:im,hr:Kr,html:dm,lheading:Yc,list:cm,newline:rm,paragraph:Wc,table:Mr,text:lm},Cl=ie("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Kr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oa).getRegex(),vm={...Wi,lheading:om,table:Cl,paragraph:ie(Ki).replace("hr",Kr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Cl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oa).getRegex()},hm={...Wi,html:ie(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Yi).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Mr,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ie(Ki).replace("hr",Kr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Yc).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},pm=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,gm=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Qc=/^( {2,}|\\)\n(?!\s*$)/,mm=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,la=/[\p{P}\p{S}]/u,Qi=/[\s\p{P}\p{S}]/u,ed=/[^\s\p{P}\p{S}]/u,_m=ie(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Qi).getRegex(),td=/(?!~)[\p{P}\p{S}]/u,ym=/(?!~)[\s\p{P}\p{S}]/u,bm=/(?:[^\s\p{P}\p{S}]|~)/u,wm=ie(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",nm?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),nd=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Sm=ie(nd,"u").replace(/punct/g,la).getRegex(),Em=ie(nd,"u").replace(/punct/g,td).getRegex(),rd="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",km=ie(rd,"gu").replace(/notPunctSpace/g,ed).replace(/punctSpace/g,Qi).replace(/punct/g,la).getRegex(),xm=ie(rd,"gu").replace(/notPunctSpace/g,bm).replace(/punctSpace/g,ym).replace(/punct/g,td).getRegex(),Tm=ie("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ed).replace(/punctSpace/g,Qi).replace(/punct/g,la).getRegex(),Am=ie(/\\(punct)/,"gu").replace(/punct/g,la).getRegex(),Im=ie(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Cm=ie(Yi).replace("(?:-->|$)","-->").getRegex(),Nm=ie("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Cm).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Xs=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Rm=ie(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Xs).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),sd=ie(/^!?\[(label)\]\[(ref)\]/).replace("label",Xs).replace("ref",Ji).getRegex(),ad=ie(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ji).getRegex(),Om=ie("reflink|nolink(?!\\()","g").replace("reflink",sd).replace("nolink",ad).getRegex(),Nl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,eo={_backpedal:Mr,anyPunctuation:Am,autolink:Im,blockSkip:wm,br:Qc,code:gm,del:Mr,emStrongLDelim:Sm,emStrongRDelimAst:km,emStrongRDelimUnd:Tm,escape:pm,link:Rm,nolink:ad,punctuation:_m,reflink:sd,reflinkSearch:Om,tag:Nm,text:mm,url:Mr},Mm={...eo,link:ie(/^!?\[(label)\]\((.*?)\)/).replace("label",Xs).getRegex(),reflink:ie(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Xs).getRegex()},_i={...eo,emStrongRDelimAst:xm,emStrongLDelim:Em,url:ie(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Nl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ie(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Nl).getRegex()},Pm={..._i,br:ie(Qc).replace("{2,}","*").getRegex(),text:ie(_i.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},rs={normal:Wi,gfm:vm,pedantic:hm},kr={normal:eo,gfm:_i,breaks:Pm,pedantic:Mm},Lm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rl=e=>Lm[e];function Gt(e,t){if(t){if(We.escapeTest.test(e))return e.replace(We.escapeReplace,Rl)}else if(We.escapeTestNoEncode.test(e))return e.replace(We.escapeReplaceNoEncode,Rl);return e}function Ol(e){try{e=encodeURI(e).replace(We.percentDecode,"%")}catch{return null}return e}function Ml(e,t){let n=e.replace(We.findPipe,(a,i,o)=>{let l=!1,u=i;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(We.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(We.slashPipe,"|");return r}function xr(e,t,n){let r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Dm(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Pl(e,t,n,r,s){let a=t.href,i=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:i,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function $m(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let s=r[1];return t.split(`
`).map(a=>{let i=a.match(n.other.beginningSpace);if(i===null)return a;let[o]=i;return o.length>=s.length?a.slice(s.length):a}).join(`
`)}var Ks=class{options;rules;lexer;constructor(e){this.options=e||Fn}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:xr(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=$m(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=xr(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:xr(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=xr(t[0],`
`).split(`
`),r="",s="",a=[];for(;n.length>0;){let i=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),i=!0;else if(!i)o.push(n[l]);else break;n=n.slice(l);let u=o.join(`
`),c=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${u}`:u,s=s?`${s}
${c}`:c;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,a,!0),this.lexer.state.top=d,n.length===0)break;let h=a.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let f=h,p=f.raw+`
`+n.join(`
`),m=this.blockquote(p);a[a.length-1]=m,r=r.substring(0,r.length-f.raw.length)+m.raw,s=s.substring(0,s.length-f.text.length)+m.text;break}else if(h?.type==="list"){let f=h,p=f.raw+`
`+n.join(`
`),m=this.list(p);a[a.length-1]=m,r=r.substring(0,r.length-h.raw.length)+m.raw,s=s.substring(0,s.length-f.raw.length)+m.raw,n=p.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:a,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let a=this.rules.other.listItemRegex(n),i=!1;for(;e;){let l=!1,u="",c="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),h=e.split(`
`,1)[0],f=!d.trim(),p=0;if(this.options.pedantic?(p=2,c=d.trimStart()):f?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,c=d.slice(p),p+=t[1].length),f&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),l=!0),!l){let m=this.rules.other.nextBulletRegex(p),g=this.rules.other.hrRegex(p),S=this.rules.other.fencesBeginRegex(p),E=this.rules.other.headingBeginRegex(p),b=this.rules.other.htmlBeginRegex(p);for(;e;){let k=e.split(`
`,1)[0],N;if(h=k,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),N=h):N=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||E.test(h)||b.test(h)||m.test(h)||g.test(h))break;if(N.search(this.rules.other.nonSpaceChar)>=p||!h.trim())c+=`
`+N.slice(p);else{if(f||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||E.test(d)||g.test(d))break;c+=`
`+h}!f&&!h.trim()&&(f=!0),u+=k+`
`,e=e.substring(k.length+1),d=N.slice(p)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),s.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(c),loose:!1,text:c,tokens:[]}),s.raw+=u}let o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let c=this.lexer.inlineQueue.length-1;c>=0;c--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[c].src)){this.lexer.inlineQueue[c].src=this.lexer.inlineQueue[c].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(l.raw);if(u){let c={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};l.checked=c.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=c.raw+l.tokens[0].raw,l.tokens[0].text=c.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(c)):l.tokens.unshift({type:"paragraph",raw:c.raw,text:c.raw,tokens:[c]}):l.tokens.unshift(c)}}if(!s.loose){let u=l.tokens.filter(d=>d.type==="space"),c=u.length>0&&u.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=c}}if(s.loose)for(let l of s.items){l.loose=!0;for(let u of l.tokens)u.type==="text"&&(u.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Ml(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?a.align.push("right"):this.rules.other.tableAlignCenter.test(i)?a.align.push("center"):this.rules.other.tableAlignLeft.test(i)?a.align.push("left"):a.align.push(null);for(let i=0;i<n.length;i++)a.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:a.align[i]});for(let i of s)a.rows.push(Ml(i,a.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:a.align[l]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=xr(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=Dm(t[2],"()");if(a===-2)return;if(a>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(r);a&&(r=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Pl(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return Pl(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,a,i,o=s,l=0,u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(i=[...a].length,r[3]||r[4]){o+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(o-=i,o>0)continue;i=Math.min(i,i+o+l);let c=[...r[0]][0].length,d=e.slice(0,s+r.index+c+i);if(Math.min(s,i)%2){let f=d.slice(1,-1);return{type:"em",raw:d,text:f,tokens:this.lexer.inlineTokens(f)}}let h=d.slice(2,-2);return{type:"strong",raw:d,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},St=class yi{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Fn,this.options.tokenizer=this.options.tokenizer||new Ks,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:We,block:rs.normal,inline:kr.normal};this.options.pedantic?(n.block=rs.pedantic,n.inline=kr.pedantic):this.options.gfm&&(n.block=rs.gfm,this.options.breaks?n.inline=kr.breaks:n.inline=kr.gfm),this.tokenizer.rules=n}static get rules(){return{block:rs,inline:kr}}static lex(t,n){return new yi(n).lex(t)}static lexInline(t,n){return new yi(n).inlineTokens(t)}lex(t){t=t.replace(We.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(We.tabCharGlobal,"    ").replace(We.spaceLine,""));t;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}let a=t;if(this.options.extensions?.startBlock){let i=1/0,o=t.slice(1),l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(a=t.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=a.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)a=s[2]?s[2].length:0,r=r.slice(0,s.index+a)+"["+"a".repeat(s[0].length-a-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,o="";for(;t;){i||(o=""),i=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let c=n.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,r,o)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let u=t;if(this.options.extensions?.startInline){let c=1/0,d=t.slice(1),h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(l=this.tokenizer.inlineText(u)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),i=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},Js=class{options;parser;constructor(e){this.options=e||Fn}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(We.notSpaceStart)?.[0],s=e.replace(We.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Gt(r)+'">'+(n?s:Gt(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Gt(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let i=0;i<e.items.length;i++){let o=e.items[i];r+=this.listitem(o)}let s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+r+"</"+s+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];n="";for(let i=0;i<a.length;i++)n+=this.tablecell(a[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Gt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=Ol(e);if(s===null)return r;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+Gt(t)+'"'),a+=">"+r+"</a>",a}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=Ol(e);if(s===null)return Gt(n);e=s;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${Gt(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Gt(e.text)}},to=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},Et=class bi{options;renderer;textRenderer;constructor(t){this.options=t||Fn,this.options.renderer=this.options.renderer||new Js,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new to}static parse(t,n){return new bi(n).parse(t)}static parseInline(t,n){return new bi(n).parseInline(t)}parse(t){let n="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,o=this.options.extensions.renderers[i.type].call({parser:this},i);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=o||"";continue}}let a=s;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(t,n=this.renderer){let r="";for(let s=0;s<t.length;s++){let a=t[s];if(this.options.extensions?.renderers?.[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=o||"";continue}}let i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},Rr=class{options;block;constructor(e){this.options=e||Fn}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?St.lex:St.lexInline}provideParser(){return this.block?Et.parse:Et.parseInline}},Um=class{defaults=Zi();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Et;Renderer=Js;TextRenderer=to;Lexer=St;Tokenizer=Ks;Hooks=Rr;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let s=r;for(let a of s.header)n=n.concat(this.walkTokens(a.tokens,t));for(let a of s.rows)for(let i of a)n=n.concat(this.walkTokens(i.tokens,t));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{let i=s[a].flat(1/0);n=n.concat(this.walkTokens(i,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=t.renderers[s.name];a?t.renderers[s.name]=function(...i){let o=s.renderer.apply(this,i);return o===!1&&(o=a.apply(this,i)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){let s=this.defaults.renderer||new Js(this.defaults);for(let a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let i=a,o=n.renderer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new Ks(this.defaults);for(let a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let i=a,o=n.tokenizer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new Rr;for(let a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let i=a,o=n.hooks[i],l=s[i];Rr.passThroughHooks.has(a)?s[i]=u=>{if(this.defaults.async&&Rr.passThroughHooksRespectAsync.has(a))return(async()=>{let d=await o.call(s,u);return l.call(s,d)})();let c=o.call(s,u);return l.call(s,c)}:s[i]=(...u)=>{if(this.defaults.async)return(async()=>{let d=await o.apply(s,u);return d===!1&&(d=await l.apply(s,u)),d})();let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(i){let o=[];return o.push(a.call(this,i)),s&&(o=o.concat(s.call(this,i))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return St.lex(e,t??this.defaults)}parser(e,t){return Et.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(t):t,o=await(s.hooks?await s.hooks.provideLexer():e?St.lex:St.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(o):o;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let u=await(s.hooks?await s.hooks.provideParser():e?Et.parse:Et.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(u):u})().catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let i=(s.hooks?s.hooks.provideLexer():e?St.lex:St.lexInline)(t,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let o=(s.hooks?s.hooks.provideParser():e?Et.parse:Et.parseInline)(i,s);return s.hooks&&(o=s.hooks.postprocess(o)),o}catch(i){return a(i)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+Gt(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Un=new Um;function ce(e,t){return Un.parse(e,t)}ce.options=ce.setOptions=function(e){return Un.setOptions(e),ce.defaults=Un.defaults,Kc(ce.defaults),ce};ce.getDefaults=Zi;ce.defaults=Fn;ce.use=function(...e){return Un.use(...e),ce.defaults=Un.defaults,Kc(ce.defaults),ce};ce.walkTokens=function(e,t){return Un.walkTokens(e,t)};ce.parseInline=Un.parseInline;ce.Parser=Et;ce.parser=Et.parse;ce.Renderer=Js;ce.TextRenderer=to;ce.Lexer=St;ce.lexer=St.lex;ce.Tokenizer=Ks;ce.Hooks=Rr;ce.parse=ce;ce.options;ce.setOptions;ce.use;ce.walkTokens;ce.parseInline;Et.parse;St.lex;ce.setOptions({breaks:!0,gfm:!0});function id(e){if(!e)return"";try{return ce.parse(e,{async:!1})}catch{return e}}let Ll=!1;function zm(){Ll||typeof window>"u"||(Ll=!0,window.addEventListener("error",e=>{console.error("[playground-ui] Unhandled error:",e.error??e.message)}),window.addEventListener("unhandledrejection",e=>{console.error("[playground-ui] Unhandled rejection:",e.reason)}))}var jm=T("<div><!></div>");function no(e,t){let n=je(t,"position",3,"center"),r=je(t,"class",3,"");var s=jm(),a=_(s);it(a,()=>t.children??$e),D(()=>we(s,1,`column ${n()??""} ${r()??""}`,"svelte-1k9hy8f")),w(e,s)}var Bm=T('<div class="page svelte-1g511ye"><!></div>');function Gm(e,t){var n=Bm(),r=_(n);it(r,()=>t.children??$e),w(e,n)}function Fm(e,t){no(e,{position:"left",children:(n,r)=>{var s=Pe(),a=W(s);it(a,()=>t.children??$e),w(n,s)},$$slots:{default:!0}})}Xd();var Vm=T("<div><!></div>");function Vn(e,t){let n=je(t,"class",3,"");var r=Vm(),s=_(r);it(s,()=>t.children??$e),D(()=>we(r,1,`card ${n()??""}`,"svelte-4n6w97")),w(e,r)}var Hm=T('<button type="button"> </button>'),qm=T('<div class="tabs svelte-1nusxqd"><!> <!></div>');function Zm(e,t){ee(t,!0);var n=qm(),r=_(n);Le(r,17,()=>t.tabs,a=>a.id,(a,i)=>{var o=Hm();let l;o.__click=()=>t.onchange?.(v(i).id);var u=_(o);D(()=>{l=we(o,1,"tab svelte-1nusxqd",null,l,{active:t.active===v(i).id}),L(u,v(i).label)}),w(a,o)});var s=y(r,2);it(s,()=>t.right??$e),w(e,n),te()}yt(["click"]);var Xm=T('<div class="icon svelte-12nvmli"> </div>'),Km=T('<div class="subtitle svelte-12nvmli"> </div>'),Jm=T('<div><!> <div class="title svelte-12nvmli"> </div> <!></div>');function ua(e,t){let n=je(t,"inline",3,!1);var r=Jm();let s;var a=_(r);{var i=d=>{var h=Xm(),f=_(h);D(()=>L(f,t.icon)),w(d,h)};$(a,d=>{t.icon&&d(i)})}var o=y(a,2),l=_(o),u=y(o,2);{var c=d=>{var h=Km(),f=_(h);D(()=>L(f,t.subtitle)),w(d,h)};$(u,d=>{t.subtitle&&d(c)})}D(()=>{s=we(r,1,"empty svelte-12nvmli",null,s,{inline:n()}),L(l,t.title)}),w(e,r)}var Ym=T('<div class="error-row svelte-1bc74kj"> </div>'),Wm=T('<div class="errors svelte-1bc74kj"></div>');function od(e,t){ee(t,!0);var n=Pe(),r=W(n);{var s=a=>{var i=Wm();Le(i,21,()=>t.errors,o=>o.id,(o,l)=>{var u=Ym(),c=_(u);D(()=>L(c,`Warning ${v(l).message??""}`)),w(o,u)}),w(a,i)};$(r,a=>{t.errors.length>0&&a(s)})}w(e,n),te()}var Qm=T('<div class="label svelte-1hc9aln"> </div>'),e_=T('<div class="code-block svelte-1hc9aln"><!> <pre class="svelte-1hc9aln"> </pre></div>');function Dl(e,t){let n=je(t,"maxHeight",3,"100px");const r=ye(()=>typeof t.content=="string"?t.content:JSON.stringify(t.content,null,2));var s=e_(),a=_(s);{var i=u=>{var c=Qm(),d=_(c);D(()=>L(d,t.label)),w(u,c)};$(a,u=>{t.label&&u(i)})}var o=y(a,2),l=_(o);D(()=>{Bf(o,`max-height: ${n()??""}`),L(l,v(r))}),w(e,s)}var t_=T("<span><!></span>");function dt(e,t){let n=je(t,"variant",3,"default"),r=je(t,"size",3,"default"),s=je(t,"class",3,"");var a=t_(),i=_(a);it(i,()=>t.children??$e),D(()=>we(a,1,`pill ${n()??""} ${r()??""} ${s()??""}`,"svelte-1qe3l4g")),w(e,a)}var n_=T("<span><!></span>");function r_(e,t){var n=n_(),r=_(n);{var s=a=>{var i=Xe();D(()=>L(i,t.label)),w(a,i)};$(r,a=>{t.label&&a(s)})}D(()=>we(n,1,`status-dot ${t.status??""}`,"svelte-1506mec")),w(e,n)}var s_=T('<button class="icon-btn svelte-w50x32"><!></button>');function a_(e,t){var n=s_();n.__click=function(...s){t.onclick?.apply(this,s)};var r=_(n);it(r,()=>t.children??$e),D(()=>Ye(n,"title",t.title)),w(e,n)}yt(["click"]);var i_=T('<div class="row space-between align-center svelte-1683ey6"><div><div class="title svelte-1683ey6"> </div> <div class="muted svelte-1683ey6"> </div></div> <!></div> <div class="badges svelte-1683ey6"></div> <div class="stats-row svelte-1683ey6"><div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">TOOLS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">FLOWS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">SVCS</div> <div class="stat-value svelte-1683ey6"> </div></div></div>',1);function $l(e,t){ee(t,!1);const n=hr();vt(),Vn(e,{class:"project-card",children:(r,s)=>{var a=i_(),i=W(a),o=_(i),l=_(o),u=_(l),c=y(l,2),d=_(c),h=y(o,2);dt(h,{variant:"subtle",children:(U,R)=>{var A=Xe();D(()=>L(A,n.meta.version||n.meta.template)),w(U,A)},$$slots:{default:!0}});var f=y(i,2);Le(f,5,()=>n.meta.flags,$r,(U,R)=>{dt(U,{variant:"ghost",children:(A,B)=>{var F=Xe();D(()=>L(F,v(R))),w(A,F)},$$slots:{default:!0}})});var p=y(f,2),m=_(p),g=y(_(m),2),S=_(g),E=y(m,2),b=y(_(E),2),k=_(b),N=y(E,2),C=y(_(N),2),O=_(C);D(()=>{L(u,n.meta.name),L(d,n.meta.description),L(S,n.meta.tools),L(k,n.meta.flows),L(O,n.services.length)}),w(r,a)},$$slots:{default:!0}}),te()}var o_=T('<div class="tabs svelte-1t9psp2"><div class="tab active svelte-1t9psp2">Spec YAML</div> <div class="tab svelte-1t9psp2">Validation</div> <!></div> <pre class="spec-view svelte-1t9psp2"> </pre> <!>',1);function Ul(e,t){ee(t,!0);const n=Uv(),r=ye(()=>n.status==="valid"?"Valid":n.status==="error"?"Errors":"Pending");Vn(e,{class:"spec-card",children:(s,a)=>{var i=o_(),o=W(i),l=y(_(o),4);r_(l,{get status(){return n.status},get label(){return v(r)}});var u=y(o,2),c=_(u),d=y(u,2);od(d,{get errors(){return n.errors}}),D(()=>L(c,n.content)),w(s,i)},$$slots:{default:!0}}),te()}yt(["click"]);var l_=T('<span class="dot active svelte-15dukw8"></span> ',1),u_=T('<div class="chat-header svelte-15dukw8"><!> <!></div>');function c_(e,t){ee(t,!1);const n=hr();vt();var r=u_(),s=_(r);dt(s,{class:"header-pill",children:(i,o)=>{var l=l_(),u=y(W(l));D(()=>L(u,` ${n.meta.name??""}`)),w(i,l)},$$slots:{default:!0}});var a=y(s,2);dt(a,{variant:"ghost",children:(i,o)=>{var l=Xe("DEV PLAYGROUND");w(i,l)},$$slots:{default:!0}}),w(e,r),te()}var d_=T('<details class="thinking-panel svelte-1xc7ue3"><summary class="thinking-summary svelte-1xc7ue3"> </summary> <div class="thinking-body svelte-1xc7ue3"><div class="markdown-content"><!></div></div></details>');function f_(e,t){ee(t,!0);const n=u=>{const c=u.currentTarget;t.ontoggle?.(c.open)};var r=d_(),s=_(r),a=_(s),i=y(s,2),o=_(i),l=_(o);Lu(l,()=>id(t.observations)),D(()=>{r.open=t.open,L(a,t.isStreaming?"Thinking...":"Thought")}),kf("toggle",r,n),w(e,r),te()}var v_=T('<a class="pause-link svelte-sbh9b9" target="_blank" rel="noreferrer">Open authorization link</a>'),h_=T('<div class="pause-token svelte-sbh9b9"> </div>'),p_=T('<div class="pause-card svelte-sbh9b9"><div class="pause-title svelte-sbh9b9">Action required</div> <!> <!> <div class="pause-meta svelte-sbh9b9"> <!></div></div>');function g_(e,t){ee(t,!0);const n=ye(()=>t.pause.payload?.auth_url||t.pause.payload?.url||""),r=ye(()=>t.pause.payload?.provider||"");var s=p_(),a=y(_(s),2);{var i=f=>{var p=v_();D(()=>Ye(p,"href",v(n))),w(f,p)};$(a,f=>{v(n)&&f(i)})}var o=y(a,2);{var l=f=>{var p=h_(),m=_(p);D(()=>L(m,`Resume token: ${t.pause.resume_token??""}`)),w(f,p)};$(o,f=>{t.pause.resume_token&&f(l)})}var u=y(o,2),c=_(u),d=y(c);{var h=f=>{var p=Xe();D(()=>L(p,`- provider: ${v(r)??""}`)),w(f,p)};$(d,f=>{v(r)&&f(h)})}D(()=>L(c,`${t.pause.reason?`reason: ${t.pause.reason}`:"paused"} `)),w(e,s),te()}var m_=T('<div class="typing svelte-1gl9kj5"><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span></div>');function __(e){var t=m_();w(e,t)}const y_="modulepreload",b_=function(e){return"/"+e},zl={},Re=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");s=l(n.map(u=>{if(u=b_(u),u in zl)return;zl[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":y_,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function ro(e,t=[]){if(!e||typeof e!="object"||Array.isArray(e))return Ps(new Error("Props must be an object."));const n=e;for(const r of t)if(!(r in n))return Ps(new Error(`Missing required prop: ${r}`));return Li(n)}function w_(e,t){const n=e[t];return typeof n!="string"||!n.trim()?Ps(new Error(`Invalid or missing string prop: ${t}`)):Li(e)}function S_(e,t){const n=e[t];return!n||typeof n!="object"||Array.isArray(n)?Ps(new Error(`Invalid or missing object prop: ${t}`)):Li(e)}const ze=e=>ro(e),E_=e=>{const t=ro(e,["option"]);return t.ok?S_(t.data,"option"):t},k_=e=>{const t=ro(e,["code"]);return t.ok?w_(t.data,"code"):t},x_={echarts:{load:()=>Re(()=>import("./ECharts-Dh3KIvYc.js"),__vite__mapDeps([0,1])),validateProps:E_},mermaid:{load:()=>Re(()=>import("./Mermaid-CWJqpUQX.js").then(e=>e.bA),__vite__mapDeps([2,3,4,5])),validateProps:k_},plotly:{load:()=>Re(()=>import("./Plotly-vGI5WD-H.js"),__vite__mapDeps([6,3,7])),validateProps:ze},datagrid:{load:()=>Re(()=>import("./DataGrid-DC8HLCGy.js"),__vite__mapDeps([8,9])),validateProps:ze},json:{load:()=>Re(()=>import("./Json-JGXZ_HdN.js"),__vite__mapDeps([10,11])),validateProps:ze},metric:{load:()=>Re(()=>import("./Metric-CvwFpWxL.js"),__vite__mapDeps([12,13])),validateProps:ze},markdown:{load:()=>Re(()=>import("./Markdown-CH3hBE82.js"),__vite__mapDeps([14,4,15,16,17])),validateProps:ze},code:{load:()=>Re(()=>import("./Code-D8rGw3BA.js"),__vite__mapDeps([18,19])),validateProps:ze},latex:{load:()=>Re(()=>import("./Latex-7r3LdLVU.js"),__vite__mapDeps([20,15,21,17])),validateProps:ze},callout:{load:()=>Re(()=>import("./Callout-3vTLDmOr.js"),__vite__mapDeps([22,14,4,15,16,17,23])),validateProps:ze},form:{load:()=>Re(()=>import("./Form-C7vfJIgg.js"),__vite__mapDeps([24,25])),validateProps:ze},confirm:{load:()=>Re(()=>import("./Confirm-Dsrz5MWk.js"),__vite__mapDeps([26,14,4,15,16,17,27])),validateProps:ze},select_option:{load:()=>Re(()=>import("./SelectOption-DelcoAu1.js"),__vite__mapDeps([28,29])),validateProps:ze},report:{load:()=>Re(()=>import("./Report-D-9m3M9a.js"),__vite__mapDeps([30,14,4,15,16,17,31])),validateProps:ze},grid:{load:()=>Re(()=>import("./Grid-BDH12miG.js"),__vite__mapDeps([32,33])),validateProps:ze},tabs:{load:()=>Re(()=>import("./Tabs-BOpSrxIb.js"),__vite__mapDeps([34,14,4,15,16,17,35])),validateProps:ze},accordion:{load:()=>Re(()=>import("./Accordion-GmEbV2pm.js"),__vite__mapDeps([36,14,4,15,16,17,37])),validateProps:ze},image:{load:()=>Re(()=>import("./Image-cbs3k3Pu.js"),__vite__mapDeps([38,39])),validateProps:ze},html:{load:()=>Re(()=>import("./Html-CLqx3OV7.js"),__vite__mapDeps([40,41])),validateProps:ze},video:{load:()=>Re(()=>import("./Video-BcP9aOAb.js"),__vite__mapDeps([42,43])),validateProps:ze},embed:{load:()=>Re(()=>import("./Embed-DGhuMqp_.js"),__vite__mapDeps([44,45])),validateProps:ze}};var T_=T("<div><!></div>"),A_=T('<div class="artifact-error svelte-1ly7nl2"><strong> </strong> <pre class="svelte-1ly7nl2"> </pre></div>'),I_=T('<div class="renderer-loading svelte-1ly7nl2">Loading...</div>');function wi(e,t){ee(t,!0);let n=je(t,"props",19,()=>({})),r=je(t,"onResult",3,void 0);const s=Ui(),a=ye(()=>s.getComponent(t.component)),i=ye(()=>v(a)?.interactive??!1),o=ye(async()=>{const c=x_[t.component];if(!c)return{ok:!1,error:new Error(`Renderer not found: ${t.component}`)};try{const d=await c.load(),h=c.validateProps(n());return h.ok?{ok:!0,data:{Renderer:d.default,props:h.data}}:h}catch(d){return{ok:!1,error:bv(d,`Failed to load renderer: ${t.component}`)}}});var l=Pe(),u=W(l);Rf(u,()=>v(o),c=>{var d=I_();w(c,d)},(c,d)=>{var h=Pe(),f=W(h);{var p=g=>{const S=ye(()=>v(d).data.Renderer);var E=T_();let b;var k=_(E);$f(k,()=>v(S),(N,C)=>{C(N,Wf(()=>v(d).data.props,{get onResult(){return r()}}))}),D(()=>{b=we(E,1,"artifact svelte-1ly7nl2",null,b,{interactive:v(i)}),Ye(E,"data-component",t.component)}),w(g,E)},m=g=>{var S=A_(),E=_(S),b=_(E),k=y(E),N=y(k),C=_(N);D(O=>{L(b,`Failed to render ${t.component??""}:`),L(k,` ${v(d).error.message??""} `),L(C,O)},[()=>JSON.stringify(n(),null,2)]),w(g,S)};$(f,g=>{v(d).ok?g(p):g(m,!1)})}w(c,h)}),w(e,l),te()}var C_=T('<div class="artifact-title svelte-1dv1zra"> </div>'),N_=T("<!> <!>",1),R_=T('<div class="component-artifacts svelte-1dv1zra"></div>'),O_=T('<div class="component-interaction svelte-1dv1zra"><!></div>'),M_=T('<span class="link svelte-1dv1zra"> </span>'),P_=T('<div><div><!> <div class="markdown-content"><!></div> <!> <!> <!> <!></div> <div class="meta-row svelte-1dv1zra"><span> </span> <!></div></div>');function L_(e,t){ee(t,!0);let n=je(t,"message",7);const r=ye(()=>n().role==="agent"&&n().observations&&n().observations.trim()!==""),s=$i(),a=ye(()=>s.artifacts.filter(A=>A.message_id===n().id)),i=ye(()=>{const A=s.pendingInteraction;return!A||A.message_id!==n().id?null:A});var o=P_(),l=_(o),u=_(l);{var c=A=>{{let B=ye(()=>n().showObservations??!1),F=ye(()=>n().isStreaming??!1);f_(A,{get observations(){return n().observations},get open(){return v(B)},get isStreaming(){return v(F)},ontoggle:H=>{n().showObservations=H}})}};$(u,A=>{v(r)&&A(c)})}var d=y(u,2),h=_(d);Lu(h,()=>id(n().text));var f=y(d,2);{var p=A=>{var B=R_();Le(B,21,()=>v(a),F=>F.id,(F,H)=>{var ne=N_(),fe=W(ne);{var oe=ge=>{var ht=C_(),zt=_(ht);D(()=>L(zt,v(H).title)),w(ge,ht)};$(fe,ge=>{v(H).title&&ge(oe)})}var Ue=y(fe,2);wi(Ue,{get component(){return v(H).component},get props(){return v(H).props}}),w(F,ne)}),w(A,B)};$(f,A=>{n().role==="agent"&&v(a).length>0&&A(p)})}var m=y(f,2);{var g=A=>{var B=O_(),F=_(B);wi(F,{get component(){return v(i).component},get props(){return v(i).props},onResult:H=>t.onInteractionResult?.(v(i),H)}),w(A,B)};$(m,A=>{n().role==="agent"&&v(i)&&A(g)})}var S=y(m,2);{var E=A=>{g_(A,{get pause(){return n().pause}})};$(S,A=>{n().pause&&A(E)})}var b=y(S,2);{var k=A=>{__(A)};$(b,A=>{(n().isStreaming||n().isThinking)&&A(k)})}var N=y(l,2),C=_(N),O=_(C),U=y(C,2);{var R=A=>{var B=M_(),F=_(B);D(()=>L(F,`#${n().traceId??""}`)),w(A,B)};$(U,A=>{n().traceId&&A(R)})}D(A=>{we(o,1,`message-row ${n().role==="agent"?"agent":"user"}`,"svelte-1dv1zra"),we(l,1,`bubble ${n().role}`,"svelte-1dv1zra"),L(O,A)},[()=>tv(n().ts)]),w(e,o),te()}var D_=T('<div class="chat-body svelte-mwyedf"><!></div>');function $_(e,t){ee(t,!0);const n=qu();let r=je(t,"chatBodyEl",15,null);var s=D_(),a=_(s);{var i=l=>{ua(l,{icon:"*",title:"Ready to test agent behavior.",subtitle:"Type a message below to start a run."})},o=l=>{var u=Pe(),c=W(u);Le(c,17,()=>n.messages,d=>d.id,(d,h)=>{L_(d,{get message(){return v(h)},get onInteractionResult(){return t.onInteractionResult}})}),w(l,u)};$(a,l=>{n.isEmpty?l(i):l(o,!1)})}Ur(s,l=>r(l),()=>r()),w(e,s),te()}var U_=T('<div class="chat-input svelte-esbonz"><textarea placeholder="Ask your agent something..." class="svelte-esbonz"></textarea> <button class="send-btn svelte-esbonz">></button></div>');function z_(e,t){ee(t,!0);const n=qu(),r=Zr(),s=l=>{l.key==="Enter"&&!l.shiftKey&&(l.preventDefault(),t.onsubmit())};var a=U_(),i=_(a);i.__keydown=s;var o=y(i,2);o.__click=function(...l){t.onsubmit?.apply(this,l)},D(l=>o.disabled=l,[()=>r.isSending||!n.input.trim()]),xn(i,()=>n.input,l=>n.input=l),w(e,a),te()}yt(["keydown","click"]);const ld=Symbol("agui");function j_(e){ft(ld,e)}function ud(){const e=Tt(ld);if(!e)throw new Error("AGUIProvider not found");return e}var B_=T('<span class="dots svelte-z9q8sr">...</span>'),G_=T('<div class="result svelte-z9q8sr"><div class="label svelte-z9q8sr">Result</div> <pre class="svelte-z9q8sr"> </pre></div>'),F_=T('<div><div class="header svelte-z9q8sr"><span class="icon svelte-z9q8sr">tool</span> <strong class="svelte-z9q8sr"> </strong> <!></div> <pre class="args svelte-z9q8sr"> </pre> <!></div>');function V_(e,t){ee(t,!1);const n=Yt();let r=je(t,"toolCall",8);_u(()=>rt(r()),()=>{x(n,(()=>{try{return JSON.parse(r().arguments)}catch{return null}})())}),yu(),vt();var s=F_();let a;var i=_(s),o=y(_(i),2),l=_(o),u=y(o,2);{var c=m=>{var g=B_();w(m,g)};$(u,m=>{rt(r()),le(()=>r().isStreaming)&&m(c)})}var d=y(i,2),h=_(d),f=y(d,2);{var p=m=>{var g=G_(),S=y(_(g),2),E=_(S);D(()=>L(E,(rt(r()),le(()=>r().result)))),w(m,g)};$(f,m=>{rt(r()),le(()=>r().result)&&m(p)})}D(m=>{a=we(s,1,"agui-tool-call svelte-z9q8sr",null,a,{streaming:r().isStreaming}),L(l,(rt(r()),le(()=>r().name))),L(h,`${m??""}
  `)},[()=>(v(n),rt(r()),le(()=>v(n)?JSON.stringify(v(n),null,2):r().arguments))]),w(e,s),te()}var H_=T('<span class="cursor svelte-19eh49q">|</span>'),q_=T('<div class="agui-tool-calls svelte-19eh49q"></div>'),Z_=T('<div><div><div class="agui-role svelte-19eh49q"> </div> <div class="agui-message-content svelte-19eh49q"> <!></div> <!></div></div>');function X_(e,t){ee(t,!1);let n=je(t,"message",8);vt();var r=Z_(),s=_(r),a=_(s),i=_(a),o=y(a,2),l=_(o),u=y(l);{var c=f=>{var p=H_();w(f,p)};$(u,f=>{rt(n()),le(()=>n().isStreaming)&&f(c)})}var d=y(o,2);{var h=f=>{var p=q_();Le(p,5,()=>(rt(n()),le(()=>n().toolCalls)),m=>m.id,(m,g)=>{V_(m,{get toolCall(){return v(g)}})}),w(f,p)};$(d,f=>{rt(n()),le(()=>n().toolCalls.length>0)&&f(h)})}D(()=>{we(r,1,(rt(n()),le(()=>`agui-message-row ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),we(s,1,(rt(n()),le(()=>`agui-bubble ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),L(i,(rt(n()),le(()=>n().role))),L(l,(rt(n()),le(()=>n().content)))}),w(e,r),te()}var K_=T('<p class="agui-empty svelte-15on836">No messages yet</p>'),J_=T('<div class="agui-message-list svelte-15on836"><!> <!></div>');function Y_(e,t){ee(t,!1);const n=()=>Ar(a,"$messages",r),[r,s]=zu(),{messages:a}=ud();let i=Yt();_u(()=>(n(),v(i)),()=>{n().length&&v(i)&&requestAnimationFrame(()=>{v(i)&&sn(i,v(i).scrollTop=v(i).scrollHeight)})}),yu(),vt();var o=J_(),l=_(o);Le(l,1,n,d=>d.id,(d,h)=>{X_(d,{get message(){return v(h)}})});var u=y(l,2);{var c=d=>{var h=Pe(),f=W(h);Df(f,t,"empty",{},p=>{var m=K_();w(p,m)}),w(d,h)};$(u,d=>{n(),le(()=>n().length===0)&&d(c)})}Ur(o,d=>x(i,d),()=>v(i)),w(e,o),te(),s()}var W_=T("<li> </li>"),Q_=T('<section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Active Steps</h4> <ul class="svelte-rwecvr"></ul></section>'),ey=T('<section class="error svelte-rwecvr"><h4 class="svelte-rwecvr">Error</h4> <pre class="svelte-rwecvr"> </pre></section>'),ty=T('<details class="agui-debugger svelte-rwecvr"><summary class="svelte-rwecvr">AG-UI Debug <span> </span></summary> <div class="content svelte-rwecvr"><section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Thread / Run</h4> <code class="svelte-rwecvr"> </code></section> <!> <section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Agent State</h4> <pre class="svelte-rwecvr"> </pre></section> <!></div></details>');function ny(e,t){ee(t,!1);const n=()=>Ar(u,"$status",i),r=()=>Ar(l,"$state",i),s=()=>Ar(d,"$activeSteps",i),a=()=>Ar(c,"$agentState",i),[i,o]=zu(),{state:l,status:u,agentState:c,activeSteps:d}=ud();let h=je(t,"expanded",12,!1);vt();var f=ty(),p=_(f),m=y(_(p));let g;var S=_(m),E=y(p,2),b=_(E),k=y(_(b),2),N=_(k),C=y(b,2);{var O=H=>{var ne=Q_(),fe=y(_(ne),2);Le(fe,5,s,$r,(oe,Ue)=>{var ge=W_(),ht=_(ge);D(()=>L(ht,(v(Ue),le(()=>v(Ue).name)))),w(oe,ge)}),w(H,ne)};$(C,H=>{s(),le(()=>s().length>0)&&H(O)})}var U=y(C,2),R=y(_(U),2),A=_(R),B=y(U,2);{var F=H=>{var ne=ey(),fe=y(_(ne),2),oe=_(fe);D(Ue=>L(oe,Ue),[()=>(r(),le(()=>JSON.stringify(r().error,null,2)))]),w(H,ne)};$(B,H=>{r(),le(()=>r().error)&&H(F)})}D(H=>{g=we(m,1,"status svelte-rwecvr",null,g,{running:n()==="running",error:n()==="error"}),L(S,n()),L(N,`${r(),le(()=>r().threadId??"â")??""} / ${r(),le(()=>r().runId??"â")??""}`),L(A,H)},[()=>(a(),le(()=>JSON.stringify(a(),null,2)))]),Zf("open","toggle",f,h,h),w(e,f),te(),o()}var ry=T('<div class="muted tiny svelte-asidmd"> </div>'),sy=T('<div><div class="label svelte-asidmd"> </div> <!> <!></div>');function Zn(e,t){let n=je(t,"full",3,!1);var r=sy();let s;var a=_(r),i=_(a),o=y(a,2);it(o,()=>t.children??$e);var l=y(o,2);{var u=c=>{var d=ry(),h=_(d);D(()=>L(h,t.hint)),w(c,d)};$(l,c=>{t.hint&&c(u)})}D(()=>{s=we(r,1,"setup-field svelte-asidmd",null,s,{full:n()}),L(i,t.label)}),w(e,r)}var ay=T('<div class="row gap svelte-18icuuu"><input class="setup-input svelte-18icuuu"/> <button class="ghost-btn small svelte-18icuuu">New</button></div>'),iy=T('<input class="setup-input svelte-18icuuu"/>'),oy=T('<input class="setup-input svelte-18icuuu"/>'),ly=T('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),uy=T('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),cy=T('<label class="toggle-row svelte-18icuuu"><input class="toggle-input svelte-18icuuu" type="checkbox"/> <span>Use AG-UI</span></label>'),dy=T('<div class="agui-preview svelte-18icuuu"><div class="agui-preview-title svelte-18icuuu">AG-UI Preview</div> <!> <!></div>'),fy=T('<div class="setup-body svelte-18icuuu"><div class="setup-grid svelte-18icuuu"><!> <!> <!> <!> <!> <!></div> <!> <!></div>');function vy(e,t){ee(t,!1);const n={messages:En([{id:"preview-msg",role:"assistant",content:"AG-UI preview message with a tool call.",isStreaming:!1,toolCalls:[{id:"preview-call",name:"search",arguments:'{"query":"preview"}',isStreaming:!1,result:"ok"}]}]),state:En({status:"idle",threadId:"preview-thread",runId:"preview-run",messages:[],agentState:{mode:"preview"},activeSteps:[],error:null}),status:En("idle"),agentState:En({mode:"preview"}),isRunning:En(!1),error:En(null),activeSteps:En([]),sendMessage:async()=>{},cancel:()=>{},reset:()=>{}},r=Yt(Zr()),s=Yt(Bv()),a=na(),i=Di(),o=$i();j_(n),vt();var l=fy(),u=_(l),c=_(u);Zn(c,{label:"Session ID",hint:"Used to scope short-term memory and trajectory lookups.",children:(k,N)=>{var C=ay(),O=_(C),U=y(O,2);U.__click=()=>{v(r).newSession(),a.clear(),i.clear(),o.clear()},xn(O,()=>v(r).sessionId,R=>sn(r,v(r).sessionId=R)),w(k,C)},$$slots:{default:!0}});var d=y(c,2);Zn(d,{label:"Tenant ID",children:(k,N)=>{var C=iy();xn(C,()=>v(s).tenantId,O=>sn(s,v(s).tenantId=O)),w(k,C)},$$slots:{default:!0}});var h=y(d,2);Zn(h,{label:"User ID",children:(k,N)=>{var C=oy();xn(C,()=>v(s).userId,O=>sn(s,v(s).userId=O)),w(k,C)},$$slots:{default:!0}});var f=y(h,2);Zn(f,{label:"Tool Context (JSON)",hint:"Merged with tenant/user and injected as runtime tool_context.",full:!0,children:(k,N)=>{var C=ly();Ye(C,"placeholder",'{"any_runtime_key": "value"}'),xn(C,()=>v(s).toolContextRaw,O=>sn(s,v(s).toolContextRaw=O)),w(k,C)},$$slots:{default:!0}});var p=y(f,2);Zn(p,{label:"LLM Context (JSON)",hint:"Only used when the playground wraps a planner entry point.",full:!0,children:(k,N)=>{var C=uy();Ye(C,"placeholder","{}"),xn(C,()=>v(s).llmContextRaw,O=>sn(s,v(s).llmContextRaw=O)),w(k,C)},$$slots:{default:!0}});var m=y(p,2);Zn(m,{label:"Streaming Protocol",hint:"Enable AG-UI streaming for the playground.",full:!0,children:(k,N)=>{var C=cy(),O=_(C);Hf(O,()=>v(s).useAgui,U=>sn(s,v(s).useAgui=U)),w(k,C)},$$slots:{default:!0}});var g=y(u,2);{var S=k=>{{let N=ea(()=>[{id:"setup-err",message:v(s).error}]);od(k,{get errors(){return v(N)}})}};$(g,k=>{v(s).error&&k(S)})}var E=y(g,2);{var b=k=>{var N=dy(),C=y(_(N),2);Y_(C,{});var O=y(C,2);ny(O,{}),w(k,N)};$(E,k=>{v(s).useAgui&&k(b)})}w(e,l),te()}yt(["click"]);var hy=T('<span class="badge active svelte-184tvz6">Active</span>'),py=T('<span class="badge svelte-184tvz6">Disabled</span>'),gy=T('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6">Summary</h4> <div class="summary-text svelte-184tvz6"> </div></div>'),my=T('<span class="digest-item svelte-184tvz6"> </span>'),_y=T('<span class="digest-item svelte-184tvz6"> </span>'),yy=T('<div class="turn-digest svelte-184tvz6"><!> <!></div>'),by=T('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div> <!></div>'),wy=T('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list svelte-184tvz6"></div></div>'),Sy=T('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div></div>'),Ey=T('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list pending svelte-184tvz6"></div></div>'),ky=T("<!> <!> <!>",1),xy=T('<div class="empty-section svelte-184tvz6">Short-term memory is not enabled or no conversation history exists.</div>'),Ty=T('<div class="section-content svelte-184tvz6"><!></div>'),Ay=T('<pre class="json-block svelte-184tvz6"> </pre>'),Iy=T('<div class="empty-section svelte-184tvz6">No additional LLM context was injected (besides memory).</div>'),Cy=T('<div class="section-content svelte-184tvz6"><!></div>'),Ny=T('<pre class="json-block svelte-184tvz6"> </pre>'),Ry=T('<div class="empty-section svelte-184tvz6">No tool context was passed.</div>'),Oy=T('<div class="section-content svelte-184tvz6"><!></div>'),My=T('<section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Conversation Memory <!></span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">LLM Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Tool Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section>',1),Py=T('<div class="context-body svelte-184tvz6"><!></div>');function Ly(e,t){ee(t,!0);const n=na();let r=G(!0),s=G(!0),a=G(!1);const i=ye(()=>{if(!n.llmContext)return null;const{conversation_memory:f,...p}=n.llmContext;return Object.keys(p).length>0?p:null}),o=f=>{try{return JSON.stringify(f,null,2)}catch{return String(f)}},l=(f,p=100)=>f.length<=p?f:f.slice(0,p)+"...";var u=Py(),c=_(u);{var d=f=>{ua(f,{icon:"*",title:"No context yet",subtitle:"Send a prompt to see injected context."})},h=f=>{var p=My(),m=W(p),g=_(m);g.__click=()=>x(r,!v(r));var S=_(g),E=y(_(S));{var b=Ae=>{var nt=hy();w(Ae,nt)},k=Ae=>{var nt=py();w(Ae,nt)};$(E,Ae=>{n.hasMemory?Ae(b):Ae(k,!1)})}var N=y(S,2);let C;var O=y(g,2);{var U=Ae=>{var nt=Ty(),_n=_(nt);{var yn=Ee=>{var Be=ky(),rn=W(Be);{var wn=me=>{var Ke=gy(),jt=y(_(Ke),2),gr=_(jt);D(()=>L(gr,n.conversationMemory.summary)),w(me,Ke)};$(rn,me=>{n.conversationMemory.summary&&me(wn)})}var Jr=y(rn,2);{var ca=me=>{var Ke=wy(),jt=_(Ke),gr=_(jt),va=y(jt,2);Le(va,21,()=>n.conversationMemory.recent_turns,$r,(ha,At,pa)=>{var mr=by(),_r=_(mr);_r.textContent=`Turn ${pa+1}`;var yr=y(_r,2),ga=y(_(yr),2),ma=_(ga),Yr=y(yr,2),_a=y(_(Yr),2),ya=_(_a),ba=y(Yr,2);{var wa=br=>{var Wr=yy(),so=_(Wr);{var pd=Sn=>{var wr=my(),Sa=_(wr);D(Ea=>L(Sa,`Tools: ${Ea??""}`),[()=>v(At).trajectory_digest.tools_invoked.join(", ")]),w(Sn,wr)};$(so,Sn=>{v(At).trajectory_digest.tools_invoked?.length&&Sn(pd)})}var gd=y(so,2);{var md=Sn=>{var wr=_y(),Sa=_(wr);D(Ea=>L(Sa,`Obs: ${Ea??""}`),[()=>l(v(At).trajectory_digest.observations_summary,80)]),w(Sn,wr)};$(gd,Sn=>{v(At).trajectory_digest.observations_summary&&Sn(md)})}w(br,Wr)};$(ba,br=>{v(At).trajectory_digest&&br(wa)})}D((br,Wr)=>{L(ma,br),L(ya,Wr)},[()=>l(v(At).user,150),()=>l(v(At).assistant,150)]),w(ha,mr)}),D(()=>L(gr,`Recent Turns (${n.conversationMemory.recent_turns.length??""})`)),w(me,Ke)};$(Jr,me=>{n.conversationMemory.recent_turns?.length&&me(ca)})}var da=y(Jr,2);{var fa=me=>{var Ke=Ey(),jt=_(Ke),gr=_(jt),va=y(jt,2);Le(va,21,()=>n.conversationMemory.pending_turns,$r,(ha,At,pa)=>{var mr=Sy(),_r=_(mr);_r.textContent=`Pending ${pa+1}`;var yr=y(_r,2),ga=y(_(yr),2),ma=_(ga),Yr=y(yr,2),_a=y(_(Yr),2),ya=_(_a);D((ba,wa)=>{L(ma,ba),L(ya,wa)},[()=>l(v(At).user,100),()=>l(v(At).assistant,100)]),w(ha,mr)}),D(()=>L(gr,`Pending Turns (${n.conversationMemory.pending_turns.length??""})`)),w(me,Ke)};$(da,me=>{n.conversationMemory.pending_turns?.length&&me(fa)})}w(Ee,Be)},bn=Ee=>{var Be=xy();w(Ee,Be)};$(_n,Ee=>{n.conversationMemory?Ee(yn):Ee(bn,!1)})}w(Ae,nt)};$(O,Ae=>{v(r)&&Ae(U)})}var R=y(m,2),A=_(R);A.__click=()=>x(s,!v(s));var B=y(_(A),2);let F;var H=y(A,2);{var ne=Ae=>{var nt=Cy(),_n=_(nt);{var yn=Ee=>{var Be=Ay(),rn=_(Be);D(wn=>L(rn,wn),[()=>o(v(i))]),w(Ee,Be)},bn=Ee=>{var Be=Iy();w(Ee,Be)};$(_n,Ee=>{v(i)?Ee(yn):Ee(bn,!1)})}w(Ae,nt)};$(H,Ae=>{v(s)&&Ae(ne)})}var fe=y(R,2),oe=_(fe);oe.__click=()=>x(a,!v(a));var Ue=y(_(oe),2);let ge;var ht=y(oe,2);{var zt=Ae=>{var nt=Oy(),_n=_(nt);{var yn=Ee=>{var Be=Ny(),rn=_(Be);D(wn=>L(rn,wn),[()=>o(n.toolContext)]),w(Ee,Be)},bn=Ee=>{var Be=Ry();w(Ee,Be)};$(_n,Ee=>{n.toolContext&&Object.keys(n.toolContext).length>0?Ee(yn):Ee(bn,!1)})}w(Ae,nt)};$(ht,Ae=>{v(a)&&Ae(zt)})}D(()=>{Ye(g,"aria-expanded",v(r)),C=we(N,1,"chevron svelte-184tvz6",null,C,{expanded:v(r)}),Ye(A,"aria-expanded",v(s)),F=we(B,1,"chevron svelte-184tvz6",null,F,{expanded:v(s)}),Ye(oe,"aria-expanded",v(a)),ge=we(Ue,1,"chevron svelte-184tvz6",null,ge,{expanded:v(a)})}),w(f,p)};$(c,f=>{n.hasContext?f(h,!1):f(d)})}w(e,u),te()}yt(["click"]);var Dy=T('<button><span class="name svelte-al447k"> </span> <span class="meta svelte-al447k"> </span></button>'),$y=T('<div class="error svelte-al447k"> </div>'),Uy=T('<div class="empty svelte-al447k">Fix payload to preview.</div>'),zy=T('<header class="svelte-al447k"><div><h2 class="svelte-al447k"> </h2> <p class="svelte-al447k"> </p></div> <div class="actions svelte-al447k"><button class="svelte-al447k">Use Example</button> <button class="svelte-al447k">Use Last Artifact</button> <button class="svelte-al447k">Reset</button></div></header> <div class="detail-grid svelte-al447k"><div class="schema svelte-al447k"><h4 class="svelte-al447k">Props Schema</h4> <pre class="svelte-al447k"> </pre></div> <div class="example svelte-al447k"><h4 class="svelte-al447k">Example</h4> <pre class="svelte-al447k"> </pre></div></div> <div class="editor svelte-al447k"><h4 class="svelte-al447k">Payload</h4> <textarea class="svelte-al447k"></textarea> <!></div> <div class="preview svelte-al447k"><h4 class="svelte-al447k">Preview</h4> <!></div>',1),jy=T('<div class="empty svelte-al447k">No registry loaded.</div>'),By=T('<div class="component-lab svelte-al447k"><aside class="component-list svelte-al447k"><h3 class="svelte-al447k">Components</h3> <div class="component-scroll svelte-al447k"></div></aside> <section class="component-detail svelte-al447k"><!></section></div>');function Gy(e,t){ee(t,!0);const n=Ui(),r=$i(),s=ye(()=>Object.values(n.components||{})),a=ye(()=>[...v(s)].sort((O,U)=>`${O.category}-${O.name}`.localeCompare(`${U.category}-${U.name}`)));let i=G(null),o=G("");sr(()=>{if(!v(i)&&v(a).length){const[O]=v(a);O&&x(i,O.name,!0)}}),sr(()=>{if(v(i)&&!v(o)){const U=n.getComponent(v(i))?.example?.props??{};x(o,JSON.stringify({component:v(i),props:U},null,2),!0)}});const l=ye(()=>v(i)?n.getComponent(v(i)):void 0),u=ye(()=>{try{const O=JSON.parse(v(o));return!O||typeof O!="object"?{preview:null,error:"Payload must be a JSON object."}:!O.component||!O.props?{preview:null,error:"Payload must include component and props keys."}:{preview:O,error:null}}catch(O){return{preview:null,error:O instanceof Error?O.message:"Invalid JSON."}}}),c=ye(()=>v(u).preview),d=ye(()=>v(u).error);function h(){v(l)&&x(o,JSON.stringify({component:v(l).name,props:v(l).example?.props??{}},null,2),!0)}function f(){const O=r.lastArtifact;O&&x(o,JSON.stringify({component:O.component,props:O.props},null,2),!0)}function p(){x(o,"")}function m(O){x(i,O,!0),x(o,"")}var g=By(),S=_(g),E=y(_(S),2);Le(E,21,()=>v(a),$r,(O,U)=>{var R=Dy();R.__click=()=>m(v(U).name);var A=_(R),B=_(A),F=y(A,2),H=_(F);D(()=>{we(R,1,`component-item ${v(i)===v(U).name?"active":""}`,"svelte-al447k"),L(B,v(U).name),L(H,`${v(U).category??""}${v(U).interactive?" â¢ interactive":""}`)}),w(O,R)});var b=y(S,2),k=_(b);{var N=O=>{var U=zy(),R=W(U),A=_(R),B=_(A),F=_(B),H=y(B,2),ne=_(H),fe=y(A,2),oe=_(fe);oe.__click=h;var Ue=y(oe,2);Ue.__click=f;var ge=y(Ue,2);ge.__click=p;var ht=y(R,2),zt=_(ht),Ae=y(_(zt),2),nt=_(Ae),_n=y(zt,2),yn=y(_(_n),2),bn=_(yn),Ee=y(ht,2),Be=y(_(Ee),2),rn=y(Be,2);{var wn=me=>{var Ke=$y(),jt=_(Ke);D(()=>L(jt,v(d))),w(me,Ke)};$(rn,me=>{v(d)&&me(wn)})}var Jr=y(Ee,2),ca=y(_(Jr),2);{var da=me=>{wi(me,{get component(){return v(c).component},get props(){return v(c).props}})},fa=me=>{var Ke=Uy();w(me,Ke)};$(ca,me=>{v(c)?me(da):me(fa,!1)})}D((me,Ke)=>{L(F,v(l).name),L(ne,v(l).description),Ue.disabled=!r.lastArtifact,L(nt,me),L(bn,Ke)},[()=>JSON.stringify(v(l).propsSchema,null,2),()=>JSON.stringify(v(l).example?.props??{},null,2)]),xn(Be,()=>v(o),me=>x(o,me)),w(O,U)},C=O=>{var U=jy();w(O,U)};$(k,O=>{v(l)?O(N):O(C,!1)})}w(e,g),te()}yt(["click"]);var Fy=T("<!> <!>",1),Vy=T("<!> <!> <!>",1);function cd(e,t){ee(t,!0);let n=je(t,"chatBodyEl",15,null),r=G("chat");const s=Ui(),a=ye(()=>{const l=[{id:"chat",label:"Chat"},{id:"setup",label:"Setup"},{id:"context",label:"Context"}];return s.enabled&&l.push({id:"components",label:"Components"}),l});var o={switchToSetup:()=>{x(r,"setup")}};return Vn(e,{class:"chat-card",children:(l,u)=>{var c=Vy(),d=W(c);c_(d,{});var h=y(d,2);Zm(h,{get tabs(){return v(a)},get active(){return v(r)},onchange:g=>{x(r,g,!0)}});var f=y(h,2);{var p=g=>{vy(g,{})},m=g=>{var S=Pe(),E=W(S);{var b=N=>{Ly(N,{})},k=N=>{var C=Pe(),O=W(C);{var U=A=>{Gy(A,{})},R=A=>{var B=Fy(),F=W(B);$_(F,{get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(ne){n(ne)}});var H=y(F,2);z_(H,{get onsubmit(){return t.onSendChat}}),w(A,B)};$(O,A=>{v(r)==="components"?A(U):A(R,!1)},!0)}w(N,C)};$(E,N=>{v(r)==="context"?N(b):N(k,!1)},!0)}w(g,S)};$(f,g=>{v(r)==="setup"?g(p):g(m,!1)})}w(l,c)},$$slots:{default:!0}}),te(o)}var Hy=T('<details class="svelte-1pjwbaq"><summary class="svelte-1pjwbaq">Details</summary> <!> <!></details>');function qy(e,t){var n=Hy(),r=y(_(n),2);{var s=o=>{Dl(o,{label:"args",get content(){return t.args}})};$(r,o=>{t.args&&o(s)})}var a=y(r,2);{var i=o=>{Dl(o,{label:"result",get content(){return t.result}})};$(a,o=>{t.result&&o(i)})}w(e,n)}var Zy=T('<div class="thought svelte-kirucq"> </div>'),Xy=T('<div class="timeline-item svelte-kirucq"><div class="line svelte-kirucq"></div> <div></div> <div class="timeline-body svelte-kirucq"><div class="row space-between align-center svelte-kirucq"><div class="step-name svelte-kirucq"> </div> <!></div> <!> <!></div></div>');function Ky(e,t){ee(t,!0);var n=Xy(),r=y(_(n),2),s=y(r,2),a=_(s),i=_(a),o=_(i),l=y(i,2);{var u=f=>{dt(f,{variant:"subtle",size:"small",children:(p,m)=>{var g=Xe();D(()=>L(g,`${t.step.latencyMs??""} ms`)),w(p,g)},$$slots:{default:!0}})};$(l,f=>{t.step.latencyMs&&f(u)})}var c=y(a,2);{var d=f=>{var p=Zy(),m=_(p);D(()=>L(m,`"${t.step.thought??""}"`)),w(f,p)};$(c,f=>{t.step.thought&&f(d)})}var h=y(c,2);qy(h,{get args(){return t.step.args},get result(){return t.step.result}}),D(()=>{we(r,1,`dot ${t.step.status??""}`,"svelte-kirucq"),L(o,t.step.name)}),w(e,n),te()}var Jy=T('<div class="timeline svelte-a305uj"></div>');function Yy(e,t){var n=Jy();Le(n,21,()=>t.steps,r=>r.id,(r,s)=>{Ky(r,{get step(){return v(s)}})}),w(e,n)}var Wy=T('<div class="trajectory-header svelte-a3gaf7"><div class="title-small svelte-a3gaf7">Execution Trajectory</div> <!></div> <!>',1);function dd(e,t){ee(t,!1);const n=Zr(),r=na();vt(),Vn(e,{class:"trajectory-card",children:(s,a)=>{var i=Wy(),o=W(i),l=y(_(o),2);{var u=f=>{dt(f,{variant:"subtle",size:"small",children:(p,m)=>{var g=Xe();D(S=>L(g,`trace ${S??""}`),[()=>n.activeTraceId.slice(0,8)]),w(p,g)},$$slots:{default:!0}})};$(l,f=>{n.activeTraceId&&f(u)})}var c=y(o,2);{var d=f=>{ua(f,{inline:!0,title:"No trajectory yet",subtitle:"Send a prompt to see steps."})},h=f=>{var p=Pe(),m=W(p);Of(m,()=>n.activeTraceId,g=>{Yy(g,{get steps(){return r.steps}})}),w(f,p)};$(c,f=>{r.isEmpty?f(d):f(h,!1)})}w(s,i)},$$slots:{default:!0}}),te()}var Qy=T("<!> <!>",1);function eb(e,t){ee(t,!0);let n=je(t,"chatBodyEl",15,null),r;var a={switchToSetup:()=>{r?.switchToSetup()}};return no(e,{position:"center",children:(i,o)=>{var l=Qy(),u=W(l);Ur(cd(u,{get onSendChat(){return t.onSendChat},get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(d){n(d)}}),d=>r=d,()=>r);var c=y(u,2);dd(c,{}),w(i,l)},$$slots:{default:!0}}),te(a)}var tb=T('<div class="events-header svelte-1d58ppa"><div class="title-small svelte-1d58ppa">Planner Events</div> <div class="icon-row svelte-1d58ppa"><!> <select class="filter svelte-1d58ppa"><option>All</option><option>step</option><option>event</option><option>chunk</option><option>artifact_chunk</option></select></div></div>');function nb(e,t){ee(t,!1);const n=Yt(Di());vt();var r=tb(),s=y(_(r),2),a=_(s);a_(a,{onclick:()=>{sn(n,v(n).paused=!v(n).paused)},children:(h,f)=>{var p=Xe();D(()=>L(p,v(n).paused?">":"||")),w(h,p)}});var i=y(a,2);i.__change=h=>{const f=h.currentTarget.value;v(n).setFilter(f||null)};var o=_(i);o.value=o.__value="";var l=y(o);l.value=l.__value="step";var u=y(l);u.value=u.__value="event";var c=y(u);c.value=c.__value="chunk";var d=y(c);d.value=d.__value="artifact_chunk",w(e,r),te()}yt(["change"]);var rb=T('<div class="event-desc svelte-1tjxgju"> </div>'),sb=T('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Args:</span> </div>'),ab=T('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Result:</span> </div>'),ib=T('<div><div class="event-icon svelte-1tjxgju"> </div> <div class="event-main svelte-1tjxgju"><div class="event-header svelte-1tjxgju"><span class="event-name svelte-1tjxgju"> </span> <!></div> <!> <!> <!></div> <!></div>');function ob(e,t){ee(t,!0);let n=je(t,"alt",3,!1);const r={step:{icon:"â¶",variant:"ghost"},tool_call:{icon:"ð§",variant:"subtle"},artifact:{icon:"ð",variant:"subtle"},other:{icon:"â¢",variant:"ghost"}};let s=ye(()=>r[t.event.type]??r.other);function a(R){return R?R<1e3?`${R.toFixed(0)}ms`:`${(R/1e3).toFixed(2)}s`:""}var i=ib();let o;var l=_(i),u=_(l),c=y(l,2),d=_(c),h=_(d),f=_(h),p=y(h,2);{var m=R=>{dt(R,{variant:"subtle",size:"small",children:(A,B)=>{var F=Xe("tool");w(A,F)},$$slots:{default:!0}})},g=R=>{var A=Pe(),B=W(A);{var F=H=>{dt(H,{variant:"subtle",size:"small",children:(ne,fe)=>{var oe=Xe("artifact");w(ne,oe)},$$slots:{default:!0}})};$(B,H=>{t.event.type==="artifact"&&H(F)},!0)}w(R,A)};$(p,R=>{t.event.type==="tool_call"?R(m):R(g,!1)})}var S=y(d,2);{var E=R=>{var A=rb(),B=_(A);D(()=>L(B,t.event.description)),w(R,A)};$(S,R=>{t.event.description&&R(E)})}var b=y(S,2);{var k=R=>{var A=sb(),B=y(_(A));D(()=>L(B,` ${t.event.args??""}`)),w(R,A)};$(b,R=>{t.event.type==="tool_call"&&t.event.args&&R(k)})}var N=y(b,2);{var C=R=>{var A=ab(),B=y(_(A));D(()=>L(B,` ${t.event.result??""}`)),w(R,A)};$(N,R=>{t.event.type==="tool_call"&&t.event.result&&R(C)})}var O=y(c,2);{var U=R=>{dt(R,{variant:"subtle",size:"small",children:(A,B)=>{var F=Xe();D(H=>L(F,H),[()=>a(t.event.duration_ms)]),w(A,F)},$$slots:{default:!0}})};$(O,R=>{t.event.duration_ms&&R(U)})}D(()=>{o=we(i,1,"event-row svelte-1tjxgju",null,o,{alt:n()}),L(u,v(s).icon),L(f,t.event.name)}),w(e,i),te()}var lb=T('<div class="events-body svelte-f0vs81"><!></div>');function ub(e,t){ee(t,!0);const n=Di();let r=ye(()=>n.displayEvents);var s=lb(),a=_(s);{var i=l=>{ua(l,{inline:!0,title:"No events yet",subtitle:"Events will appear during runs."})},o=l=>{var u=Pe(),c=W(u);Le(c,19,()=>v(r),d=>d.id,(d,h,f)=>{{let p=ye(()=>v(f)%2===0);ob(d,{get event(){return v(h)},get alt(){return v(p)}})}}),w(l,u)};$(a,l=>{v(r).length===0?l(i):l(o,!1)})}w(e,s),te()}var cb=T('<div class="artifact-row svelte-ko4yy5"><!> <pre class="svelte-ko4yy5"> </pre></div>'),db=T('<div class="section svelte-ko4yy5"><div class="title-small svelte-ko4yy5">Artifact Streams</div> <!></div>');function fb(e,t){ee(t,!1);const n=na();vt();var r=Pe(),s=W(r);{var a=i=>{var o=db(),l=y(_(o),2);Le(l,1,()=>Object.entries(n.artifactStreams),([u,c])=>u,(u,c)=>{var d=ye(()=>Ed(v(c),2));let h=()=>v(d)[0],f=()=>v(d)[1];var p=cb(),m=_(p);dt(m,{variant:"ghost",size:"small",children:(E,b)=>{var k=Xe();D(()=>L(k,h())),w(E,k)},$$slots:{default:!0}});var g=y(m,2),S=_(g);D(E=>L(S,E),[()=>JSON.stringify(f()[f().length-1],null,2)]),w(u,p)}),w(i,o)};$(s,i=>{n.hasArtifacts&&i(a)})}w(e,r),te()}var vb=T("<!> <!> <!>",1);function fd(e){Vn(e,{class:"events-card",children:(t,n)=>{var r=vb(),s=W(r);nb(s,{});var a=y(s,2);ub(a,{});var i=y(a,2);fb(i,{}),w(t,r)},$$slots:{default:!0}})}var hb=T('<span class="spinner svelte-tbolst"></span>'),pb=Tf('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12L3 7L4.4 5.55L7 8.15V1H9V8.15L11.6 5.55L13 7L8 12Z" fill="currentColor"></path><path d="M2 14V11H4V13H12V11H14V14C14 14.55 13.55 15 13 15H3C2.45 15 2 14.55 2 14Z" fill="currentColor"></path></svg>'),gb=T('<span class="artifact-error svelte-tbolst" role="alert"> </span>'),mb=T('<div class="artifact-item svelte-tbolst"><div class="artifact-info svelte-tbolst"><span class="artifact-icon svelte-tbolst"></span> <div class="artifact-details svelte-tbolst"><span class="artifact-name svelte-tbolst"> </span> <span class="artifact-meta svelte-tbolst"> <!></span></div></div> <button type="button" class="download-btn svelte-tbolst"><!></button> <!></div>');function _b(e,t){ee(t,!0);const n=Zr();let r=G(!1),s=G(null);async function a(){x(r,!0),x(s,null);try{await nc(t.artifact.id,n.sessionId,t.artifact.filename??void 0)}catch(C){x(s,C instanceof Error?C.message:"Download failed",!0)}finally{x(r,!1)}}var i=mb(),o=_(i),l=_(o),u=y(l,2),c=_(u),d=_(c),h=y(c,2),f=_(h),p=y(f);{var m=C=>{dt(C,{size:"small",variant:"subtle",children:(O,U)=>{var R=Xe();D(A=>L(R,A),[()=>sv(t.artifact.mime_type)]),w(O,R)},$$slots:{default:!0}})};$(p,C=>{t.artifact.mime_type&&C(m)})}var g=y(o,2);g.__click=a;var S=_(g);{var E=C=>{var O=hb();w(C,O)},b=C=>{var O=pb();w(C,O)};$(S,C=>{v(r)?C(E):C(b,!1)})}var k=y(g,2);{var N=C=>{var O=gb(),U=_(O);D(()=>L(U,v(s))),w(C,O)};$(k,C=>{v(s)&&C(N)})}D((C,O)=>{Ye(l,"data-type",C),Ye(c,"title",t.artifact.filename||t.artifact.id),L(d,t.artifact.filename||t.artifact.id),L(f,`${O??""} `),Ye(g,"title",v(r)?"Downloading...":"Download"),g.disabled=v(r),Ye(g,"aria-label",v(r)?"Downloading":`Download ${t.artifact.filename||"artifact"}`)},[()=>rv(t.artifact.mime_type),()=>nv(t.artifact.size_bytes)]),w(e,i),te()}yt(["click"]);var yb=T('<span class="count-badge svelte-1cjy38f"> </span>'),bb=T('<span class="spinner svelte-1cjy38f"></span> Downloading...',1),wb=T('<button type="button" class="download-all-btn svelte-1cjy38f"><!></button>'),Sb=T('<p class="no-artifacts svelte-1cjy38f">No artifacts yet. Artifacts will appear here when tools generate downloadable files.</p>'),Eb=T('<div class="artifacts-list svelte-1cjy38f"></div>'),kb=T('<div class="artifacts-header svelte-1cjy38f"><h3 class="artifacts-title svelte-1cjy38f">Artifacts <!></h3> <!></div> <div class="artifacts-body svelte-1cjy38f"><!></div>',1);function vd(e,t){ee(t,!0);let n=G(!1);const r=Av(),s=Zr();async function a(){x(n,!0);for(const i of r.list)try{await nc(i.id,s.sessionId,i.filename??void 0),await new Promise(o=>setTimeout(o,300))}catch{}x(n,!1)}Vn(e,{class:"artifacts-card",children:(i,o)=>{var l=kb(),u=W(l),c=_(u),d=y(_(c));{var h=b=>{var k=yb(),N=_(k);D(()=>L(N,r.count)),w(b,k)};$(d,b=>{r.count>0&&b(h)})}var f=y(c,2);{var p=b=>{var k=wb();k.__click=a;var N=_(k);{var C=U=>{var R=bb();w(U,R)},O=U=>{var R=Xe("Download All");w(U,R)};$(N,U=>{v(n)?U(C):U(O,!1)})}D(()=>{k.disabled=v(n),Ye(k,"aria-label",v(n)?"Downloading all artifacts":"Download all artifacts")}),w(b,k)};$(f,b=>{r.count>1&&b(p)})}var m=y(u,2),g=_(m);{var S=b=>{var k=Sb();w(b,k)},E=b=>{var k=Eb();Le(k,21,()=>r.list,N=>N.id,(N,C)=>{_b(N,{get artifact(){return v(C)}})}),w(b,k)};$(g,b=>{r.count===0?b(S):b(E,!1)})}w(i,l)},$$slots:{default:!0}}),te()}yt(["click"]);var xb=T("<!> <!>",1);function Tb(e){no(e,{position:"right",children:(t,n)=>{var r=xb(),s=W(r);fd(s);var a=y(s,2);vd(a,{}),w(t,r)},$$slots:{default:!0}})}var Ab=T('<div class="tile svelte-9qt9q6"><div class="tile-label svelte-9qt9q6"> </div> <div class="tile-value svelte-9qt9q6"> </div></div>'),Ib=T('<div class="section svelte-9qt9q6"><div class="section-label svelte-9qt9q6">Planner Config</div> <div class="tile-grid svelte-9qt9q6"></div></div>');function Cb(e,t){ee(t,!1);const n=hr();vt();var r=Ib(),s=y(_(r),2);Le(s,5,()=>n.plannerConfig,a=>a.label,(a,i)=>{var o=Ab(),l=_(o),u=_(l),c=y(l,2),d=_(c);D(()=>{L(u,v(i).label),L(d,v(i).value)}),w(a,o)}),w(e,r),te()}var Nb=T('<div class="service-row svelte-k5f3xe"><div><div class="service-name svelte-k5f3xe"> </div> <div class="muted tiny svelte-k5f3xe"> </div></div> <!></div>');function Rb(e,t){ee(t,!0);var n=Nb(),r=_(n),s=_(r),a=_(s),i=y(s,2),o=_(i),l=y(r,2);{let u=ye(()=>t.service.status==="enabled"?"subtle":"ghost");dt(l,{get variant(){return v(u)},size:"small",children:(c,d)=>{var h=Xe();D(()=>L(h,t.service.status)),w(c,h)},$$slots:{default:!0}})}D(()=>{L(a,t.service.name),L(o,t.service.url||"not configured")}),w(e,n),te()}var Ob=T('<div class="section svelte-1eltd2"><div class="section-label svelte-1eltd2">Services</div> <!></div>');function Mb(e,t){ee(t,!1);const n=hr();vt();var r=Ob(),s=y(_(r),2);Le(s,1,()=>n.services,a=>a.name,(a,i)=>{Rb(a,{get service(){return v(i)}})}),w(e,r),te()}var Pb=T('<div class="tool-row svelte-8lkzhn"><div><div class="tool-name svelte-8lkzhn"> </div> <div class="muted tiny svelte-8lkzhn"> </div></div> <div class="tag-row svelte-8lkzhn"></div></div>');function Lb(e,t){ee(t,!0);var n=Pb(),r=_(n),s=_(r),a=_(s),i=y(s,2),o=_(i),l=y(r,2);Le(l,23,()=>t.tool.tags,(u,c)=>`${t.tool.name}-${c}`,(u,c)=>{dt(u,{variant:"ghost",size:"small",children:(d,h)=>{var f=Xe();D(()=>L(f,v(c))),w(d,f)},$$slots:{default:!0}})}),D(()=>{L(a,t.tool.name),L(o,t.tool.desc)}),w(e,n),te()}var Db=T('<div class="section svelte-njx06l"><div class="section-label svelte-njx06l">Tool Catalog</div> <!></div>');function $b(e,t){ee(t,!1);const n=hr();vt();var r=Db(),s=y(_(r),2);Le(s,1,()=>n.catalog,a=>a.name,(a,i)=>{Lb(a,{get tool(){return v(i)}})}),w(e,r),te()}var Ub=T('<div class="title-small svelte-kxiy41">Config & Catalog</div> <!> <!> <!>',1);function jl(e){Vn(e,{class:"config-card",children:(t,n)=>{var r=Ub(),s=y(W(r),2);Cb(s,{});var a=y(s,2);Mb(a,{});var i=y(a,2);$b(i,{}),w(t,r)},$$slots:{default:!0}})}var zb=T('<button type="button"> </button>'),jb=T('<div class="drawer svelte-1g84vkc"><div class="drawer-tabs svelte-1g84vkc"></div> <div class="drawer-content svelte-1g84vkc"><!></div></div>'),Bb=T('<button type="button" class="backdrop svelte-1g84vkc" aria-label="Close menu"></button>'),Gb=T('<header class="mobile-header svelte-1g84vkc"><div class="header-bar svelte-1g84vkc"><button type="button" class="menu-btn svelte-1g84vkc" aria-label="Toggle menu"><span><span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span></span></button> <h1 class="agent-name svelte-1g84vkc"> </h1> <div class="header-spacer svelte-1g84vkc"></div></div> <!></header> <!>',1);function Fb(e,t){ee(t,!0);const n=hr();let r=G(!1),s=G("info");const a=[{id:"info",label:"Info"},{id:"spec",label:"Spec"},{id:"config",label:"Config"}],i=()=>{x(r,!1)};var o=Gb(),l=W(o),u=_(l),c=_(u);c.__click=()=>x(r,!v(r));var d=_(c);let h;var f=y(c,2),p=_(f),m=y(u,2);{var g=b=>{var k=jb(),N=_(k);Le(N,21,()=>a,A=>A.id,(A,B)=>{var F=zb();let H;F.__click=()=>x(s,v(B).id,!0);var ne=_(F);D(()=>{H=we(F,1,"drawer-tab svelte-1g84vkc",null,H,{active:v(s)===v(B).id}),L(ne,v(B).label)}),w(A,F)});var C=y(N,2),O=_(C);{var U=A=>{var B=Pe(),F=W(B);it(F,()=>t.infoContent??$e),w(A,B)},R=A=>{var B=Pe(),F=W(B);{var H=fe=>{var oe=Pe(),Ue=W(oe);it(Ue,()=>t.specContent??$e),w(fe,oe)},ne=fe=>{var oe=Pe(),Ue=W(oe);it(Ue,()=>t.configContent??$e),w(fe,oe)};$(F,fe=>{v(s)==="spec"?fe(H):fe(ne,!1)},!0)}w(A,B)};$(O,A=>{v(s)==="info"?A(U):A(R,!1)})}w(b,k)};$(m,b=>{v(r)&&b(g)})}var S=y(l,2);{var E=b=>{var k=Bb();k.__click=i,w(b,k)};$(S,b=>{v(r)&&b(E)})}D(()=>{h=we(d,1,"hamburger svelte-1g84vkc",null,h,{open:v(r)}),L(p,n.meta.name)}),w(e,o),te()}yt(["click"]);var Vb=T('<button type="button"> </button>'),Hb=T('<div class="panel-tabs svelte-1wcjmjk"></div> <div class="panel-content svelte-1wcjmjk"><!></div>',1),qb=T('<div><button type="button" class="toggle-bar svelte-1wcjmjk"><div class="toggle-handle svelte-1wcjmjk"></div> <span class="toggle-label svelte-1wcjmjk"> </span></button> <!></div>');function Zb(e,t){let n=G(!1),r=G("trajectory");const s=[{id:"trajectory",label:"Steps"},{id:"events",label:"Events"},{id:"artifacts",label:"Artifacts"}];var a=qb();let i;var o=_(a);o.__click=()=>x(n,!v(n));var l=y(_(o),2),u=_(l),c=y(o,2);{var d=h=>{var f=Hb(),p=W(f);Le(p,21,()=>s,b=>b.id,(b,k)=>{var N=Vb();let C;N.__click=()=>x(r,v(k).id,!0);var O=_(N);D(()=>{C=we(N,1,"panel-tab svelte-1wcjmjk",null,C,{active:v(r)===v(k).id}),L(O,v(k).label)}),w(b,N)});var m=y(p,2),g=_(m);{var S=b=>{var k=Pe(),N=W(k);it(N,()=>t.trajectoryContent??$e),w(b,k)},E=b=>{var k=Pe(),N=W(k);{var C=U=>{var R=Pe(),A=W(R);it(A,()=>t.eventsContent??$e),w(U,R)},O=U=>{var R=Pe(),A=W(R);it(A,()=>t.artifactsContent??$e),w(U,R)};$(N,U=>{v(r)==="events"?U(C):U(O,!1)},!0)}w(b,k)};$(g,b=>{v(r)==="trajectory"?b(S):b(E,!1)})}w(h,f)};$(c,h=>{v(n)&&h(d)})}D(()=>{i=we(a,1,"bottom-panel svelte-1wcjmjk",null,i,{open:v(n)}),Ye(o,"aria-label",v(n)?"Hide details panel":"Show details panel"),Ye(o,"aria-expanded",v(n)),L(u,v(n)?"Hide Details":"Show Details")}),w(e,a)}yt(["click"]);var Xb=T('<div class="mobile-layout svelte-1n46o8q"><!> <main class="mobile-main svelte-1n46o8q"><!></main> <!></div>'),Kb=T("<!> <!> <!>",1),Jb=T("<!> <!> <!>",1);function Yb(e,t){ee(t,!0);const n=Wv(),{sessionStore:r,chatStore:s,trajectoryStore:a,agentStore:i,specStore:o,setupStore:l,componentRegistryStore:u,interactionsStore:c}=n,d=Yg(n),h=tm(n);let f=G(null),p=G(void 0),m=G(void 0),g=G(!1);const S=()=>{x(g,window.innerWidth<=1200)};sr(()=>{s.messages.length;const R=s.messages.find(A=>A.isStreaming);R&&`${R.text}${R.observations??""}`,v(f)&&requestAnimationFrame(()=>{v(f)&&(v(f).scrollTop=v(f).scrollHeight)})}),ju(()=>(S(),window.addEventListener("resize",S),E(),()=>{window.removeEventListener("resize",S),d.close(),h.close()}));const E=async()=>{const[R,A,B]=await Promise.all([eh(),nh(),th()]);R&&i.setFromResponse(R),A&&o.setFromSpecData(A),B&&u.setFromPayload(B)},b=()=>{const R=s.input.trim();if(!R||r.isSending)return;l.clearError();const A=l.parseContexts();if(!A){v(g)?v(m)?.switchToSetup():v(p)?.switchToSetup();return}const{toolContext:B,llmContext:F}=A;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),s.addUserMessage(R),s.clearInput(),d.start(R,r.sessionId,B,F,{onDone:async H=>{if(r.activeTraceId=H,H){const ne=await xo(H,r.sessionId);ne&&r.activeTraceId===H&&a.setFromPayload(ne),h.start(H,r.sessionId)}r.isSending=!1},onError:()=>{r.isSending=!1}},l.useAgui?"agui":"sse")},k=(R,A)=>{if(!l.useAgui){l.error="Interactive components require AG-UI streaming.";return}if(!R.resume_token){l.error="Cannot submit: session expired or interrupted. Please resend your message.",c.clearPendingInteraction();return}const B=l.parseContexts();if(!B){v(g)?v(m)?.switchToSetup():v(p)?.switchToSetup();return}const{toolContext:F}=B;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),d.resumeAgui(R,A,r.sessionId,F,{onDone:async H=>{if(r.activeTraceId=H,H){const ne=await xo(H,r.sessionId);ne&&r.activeTraceId===H&&a.setFromPayload(ne),h.start(H,r.sessionId)}r.isSending=!1},onError:H=>{l.error=H||"Failed to submit response. Please try again.",r.isSending=!1}})};var N=Pe(),C=W(N);{var O=R=>{var A=Xb(),B=_(A);Fb(B,{infoContent:ge=>{$l(ge,{})},specContent:ge=>{Ul(ge,{})},configContent:ge=>{jl(ge)},$$slots:{infoContent:!0,specContent:!0,configContent:!0}});var F=y(B,2),H=_(F);Ur(cd(H,{onSendChat:b,onInteractionResult:k,get chatBodyEl(){return v(f)},set chatBodyEl(fe){x(f,fe,!0)}}),fe=>x(m,fe,!0),()=>v(m));var ne=y(F,2);Zb(ne,{trajectoryContent:ge=>{dd(ge,{})},eventsContent:ge=>{fd(ge)},artifactsContent:ge=>{vd(ge,{})}}),w(R,A)},U=R=>{Gm(R,{children:(A,B)=>{var F=Jb(),H=W(F);Fm(H,{children:(oe,Ue)=>{var ge=Kb(),ht=W(ge);$l(ht,{});var zt=y(ht,2);Ul(zt,{});var Ae=y(zt,2);jl(Ae),w(oe,ge)}});var ne=y(H,2);Ur(eb(ne,{onSendChat:b,onInteractionResult:k,get chatBodyEl(){return v(f)},set chatBodyEl(oe){x(f,oe,!0)}}),oe=>x(p,oe,!0),()=>v(p));var fe=y(ne,2);Tb(fe),w(A,F)}})};$(C,R=>{v(g)?R(O):R(U,!1)})}w(e,N),te()}zm();const hd=document.getElementById("app");if(!hd)throw new Error("Missing #app element");Af(Yb,{target:hd});export{W as A,Lu as B,e0 as C,Pe as D,bv as E,Ye as F,wi as G,ju as H,ce as I,Ci as J,de as K,hf as L,ss as M,Bl as N,Qb as O,of as P,Hr as Q,kf as R,Hf as S,n0 as T,Ur as U,r0 as V,Re as _,je as a,Me as b,ye as c,x as d,_ as e,T as f,v as g,y as h,$ as i,Le as j,Bf as k,we as l,L as m,w as n,$r as o,ee as p,t0 as q,te as r,G as s,D as t,sr as u,Er as v,xn as w,yt as x,Ed as y,Xe as z};
