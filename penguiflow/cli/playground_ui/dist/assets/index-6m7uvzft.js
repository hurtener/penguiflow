const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ECharts-CqupL3i4.js","assets/ECharts-SUlEdAZf.css","assets/Mermaid-DHuKDyIY.js","assets/_commonjsHelpers-CqkleIqs.js","assets/purify.es-HRjpPm7y.js","assets/Mermaid-D_q-5SJ2.css","assets/Plotly-iT82rl3a.js","assets/Plotly-BnH91lxL.css","assets/DataGrid-D3lJVewU.js","assets/DataGrid-CnGdOVL9.css","assets/Json-Di4htBNe.js","assets/Json-BfbC447w.css","assets/Metric-DC9rxsFz.js","assets/Metric-BR7LGQoy.css","assets/Markdown-D5s2FDMZ.js","assets/katex-XbL3y5x-.js","assets/Markdown-CElcD4b8.css","assets/katex-DvXFAOB1.css","assets/Code-BXjCgb-K.js","assets/Code-CS6X8G3Y.css","assets/Latex-B937GLtl.js","assets/Latex-De3SCfkv.css","assets/Callout-7s_UdIVM.js","assets/Callout-B-wLDEhr.css","assets/Form-CzNQ41Oz.js","assets/Form-eWoJO6O2.css","assets/Confirm-BWXifF4R.js","assets/Confirm-YhSN8Zxn.css","assets/SelectOption--qSfevVe.js","assets/SelectOption-CEnDdoyK.css","assets/Report-C0BYhrrP.js","assets/Report-DYNw1-yU.css","assets/Grid-XnG42vjI.js","assets/Grid-Cg7MxYKJ.css","assets/Tabs-9kyMOLjb.js","assets/Tabs-BoGLw0iN.css","assets/Accordion-BCTs7xhQ.js","assets/Accordion-2qjp3LnE.css","assets/Image-Cvir6sQN.js","assets/Image-CbfbhndX.css","assets/Html-CxrbKPpz.js","assets/Html-CBo-9Zlq.css","assets/Video-BGd9HufX.js","assets/Video-CRk6YMQD.css","assets/Embed-CuYtRI1M.js","assets/Embed-fxz_xzQf.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const ai=!1;var iu=Array.isArray,Ud=Array.prototype.indexOf,Gi=Array.from,ou=Object.defineProperty,Vn=Object.getOwnPropertyDescriptor,lu=Object.getOwnPropertyDescriptors,zd=Object.prototype,jd=Array.prototype,Bi=Object.getPrototypeOf,xo=Object.isExtensible;function ss(e){return typeof e=="function"}const Ke=()=>{};function Gd(e){return typeof e?.then=="function"}function Bd(e){return e()}function ii(e){for(var t=0;t<e.length;t++)e[t]()}function uu(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}function Fd(e,t){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const n=[];for(const r of e)if(n.push(r),n.length===t)break;return n}const it=2,Fi=4,Ca=8,Vd=1<<24,Cn=16,Nn=32,kr=64,Na=128,Ht=512,st=1024,Et=2048,sn=4096,Ot=8192,bn=16384,Vi=32768,Xn=65536,To=1<<17,cu=1<<18,Jr=1<<19,du=1<<20,hr=32768,oi=1<<21,qi=1<<22,qn=1<<23,Qt=Symbol("$state"),fu=Symbol("legacy props"),qd=Symbol(""),Lr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Hi(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Hd(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Zd(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xd(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Kd(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Jd(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Yd(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wd(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Qd(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ef(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function tf(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const vu=1,hu=2,pu=4,nf=8,rf=16,sf=1,af=2,of=4,lf=8,uf=16,cf=1,df=2,rt=Symbol(),ff="http://www.w3.org/1999/xhtml";function fS(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function vf(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function gu(e){return e===this.v}function _u(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function mu(e){return!_u(e,this.v)}let Yr=!1,hf=!1;function pf(){Yr=!0}let Ce=null;function Gr(e){Ce=e}function Mt(e){return yu().get(e)}function xt(e,t){return yu().set(e,t),t}function oe(e,t=!1,n){Ce={p:Ce,i:!1,c:null,e:null,s:e,x:null,l:Yr&&!t?{s:null,u:null,$:[]}:null}}function le(e){var t=Ce,n=t.e;if(n!==null){t.e=null;for(var r of n)Du(r)}return e!==void 0&&(t.x=e),t.i=!0,Ce=t.p,e??{}}function Er(){return!Yr||Ce!==null&&Ce.l===null}function yu(e){return Ce===null&&Hi(),Ce.c??=new Map(gf(Ce)||void 0)}function gf(e){let t=e.p;for(;t!==null;){const n=t.c;if(n!==null)return n;t=t.p}return null}let ur=[];function bu(){var e=ur;ur=[],ii(e)}function En(e){if(ur.length===0&&!$r){var t=ur;queueMicrotask(()=>{t===ur&&bu()})}ur.push(e)}function _f(){for(;ur.length>0;)bu()}function Su(e){var t=be;if(t===null)return de.f|=qn,e;if((t.f&Vi)===0){if((t.f&Na)===0)throw e;t.b.error(e)}else Br(e,t)}function Br(e,t){for(;t!==null;){if((t.f&Na)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const Ns=new Set;let ke=null,Ds=null,Ut=null,Dt=[],Ra=null,li=!1,$r=!1;class qt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){Dt=[],Ds=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of t)this.#i(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(Ds=this,ke=null,Ao(n.render_effects),Ao(n.effects),Ds=null,this.#l?.resolve()),Ut=null}#i(t,n){t.f^=st;for(var r=t.first;r!==null;){var s=r.f,a=(s&(Nn|kr))!==0,i=a&&(s&st)!==0,o=i||(s&Ot)!==0||this.skipped_effects.has(r);if((r.f&Na)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){a?r.f^=st:(s&Fi)!==0?n.effects.push(r):Wr(r)&&((r.f&Cn)!==0&&n.block_effects.push(r),Fr(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=u.next,u=u.parent}}#o(t){for(const n of t)((n.f&Et)!==0?this.#a:this.#s).push(n),this.#u(n.deps),at(n,st)}#u(t){if(t!==null)for(const n of t)(n.f&it)===0||(n.f&hr)===0||(n.f^=hr,this.#u(n.deps))}capture(t,n){this.previous.has(t)||this.previous.set(t,n),(t.f&qn)===0&&(this.current.set(t,t.v),Ut?.set(t,t.v))}activate(){ke=this,this.apply()}deactivate(){ke===this&&(ke=null,Ut=null)}flush(){if(this.activate(),Dt.length>0){if(ku(),ke!==null&&ke!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#t)t(this);this.#t.clear()}#c(){if(this.#n===0){for(const t of this.#e)t();this.#e.clear()}this.#r===0&&this.#d()}#d(){if(Ns.size>1){this.previous.clear();var t=Ut,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of Ns){if(a===this){n=!1;continue}const i=[];for(const[l,u]of this.current){if(a.current.has(l))if(n&&u!==a.current.get(l))a.current.set(l,u);else continue;i.push(l)}if(i.length===0)continue;const o=[...a.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=Dt;Dt=[];const l=new Set,u=new Map;for(const c of i)Eu(c,o,l,u);if(Dt.length>0){ke=a,a.apply();for(const c of Dt)a.#i(c,r);a.deactivate()}Dt=s}}ke=null,Ut=t}this.committed=!0,Ns.delete(this)}increment(t){this.#r+=1,t&&(this.#n+=1)}decrement(t){this.#r-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#a)at(t,Et),pr(t);for(const t of this.#s)at(t,sn),pr(t);this.#a=[],this.#s=[],this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#t.add(t)}settled(){return(this.#l??=uu()).promise}static ensure(){if(ke===null){const t=ke=new qt;Ns.add(ke),$r||qt.enqueue(()=>{ke===t&&t.flush()})}return ke}static enqueue(t){En(t)}apply(){}}function wu(e){var t=$r;$r=!0;try{for(var n;;){if(_f(),Dt.length===0&&(ke?.flush(),Dt.length===0))return Ra=null,n;ku()}}finally{$r=t}}function ku(){var e=cr;li=!0;var t=null;try{var n=0;for(la(!0);Dt.length>0;){var r=qt.ensure();if(n++>1e3){var s,a;mf()}r.process(Dt),Hn.clear()}}finally{li=!1,la(e),Ra=null}}function mf(){try{Jd()}catch(e){Br(e,Ra)}}let _n=null;function Ao(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(bn|Ot))===0&&Wr(r)&&(_n=new Set,Fr(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?Bu(r):r.fn=null),_n?.size>0)){Hn.clear();for(const s of _n){if((s.f&(bn|Ot))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)_n.has(i)&&(_n.delete(i),a.push(i)),i=i.parent;for(let o=a.length-1;o>=0;o--){const l=a[o];(l.f&(bn|Ot))===0&&Fr(l)}}_n.clear()}}_n=null}}function Eu(e,t,n,r){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const s of e.reactions){const a=s.f;(a&it)!==0?Eu(s,t,n,r):(a&(qi|Cn))!==0&&(a&Et)===0&&xu(s,t,r)&&(at(s,Et),pr(s))}}function xu(e,t,n){const r=n.get(e);if(r!==void 0)return r;if(e.deps!==null)for(const s of e.deps){if(t.includes(s))return!0;if((s.f&it)!==0&&xu(s,t,n))return n.set(s,!0),!0}return n.set(e,!1),!1}function pr(e){for(var t=Ra=e;t.parent!==null;){t=t.parent;var n=t.f;if(li&&t===be&&(n&Cn)!==0&&(n&cu)===0)return;if((n&(kr|Nn))!==0){if((n&st)===0)return;t.f^=st}}Dt.push(t)}function yf(e){let t=0,n=xn(0),r;return()=>{_s()&&(d(n),Wn(()=>(t===0&&(r=ye(()=>e(()=>hs(n)))),t+=1,()=>{En(()=>{t-=1,t===0&&(r?.(),r=void 0,hs(n))})})))}}var bf=Xn|Jr|Na;function Sf(e,t,n){new wf(e,t,n)}class wf{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#u=null;#c=null;#d=0;#f=0;#h=!1;#v=null;#y=yf(()=>(this.#v=xn(this.#d),()=>{this.#v=null}));constructor(t,n,r){this.#t=t,this.#n=n,this.#l=r,this.parent=be.b,this.#e=!!this.#n.pending,this.#a=xr(()=>{be.b=this;{var s=this.#_();try{this.#s=$t(()=>r(s))}catch(a){this.error(a)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#c?.remove()}},bf)}#b(){try{this.#s=$t(()=>this.#l(this.#t))}catch(t){this.error(t)}this.#e=!1}#S(){const t=this.#n.pending;t&&(this.#i=$t(()=>t(this.#t)),qt.enqueue(()=>{var n=this.#_();this.#s=this.#p(()=>(qt.ensure(),$t(()=>this.#l(n)))),this.#f>0?this.#g():(Ur(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#_(){var t=this.#t;return this.#e&&(this.#c=An(),this.#t.before(this.#c),t=this.#c),t}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var n=be,r=de,s=Ce;tn(this.#a),St(this.#a),Gr(this.#a.ctx);try{return t()}catch(a){return Su(a),null}finally{tn(n),St(r),Gr(s)}}#g(){const t=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),qu(this.#s,this.#u)),this.#i===null&&(this.#i=$t(()=>t(this.#t)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#f+=t,this.#f===0&&(this.#e=!1,this.#i&&Ur(this.#i,()=>{this.#i=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(t){this.#m(t),this.#d+=t,this.#v&&Sn(this.#v,this.#d)}get_effect_pending(){return this.#y(),d(this.#v)}error(t){var n=this.#n.onerror;let r=this.#n.failed;if(this.#h||!n&&!r)throw t;this.#s&&(wt(this.#s),this.#s=null),this.#i&&(wt(this.#i),this.#i=null),this.#o&&(wt(this.#o),this.#o=null);var s=!1,a=!1;const i=()=>{if(s){vf();return}s=!0,a&&tf(),qt.ensure(),this.#d=0,this.#o!==null&&Ur(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#h=!1,$t(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var o=de;try{St(null),a=!0,n?.(t,i),a=!1}catch(l){Br(l,this.#a&&this.#a.parent)}finally{St(o)}r&&En(()=>{this.#o=this.#p(()=>{qt.ensure(),this.#h=!0;try{return $t(()=>{r(this.#t,()=>t,()=>i)})}catch(l){return Br(l,this.#a.parent),null}finally{this.#h=!1}})})}}function kf(e,t,n,r){const s=Er()?Es:Oa;if(n.length===0&&e.length===0){r(t.map(s));return}var a=ke,i=be,o=Tu();function l(){Promise.all(n.map(u=>Ef(u))).then(u=>{o();try{r([...t.map(s),...u])}catch(c){(i.f&bn)===0&&Br(c,i)}a?.deactivate(),gs()}).catch(u=>{Br(u,i)})}e.length>0?Promise.all(e).then(()=>{o();try{return l()}finally{a?.deactivate(),gs()}}):l()}function Tu(){var e=be,t=de,n=Ce,r=ke;return function(a=!0){tn(e),St(t),Gr(n),a&&r?.activate()}}function gs(){tn(null),St(null),Gr(null)}function Es(e){var t=it|Et,n=de!==null&&(de.f&it)!==0?de:null;return be!==null&&(be.f|=Jr),{ctx:Ce,deps:null,effects:null,equals:gu,f:t,fn:e,reactions:null,rv:0,v:rt,wv:0,parent:n??be,ac:null}}function Ef(e,t){let n=be;n===null&&Hd();var r=n.b,s=void 0,a=xn(rt),i=!de,o=new Map;return Lf(()=>{var l=uu();s=l.promise;try{Promise.resolve(e()).then(l.resolve,l.reject).then(()=>{u===ke&&u.committed&&u.deactivate(),gs()})}catch(h){l.reject(h),gs()}var u=ke;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),o.get(u)?.reject(Lr),o.delete(u),o.set(u,l)}const f=(h,v=void 0)=>{if(u.activate(),v)v!==Lr&&(a.f|=qn,Sn(a,v));else{(a.f&qn)!==0&&(a.f^=qn),Sn(a,h);for(const[p,m]of o){if(o.delete(p),p===u)break;m.reject(Lr)}}i&&(r.update_pending_count(-1),u.decrement(c))};l.promise.then(f,h=>f(null,h||"unknown"))}),Ts(()=>{for(const l of o.values())l.reject(Lr)}),new Promise(l=>{function u(c){function f(){c===s?l(a):u(s)}c.then(f,f)}u(s)})}function ue(e){const t=Es(e);return Hu(t),t}function Oa(e){const t=Es(e);return t.equals=mu,t}function Au(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)wt(t[n])}}function xf(e){for(var t=e.parent;t!==null;){if((t.f&it)===0)return(t.f&bn)===0?t:null;t=t.parent}return null}function Zi(e){var t,n=be;tn(xf(e));try{e.f&=~hr,Au(e),t=Ju(e)}finally{tn(n)}return t}function Iu(e){var t=Zi(e);if(e.equals(t)||(ke?.is_fork||(e.v=t),e.wv=Xu()),!Tr)if(Ut!==null)(_s()||ke?.is_fork)&&Ut.set(e,t);else{var n=(e.f&Ht)===0?sn:st;at(e,n)}}let ui=new Set;const Hn=new Map;let Cu=!1;function xn(e,t){var n={f:0,v:e,reactions:null,equals:gu,rv:0,wv:0};return n}function G(e,t){const n=xn(e);return Hu(n),n}function Tn(e,t=!1,n=!0){const r=xn(e);return t||(r.equals=mu),Yr&&n&&Ce!==null&&Ce.l!==null&&(Ce.l.s??=[]).push(r),r}function Gn(e,t){return x(e,ye(()=>d(e))),t}function x(e,t,n=!1){de!==null&&(!Wt||(de.f&To)!==0)&&Er()&&(de.f&(it|Cn|qi|To))!==0&&!wn?.includes(e)&&ef();let r=n?je(t):t;return Sn(e,r)}function Sn(e,t){if(!e.equals(t)){var n=e.v;Tr?Hn.set(e,t):Hn.set(e,n),e.v=t;var r=qt.ensure();r.capture(e,n),(e.f&it)!==0&&((e.f&Et)!==0&&Zi(e),at(e,(e.f&Ht)!==0?st:sn)),e.wv=Xu(),Nu(e,Et),Er()&&be!==null&&(be.f&st)!==0&&(be.f&(Nn|kr))===0&&(Lt===null?$f([e]):Lt.push(e)),!r.is_fork&&ui.size>0&&!Cu&&Tf()}return t}function Tf(){Cu=!1;var e=cr;la(!0);const t=Array.from(ui);try{for(const n of t)(n.f&st)!==0&&at(n,sn),Wr(n)&&Fr(n)}finally{la(e)}ui.clear()}function hs(e){x(e,e.v+1)}function Nu(e,t){var n=e.reactions;if(n!==null)for(var r=Er(),s=n.length,a=0;a<s;a++){var i=n[a],o=i.f;if(!(!r&&i===be)){var l=(o&Et)===0;if(l&&at(i,t),(o&it)!==0){var u=i;Ut?.delete(u),(o&hr)===0&&(o&Ht&&(i.f|=hr),Nu(u,sn))}else l&&((o&Cn)!==0&&_n!==null&&_n.add(i),pr(i))}}}function je(e){if(typeof e!="object"||e===null||Qt in e)return e;const t=Bi(e);if(t!==zd&&t!==jd)return e;var n=new Map,r=iu(e),s=G(0),a=dr,i=o=>{if(dr===a)return o();var l=de,u=dr;St(null),Oo(a);var c=o();return St(l),Oo(u),c};return r&&n.set("length",G(e.length)),new Proxy(e,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Wd();var c=n.get(l);return c===void 0?c=i(()=>{var f=G(u.value);return n.set(l,f),f}):x(c,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const c=i(()=>G(rt));n.set(l,c),hs(s)}}else x(u,rt),hs(s);return!0},get(o,l,u){if(l===Qt)return e;var c=n.get(l),f=l in o;if(c===void 0&&(!f||Vn(o,l)?.writable)&&(c=i(()=>{var v=je(f?o[l]:rt),p=G(v);return p}),n.set(l,c)),c!==void 0){var h=d(c);return h===rt?void 0:h}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=d(c))}else if(u===void 0){var f=n.get(l),h=f?.v;if(f!==void 0&&h!==rt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(o,l){if(l===Qt)return!0;var u=n.get(l),c=u!==void 0&&u.v!==rt||Reflect.has(o,l);if(u!==void 0||be!==null&&(!c||Vn(o,l)?.writable)){u===void 0&&(u=i(()=>{var h=c?je(o[l]):rt,v=G(h);return v}),n.set(l,u));var f=d(u);if(f===rt)return!1}return c},set(o,l,u,c){var f=n.get(l),h=l in o;if(r&&l==="length")for(var v=u;v<f.v;v+=1){var p=n.get(v+"");p!==void 0?x(p,rt):v in o&&(p=i(()=>G(rt)),n.set(v+"",p))}if(f===void 0)(!h||Vn(o,l)?.writable)&&(f=i(()=>G(void 0)),x(f,je(u)),n.set(l,f));else{h=f.v!==rt;var m=i(()=>je(u));x(f,m)}var _=Reflect.getOwnPropertyDescriptor(o,l);if(_?.set&&_.set.call(c,u),!h){if(r&&typeof l=="string"){var k=n.get("length"),S=Number(l);Number.isInteger(S)&&S>=k.v&&x(k,S+1)}hs(s)}return!0},ownKeys(o){d(s);var l=Reflect.ownKeys(o).filter(f=>{var h=n.get(f);return h===void 0||h.v!==rt});for(var[u,c]of n)c.v!==rt&&!(u in o)&&l.push(u);return l},setPrototypeOf(){Qd()}})}function Io(e){try{if(e!==null&&typeof e=="object"&&Qt in e)return e[Qt]}catch{}return e}function Af(e,t){return Object.is(Io(e),Io(t))}var Co,Ru,Ou,Mu;function If(){if(Co===void 0){Co=window,Ru=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ou=Vn(t,"firstChild").get,Mu=Vn(t,"nextSibling").get,xo(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),xo(n)&&(n.__t=void 0)}}function An(e=""){return document.createTextNode(e)}function Yt(e){return Ou.call(e)}function xs(e){return Mu.call(e)}function g(e,t){return Yt(e)}function ne(e,t=!1){{var n=Yt(e);return n instanceof Comment&&n.data===""?xs(n):n}}function y(e,t=1,n=!1){let r=e;for(;t--;)r=xs(r);return r}function Cf(e){e.textContent=""}function Pu(){return!1}let No=!1;function Nf(){No||(No=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function Ma(e){var t=de,n=be;St(null),tn(null);try{return e()}finally{St(t),tn(n)}}function Xi(e,t,n,r=n){e.addEventListener(t,()=>Ma(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Nf()}function Lu(e){be===null&&(de===null&&Kd(),Xd()),Tr&&Zd()}function Rf(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function an(e,t,n){var r=be;r!==null&&(r.f&Ot)!==0&&(e|=Ot);var s={ctx:Ce,deps:null,nodes:null,f:e|Et|Ht,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Fr(s),s.f|=Vi}catch(o){throw wt(s),o}else t!==null&&pr(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&Jr)===0&&(a=a.first,(e&Cn)!==0&&(e&Xn)!==0&&a!==null&&(a.f|=Xn)),a!==null&&(a.parent=r,r!==null&&Rf(a,r),de!==null&&(de.f&it)!==0&&(e&kr)===0)){var i=de;(i.effects??=[]).push(a)}return s}function _s(){return de!==null&&!Wt}function Ts(e){const t=an(Ca,null,!1);return at(t,st),t.teardown=e,t}function gr(e){Lu();var t=be.f,n=!de&&(t&Nn)!==0&&(t&Vi)===0;if(n){var r=Ce;(r.e??=[]).push(e)}else return Du(e)}function Du(e){return an(Fi|du,e,!1)}function Of(e){return Lu(),an(Ca|du,e,!0)}function Mf(e){qt.ensure();const t=an(kr|Jr,e,!0);return(n={})=>new Promise(r=>{n.outro?Ur(t,()=>{wt(t),r(void 0)}):(wt(t),r(void 0))})}function Pf(e){return an(Fi,e,!1)}function $u(e,t){var n=Ce,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=Wn(()=>{e(),!r.ran&&(r.ran=!0,ye(t))})}function Uu(){var e=Ce;Wn(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&st)!==0&&at(n,sn),Wr(n)&&Fr(n),t.ran=!1}})}function Lf(e){return an(qi|Jr,e,!0)}function Wn(e,t=0){return an(Ca|t,e,!0)}function P(e,t=[],n=[],r=[]){kf(r,t,n,s=>{an(Ca,()=>e(...s.map(d)),!0)})}function xr(e,t=0){var n=an(Cn|t,e,!0);return n}function $t(e){return an(Nn|Jr,e,!0)}function zu(e){var t=e.teardown;if(t!==null){const n=Tr,r=de;Ro(!0),St(null);try{t.call(null)}finally{Ro(n),St(r)}}}function ju(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&Ma(()=>{s.abort(Lr)});var r=n.next;(n.f&kr)!==0?n.parent=null:wt(n,t),n=r}}function Df(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Nn)===0&&wt(t),t=n}}function wt(e,t=!0){var n=!1;(t||(e.f&cu)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Gu(e.nodes.start,e.nodes.end),n=!0),ju(e,t&&!n),ua(e,0),at(e,bn);var r=e.nodes&&e.nodes.t;if(r!==null)for(const a of r)a.stop();zu(e);var s=e.parent;s!==null&&s.first!==null&&Bu(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Gu(e,t){for(;e!==null;){var n=e===t?null:xs(e);e.remove(),e=n}}function Bu(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Ur(e,t,n=!0){var r=[];Ki(e,r,!0),Fu(r,()=>{n&&wt(e),t&&t()})}function Fu(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Ki(e,t,n){if((e.f&Ot)===0){e.f^=Ot;var r=e.nodes&&e.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&t.push(o);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&Xn)!==0||(s.f&Nn)!==0&&(e.f&Cn)!==0;Ki(s,t,i?n:!1),s=a}}}function Ji(e){Vu(e,!0)}function Vu(e,t){if((e.f&Ot)!==0){e.f^=Ot,(e.f&st)===0&&(at(e,Et),pr(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&Xn)!==0||(n.f&Nn)!==0;Vu(n,s?t:!1),n=r}var a=e.nodes&&e.nodes.t;if(a!==null)for(const i of a)(i.is_global||t)&&i.in()}}function qu(e,t){if(e.nodes)for(var n=e.nodes.start,r=e.nodes.end;n!==null;){var s=n===r?null:xs(n);t.append(n),n=s}}let cr=!1;function la(e){cr=e}let Tr=!1;function Ro(e){Tr=e}let de=null,Wt=!1;function St(e){de=e}let be=null;function tn(e){be=e}let wn=null;function Hu(e){de!==null&&(wn===null?wn=[e]:wn.push(e))}let ct=null,Nt=0,Lt=null;function $f(e){Lt=e}let Zu=1,ms=0,dr=ms;function Oo(e){dr=e}function Xu(){return++Zu}function Wr(e){var t=e.f;if((t&Et)!==0)return!0;if(t&it&&(e.f&=~hr),(t&sn)!==0){var n=e.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(Wr(a)&&Iu(a),a.wv>e.wv)return!0}(t&Ht)!==0&&Ut===null&&at(e,st)}return!1}function Ku(e,t,n=!0){var r=e.reactions;if(r!==null&&!wn?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&it)!==0?Ku(a,t,!1):t===a&&(n?at(a,Et):(a.f&st)!==0&&at(a,sn),pr(a))}}function Ju(e){var t=ct,n=Nt,r=Lt,s=de,a=wn,i=Ce,o=Wt,l=dr,u=e.f;ct=null,Nt=0,Lt=null,de=(u&(Nn|kr))===0?e:null,wn=null,Gr(e.ctx),Wt=!1,dr=++ms,e.ac!==null&&(Ma(()=>{e.ac.abort(Lr)}),e.ac=null);try{e.f|=oi;var c=e.fn,f=c(),h=e.deps;if(ct!==null){var v;if(ua(e,Nt),h!==null&&Nt>0)for(h.length=Nt+ct.length,v=0;v<ct.length;v++)h[Nt+v]=ct[v];else e.deps=h=ct;if(_s()&&(e.f&Ht)!==0)for(v=Nt;v<h.length;v++)(h[v].reactions??=[]).push(e)}else h!==null&&Nt<h.length&&(ua(e,Nt),h.length=Nt);if(Er()&&Lt!==null&&!Wt&&h!==null&&(e.f&(it|sn|Et))===0)for(v=0;v<Lt.length;v++)Ku(Lt[v],e);return s!==null&&s!==e&&(ms++,Lt!==null&&(r===null?r=Lt:r.push(...Lt))),(e.f&qn)!==0&&(e.f^=qn),f}catch(p){return Su(p)}finally{e.f^=oi,ct=t,Nt=n,Lt=r,de=s,wn=a,Gr(i),Wt=o,dr=l}}function Uf(e,t){let n=t.reactions;if(n!==null){var r=Ud.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&it)!==0&&(ct===null||!ct.includes(t))&&(at(t,sn),(t.f&Ht)!==0&&(t.f^=Ht,t.f&=~hr),Au(t),ua(t,0))}function ua(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)Uf(e,n[r])}function Fr(e){var t=e.f;if((t&bn)===0){at(e,st);var n=be,r=cr;be=e,cr=!0;try{(t&(Cn|Vd))!==0?Df(e):ju(e),zu(e);var s=Ju(e);e.teardown=typeof s=="function"?s:null,e.wv=Zu;var a;ai&&hf&&(e.f&Et)!==0&&e.deps}finally{cr=r,be=n}}}async function zf(){await Promise.resolve(),wu()}function d(e){var t=e.f,n=(t&it)!==0;if(de!==null&&!Wt){var r=be!==null&&(be.f&bn)!==0;if(!r&&!wn?.includes(e)){var s=de.deps;if((de.f&oi)!==0)e.rv<ms&&(e.rv=ms,ct===null&&s!==null&&s[Nt]===e?Nt++:ct===null?ct=[e]:ct.includes(e)||ct.push(e));else{(de.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[de]:a.includes(de)||a.push(de)}}}if(Tr){if(Hn.has(e))return Hn.get(e);if(n){var i=e,o=i.v;return((i.f&st)===0&&i.reactions!==null||Wu(i))&&(o=Zi(i)),Hn.set(i,o),o}}else n&&(!Ut?.has(e)||ke?.is_fork&&!_s())&&(i=e,Wr(i)&&Iu(i),cr&&_s()&&(i.f&Ht)===0&&Yu(i));if(Ut?.has(e))return Ut.get(e);if((e.f&qn)!==0)throw e.v;return e.v}function Yu(e){if(e.deps!==null){e.f^=Ht;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&it)!==0&&(t.f&Ht)===0&&Yu(t)}}function Wu(e){if(e.v===rt)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(Hn.has(t)||(t.f&it)!==0&&Wu(t))return!0;return!1}function ye(e){var t=Wt;try{return Wt=!0,e()}finally{Wt=t}}const jf=-7169;function at(e,t){e.f=e.f&jf|t}function bt(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Qt in e)ci(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Qt in n&&ci(n)}}}function ci(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{ci(e[r],t)}catch{}const n=Bi(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=lu(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const Gf=["touchstart","touchmove"];function Bf(e){return Gf.includes(e)}const Qu=new Set,di=new Set;function Ff(e,t,n,r={}){function s(a){if(r.capture||ls.call(t,a),!a.cancelBubble)return Ma(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?En(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function Vf(e,t,n,r,s){var a={capture:r,passive:s},i=Ff(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Ts(()=>{t.removeEventListener(e,i,a)})}function Tt(e){for(var t=0;t<e.length;t++)Qu.add(e[t]);for(var n of di)n(e)}let Mo=null;function ls(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;Mo=e;var i=0,o=Mo===e&&e.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;l<=u&&(i=l)}if(a=s[i]||e.target,a!==t){ou(e,"currentTarget",{configurable:!0,get(){return a||n}});var c=de,f=be;St(null),tn(null);try{for(var h,v=[];a!==null;){var p=a.assignedSlot||a.parentNode||a.host||null;try{var m=a["__"+r];m!=null&&(!a.disabled||e.target===a)&&m.call(a,e)}catch(_){h?v.push(_):h=_}if(e.cancelBubble||p===t||p===null)break;a=p}if(h){for(let _ of v)queueMicrotask(()=>{throw _});throw h}}finally{e.__root=t,delete e.currentTarget,St(c),tn(f)}}}function Yi(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Vr(e,t){var n=be;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function E(e,t){var n=(t&cf)!==0,r=(t&df)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Yi(a?e:"<!>"+e),n||(s=Yt(s)));var i=r||Ru?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=Yt(i),l=i.lastChild;Vr(o,l)}else Vr(i,i);return i}}function qf(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var i=Yi(s),o=Yt(i);a=Yt(o)}var l=a.cloneNode(!0);return Vr(l,l),l}}function Hf(e,t){return qf(e,t,"svg")}function tt(e=""){{var t=An(e+"");return Vr(t,t),t}}function Ze(){var e=document.createDocumentFragment(),t=document.createComment(""),n=An();return e.append(t,n),Vr(t,n),e}function b(e,t){e!==null&&e.before(t)}function N(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function Zf(e,t){return Xf(e,t)}const Nr=new Map;function Xf(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:i=!0}){If();var o=new Set,l=f=>{for(var h=0;h<f.length;h++){var v=f[h];if(!o.has(v)){o.add(v);var p=Bf(v);t.addEventListener(v,ls,{passive:p});var m=Nr.get(v);m===void 0?(document.addEventListener(v,ls,{passive:p}),Nr.set(v,1)):Nr.set(v,m+1)}}};l(Gi(Qu)),di.add(l);var u=void 0,c=Mf(()=>{var f=n??t.appendChild(An());return Sf(f,{pending:()=>{}},h=>{if(a){oe({});var v=Ce;v.c=a}s&&(r.$$events=s),u=e(h,r)||{},a&&le()}),()=>{for(var h of o){t.removeEventListener(h,ls);var v=Nr.get(h);--v===0?(document.removeEventListener(h,ls),Nr.delete(h)):Nr.set(h,v)}di.delete(l),f!==n&&f.parentNode?.removeChild(f)}});return Kf.set(u,c),u}let Kf=new WeakMap;class As{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(t,n=!0){this.anchor=t,this.#l=n}#a=()=>{var t=ke;if(this.#e.has(t)){var n=this.#e.get(t),r=this.#t.get(n);if(r)Ji(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===t)break;const o=this.#r.get(i);o&&(wt(o.effect),this.#r.delete(i))}for(const[a,i]of this.#t){if(a===n||this.#n.has(a))continue;const o=()=>{if(Array.from(this.#e.values()).includes(a)){var u=document.createDocumentFragment();qu(i,u),u.append(An()),this.#r.set(a,{effect:i,fragment:u})}else wt(i);this.#n.delete(a),this.#t.delete(a)};this.#l||!r?(this.#n.add(a),Ur(i,o,!1)):o()}}};#s=t=>{this.#e.delete(t);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(wt(s.effect),this.#r.delete(r))};ensure(t,n){var r=ke,s=Pu();if(n&&!this.#t.has(t)&&!this.#r.has(t))if(s){var a=document.createDocumentFragment(),i=An();a.append(i),this.#r.set(t,{effect:$t(()=>n(i)),fragment:a})}else this.#t.set(t,$t(()=>n(this.anchor)));if(this.#e.set(r,t),s){for(const[o,l]of this.#t)o===t?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===t?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}const Jf=0,Ba=1;function Yf(e,t,n,r,s){var a=Er(),i=rt,o=a?xn(i):Tn(i,!1,!1),l=a?xn(i):Tn(i,!1,!1),u=new As(e);xr(()=>{var c=t(),f=!1;if(Gd(c)){var h=Tu(),v=!1;const p=m=>{if(!f){v=!0,h(!1),qt.ensure();try{m()}finally{gs(),$r||wu()}}};c.then(m=>{p(()=>{Sn(o,m),u.ensure(Ba,r&&(_=>r(_,o)))})},m=>{p(()=>{if(Sn(l,m),u.ensure(Ba,s&&(_=>s(_,l))),!s)throw l.v})}),En(()=>{v||p(()=>{u.ensure(Jf,n)})})}else Sn(o,c),u.ensure(Ba,r&&(p=>r(p,o)));return()=>{f=!0}})}function M(e,t,n=!1){var r=new As(e),s=n?Xn:0;function a(i,o){r.ensure(i,o)}xr(()=>{var i=!1;t((o,l=!0)=>{i=!0,a(l,o)}),i||a(!1,null)},s)}function Wf(e,t,n){var r=new As(e),s=!Er();xr(()=>{var a=t();s&&a!==null&&typeof a=="object"&&(a={}),r.ensure(a,n)})}function qr(e,t){return t}function Qf(e,t,n){for(var r=[],s=t.length,a=0;a<s;a++)Ki(t[a].e,r,!0);Fu(r,()=>{var i=r.length===0&&n!==null;if(i){var o=n,l=o.parentNode;Cf(l),l.append(o),e.items.clear(),Bt(e,t[0].prev,t[s-1].next)}for(var u=0;u<s;u++){var c=t[u];i||(e.items.delete(c.k),Bt(e,c.prev,c.next)),wt(c.e,!i)}e.first===t[0]&&(e.first=t[0].prev)})}function Me(e,t,n,r,s,a=null){var i=e,o=new Map,l=null,u=(t&pu)!==0,c=(t&vu)!==0,f=(t&hu)!==0;if(u){var h=e;i=h.appendChild(An())}var v=null,p=Oa(()=>{var T=n();return iu(T)?T:T==null?[]:Gi(T)}),m,_=!0;function k(){ev(w,m,i,t,r),v!==null&&(m.length===0?(v.fragment?(i.before(v.fragment),v.fragment=null):Ji(v.effect),S.first=v.effect):Ur(v.effect,()=>{v=null}))}var S=xr(()=>{m=d(p);for(var T=m.length,C=new Set,A=ke,R=null,U=Pu(),$=0;$<T;$+=1){var I=m[$],j=r(I,$),B=_?null:o.get(j);B?(c&&Sn(B.v,I),f&&Sn(B.i,$),U&&A.skipped_effects.delete(B.e)):(B=tv(_?i:null,R,I,j,$,s,t,n),_&&(B.o=!0,R===null?l=B:R.next=B,R=B),o.set(j,B)),C.add(j)}if(T===0&&a&&!v)if(_)v={fragment:null,effect:$t(()=>a(i))};else{var q=document.createDocumentFragment(),Q=An();q.append(Q),v={fragment:q,effect:$t(()=>a(Q))}}if(!_)if(U){for(const[ee,re]of o)C.has(ee)||A.skipped_effects.add(re.e);A.oncommit(k),A.ondiscard(()=>{})}else k();d(p)}),w={effect:S,items:o,first:l};_=!1}function ev(e,t,n,r,s){var a=(r&nf)!==0,i=t.length,o=e.items,l=e.first,u,c=null,f,h=[],v=[],p,m,_,k;if(a)for(k=0;k<i;k+=1)p=t[k],m=s(p,k),_=o.get(m),_.o&&(_.e.nodes?.a?.measure(),(f??=new Set).add(_));for(k=0;k<i;k+=1){if(p=t[k],m=s(p,k),_=o.get(m),e.first??=_,!_.o){_.o=!0;var S=c?c.next:l;Bt(e,c,_),Bt(e,_,S),Fa(_,S,n),c=_,h=[],v=[],l=c.next;continue}if((_.e.f&Ot)!==0&&(Ji(_.e),a&&(_.e.nodes?.a?.unfix(),(f??=new Set).delete(_))),_!==l){if(u!==void 0&&u.has(_)){if(h.length<v.length){var w=v[0],T;c=w.prev;var C=h[0],A=h[h.length-1];for(T=0;T<h.length;T+=1)Fa(h[T],w,n);for(T=0;T<v.length;T+=1)u.delete(v[T]);Bt(e,C.prev,A.next),Bt(e,c,C),Bt(e,A,w),l=w,c=A,k-=1,h=[],v=[]}else u.delete(_),Fa(_,l,n),Bt(e,_.prev,_.next),Bt(e,_,c===null?e.first:c.next),Bt(e,c,_),c=_;continue}for(h=[],v=[];l!==null&&l!==_;)(l.e.f&Ot)===0&&(u??=new Set).add(l),v.push(l),l=l.next;if(l===null)continue;_=l}h.push(_),c=_,l=_.next}let R=o.size>i;if(l!==null||u!==void 0){for(var U=u===void 0?[]:Gi(u);l!==null;)(l.e.f&Ot)===0&&U.push(l),l=l.next;var $=U.length;if(R=o.size-$>i,$>0){var I=(r&pu)!==0&&i===0?n:null;if(a){for(k=0;k<$;k+=1)U[k].e.nodes?.a?.measure();for(k=0;k<$;k+=1)U[k].e.nodes?.a?.fix()}Qf(e,U,I)}}if(R)for(const j of o.values())j.o||(Bt(e,c,j),c=j);e.effect.last=c&&c.e,a&&En(()=>{if(f!==void 0)for(_ of f)_.e.nodes?.a?.apply()})}function tv(e,t,n,r,s,a,i,o){var l=(i&vu)!==0,u=(i&rf)===0,c=l?u?Tn(n,!1,!1):xn(n):n,f=(i&hu)===0?s:xn(s),h={i:f,v:c,k:r,e:null,o:!1,prev:t,next:null};if(e===null){var v=document.createDocumentFragment();v.append(e=An())}return h.e=$t(()=>a(e,c,f,o)),t!==null&&(t.next=h),h}function Fa(e,t,n){if(e.e.nodes)for(var r=e.next?e.next.e.nodes.start:n,s=t?t.e.nodes.start:n,a=e.e.nodes.start;a!==null&&a!==r;){var i=xs(a);s.before(a),a=i}}function Bt(e,t,n){t===null?(e.first=n,e.effect.first=n&&n.e):(t.e.next&&(t.e.next.prev=null),t.next=n,t.e.next=n&&n.e),n!==null&&(n.e.prev&&(n.e.prev.next=null),n.prev=t,n.e.prev=t&&t.e)}function ec(e,t,n=!1,r=!1,s=!1){var a=e,i="";P(()=>{var o=be;if(i!==(i=t()??"")&&(o.nodes!==null&&(Gu(o.nodes.start,o.nodes.end),o.nodes=null),i!=="")){var l=i+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=Yi(l);if((n||r)&&(u=Yt(u)),Vr(Yt(u),u.lastChild),n||r)for(;Yt(u);)a.before(Yt(u));else a.before(u)}})}function nv(e,t,n,r,s){var a=t.$$slots?.[n],i=!1;a===!0&&(a=t[n],i=!0),a===void 0?s!==null&&s(e):a(e,i?()=>r:r)}function kt(e,t,...n){var r=new As(e);xr(()=>{const s=t()??null;r.ensure(s,s&&(a=>s(a,...n)))},Xn)}function rv(e,t,n){var r=new As(e);xr(()=>{var s=t()??null;r.ensure(s,s&&(a=>n(a,s)))},Xn)}function tc(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=tc(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function sv(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=tc(e))&&(r&&(r+=" "),r+=t);return r}function vS(e){return typeof e=="object"?sv(e):e??""}const Po=[...` 	
\r\fÂ \v\uFEFF`];function av(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,i=0;(i=r.indexOf(s,i))>=0;){var o=i+a;(i===0||Po.includes(r[i-1]))&&(o===r.length||Po.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function Lo(e,t=!1){var n=t?" !important;":";",r="";for(var s in e){var a=e[s];a!=null&&a!==""&&(r+=" "+s+": "+a+n)}return r}function Va(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function iv(e,t){if(t){var n="",r,s;if(Array.isArray(t)?(r=t[0],s=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,i=0,o=!1,l=[];r&&l.push(...Object.keys(r).map(Va)),s&&l.push(...Object.keys(s).map(Va));var u=0,c=-1;const m=e.length;for(var f=0;f<m;f++){var h=e[f];if(o?h==="/"&&e[f-1]==="*"&&(o=!1):a?a===h&&(a=!1):h==="/"&&e[f+1]==="*"?o=!0:h==='"'||h==="'"?a=h:h==="("?i++:h===")"&&i--,!o&&a===!1&&i===0){if(h===":"&&c===-1)c=f;else if(h===";"||f===m-1){if(c!==-1){var v=Va(e.substring(u,c).trim());if(!l.includes(v)){h!==";"&&f++;var p=e.substring(u,f).trim();n+=" "+p+";"}}u=f+1,c=-1}}}}return r&&(n+=Lo(r)),s&&(n+=Lo(s,!0)),n=n.trim(),n===""?null:n}return e==null?null:String(e)}function Ee(e,t,n,r,s,a){var i=e.__className;if(i!==n||i===void 0){var o=av(n,r,a);o==null?e.removeAttribute("class"):e.className=o,e.__className=n}else if(a&&s!==a)for(var l in a){var u=!!a[l];(s==null||u!==!!s[l])&&e.classList.toggle(l,u)}return a}function qa(e,t={},n,r){for(var s in n){var a=n[s];t[s]!==a&&(n[s]==null?e.style.removeProperty(s):e.style.setProperty(s,a,r))}}function fi(e,t,n,r){var s=e.__style;if(s!==t){var a=iv(t,r);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}else r&&(Array.isArray(r)?(qa(e,n?.[0],r[0]),qa(e,n?.[1],r[1],"important")):qa(e,n,r));return r}const ov=Symbol("is custom element"),lv=Symbol("is html");function hS(e,t){var n=nc(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function et(e,t,n,r){var s=nc(e);s[t]!==(s[t]=n)&&(t==="loading"&&(e[qd]=n),n==null?e.removeAttribute(t):typeof n!="string"&&uv(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function nc(e){return e.__attributes??={[ov]:e.nodeName.includes("-"),[lv]:e.namespaceURI===ff}}var Do=new Map;function uv(e){var t=e.getAttribute("is")||e.nodeName,n=Do.get(t);if(n)return n;Do.set(t,n=[]);for(var r,s=e,a=Element.prototype;a!==s;){r=lu(s);for(var i in r)r[i].set&&n.push(i);s=Bi(s)}return n}function lr(e,t,n=t){var r=new WeakSet;Xi(e,"input",async s=>{var a=s?e.defaultValue:e.value;if(a=Za(e)?Xa(a):a,n(a),ke!==null&&r.add(ke),await zf(),a!==(a=t())){var i=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=a??"",o!==null){var u=e.value.length;i===o&&o===l&&u>l?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=i,e.selectionEnd=Math.min(o,u))}}}),ye(t)==null&&e.value&&(n(Za(e)?Xa(e.value):e.value),ke!==null&&r.add(ke)),Wn(()=>{var s=t();if(e===document.activeElement){var a=Ds??ke;if(r.has(a))return}Za(e)&&s===Xa(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}const Ha=new Set;function pS(e,t,n,r,s=r){var a=n.getAttribute("type")==="checkbox",i=e;if(t!==null)for(var o of t)i=i[o]??=[];i.push(n),Xi(n,"change",()=>{var l=n.__value;a&&(l=dv(i,l,n.checked)),s(l)},()=>s(a?[]:null)),Wn(()=>{var l=r();a?(l=l||[],n.checked=l.includes(n.__value)):n.checked=Af(n.__value,l)}),Ts(()=>{var l=i.indexOf(n);l!==-1&&i.splice(l,1)}),Ha.has(i)||(Ha.add(i),En(()=>{i.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Ha.delete(i)})),En(()=>{})}function cv(e,t,n=t){Xi(e,"change",r=>{var s=r?e.defaultChecked:e.checked;n(s)}),ye(t)==null&&n(e.checked),Wn(()=>{var r=t();e.checked=!!r})}function dv(e,t,n){for(var r=new Set,s=0;s<e.length;s+=1)e[s].checked&&r.add(e[s].__value);return n||r.delete(t),Array.from(r)}function Za(e){var t=e.type;return t==="number"||t==="range"}function Xa(e){return e===""?null:+e}function $o(e,t){return e===t||e?.[Qt]===t}function ys(e={},t,n,r){return Pf(()=>{var s,a;return Wn(()=>{s=a,a=[],ye(()=>{e!==n(...a)&&(t(e,...a),s&&$o(n(...s),e)&&t(null,...s))})}),()=>{En(()=>{a&&$o(n(...a),e)&&t(null,...a)})}}),e}function fv(e,t,n,r,s){var a=()=>{r(n[e])};n.addEventListener(t,a),s?Wn(()=>{n[e]=s()}):a(),(n===document.body||n===window||n===document)&&Ts(()=>{n.removeEventListener(t,a)})}function At(e=!1){const t=Ce,n=t.l.u;if(!n)return;let r=()=>bt(t.s);if(e){let s=0,a={};const i=Es(()=>{let o=!1;const l=t.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&s++,s});r=()=>d(i)}n.b.length&&Of(()=>{Uo(t,r),ii(n.b)}),gr(()=>{const s=ye(()=>n.m.map(Bd));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&gr(()=>{Uo(t,r),ii(n.a)})}function Uo(e,t){if(e.l.s)for(const n of e.l.s)d(n);t()}function rc(e,t,n){if(e==null)return t(void 0),Ke;const r=ye(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const Rr=[];function ir(e,t){return{subscribe:vv(e,t).subscribe}}function vv(e,t=Ke){let n=null;const r=new Set;function s(o){if(_u(e,o)&&(e=o,n)){const l=!Rr.length;for(const u of r)u[1](),Rr.push(u,e);if(l){for(let u=0;u<Rr.length;u+=2)Rr[u][0](Rr[u+1]);Rr.length=0}}}function a(o){s(o(e))}function i(o,l=Ke){const u=[o,l];return r.add(u),r.size===1&&(n=t(s,a)||Ke),o(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:i}}function hv(e){let t;return rc(e,n=>t=n)(),t}let Rs=!1,vi=Symbol();function us(e,t,n){const r=n[t]??={store:null,source:Tn(void 0),unsubscribe:Ke};if(r.store!==e&&!(vi in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Ke;else{var s=!0;r.unsubscribe=rc(e,a=>{s?r.source.v=a:x(r.source,a)}),s=!1}return e&&vi in n?hv(e):d(r.source)}function sc(){const e={};function t(){Ts(()=>{for(var n in e)e[n].unsubscribe();ou(e,vi,{enumerable:!1,value:!0})})}return[e,t]}function pv(e){var t=Rs;try{return Rs=!1,[e(),Rs]}finally{Rs=t}}const gv={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(ss(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];ss(s)&&(s=s());const a=Vn(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(ss(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=Vn(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===Qt||t===fu)return!1;for(let n of e.props)if(ss(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(ss(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function _v(...e){return new Proxy({props:e},gv)}function We(e,t,n,r){var s=!Yr||(n&af)!==0,a=(n&lf)!==0,i=(n&uf)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?ye(r):r),o),c;if(a){var f=Qt in e||fu in e;c=Vn(e,t)?.set??(f&&t in e?w=>e[t]=w:void 0)}var h,v=!1;a?[h,v]=pv(()=>e[t]):h=e[t],h===void 0&&r!==void 0&&(h=u(),c&&(s&&Yd(),c(h)));var p;if(s?p=()=>{var w=e[t];return w===void 0?u():(l=!0,w)}:p=()=>{var w=e[t];return w!==void 0&&(o=void 0),w===void 0?o:w},s&&(n&of)===0)return p;if(c){var m=e.$$legacy;return(function(w,T){return arguments.length>0?((!s||!T||m||v)&&c(T?p():w),w):p()})}var _=!1,k=((n&sf)!==0?Es:Oa)(()=>(_=!1,p()));a&&d(k);var S=be;return(function(w,T){if(arguments.length>0){const C=T?d(k):s&&a?je(w):w;return x(k,C),_=!0,o!==void 0&&(o=C),w}return Tr&&_||(S.f&bn)!==0?k.v:d(k)})}function ac(e){Ce===null&&Hi(),Yr&&Ce.l!==null?mv(Ce).m.push(e):gr(()=>{const t=ye(e);if(typeof t=="function")return t})}function gS(e){Ce===null&&Hi(),ac(()=>()=>ye(e))}function mv(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const yv="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(yv);const bv=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),zr=()=>crypto.randomUUID(),Wi=e=>{try{return JSON.parse(e)}catch{return null}},zo=(e,t)=>{const{label:n}=t,r=e.trim();if(!r)return{};let s;try{s=JSON.parse(r)}catch{throw new Error(`${n} must be valid JSON.`)}if(s===null||Array.isArray(s)||typeof s!="object")throw new Error(`${n} must be a JSON object.`);return s},Mr=-1,jo=200;function Sv(e){return e?e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`:"Unknown size"}function wv(e){return e?e.startsWith("image/")?"image":e==="application/pdf"?"pdf":e.includes("spreadsheet")||e.includes("excel")?"spreadsheet":e.includes("presentation")||e.includes("powerpoint")?"presentation":"file":"file"}function kv(e){if(!e)return"file";const t=e.split("/");return t[1]??t[0]??"file"}var Ev=(function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),xv=Object.prototype.hasOwnProperty;function hi(e,t){return xv.call(e,t)}function pi(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var s in e)hi(e,s)&&r.push(s);return r}function Rt(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function gi(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function or(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function ic(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function _i(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(_i(e[t]))return!0}else if(typeof e=="object"){for(var r=pi(e),s=r.length,a=0;a<s;a++)if(_i(e[r[a]]))return!0}}return!1}function Go(e,t){var n=[e];for(var r in t){var s=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof s<"u"&&n.push(r+": "+s)}return n.join(`
`)}var oc=(function(e){Ev(t,e);function t(n,r,s,a,i){var o=this.constructor,l=e.call(this,Go(n,{name:r,index:s,operation:a,tree:i}))||this;return l.name=r,l.index=s,l.operation=a,l.tree=i,Object.setPrototypeOf(l,o.prototype),l.message=Go(n,{name:r,index:s,operation:a,tree:i}),l}return t})(Error),Fe=oc,Tv=Rt,Dr={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=ca(n,this.path);r&&(r=Rt(r));var s=fr(n,{op:"remove",path:this.from}).removed;return fr(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=ca(n,this.from);return fr(n,{op:"add",path:this.path,value:Rt(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:bs(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},Av={add:function(e,t,n){return gi(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Dr.move,copy:Dr.copy,test:Dr.test,_get:Dr._get};function ca(e,t){if(t=="")return e;var n={op:"_get",path:t};return fr(e,n),n.value}function fr(e,t,n,r,s,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):da(t,0)),t.path===""){var i={newDocument:e};if(t.op==="add")return i.newDocument=t.value,i;if(t.op==="replace")return i.newDocument=t.value,i.removed=e,i;if(t.op==="move"||t.op==="copy")return i.newDocument=ca(e,t.from),t.op==="move"&&(i.removed=e),i;if(t.op==="test"){if(i.test=bs(e,t.value),i.test===!1)throw new Fe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i.newDocument=e,i}else{if(t.op==="remove")return i.removed=e,i.newDocument=null,i;if(t.op==="_get")return t.value=e,i;if(n)throw new Fe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return i}}else{r||(e=Rt(e));var o=t.path||"",l=o.split("/"),u=e,c=1,f=l.length,h=void 0,v=void 0,p=void 0;for(typeof n=="function"?p=n:p=da;;){if(v=l[c],v&&v.indexOf("~")!=-1&&(v=ic(v)),s&&(v=="__proto__"||v=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&h===void 0&&(u[v]===void 0?h=l.slice(0,c).join("/"):c==f-1&&(h=t.path),h!==void 0&&p(t,0,e,h)),c++,Array.isArray(u)){if(v==="-")v=u.length;else{if(n&&!gi(v))throw new Fe("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);gi(v)&&(v=~~v)}if(c>=f){if(n&&t.op==="add"&&v>u.length)throw new Fe("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var i=Av[t.op].call(t,u,v,e);if(i.test===!1)throw new Fe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}}else if(c>=f){var i=Dr[t.op].call(t,u,v,e);if(i.test===!1)throw new Fe("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return i}if(u=u[v],n&&c<f&&(!u||typeof u!="object"))throw new Fe("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,t,e)}}}function Hr(e,t,n,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),n&&!Array.isArray(t))throw new Fe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Rt(e));for(var a=new Array(t.length),i=0,o=t.length;i<o;i++)a[i]=fr(e,t[i],n,!0,s,i),e=a[i].newDocument;return a.newDocument=e,a}function Iv(e,t,n){var r=fr(e,t);if(r.test===!1)throw new Fe("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function da(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Fe("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(Dr[e.op]){if(typeof e.path!="string")throw new Fe("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Fe('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Fe("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Fe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&_i(e.value))throw new Fe("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var s=e.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new Fe("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Fe("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var i={op:"_get",path:e.from,value:void 0},o=lc([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new Fe("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Fe("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function lc(e,t,n){try{if(!Array.isArray(e))throw new Fe("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)Hr(Rt(t),Rt(e),n||!0);else{n=n||da;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(s){if(s instanceof Fe)return s;throw s}}function bs(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),s,a,i;if(n&&r){if(a=e.length,a!=t.length)return!1;for(s=a;s--!==0;)if(!bs(e[s],t[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(e);if(a=o.length,a!==Object.keys(t).length)return!1;for(s=a;s--!==0;)if(!t.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!bs(e[i],t[i]))return!1;return!0}return e!==e&&t!==t}const Cv=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:Fe,_areEquals:bs,applyOperation:fr,applyPatch:Hr,applyReducer:Iv,deepClone:Tv,getValueByPointer:ca,validate:lc,validator:da},Symbol.toStringTag,{value:"Module"}));var Qi=new WeakMap,Nv=(function(){function e(t){this.observers=new Map,this.obj=t}return e})(),Rv=(function(){function e(t,n){this.callback=t,this.observer=n}return e})();function Ov(e){return Qi.get(e)}function Mv(e,t){return e.observers.get(t)}function Pv(e,t){e.observers.delete(t.callback)}function Lv(e,t){t.unobserve()}function Dv(e,t){var n=[],r,s=Ov(e);if(!s)s=new Nv(e),Qi.set(e,s);else{var a=Mv(s,t);r=a&&a.observer}if(r)return r;if(r={},s.value=Rt(e),t){r.callback=t,r.next=null;var i=function(){mi(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=e,r.unobserve=function(){mi(r),clearTimeout(r.next),Pv(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},s.observers.set(t,new Rv(t,r)),r}function mi(e,t){t===void 0&&(t=!1);var n=Qi.get(e.object);eo(n.value,e.object,e.patches,"",t),e.patches.length&&Hr(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function eo(e,t,n,r,s){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=pi(t),i=pi(e),o=!1,l=i.length-1;l>=0;l--){var u=i[l],c=e[u];if(hi(t,u)&&!(t[u]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?eo(c,f,n,r+"/"+or(u),s):c!==f&&(s&&n.push({op:"test",path:r+"/"+or(u),value:Rt(c)}),n.push({op:"replace",path:r+"/"+or(u),value:Rt(f)}))}else Array.isArray(e)===Array.isArray(t)?(s&&n.push({op:"test",path:r+"/"+or(u),value:Rt(c)}),n.push({op:"remove",path:r+"/"+or(u)}),o=!0):(s&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!hi(e,u)&&t[u]!==void 0&&n.push({op:"add",path:r+"/"+or(u),value:Rt(t[u])})}}}function $v(e,t,n){n===void 0&&(n=!1);var r=[];return eo(e,t,r,"",n),r}const Uv=Object.freeze(Object.defineProperty({__proto__:null,compare:$v,generate:mi,observe:Dv,unobserve:Lv},Symbol.toStringTag,{value:"Module"}));Object.assign({},Cv,Uv,{JsonPatchError:oc,deepClone:Rt,escapePathComponent:or,unescapePathComponent:ic});function to(e){return{ok:!0,data:e}}function fa(e){return{ok:!1,error:e}}function zv(e,t="Unknown error"){return e instanceof Error?e:typeof e=="string"&&e.trim()?new Error(e):new Error(t)}const uc=Symbol("chat-store");function jv(){let e=G(je([])),t=G("");return{get messages(){return d(e)},get input(){return d(t)},set input(n){x(t,n,!0)},get isEmpty(){return d(e).length===0},addUserMessage(n){const r={id:zr(),role:"user",text:n,ts:Date.now()};return d(e).push(r),r},addAgentMessage(){const n={id:zr(),role:"agent",text:"",observations:"",showObservations:!1,isStreaming:!0,isThinking:!1,answerStreamDone:!1,revisionStreamActive:!1,answerActionSeq:Mr,ts:Date.now()};return d(e).push(n),n},findMessage(n){return d(e).find(r=>r.id===n)},updateMessage(n,r){const s=d(e).find(a=>a.id===n);s&&Object.assign(s,r)},clearInput(){x(t,"")},clear(){x(e,[],!0),x(t,"")}}}function Gv(e=jv()){return xt(uc,e),e}function cc(){return Mt(uc)}const dc=Symbol("session-store");function Bv(){let e=G(je(zr())),t=G(null),n=G(!1);return{get sessionId(){return d(e)},set sessionId(r){x(e,r,!0)},get activeTraceId(){return d(t)},set activeTraceId(r){x(t,r,!0)},get isSending(){return d(n)},set isSending(r){x(n,r,!0)},reset(){x(e,zr(),!0),x(t,null),x(n,!1)},newSession(){x(e,zr(),!0),x(t,null)}}}function Fv(e=Bv()){return xt(dc,e),e}function Ar(){return Mt(dc)}const fc=Symbol("artifacts-store");function Vv(){let e=G(je(new Map));return{get artifacts(){return d(e)},get list(){return Array.from(d(e).values())},get count(){return d(e).size},has(t){return d(e).has(t)},get(t){return d(e).get(t)},addArtifact(t){const n={id:t.artifact_id,mime_type:t.mime_type,size_bytes:t.size_bytes,filename:t.filename,sha256:null,source:t.source},r=new Map(d(e));r.set(t.artifact_id,n),x(e,r,!0)},remove(t){if(!d(e).has(t))return!1;const n=new Map(d(e));return n.delete(t),x(e,n,!0),!0},clear(){x(e,new Map,!0)}}}function qv(e=Vv()){return xt(fc,e),e}function Hv(){return Mt(fc)}const vc=Symbol("agent-store"),Bo={name:"loading_agent",description:"",template:"",version:"",flags:[],tools:0,flows:0};function Zv(){let e=G(je({...Bo})),t=G(je([])),n=G(je([])),r=G(je([]));return{get meta(){return d(e)},get plannerConfig(){return d(t)},get services(){return d(n)},get catalog(){return d(r)},setFromResponse(s){const a=s.agent??{};x(e,{name:a.name??"agent",description:a.description??"",template:a.template??"",version:a.version??"",flags:a.flags??[],tools:(s.tools??[]).length,flows:(s.flows??[]).length},!0),x(t,s.planner&&Object.keys(s.planner).length?Object.entries(s.planner).map(([i,o])=>({label:i,value:o})):[],!0),x(n,s.services?.map(i=>({name:i.name,status:i.enabled?"enabled":"disabled",url:i.url??null}))??[],!0),x(r,s.tools?.map(i=>({name:i.name,desc:i.description,tags:i.tags??[]}))??[],!0)},reset(){x(e,{...Bo},!0),x(t,[],!0),x(n,[],!0),x(r,[],!0)}}}function Xv(e=Zv()){return xt(vc,e),e}function Qr(){return Mt(vc)}const hc=Symbol("events-store"),Kv=new Set(["thinking","revision","tool_call_start","tool_call_args","tool_call_end","tool_call_result","llm_stream_chunk"]),Jv=new Set(["step","step_start","step_complete"]);function Yv(){let e=G(je([])),t=G(je(new Set)),n=G(!1),r=G(je(new Map));function s(){const a=[],i=new Set;for(const o of d(e)){const l=o.event?.toLowerCase()??"";if(!Kv.has(l)){if(Jv.has(l)||l==="event"){(l==="step_complete"||o.latency_ms)&&a.push({id:o.id,type:"step",name:o.node??"step",description:o.thought?Os(o.thought,100):void 0,duration_ms:o.latency_ms,ts:o.ts??Date.now()});continue}if(l==="artifact_stored"||l==="artifact_chunk"){a.push({id:o.id,type:"artifact",name:o.artifact_id??"artifact",description:o.mime_type??void 0,ts:o.ts??Date.now()});continue}a.push({id:o.id,type:"other",name:l,description:o.thought?Os(o.thought,80):void 0,ts:o.ts??Date.now()})}}for(const[o,l]of d(r))l.endTs&&!i.has(o)&&(a.push({id:`tc_${o}`,type:"tool_call",name:l.name,args:l.args?Os(l.args,100):void 0,result:l.result?Os(l.result,100):void 0,duration_ms:l.endTs-l.startTs,ts:l.startTs}),i.add(o));return a.sort((o,l)=>l.ts-o.ts),a}return{get events(){return d(e)},get displayEvents(){return s()},get filter(){return d(t)},get paused(){return d(n)},set paused(a){x(n,a,!0)},get isEmpty(){return d(e).length===0},setFilter(a){a?x(t,new Set([a]),!0):x(t,new Set,!0)},addEvent(a,i){const o=a.tool_call_id,l=i.toLowerCase();if(o){if(l==="tool_call_start")d(r).set(o,{id:o,name:a.tool_call_name??"tool",args:"",result:"",startTs:Date.now()});else if(l==="tool_call_args"){const f=d(r).get(o);f&&(f.args+=a.delta??"")}else if(l==="tool_call_result"){const f=d(r).get(o);f&&(f.result=a.content??"")}else if(l==="tool_call_end"){const f=d(r).get(o);f&&(f.endTs=Date.now())}}const u=`${a.event??""}|${a.node??""}|${a.ts??""}`;if(!d(e).some(f=>`${f.event??""}|${f.node??""}|${f.ts??""}`===u)){const f={id:zr(),event:i,...a};d(e).unshift(f),d(e).length>jo&&(d(e).length=jo)}},shouldProcess(a){return d(n)?!1:d(t).size===0?!0:d(t).has(a)},clear(){x(e,[],!0),x(r,new Map,!0)}}}function Os(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}function Wv(e=Yv()){return xt(hc,e),e}function no(){return Mt(hc)}const pc=Symbol("tasks-store");function Qv(){let e=G(je({})),t=G(null),n=G(null),r=G(je([])),s=G(!1);function a(o,l){const u=d(e)[o];if(u)return u;const c={task_id:o,session_id:l,status:"PENDING",task_type:"FOREGROUND",priority:0};return x(e,{...d(e),[o]:c},!0),c}function i(o,l){const u=l.status;u&&(o.status=u);const c=l.task_type;typeof c=="string"&&(o.task_type=c);const f=l.priority;typeof f=="number"&&(o.priority=f);const h=l.progress;h&&typeof h=="object"&&!Array.isArray(h)&&(o.progress=h),o.updated_at=new Date().toISOString()}return{get tasks(){return Object.values(d(e)).sort((o,l)=>{const u=o.updated_at?Date.parse(o.updated_at):0;return(l.updated_at?Date.parse(l.updated_at):0)-u})},get count(){return Object.keys(d(e)).length},get foregroundTaskId(){return d(t)},get foregroundStatus(){return d(n)},get backgroundTasks(){return d(r)},get isPolling(){return d(s)},get hasForegroundRunning(){return d(t)!==null&&d(n)==="RUNNING"},get hasActiveBackgroundTasks(){return d(r).length>0},get shouldShowSteerButton(){return d(t)!==null&&d(n)==="RUNNING"},applyUpdate(o){const l=a(o.task_id,o.session_id);if(o.trace_id&&(l.trace_id=o.trace_id),o.update_type==="STATUS_CHANGE"){if(o.content&&typeof o.content=="object"&&!Array.isArray(o.content)){const u=o.content;i(l,u);const c=u.task_type,f=u.status;c==="FOREGROUND"&&(f==="RUNNING"?(x(t,o.task_id,!0),x(n,f,!0)):f==="COMPLETE"||f==="FAILED"||f==="CANCELLED"?d(t)===o.task_id&&(x(t,null),x(n,null)):d(t)===o.task_id&&x(n,f??null,!0)),c==="BACKGROUND"&&(f&&new Set(["RUNNING","PENDING","PAUSED"]).has(f)?d(r).find(p=>p.task_id===o.task_id)?x(r,d(r).map(p=>p.task_id===o.task_id?{...p,status:f}:p),!0):x(r,[...d(r),{task_id:o.task_id,description:l.description??null,status:f,task_type:c,priority:l.priority}],!0):x(r,d(r).filter(v=>v.task_id!==o.task_id),!0))}return}if(o.update_type==="PROGRESS"){o.content&&typeof o.content=="object"&&!Array.isArray(o.content)&&(l.progress=o.content,l.updated_at=new Date().toISOString());return}if(o.update_type==="RESULT"){const u=o.content;l.result=o.content,u&&typeof u=="object"&&("task_patch"in u&&(l.task_patch=u.task_patch),"patch_id"in u&&(l.patch_id=u.patch_id)),l.status="COMPLETE",l.updated_at=new Date().toISOString(),d(t)===o.task_id&&(x(t,null),x(n,null));return}if(o.update_type==="CHECKPOINT"){const u=o.content;if(u&&typeof u=="object"){const c=u.patch_id;c&&(l.patch_id=c,l.updated_at=new Date().toISOString())}return}o.update_type==="ERROR"&&(o.content&&typeof o.content=="object"&&!Array.isArray(o.content)?l.error=String(o.content.error??"Error"):l.error="Error",l.status="FAILED",l.updated_at=new Date().toISOString(),d(t)===o.task_id&&(x(t,null),x(n,null)),x(r,d(r).filter(u=>u.task_id!==o.task_id),!0))},setTasks(o){const l={};for(const u of o)l[u.task_id]={...u};x(e,l,!0)},async fetchTaskState(o){try{x(s,!0);const l=await fetch(`/session/${o}/task-state`);if(!l.ok){console.error("Failed to fetch task state:",l.statusText);return}const u=await l.json();x(t,u.foreground_task_id,!0),x(n,u.foreground_status,!0),x(r,u.background_tasks,!0)}catch(l){console.error("Failed to fetch task state:",l)}finally{x(s,!1)}},setPolling(o){x(s,o,!0)},clear(){x(e,{},!0),x(t,null),x(n,null),x(r,[],!0),x(s,!1)}}}function eh(e=Qv()){return xt(pc,e),e}function gc(){return Mt(pc)}const _c=Symbol("trajectory-store");function th(){let e=G(je([])),t=G(je({})),n=G(null),r=G(null),s=G(null),a=G(null),i=G(null);return{get steps(){return d(e)},get artifactStreams(){return d(t)},get query(){return d(n)},get llmContext(){return d(r)},get toolContext(){return d(s)},get traceId(){return d(a)},get sessionId(){return d(i)},get isEmpty(){return d(e).length===0},get hasArtifacts(){return Object.keys(d(t)).length>0},get hasContext(){return d(a)!=null||d(r)!=null||d(s)!=null},get conversationMemory(){return d(r)?.conversation_memory??null},get hasMemory(){return d(r)?.conversation_memory!=null},setFromPayload(o){const l=o?.steps??[];x(e,l.map((u,c)=>{const f=u.action??{};return{id:`step-${c}`,name:f.next_node??f.plan?.[0]?.node??"step",thought:f.thought,args:f.args,result:u.observation,latencyMs:u.latency_ms??void 0,reflectionScore:u.metadata?.reflection?.score??void 0,status:u.error?"error":"ok"}}),!0),x(n,o?.query??null,!0),x(r,o?.llm_context??null,!0),x(s,o?.tool_context??null,!0),x(a,o?.trace_id??null,!0),x(i,o?.session_id??null,!0)},addArtifactChunk(o,l){const u=d(t)[o]??[];d(t)[o]=[...u,l]},clearArtifacts(){x(t,{},!0)},clear(){x(e,[],!0),x(t,{},!0),x(n,null),x(r,null),x(s,null),x(a,null),x(i,null)}}}function nh(e=th()){return xt(_c,e),e}function Pa(){return Mt(_c)}const mc=Symbol("spec-store");function rh(){let e=G(""),t=G("pending"),n=G(je([]));return{get content(){return d(e)},set content(r){x(e,r,!0)},get status(){return d(t)},set status(r){x(t,r,!0)},get errors(){return d(n)},get isValid(){return d(t)==="valid"},get hasErrors(){return d(n).length>0},setFromSpecData(r){x(e,r.content,!0),x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`err-${a}`,message:s.message,line:s.line})),!0)},setValidationResult(r){x(t,r.valid?"valid":"error",!0),x(n,(r.errors??[]).map((s,a)=>({id:`val-err-${a}`,message:s.message,line:s.line})),!0)},setGenerationErrors(r){x(t,"error"),x(n,r.map((s,a)=>({id:`gen-err-${a}`,message:s.message,line:s.line})),!0)},markValid(){x(t,"valid"),x(n,[],!0)},reset(){x(e,""),x(t,"pending"),x(n,[],!0)}}}function sh(e=rh()){return xt(mc,e),e}function ah(){return Mt(mc)}const yc=Symbol("setup-store");function ih(){let e=G("playground-tenant"),t=G("playground-user"),n=G("{}"),r=G("{}"),s=G(null),a=G(!1);return{get tenantId(){return d(e)},set tenantId(i){x(e,i,!0)},get userId(){return d(t)},set userId(i){x(t,i,!0)},get toolContextRaw(){return d(n)},set toolContextRaw(i){x(n,i,!0)},get llmContextRaw(){return d(r)},set llmContextRaw(i){x(r,i,!0)},get error(){return d(s)},set error(i){x(s,i,!0)},get useAgui(){return d(a)},set useAgui(i){x(a,i,!0)},parseContexts(){try{const i=zo(d(n),{label:"Tool context"}),o={tenant_id:d(e),user_id:d(t),...i},l=zo(d(r),{label:"LLM context"});return x(s,null),{toolContext:o,llmContext:l}}catch(i){return x(s,i instanceof Error?i.message:"Invalid setup configuration.",!0),null}},clearError(){x(s,null)},reset(){x(e,"playground-tenant"),x(t,"playground-user"),x(n,"{}"),x(r,"{}"),x(s,null),x(a,!1)}}}function oh(e=ih()){return xt(yc,e),e}function lh(){return Mt(yc)}const bc=Symbol("interactions-store");function uh(){let e=G(je([])),t=G(null),n=G(null);function r(o,{message_id:l}={}){if(o.artifact_type!=="ui_component"||!o.chunk||typeof o.chunk!="object")return;const u=o.chunk,c=typeof u.component=="string"?u.component:void 0,f=u.props||{};if(!c)return;const h={id:(typeof u.id=="string"?u.id:void 0)||`ui_${Date.now()}`,component:c,props:f,title:typeof u.title=="string"?u.title:void 0,message_id:l??(typeof o.meta?.message_id=="string"?o.meta.message_id:void 0),seq:o.seq??0,ts:o.ts??Date.now(),meta:o.meta??{}};x(e,[...d(e),h],!0),x(n,h,!0)}function s(o){x(t,o,!0)}function a(o){d(t)&&x(t,{...d(t),...o},!0)}function i(){x(t,null)}return{get artifacts(){return d(e)},get pendingInteraction(){return d(t)},get lastArtifact(){return d(n)},addArtifactChunk:r,setPendingInteraction:s,updatePendingInteraction:a,clearPendingInteraction:i,clear(){x(e,[],!0),x(t,null),x(n,null)}}}function ch(e=uh()){return xt(bc,e),e}function ro(){return Mt(bc)}const Sc=Symbol("component-registry-store");function dh(){let e=G(null),t=G(null);return{get registry(){return d(e)},get error(){return d(t)},get enabled(){return d(e)?.enabled??!1},get components(){return d(e)?.components??{}},get version(){return d(e)?.version??""},get allowlist(){return d(e)?.allowlist??[]},setFromPayload(n){x(e,n,!0),x(t,null)},setError(n){x(t,n,!0)},getComponent(n){return d(e)?.components?.[n]},reset(){x(e,null),x(t,null)}}}function fh(e=dh()){return xt(Sc,e),e}function so(){return Mt(Sc)}const vh=Symbol("layout-store");function hh(){let e=G(!1),t=G(!1);return{get isMobile(){return d(e)},set isMobile(n){x(e,n,!0)},get sidebarOpen(){return d(t)},set sidebarOpen(n){x(t,n,!0)},setMobile(n){x(e,n,!0),n||x(t,!1)},toggleSidebar(){x(t,!d(t))},reset(){x(e,!1),x(t,!1)}}}function ph(e=hh()){return xt(vh,e),e}const wc=Symbol("notifications-store");function gh(){let e=G(je([]));return{get items(){return d(e)},add(t,n="info",r){const s={id:`note_${Date.now()}_${Math.random().toString(16).slice(2)}`,message:t,level:n,ts:Date.now(),actions:r};return x(e,[s,...d(e)],!0),s},remove(t){x(e,d(e).filter(n=>n.id!==t),!0)},clear(){x(e,[],!0)}}}function _h(e=gh()){return xt(wc,e),e}function mh(){return Mt(wc)}function yh(){return{chatStore:Gv(),sessionStore:Fv(),artifactsStore:qv(),agentStore:Xv(),eventsStore:Wv(),tasksStore:eh(),trajectoryStore:nh(),specStore:sh(),setupStore:oh(),interactionsStore:ch(),componentRegistryStore:fh(),layoutStore:ph(),notificationsStore:_h()}}const Qn="";class Fo extends Error{constructor(t,n,r){super(t),this.statusCode=n,this.details=r,this.name="ApiError"}}async function Ir(e,t){try{const n=t?await fetch(e,t):await fetch(e);return n.ok?{ok:!0,data:await n.json()}:{ok:!1,error:new Fo(n.statusText||"Request failed",n.status)}}catch(n){return{ok:!1,error:new Fo("Network error",0,n)}}}function bh(e){if(!e)return null;const n=e.match(/filename="(.+?)"/)?.[1];if(n)return n;const s=e.match(/filename=([^;\s]+)/)?.[1];return s||null}async function Sh(){const e=await Ir(`${Qn}/ui/meta`);return e.ok?e.data:(console.error("meta load failed",e.error),null)}async function wh(){const e=await Ir(`${Qn}/ui/components`);return e.ok?e.data:(console.error("component registry load failed",e.error),null)}async function kh(){const e=await Ir(`${Qn}/ui/spec`);return e.ok?e.data:(console.error("spec load failed",e.error),null)}async function Vo(e,t){const n=await Ir(`${Qn}/trajectory/${e}?session_id=${encodeURIComponent(t)}`);return n.ok?n.data:(console.error("trajectory fetch failed",n.error),null)}async function kc(e,t,n){const r=await fetch(`${Qn}/artifacts/${e}`,{headers:{"X-Session-ID":t}});if(!r.ok)throw new Error(`Download failed: ${r.status} ${r.statusText}`);const s=await r.blob(),a=r.headers.get("Content-Disposition"),i=n||bh(a)||`artifact-${e}`,o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}async function Ms(e,t,n,r={},s="user"){const a=await Ir(`${Qn}/steer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,task_id:t,event_type:n,payload:r,source:s})});return a.ok?!!a.data.accepted:(console.error("steer task failed",a.error),!1)}async function Eh(e,t){const n=new URL(`${Qn}/tasks`,window.location.origin);n.searchParams.set("session_id",e);const r=await Ir(n.toString());return r.ok?r.data:(console.error("tasks fetch failed",r.error),null)}async function Ec(e,t,n="apply"){const r=await Ir(`${Qn}/sessions/${e}/apply-context-patch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patch_id:t,action:n})});return r.ok?!!r.data.ok:(console.error("apply context patch failed",r.error),!1)}var fe;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},e.getValidEnumValues=s=>{const a=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return e.objectValues(i)},e.objectValues=s=>e.objectKeys(s).map(function(a){return s[a]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},e.find=(s,a)=>{for(const i of s)if(a(i))return i},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}e.joinValues=r,e.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(fe||(fe={}));var qo;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(qo||(qo={}));const F=fe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Bn=e=>{switch(typeof e){case"undefined":return F.undefined;case"string":return F.string;case"number":return Number.isNaN(e)?F.nan:F.number;case"boolean":return F.boolean;case"function":return F.function;case"bigint":return F.bigint;case"symbol":return F.symbol;case"object":return Array.isArray(e)?F.array:e===null?F.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?F.promise:typeof Map<"u"&&e instanceof Map?F.map:typeof Set<"u"&&e instanceof Set?F.set:typeof Date<"u"&&e instanceof Date?F.date:F.object;default:return F.unknown}},D=fe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class In extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(t){if(!(t instanceof In))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,fe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(t(s))}else r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}In.create=e=>new In(e);const yi=(e,t)=>{let n;switch(e.code){case D.invalid_type:e.received===F.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case D.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,fe.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:n=`Unrecognized key(s) in object: ${fe.joinValues(e.keys,", ")}`;break;case D.invalid_union:n="Invalid input";break;case D.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${fe.joinValues(e.options)}`;break;case D.invalid_enum_value:n=`Invalid enum value. Expected ${fe.joinValues(e.options)}, received '${e.received}'`;break;case D.invalid_arguments:n="Invalid function arguments";break;case D.invalid_return_type:n="Invalid function return type";break;case D.invalid_date:n="Invalid date";break;case D.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:fe.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case D.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case D.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case D.custom:n="Invalid input";break;case D.invalid_intersection_types:n="Intersection results could not be merged";break;case D.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case D.not_finite:n="Number must be finite";break;default:n=t.defaultError,fe.assertNever(e)}return{message:n}};let xh=yi;function Th(){return xh}const Ah=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:t,defaultError:o}).message;return{...s,path:a,message:o}};function z(e,t){const n=Th(),r=Ah({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===yi?void 0:yi].filter(s=>!!s)});e.common.issues.push(r)}class vt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return Y;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return vt.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return Y;a.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:t.value,value:r}}}const Y=Object.freeze({status:"aborted"}),cs=e=>({status:"dirty",value:e}),zt=e=>({status:"valid",value:e}),Ho=e=>e.status==="aborted",Zo=e=>e.status==="dirty",Zr=e=>e.status==="valid",va=e=>typeof Promise<"u"&&e instanceof Promise;var V;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(V||(V={}));class nn{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Xo=(e,t)=>{if(Zr(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new In(e.common.issues);return this._error=n,this._error}}};function se(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(i,o)=>{const{message:l}=e;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class ce{get description(){return this._def.description}_getType(t){return Bn(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Bn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new vt,ctx:{common:t.parent.common,data:t.data,parsedType:Bn(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(va(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bn(t)},s=this._parseSync({data:t,path:r.path,parent:r});return Xo(r,s)}"~validate"(t){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bn(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:n});return Zr(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>Zr(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Bn(t)},s=this._parse({data:t,path:r.path,parent:r}),a=await(va(s)?s:Promise.resolve(s));return Xo(r,a)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=t(s),o=()=>a.addIssue({code:D.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new yr({schema:this,typeName:W.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return kn.create(this,this._def)}nullable(){return br.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return en.create(this)}promise(){return ba.create(this,this._def)}or(t){return pa.create([this,t],this._def)}and(t){return ga.create(this,t,this._def)}transform(t){return new yr({...se(this._def),schema:this,typeName:W.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Sa({...se(this._def),innerType:this,defaultValue:n,typeName:W.ZodDefault})}brand(){return new Ic({typeName:W.ZodBranded,type:this,...se(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new wa({...se(this._def),innerType:this,catchValue:n,typeName:W.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return io.create(this,t)}readonly(){return ka.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Ih=/^c[^\s-]{8,}$/i,Ch=/^[0-9a-z]+$/,Nh=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Rh=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Oh=/^[a-z0-9_-]{21}$/i,Mh=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ph=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Lh=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Dh="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ka;const $h=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Uh=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,zh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,jh=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Gh=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Bh=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Fh=new RegExp(`^${xc}$`);function Tc(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Vh(e){return new RegExp(`^${Tc(e)}$`)}function qh(e){let t=`${xc}T${Tc(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Hh(e,t){return!!((t==="v4"||!t)&&$h.test(e)||(t==="v6"||!t)&&zh.test(e))}function Zh(e,t){if(!Mh.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function Xh(e,t){return!!((t==="v4"||!t)&&Uh.test(e)||(t==="v6"||!t)&&jh.test(e))}class yn extends ce{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==F.string){const a=this._getOrReturnCtx(t);return z(a,{code:D.invalid_type,expected:F.string,received:a.parsedType}),Y}const r=new vt;let s;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:D.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")t.data.length>a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:D.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=t.data.length>a.value,o=t.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(t,s),i?z(s,{code:D.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&z(s,{code:D.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")Lh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"email",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Ka||(Ka=new RegExp(Dh,"u")),Ka.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"emoji",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")Rh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"uuid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")Oh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"nanoid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Ih.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cuid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Ch.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cuid2",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")Nh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"ulid",code:D.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),z(s,{validation:"url",code:D.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"regex",code:D.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?qh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?Fh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?Vh(a).test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{code:D.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?Ph.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"duration",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?Hh(t.data,a.version)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"ip",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?Zh(t.data,a.alg)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"jwt",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?Xh(t.data,a.version)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"cidr",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?Gh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"base64",code:D.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?Bh.test(t.data)||(s=this._getOrReturnCtx(t,s),z(s,{validation:"base64url",code:D.invalid_string,message:a.message}),r.dirty()):fe.assertNever(a);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:D.invalid_string,...V.errToObj(r)})}_addCheck(t){return new yn({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...V.errToObj(t)})}url(t){return this._addCheck({kind:"url",...V.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...V.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...V.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...V.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...V.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...V.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...V.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...V.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...V.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...V.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...V.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...V.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...V.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...V.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...V.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...V.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n?.position,...V.errToObj(n?.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...V.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...V.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...V.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...V.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...V.errToObj(n)})}nonempty(t){return this.min(1,V.errToObj(t))}trim(){return new yn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new yn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new yn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}yn.create=e=>new yn({checks:[],typeName:W.ZodString,coerce:e?.coerce??!1,...se(e)});function Kh(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(e.toFixed(s).replace(".","")),i=Number.parseInt(t.toFixed(s).replace(".",""));return a%i/10**s}class Xr extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==F.number){const a=this._getOrReturnCtx(t);return z(a,{code:D.invalid_type,expected:F.number,received:a.parsedType}),Y}let r;const s=new vt;for(const a of this._def.checks)a.kind==="int"?fe.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),z(r,{code:D.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?Kh(t.data,a.value)!==0&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),z(r,{code:D.not_finite,message:a.message}),s.dirty()):fe.assertNever(a);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,V.toString(n))}gt(t,n){return this.setLimit("min",t,!1,V.toString(n))}lte(t,n){return this.setLimit("max",t,!0,V.toString(n))}lt(t,n){return this.setLimit("max",t,!1,V.toString(n))}setLimit(t,n,r,s){return new Xr({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:V.toString(s)}]})}_addCheck(t){return new Xr({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:V.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:V.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:V.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:V.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:V.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:V.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:V.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:V.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:V.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&fe.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Xr.create=e=>new Xr({checks:[],typeName:W.ZodNumber,coerce:e?.coerce||!1,...se(e)});class Ss extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==F.bigint)return this._getInvalidInput(t);let r;const s=new vt;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),z(r,{code:D.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):fe.assertNever(a);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return z(n,{code:D.invalid_type,expected:F.bigint,received:n.parsedType}),Y}gte(t,n){return this.setLimit("min",t,!0,V.toString(n))}gt(t,n){return this.setLimit("min",t,!1,V.toString(n))}lte(t,n){return this.setLimit("max",t,!0,V.toString(n))}lt(t,n){return this.setLimit("max",t,!1,V.toString(n))}setLimit(t,n,r,s){return new Ss({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:V.toString(s)}]})}_addCheck(t){return new Ss({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:V.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:V.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:V.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:V.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:V.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ss.create=e=>new Ss({checks:[],typeName:W.ZodBigInt,coerce:e?.coerce??!1,...se(e)});class bi extends ce{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==F.boolean){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.boolean,received:r.parsedType}),Y}return zt(t.data)}}bi.create=e=>new bi({typeName:W.ZodBoolean,coerce:e?.coerce||!1,...se(e)});class ha extends ce{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==F.date){const a=this._getOrReturnCtx(t);return z(a,{code:D.invalid_type,expected:F.date,received:a.parsedType}),Y}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return z(a,{code:D.invalid_date}),Y}const r=new vt;let s;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:D.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(s=this._getOrReturnCtx(t,s),z(s,{code:D.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):fe.assertNever(a);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ha({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:V.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:V.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}ha.create=e=>new ha({checks:[],coerce:e?.coerce||!1,typeName:W.ZodDate,...se(e)});class Ko extends ce{_parse(t){if(this._getType(t)!==F.symbol){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.symbol,received:r.parsedType}),Y}return zt(t.data)}}Ko.create=e=>new Ko({typeName:W.ZodSymbol,...se(e)});class Si extends ce{_parse(t){if(this._getType(t)!==F.undefined){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.undefined,received:r.parsedType}),Y}return zt(t.data)}}Si.create=e=>new Si({typeName:W.ZodUndefined,...se(e)});class wi extends ce{_parse(t){if(this._getType(t)!==F.null){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.null,received:r.parsedType}),Y}return zt(t.data)}}wi.create=e=>new wi({typeName:W.ZodNull,...se(e)});class ki extends ce{constructor(){super(...arguments),this._any=!0}_parse(t){return zt(t.data)}}ki.create=e=>new ki({typeName:W.ZodAny,...se(e)});class Jo extends ce{constructor(){super(...arguments),this._unknown=!0}_parse(t){return zt(t.data)}}Jo.create=e=>new Jo({typeName:W.ZodUnknown,...se(e)});class Kn extends ce{_parse(t){const n=this._getOrReturnCtx(t);return z(n,{code:D.invalid_type,expected:F.never,received:n.parsedType}),Y}}Kn.create=e=>new Kn({typeName:W.ZodNever,...se(e)});class Yo extends ce{_parse(t){if(this._getType(t)!==F.undefined){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.void,received:r.parsedType}),Y}return zt(t.data)}}Yo.create=e=>new Yo({typeName:W.ZodVoid,...se(e)});class en extends ce{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==F.array)return z(n,{code:D.invalid_type,expected:F.array,received:n.parsedType}),Y;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&(z(n,{code:i?D.too_big:D.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(z(n,{code:D.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(z(n,{code:D.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new nn(n,i,n.path,o)))).then(i=>vt.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new nn(n,i,n.path,o)));return vt.mergeArray(r,a)}get element(){return this._def.type}min(t,n){return new en({...this._def,minLength:{value:t,message:V.toString(n)}})}max(t,n){return new en({...this._def,maxLength:{value:t,message:V.toString(n)}})}length(t,n){return new en({...this._def,exactLength:{value:t,message:V.toString(n)}})}nonempty(t){return this.min(1,t)}}en.create=(e,t)=>new en({type:e,minLength:null,maxLength:null,exactLength:null,typeName:W.ZodArray,...se(t)});function Pr(e){if(e instanceof Xe){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=kn.create(Pr(r))}return new Xe({...e._def,shape:()=>t})}else return e instanceof en?new en({...e._def,type:Pr(e.element)}):e instanceof kn?kn.create(Pr(e.unwrap())):e instanceof br?br.create(Pr(e.unwrap())):e instanceof _r?_r.create(e.items.map(t=>Pr(t))):e}class Xe extends ce{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=fe.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==F.object){const u=this._getOrReturnCtx(t);return z(u,{code:D.invalid_type,expected:F.object,received:u.parsedType}),Y}const{status:r,ctx:s}=this._processInputParams(t),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Kn&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const c=a[u],f=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new nn(s,f,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Kn){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(z(s,{code:D.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const f=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new nn(s,f,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const f=await c.key,h=await c.value;u.push({key:f,value:h,alwaysSet:c.alwaysSet})}return u}).then(u=>vt.mergeObjectSync(r,u)):vt.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return V.errToObj,new Xe({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:V.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Xe({...this._def,unknownKeys:"strip"})}passthrough(){return new Xe({...this._def,unknownKeys:"passthrough"})}extend(t){return new Xe({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Xe({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:W.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Xe({...this._def,catchall:t})}pick(t){const n={};for(const r of fe.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Xe({...this._def,shape:()=>n})}omit(t){const n={};for(const r of fe.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Xe({...this._def,shape:()=>n})}deepPartial(){return Pr(this)}partial(t){const n={};for(const r of fe.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Xe({...this._def,shape:()=>n})}required(t){const n={};for(const r of fe.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof kn;)a=a._def.innerType;n[r]=a}return new Xe({...this._def,shape:()=>n})}keyof(){return Ac(fe.objectKeys(this.shape))}}Xe.create=(e,t)=>new Xe({shape:()=>e,unknownKeys:"strip",catchall:Kn.create(),typeName:W.ZodObject,...se(t)});Xe.strictCreate=(e,t)=>new Xe({shape:()=>e,unknownKeys:"strict",catchall:Kn.create(),typeName:W.ZodObject,...se(t)});Xe.lazycreate=(e,t)=>new Xe({shape:e,unknownKeys:"strip",catchall:Kn.create(),typeName:W.ZodObject,...se(t)});class pa extends ce{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new In(o.ctx.common.issues));return z(n,{code:D.invalid_union,unionErrors:i}),Y}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new In(l));return z(n,{code:D.invalid_union,unionErrors:o}),Y}}get options(){return this._def.options}}pa.create=(e,t)=>new pa({options:e,typeName:W.ZodUnion,...se(t)});const pn=e=>e instanceof xi?pn(e.schema):e instanceof yr?pn(e.innerType()):e instanceof ma?[e.value]:e instanceof mr?e.options:e instanceof ya?fe.objectValues(e.enum):e instanceof Sa?pn(e._def.innerType):e instanceof Si?[void 0]:e instanceof wi?[null]:e instanceof kn?[void 0,...pn(e.unwrap())]:e instanceof br?[null,...pn(e.unwrap())]:e instanceof Ic||e instanceof ka?pn(e.unwrap()):e instanceof wa?pn(e._def.innerType):[];class ao extends ce{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==F.object)return z(n,{code:D.invalid_type,expected:F.object,received:n.parsedType}),Y;const r=this.discriminator,s=n.data[r],a=this.optionsMap.get(s);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(z(n,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Y)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const a of n){const i=pn(a.shape[t]);if(!i.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,a)}}return new ao({typeName:W.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...se(r)})}}function Ei(e,t){const n=Bn(e),r=Bn(t);if(e===t)return{valid:!0,data:e};if(n===F.object&&r===F.object){const s=fe.objectKeys(t),a=fe.objectKeys(e).filter(o=>s.indexOf(o)!==-1),i={...e,...t};for(const o of a){const l=Ei(e[o],t[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===F.array&&r===F.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let a=0;a<e.length;a++){const i=e[a],o=t[a],l=Ei(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===F.date&&r===F.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ga extends ce{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(a,i)=>{if(Ho(a)||Ho(i))return Y;const o=Ei(a.value,i.value);return o.valid?((Zo(a)||Zo(i))&&n.dirty(),{status:n.value,value:o.data}):(z(r,{code:D.invalid_intersection_types}),Y)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ga.create=(e,t,n)=>new ga({left:e,right:t,typeName:W.ZodIntersection,...se(n)});class _r extends ce{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==F.array)return z(r,{code:D.invalid_type,expected:F.array,received:r.parsedType}),Y;if(r.data.length<this._def.items.length)return z(r,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Y;!this._def.rest&&r.data.length>this._def.items.length&&(z(r,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new nn(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>vt.mergeArray(n,i)):vt.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new _r({...this._def,rest:t})}}_r.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _r({items:e,typeName:W.ZodTuple,rest:null,...se(t)})};class _a extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==F.object)return z(r,{code:D.invalid_type,expected:F.object,received:r.parsedType}),Y;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in r.data)s.push({key:a._parse(new nn(r,o,r.path,o)),value:i._parse(new nn(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?vt.mergeObjectAsync(n,s):vt.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof ce?new _a({keyType:t,valueType:n,typeName:W.ZodRecord,...se(r)}):new _a({keyType:yn.create(),valueType:t,typeName:W.ZodRecord,...se(n)})}}class Wo extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==F.map)return z(r,{code:D.invalid_type,expected:F.map,received:r.parsedType}),Y;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new nn(r,o,r.path,[u,"key"])),value:a._parse(new nn(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return Y;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return Y;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}Wo.create=(e,t,n)=>new Wo({valueType:t,keyType:e,typeName:W.ZodMap,...se(n)});class ws extends ce{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==F.set)return z(r,{code:D.invalid_type,expected:F.set,received:r.parsedType}),Y;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(z(r,{code:D.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(z(r,{code:D.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const c of l){if(c.status==="aborted")return Y;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new nn(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(t,n){return new ws({...this._def,minSize:{value:t,message:V.toString(n)}})}max(t,n){return new ws({...this._def,maxSize:{value:t,message:V.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}ws.create=(e,t)=>new ws({valueType:e,minSize:null,maxSize:null,typeName:W.ZodSet,...se(t)});class xi extends ce{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}xi.create=(e,t)=>new xi({getter:e,typeName:W.ZodLazy,...se(t)});class ma extends ce{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return z(n,{received:n.data,code:D.invalid_literal,expected:this._def.value}),Y}return{status:"valid",value:t.data}}get value(){return this._def.value}}ma.create=(e,t)=>new ma({value:e,typeName:W.ZodLiteral,...se(t)});function Ac(e,t){return new mr({values:e,typeName:W.ZodEnum,...se(t)})}class mr extends ce{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return z(n,{expected:fe.joinValues(r),received:n.parsedType,code:D.invalid_type}),Y}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return z(n,{received:n.data,code:D.invalid_enum_value,options:r}),Y}return zt(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return mr.create(t,{...this._def,...n})}exclude(t,n=this._def){return mr.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}mr.create=Ac;class ya extends ce{_parse(t){const n=fe.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==F.string&&r.parsedType!==F.number){const s=fe.objectValues(n);return z(r,{expected:fe.joinValues(s),received:r.parsedType,code:D.invalid_type}),Y}if(this._cache||(this._cache=new Set(fe.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=fe.objectValues(n);return z(r,{received:r.data,code:D.invalid_enum_value,options:s}),Y}return zt(t.data)}get enum(){return this._def.values}}ya.create=(e,t)=>new ya({values:e,typeName:W.ZodNativeEnum,...se(t)});class ba extends ce{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==F.promise&&n.common.async===!1)return z(n,{code:D.invalid_type,expected:F.promise,received:n.parsedType}),Y;const r=n.parsedType===F.promise?n.data:Promise.resolve(n.data);return zt(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}ba.create=(e,t)=>new ba({type:e,typeName:W.ZodPromise,...se(t)});class yr extends ce{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===W.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,a={addIssue:i=>{z(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return Y;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?Y:l.status==="dirty"||n.value==="dirty"?cs(l.value):l});{if(n.value==="aborted")return Y;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?Y:o.status==="dirty"||n.value==="dirty"?cs(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Y:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?Y:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Zr(i))return Y;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>Zr(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):Y);fe.assertNever(s)}}yr.create=(e,t,n)=>new yr({schema:e,typeName:W.ZodEffects,effect:t,...se(n)});yr.createWithPreprocess=(e,t,n)=>new yr({schema:t,effect:{type:"preprocess",transform:e},typeName:W.ZodEffects,...se(n)});class kn extends ce{_parse(t){return this._getType(t)===F.undefined?zt(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}kn.create=(e,t)=>new kn({innerType:e,typeName:W.ZodOptional,...se(t)});class br extends ce{_parse(t){return this._getType(t)===F.null?zt(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}br.create=(e,t)=>new br({innerType:e,typeName:W.ZodNullable,...se(t)});class Sa extends ce{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===F.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Sa.create=(e,t)=>new Sa({innerType:e,typeName:W.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...se(t)});class wa extends ce{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return va(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new In(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new In(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}wa.create=(e,t)=>new wa({innerType:e,typeName:W.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...se(t)});class Qo extends ce{_parse(t){if(this._getType(t)!==F.nan){const r=this._getOrReturnCtx(t);return z(r,{code:D.invalid_type,expected:F.nan,received:r.parsedType}),Y}return{status:"valid",value:t.data}}}Qo.create=e=>new Qo({typeName:W.ZodNaN,...se(e)});class Ic extends ce{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class io extends ce{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Y:a.status==="dirty"?(n.dirty(),cs(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Y:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new io({in:t,out:n,typeName:W.ZodPipeline})}}class ka extends ce{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Zr(s)&&(s.value=Object.freeze(s.value)),s);return va(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}ka.create=(e,t)=>new ka({innerType:e,typeName:W.ZodReadonly,...se(t)});var W;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(W||(W={}));const L=yn.create,Jh=Xr.create,Ti=bi.create,ht=ki.create;Kn.create;const Zn=en.create,De=Xe.create,oo=pa.create,La=ao.create;ga.create;_r.create;const Cc=_a.create,H=ma.create,Nc=mr.create,Yh=ya.create;ba.create;kn.create;br.create;var Wh=De({name:L(),arguments:L()}),Qh=De({id:L(),type:H("function"),function:Wh}),Da=De({id:L(),role:L(),content:L().optional(),name:L().optional()}),ep=De({type:H("text"),text:L()}),Rc=De({type:H("binary"),mimeType:L(),id:L().optional(),url:L().optional(),data:L().optional(),filename:L().optional()}),Oc=(e,t)=>{!e.id&&!e.url&&!e.data&&t.addIssue({code:D.custom,message:"BinaryInputContent requires at least one of id, url, or data.",path:["id"]})};Rc.superRefine((e,t)=>{Oc(e,t)});var tp=La("type",[ep,Rc]),np=tp.superRefine((e,t)=>{e.type==="binary"&&Oc(e,t)}),rp=Da.extend({role:H("developer"),content:L()}),sp=Da.extend({role:H("system"),content:L()}),ap=Da.extend({role:H("assistant"),content:L().optional(),toolCalls:Zn(Qh).optional()}),ip=Da.extend({role:H("user"),content:oo([L(),Zn(np)])}),op=De({id:L(),content:L(),role:H("tool"),toolCallId:L(),error:L().optional()}),lp=De({id:L(),role:H("activity"),activityType:L(),content:Cc(ht())}),Mc=La("role",[rp,sp,ap,ip,op,lp]);oo([H("developer"),H("system"),H("assistant"),H("user"),H("tool"),H("activity")]);var up=De({description:L(),value:L()}),cp=De({name:L(),description:L(),parameters:ht()}),dp=De({threadId:L(),runId:L(),parentRunId:L().optional(),state:ht(),messages:Zn(Mc),tools:Zn(cp),context:Zn(up),forwardedProps:ht()}),fp=ht(),Be=class extends Error{constructor(e){super(e)}},el=class extends Be{constructor(){super("Connect not implemented. This method is not supported by the current agent.")}},Pc=oo([H("developer"),H("system"),H("assistant"),H("user")]),O=(e=>(e.TEXT_MESSAGE_START="TEXT_MESSAGE_START",e.TEXT_MESSAGE_CONTENT="TEXT_MESSAGE_CONTENT",e.TEXT_MESSAGE_END="TEXT_MESSAGE_END",e.TEXT_MESSAGE_CHUNK="TEXT_MESSAGE_CHUNK",e.THINKING_TEXT_MESSAGE_START="THINKING_TEXT_MESSAGE_START",e.THINKING_TEXT_MESSAGE_CONTENT="THINKING_TEXT_MESSAGE_CONTENT",e.THINKING_TEXT_MESSAGE_END="THINKING_TEXT_MESSAGE_END",e.TOOL_CALL_START="TOOL_CALL_START",e.TOOL_CALL_ARGS="TOOL_CALL_ARGS",e.TOOL_CALL_END="TOOL_CALL_END",e.TOOL_CALL_CHUNK="TOOL_CALL_CHUNK",e.TOOL_CALL_RESULT="TOOL_CALL_RESULT",e.THINKING_START="THINKING_START",e.THINKING_END="THINKING_END",e.STATE_SNAPSHOT="STATE_SNAPSHOT",e.STATE_DELTA="STATE_DELTA",e.MESSAGES_SNAPSHOT="MESSAGES_SNAPSHOT",e.ACTIVITY_SNAPSHOT="ACTIVITY_SNAPSHOT",e.ACTIVITY_DELTA="ACTIVITY_DELTA",e.RAW="RAW",e.CUSTOM="CUSTOM",e.RUN_STARTED="RUN_STARTED",e.RUN_FINISHED="RUN_FINISHED",e.RUN_ERROR="RUN_ERROR",e.STEP_STARTED="STEP_STARTED",e.STEP_FINISHED="STEP_FINISHED",e))(O||{}),Pe=De({type:Yh(O),timestamp:Jh().optional(),rawEvent:ht().optional()}),vp=Pe.extend({type:H("TEXT_MESSAGE_START"),messageId:L(),role:Pc.default("assistant")}),Lc=Pe.extend({type:H("TEXT_MESSAGE_CONTENT"),messageId:L(),delta:L().refine(e=>e.length>0,"Delta must not be an empty string")}),hp=Pe.extend({type:H("TEXT_MESSAGE_END"),messageId:L()}),pp=Pe.extend({type:H("TEXT_MESSAGE_CHUNK"),messageId:L().optional(),role:Pc.optional(),delta:L().optional()}),gp=Pe.extend({type:H("THINKING_TEXT_MESSAGE_START")}),_p=Lc.omit({messageId:!0,type:!0}).extend({type:H("THINKING_TEXT_MESSAGE_CONTENT")}),mp=Pe.extend({type:H("THINKING_TEXT_MESSAGE_END")}),yp=Pe.extend({type:H("TOOL_CALL_START"),toolCallId:L(),toolCallName:L(),parentMessageId:L().optional()}),bp=Pe.extend({type:H("TOOL_CALL_ARGS"),toolCallId:L(),delta:L()}),Sp=Pe.extend({type:H("TOOL_CALL_END"),toolCallId:L()}),wp=Pe.extend({messageId:L(),type:H("TOOL_CALL_RESULT"),toolCallId:L(),content:L(),role:H("tool").optional()}),kp=Pe.extend({type:H("TOOL_CALL_CHUNK"),toolCallId:L().optional(),toolCallName:L().optional(),parentMessageId:L().optional(),delta:L().optional()}),Ep=Pe.extend({type:H("THINKING_START"),title:L().optional()}),xp=Pe.extend({type:H("THINKING_END")}),Tp=Pe.extend({type:H("STATE_SNAPSHOT"),snapshot:fp}),Ap=Pe.extend({type:H("STATE_DELTA"),delta:Zn(ht())}),Ip=Pe.extend({type:H("MESSAGES_SNAPSHOT"),messages:Zn(Mc)}),Cp=Pe.extend({type:H("ACTIVITY_SNAPSHOT"),messageId:L(),activityType:L(),content:Cc(ht()),replace:Ti().optional().default(!0)}),Np=Pe.extend({type:H("ACTIVITY_DELTA"),messageId:L(),activityType:L(),patch:Zn(ht())}),Rp=Pe.extend({type:H("RAW"),event:ht(),source:L().optional()}),Op=Pe.extend({type:H("CUSTOM"),name:L(),value:ht()}),Mp=Pe.extend({type:H("RUN_STARTED"),threadId:L(),runId:L(),parentRunId:L().optional(),input:dp.optional()}),Pp=Pe.extend({type:H("RUN_FINISHED"),threadId:L(),runId:L(),result:ht().optional()}),Lp=Pe.extend({type:H("RUN_ERROR"),message:L(),code:L().optional()}),Dp=Pe.extend({type:H("STEP_STARTED"),stepName:L()}),$p=Pe.extend({type:H("STEP_FINISHED"),stepName:L()}),Dc=La("type",[vp,Lc,hp,pp,Ep,xp,gp,_p,mp,yp,bp,Sp,kp,wp,Tp,Ap,Ip,Cp,Np,Rp,Op,Mp,Pp,Lp,Dp,$p]);function Ve(e){return typeof e=="function"}function Up(e){return Ve(e?.lift)}function on(e){return function(t){if(Up(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var Ai=function(e,t){return Ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},Ai(e,t)};function es(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ai(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function zp(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(c){try{u(r.next(c))}catch(f){i(f)}}function l(c){try{u(r.throw(c))}catch(f){i(f)}}function u(c){c.done?a(c.value):s(c.value).then(o,l)}u((r=r.apply(e,t||[])).next())})}function $c(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=t.call(e,n)}catch(c){u=[6,c],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Kr(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ii(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,a=[],i;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(o){i={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function Ci(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function jr(e){return this instanceof jr?(this.v=e,this):new jr(e)}function jp(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(v){return function(p){return Promise.resolve(p).then(v,f)}}function o(v,p){r[v]&&(s[v]=function(m){return new Promise(function(_,k){a.push([v,m,_,k])>1||l(v,m)})},p&&(s[v]=p(s[v])))}function l(v,p){try{u(r[v](p))}catch(m){h(a[0][3],m)}}function u(v){v.value instanceof jr?Promise.resolve(v.value.v).then(c,f):h(a[0][2],v)}function c(v){l("next",v)}function f(v){l("throw",v)}function h(v,p){v(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function Gp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Kr=="function"?Kr(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=e[a]&&function(i){return new Promise(function(o,l){i=e[a](i),s(o,l,i.done,i.value)})}}function s(a,i,o,l){Promise.resolve(l).then(function(u){a({value:u,done:o})},i)}}var Uc=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function zc(e){return Ve(e?.then)}function lo(e){var t=function(r){Error.call(r),r.stack=new Error().stack},n=e(t);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Ja=lo(function(e){return function(n){e(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Ni(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var $a=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,n,r,s,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=Kr(i),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(m){t={error:m}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}else i.remove(this);var c=this.initialTeardown;if(Ve(c))try{c()}catch(m){a=m instanceof Ja?m.errors:[m]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=Kr(f),v=h.next();!v.done;v=h.next()){var p=v.value;try{tl(p)}catch(m){a=a??[],m instanceof Ja?a=Ci(Ci([],Ii(a)),Ii(m.errors)):a.push(m)}}}catch(m){r={error:m}}finally{try{v&&!v.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(a)throw new Ja(a)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)tl(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}},e.prototype._hasParent=function(t){var n=this._parentage;return n===t||Array.isArray(n)&&n.includes(t)},e.prototype._addParent=function(t){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t},e.prototype._removeParent=function(t){var n=this._parentage;n===t?this._parentage=null:Array.isArray(n)&&Ni(n,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&Ni(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),jc=$a.EMPTY;function Gc(e){return e instanceof $a||e&&"closed"in e&&Ve(e.remove)&&Ve(e.add)&&Ve(e.unsubscribe)}function tl(e){Ve(e)?e():e.unsubscribe()}var Bp={Promise:void 0},Fp={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Ci([e,t],Ii(n)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Bc(e){Fp.setTimeout(function(){throw e})}function Ri(){}function $s(e){e()}var uo=(function(e){es(t,e);function t(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Gc(n)&&n.add(r)):r.destination=Hp,r}return t.create=function(n,r,s){return new Oi(n,r,s)},t.prototype.next=function(n){this.isStopped||this._next(n)},t.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(n){this.destination.next(n)},t.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})($a),Vp=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var n=this.partialObserver;if(n.next)try{n.next(t)}catch(r){Ps(r)}},e.prototype.error=function(t){var n=this.partialObserver;if(n.error)try{n.error(t)}catch(r){Ps(r)}else Ps(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(n){Ps(n)}},e})(),Oi=(function(e){es(t,e);function t(n,r,s){var a=e.call(this)||this,i;return Ve(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,a.destination=new Vp(i),a}return t})(uo);function Ps(e){Bc(e)}function qp(e){throw e}var Hp={closed:!0,next:Ri,error:qp,complete:Ri},co=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function fo(e){return e}function nl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Fc(e)}function Fc(e){return e.length===0?fo:e.length===1?e[0]:function(n){return e.reduce(function(r,s){return s(r)},n)}}var pt=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(t,n,r){var s=this,a=Xp(t)?t:new Oi(t,n,r);return $s(function(){var i=s,o=i.operator,l=i.source;a.add(o?o.call(a,l):l?s._subscribe(a):s._trySubscribe(a))}),a},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(n){t.error(n)}},e.prototype.forEach=function(t,n){var r=this;return n=rl(n),new n(function(s,a){var i=new Oi({next:function(o){try{t(o)}catch(l){a(l),i.unsubscribe()}},error:a,complete:s});r.subscribe(i)})},e.prototype._subscribe=function(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)},e.prototype[co]=function(){return this},e.prototype.pipe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fc(t)(this)},e.prototype.toPromise=function(t){var n=this;return t=rl(t),new t(function(r,s){var a;n.subscribe(function(i){return a=i},function(i){return s(i)},function(){return r(a)})})},e.create=function(t){return new e(t)},e})();function rl(e){var t;return(t=e??Bp.Promise)!==null&&t!==void 0?t:Promise}function Zp(e){return e&&Ve(e.next)&&Ve(e.error)&&Ve(e.complete)}function Xp(e){return e&&e instanceof uo||Zp(e)&&Gc(e)}function Vc(e){return Ve(e[co])}function qc(e){return Symbol.asyncIterator&&Ve(e?.[Symbol.asyncIterator])}function Hc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Kp(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Zc=Kp();function Xc(e){return Ve(e?.[Zc])}function Kc(e){return jp(this,arguments,function(){var n,r,s,a;return $c(this,function(i){switch(i.label){case 0:n=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,jr(n.read())];case 3:return r=i.sent(),s=r.value,a=r.done,a?[4,jr(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,jr(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Jc(e){return Ve(e?.getReader)}function Rn(e){if(e instanceof pt)return e;if(e!=null){if(Vc(e))return Jp(e);if(Uc(e))return Yp(e);if(zc(e))return Wp(e);if(qc(e))return Yc(e);if(Xc(e))return Qp(e);if(Jc(e))return eg(e)}throw Hc(e)}function Jp(e){return new pt(function(t){var n=e[co]();if(Ve(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Yp(e){return new pt(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Wp(e){return new pt(function(t){e.then(function(n){t.closed||(t.next(n),t.complete())},function(n){return t.error(n)}).then(null,Bc)})}function Qp(e){return new pt(function(t){var n,r;try{for(var s=Kr(e),a=s.next();!a.done;a=s.next()){var i=a.value;if(t.next(i),t.closed)return}}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t.complete()})}function Yc(e){return new pt(function(t){tg(e,t).catch(function(n){return t.error(n)})})}function eg(e){return Yc(Kc(e))}function tg(e,t){var n,r,s,a;return zp(this,void 0,void 0,function(){var i,o;return $c(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=Gp(e),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,t.next(i),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function rn(e,t,n,r,s){return new ng(e,t,n,r,s)}var ng=(function(e){es(t,e);function t(n,r,s,a,i,o){var l=e.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:e.prototype._next,l._error=a?function(u){try{a(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:e.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:e.prototype._complete,l}return t.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},t})(uo),Wc={now:function(){return(Wc.delegate||Date).now()},delegate:void 0};function rg(e){return e&&Ve(e.schedule)}function sg(e){return e[e.length-1]}function ag(e){return rg(sg(e))?e.pop():void 0}function vr(e,t,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var a=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!s)return a}function Mi(e){return on(function(t,n){var r=null,s=!1,a;r=t.subscribe(rn(n,void 0,void 0,function(i){a=Rn(e(i,Mi(e)(t))),r?(r.unsubscribe(),r=null,a.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,a.subscribe(n))})}function Qc(e,t){return t===void 0&&(t=0),on(function(n,r){n.subscribe(rn(r,function(s){return vr(r,e,function(){return r.next(s)},t)},function(){return vr(r,e,function(){return r.complete()},t)},function(s){return vr(r,e,function(){return r.error(s)},t)}))})}function ed(e,t){return t===void 0&&(t=0),on(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function ig(e,t){return Rn(e).pipe(ed(t),Qc(t))}function og(e,t){return Rn(e).pipe(ed(t),Qc(t))}function lg(e,t){return new pt(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function ug(e,t){return new pt(function(n){var r;return vr(n,t,function(){r=e[Zc](),vr(n,t,function(){var s,a,i;try{s=r.next(),a=s.value,i=s.done}catch(o){n.error(o);return}i?n.complete():n.next(a)},0,!0)}),function(){return Ve(r?.return)&&r.return()}})}function td(e,t){if(!e)throw new Error("Iterable cannot be null");return new pt(function(n){vr(n,t,function(){var r=e[Symbol.asyncIterator]();vr(n,t,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function cg(e,t){return td(Kc(e),t)}function dg(e,t){if(e!=null){if(Vc(e))return ig(e,t);if(Uc(e))return lg(e,t);if(zc(e))return og(e,t);if(qc(e))return td(e,t);if(Xc(e))return ug(e,t);if(Jc(e))return cg(e,t)}throw Hc(e)}function Ea(e,t){return t?dg(e,t):Rn(e)}function Pi(e,t){return on(function(n,r){var s=0;n.subscribe(rn(r,function(a){r.next(e.call(t,a,s++))}))})}function fg(e,t,n,r,s,a,i,o){var l=[],u=0,c=0,f=!1,h=function(){f&&!l.length&&!u&&t.complete()},v=function(m){return u<r?p(m):l.push(m)},p=function(m){u++;var _=!1;Rn(n(m,c++)).subscribe(rn(t,function(k){t.next(k)},function(){_=!0},void 0,function(){if(_)try{u--;for(var k=function(){var S=l.shift();i||p(S)};l.length&&u<r;)k();h()}catch(S){t.error(S)}}))};return e.subscribe(rn(t,v,function(){f=!0,h()})),function(){}}function Jn(e,t,n){return n===void 0&&(n=1/0),Ve(t)?Jn(function(r,s){return Pi(function(a,i){return t(r,a,s,i)})(Rn(e(r,s)))},n):(typeof t=="number"&&(n=t),on(function(r,s){return fg(r,s,e,n)}))}function vg(e){return e===void 0&&(e=1/0),Jn(fo,e)}function nd(e,t){return Ve(t)?Jn(e,t,1):Jn(e,1)}var hg=lo(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Sr=(function(e){es(t,e);function t(){var n=e.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return t.prototype.lift=function(n){var r=new sl(this,this);return r.operator=n,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new hg},t.prototype.next=function(n){var r=this;$s(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=Kr(r.currentObservers),o=i.next();!o.done;o=i.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(s)throw s.error}}}})},t.prototype.error=function(n){var r=this;$s(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},t.prototype.complete=function(){var n=this;$s(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(n){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,n)},t.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},t.prototype._innerSubscribe=function(n){var r=this,s=this,a=s.hasError,i=s.isStopped,o=s.observers;return a||i?jc:(this.currentObservers=null,o.push(n),new $a(function(){r.currentObservers=null,Ni(o,n)}))},t.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,a=r.thrownError,i=r.isStopped;s?n.error(a):i&&n.complete()},t.prototype.asObservable=function(){var n=new pt;return n.source=this,n},t.create=function(n,r){return new sl(n,r)},t})(pt),sl=(function(e){es(t,e);function t(n,r){var s=e.call(this)||this;return s.destination=n,s.source=r,s}return t.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},t.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},t.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},t.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:jc},t})(Sr);function pg(e){return on(function(t,n){var r=!1;t.subscribe(rn(n,function(s){r=!0,n.next(s)},function(){r||n.next(e),n.complete()}))})}var rd=new pt(function(e){return e.complete()});function He(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=ag(e);return Ea(e,n)}function Ue(e,t){var n=Ve(e)?e:function(){return e},r=function(s){return s.error(n())};return new pt(r)}var gg=lo(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function Li(e){return on(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}var sd=(function(e){es(t,e);function t(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=Wc);var a=e.call(this)||this;return a._bufferSize=n,a._windowTime=r,a._timestampProvider=s,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,n),a._windowTime=Math.max(1,r),a}return t.prototype.next=function(n){var r=this,s=r.isStopped,a=r._buffer,i=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(a.push(n),!i&&a.push(o.now()+l)),this._trimBuffer(),e.prototype.next.call(this,n)},t.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,a=s._infiniteTimeWindow,i=s._buffer,o=i.slice(),l=0;l<o.length&&!n.closed;l+=a?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},t.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,a=n._buffer,i=n._infiniteTimeWindow,o=(i?1:2)*r;if(r<1/0&&o<a.length&&a.splice(0,a.length-o),!i){for(var l=s.now(),u=0,c=1;c<a.length&&a[c]<=l;c+=2)u=c;u&&a.splice(0,u+1)}},t})(Sr);function _g(e,t){return on(function(n,r){var s=null,a=0,i=!1,o=function(){return i&&!s&&r.complete()};n.subscribe(rn(r,function(l){s?.unsubscribe();var u=0,c=a++;Rn(e(l,c)).subscribe(s=rn(r,function(f){return r.next(t?t(l,f,c,u++):f)},function(){s=null,o()}))},function(){i=!0,o()}))})}function al(e){return on(function(t,n){Rn(e).subscribe(rn(n,function(){return n.complete()},Ri)),!n.closed&&t.subscribe(n)})}function mg(e,t,n){var r=Ve(e)||t||n?{next:e,error:t,complete:n}:e;return r?on(function(s,a){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var o=!0;s.subscribe(rn(a,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),a.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),a.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),a.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):fo}function il(e,t){return new Promise(function(n,r){var s=!1,a;e.subscribe({next:function(i){a=i,s=!0},error:r,complete:function(){s?n(a):r(new gg)}})})}function yg(e){return new pt(function(t){Rn(e()).subscribe(t)})}const nt=[];for(let e=0;e<256;++e)nt.push((e+256).toString(16).slice(1));function bg(e,t=0){return(nt[e[t+0]]+nt[e[t+1]]+nt[e[t+2]]+nt[e[t+3]]+"-"+nt[e[t+4]]+nt[e[t+5]]+"-"+nt[e[t+6]]+nt[e[t+7]]+"-"+nt[e[t+8]]+nt[e[t+9]]+"-"+nt[e[t+10]]+nt[e[t+11]]+nt[e[t+12]]+nt[e[t+13]]+nt[e[t+14]]+nt[e[t+15]]).toLowerCase()}let Ya;const Sg=new Uint8Array(16);function wg(){if(!Ya){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ya=crypto.getRandomValues.bind(crypto)}return Ya(Sg)}const kg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ol={randomUUID:kg};function as(e,t,n){if(ol.randomUUID&&!e)return ol.randomUUID();e=e||{};const r=e.random??e.rng?.()??wg();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,bg(r)}function ll(e){return` \r
	`.indexOf(e)>=0}function ad(e){for(var t=["topLevel"],n=0,r,s,a,i=function(S){return t.push(S)},o=function(S){return t[t.length-1]=S},l=function(S){r==null&&(r=n,s=t.length,a=S)},u=function(S){S===a&&(r=void 0,s=void 0,a=void 0)},c=function(){return t.pop()},f=function(){return n--},h=function(S){if("0"<=S&&S<="9"){i("number");return}switch(S){case'"':i("string");return;case"-":i("numberNeedsDigit");return;case"t":i("true");return;case"f":i("false");return;case"n":i("null");return;case"[":i("arrayNeedsValue");return;case"{":i("objectNeedsKey");return}},v=e.length;n<v;n++){var p=e[n];switch(t[t.length-1]){case"topLevel":h(p);break;case"string":switch(p){case'"':c();break;case"\\":l("stringEscape"),i("stringEscaped");break}break;case"stringEscaped":p==="u"?i("stringUnicode"):(u("stringEscape"),c());break;case"stringUnicode":n-e.lastIndexOf("u",n)===4&&(u("stringEscape"),c());break;case"number":p==="."?o("numberNeedsDigit"):p==="e"||p==="E"?o("numberNeedsExponent"):(p<"0"||p>"9")&&(f(),c());break;case"numberNeedsDigit":o("number");break;case"numberNeedsExponent":o(p==="+"||p==="-"?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(p<"a"||p>"z")&&(f(),c());break;case"arrayNeedsValue":p==="]"?c():ll(p)||(u("collectionItem"),o("arrayNeedsComma"),h(p));break;case"arrayNeedsComma":p==="]"?c():p===","&&(l("collectionItem"),o("arrayNeedsValue"));break;case"objectNeedsKey":p==="}"?c():p==='"'&&(l("collectionItem"),o("objectNeedsColon"),i("string"));break;case"objectNeedsColon":p===":"&&o("objectNeedsValue");break;case"objectNeedsValue":ll(p)||(u("collectionItem"),o("objectNeedsComma"),h(p));break;case"objectNeedsComma":p==="}"?c():p===","&&(l("collectionItem"),o("objectNeedsKey"));break}}s!=null&&(t.length=s);for(var m=[r!=null?e.slice(0,r):e],_=function(S){return m.push(S.slice(e.length-e.lastIndexOf(S[0])))},k=t.length-1;k>=0;k--)switch(t[k]){case"string":m.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":m.push("0");break;case"true":_("true");break;case"false":_("false");break;case"null":_("null");break;case"arrayNeedsValue":case"arrayNeedsComma":m.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":m.push("}");break}return m.join("")}function Eg(){let e=0,t=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,(n&128)==0)return this.assertBounds(),[e,t];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Wa(e,t,n){for(let a=0;a<28;a=a+7){const i=e>>>a,o=!(!(i>>>7)&&t==0),l=(o?i|128:i)&255;if(n.push(l),!o)return}const r=e>>>28&15|(t&7)<<4,s=t>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let a=3;a<31;a=a+7){const i=t>>>a,o=!!(i>>>7),l=(o?i|128:i)&255;if(n.push(l),!o)return}n.push(t>>>31&1)}}const Us=4294967296;function ul(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let r=0,s=0;function a(i,o){const l=Number(e.slice(i,o));s*=n,r=r*n+l,r>=Us&&(s=s+(r/Us|0),r=r%Us)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),t?od(r,s):vo(r,s)}function xg(e,t){let n=vo(e,t);const r=n.hi&2147483648;r&&(n=od(n.lo,n.hi));const s=id(n.lo,n.hi);return r?"-"+s:s}function id(e,t){if({lo:e,hi:t}=Tg(e,t),t<=2097151)return String(Us*t+e);const n=e&16777215,r=(e>>>24|t<<8)&16777215,s=t>>16&65535;let a=n+r*6777216+s*6710656,i=r+s*8147497,o=s*2;const l=1e7;return a>=l&&(i+=Math.floor(a/l),a%=l),i>=l&&(o+=Math.floor(i/l),i%=l),o.toString()+cl(i)+cl(a)}function Tg(e,t){return{lo:e>>>0,hi:t>>>0}}function vo(e,t){return{lo:e|0,hi:t|0}}function od(e,t){return t=~t,e?e=~e+1:t+=1,vo(e,t)}const cl=e=>{const t=String(e);return"0000000".slice(t.length)+t};function dl(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function Ag(){let e=this.buf[this.pos++],t=e&127;if((e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,(e&128)==0)return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,(e&128)==0)return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;(e&128)!==0&&n<10;n++)e=this.buf[this.pos++];if((e&128)!=0)throw new Error("invalid varint");return this.assertBounds(),t>>>0}var fl={};const Jt=Ig();function Ig(){const e=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof fl!="object"||fl.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>r||o<n)throw new Error(`invalid int64: ${i}`);return o},uParse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>a||o<s)throw new Error(`invalid uint64: ${i}`);return o},enc(i){return e.setBigInt64(0,this.parse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(i){return e.setBigInt64(0,this.uParse(i),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigInt64(0,!0)},uDec(i,o){return e.setInt32(0,i,!0),e.setInt32(4,o,!0),e.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),vl(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),hl(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),vl(n),ul(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),hl(n),ul(n)},dec(n,r){return xg(n,r)},uDec(n,r){return id(n,r)}}}function vl(e){if(!/^-?[0-9]+$/.test(e))throw new Error("invalid int64: "+e)}function hl(e){if(!/^[0-9]+$/.test(e))throw new Error("invalid uint64: "+e)}const Qa=Symbol.for("@bufbuild/protobuf/text-encoding");function ld(){if(globalThis[Qa]==null){const e=new globalThis.TextEncoder,t=new globalThis.TextDecoder;globalThis[Qa]={encodeUtf8(n){return e.encode(n)},decodeUtf8(n){return t.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[Qa]}var Fn;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(Fn||(Fn={}));const Cg=34028234663852886e22,Ng=-34028234663852886e22,Rg=4294967295,Og=2147483647,Mg=-2147483648;class Ae{constructor(t=ld().encodeUtf8){this.encodeUtf8=t,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let t=0;for(let s=0;s<this.chunks.length;s++)t+=this.chunks[s].length;let n=new Uint8Array(t),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(pl(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return ei(t),dl(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.encodeUtf8(t);return this.uint32(n.byteLength),this.raw(n)}float(t){Pg(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){pl(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){ei(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return ei(t),t=(t<<1^t>>31)>>>0,dl(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=Jt.enc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),r=new DataView(n.buffer),s=Jt.uEnc(t);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(t){let n=Jt.enc(t);return Wa(n.lo,n.hi,this.buf),this}sint64(t){const n=Jt.enc(t),r=n.hi>>31,s=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Wa(s,a,this.buf),this}uint64(t){const n=Jt.uEnc(t);return Wa(n.lo,n.hi,this.buf),this}}class Z{constructor(t,n=ld().decodeUtf8){this.decodeUtf8=n,this.varint64=Eg,this.uint32=Ag,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength)}tag(){let t=this.uint32(),n=t>>>3,r=t&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(t,n){let r=this.pos;switch(t){case Fn.Varint:for(;this.buf[this.pos++]&128;);break;case Fn.Bit64:this.pos+=4;case Fn.Bit32:this.pos+=4;break;case Fn.LengthDelimited:let s=this.uint32();this.pos+=s;break;case Fn.StartGroup:for(;;){const[a,i]=this.tag();if(i===Fn.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(i,a)}break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return Jt.dec(...this.varint64())}uint64(){return Jt.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),r=-(t&1);return t=(t>>>1|(n&1)<<31)^r,n=n>>>1^r,Jt.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Jt.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Jt.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.decodeUtf8(this.bytes())}}function ei(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid int32: "+typeof e);if(!Number.isInteger(e)||e>Og||e<Mg)throw new Error("invalid int32: "+e)}function pl(e){if(typeof e=="string")e=Number(e);else if(typeof e!="number")throw new Error("invalid uint32: "+typeof e);if(!Number.isInteger(e)||e>Rg||e<0)throw new Error("invalid uint32: "+e)}function Pg(e){if(typeof e=="string"){const t=e;if(e=Number(e),Number.isNaN(e)&&t!=="NaN")throw new Error("invalid float32: "+t)}else if(typeof e!="number")throw new Error("invalid float32: "+typeof e);if(Number.isFinite(e)&&(e>Cg||e<Ng))throw new Error("invalid float32: "+e)}function ti(){return{fields:{}}}var ds={encode(e,t=new Ae){return Object.entries(e.fields).forEach(([n,r])=>{r!==void 0&&Di.encode({key:n,value:r},t.uint32(10).fork()).join()}),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ti();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;const i=Di.decode(n,n.uint32());i.value!==void 0&&(s.fields[i.key]=i.value);continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ds.fromPartial(e??{})},fromPartial(e){var t;const n=ti();return n.fields=Object.entries((t=e.fields)!=null?t:{}).reduce((r,[s,a])=>(a!==void 0&&(r[s]=a),r),{}),n},wrap(e){const t=ti();if(e!==void 0)for(const n of Object.keys(e))t.fields[n]=e[n];return t},unwrap(e){const t={};if(e.fields)for(const n of Object.keys(e.fields))t[n]=e.fields[n];return t}};function gl(){return{key:"",value:void 0}}var Di={encode(e,t=new Ae){return e.key!==""&&t.uint32(10).string(e.key),e.value!==void 0&&ve.encode(ve.wrap(e.value),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=gl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.key=n.string();continue}case 2:{if(a!==18)break;s.value=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Di.fromPartial(e??{})},fromPartial(e){var t,n;const r=gl();return r.key=(t=e.key)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function ni(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}var ve={encode(e,t=new Ae){return e.nullValue!==void 0&&t.uint32(8).int32(e.nullValue),e.numberValue!==void 0&&t.uint32(17).double(e.numberValue),e.stringValue!==void 0&&t.uint32(26).string(e.stringValue),e.boolValue!==void 0&&t.uint32(32).bool(e.boolValue),e.structValue!==void 0&&ds.encode(ds.wrap(e.structValue),t.uint32(42).fork()).join(),e.listValue!==void 0&&fs.encode(fs.wrap(e.listValue),t.uint32(50).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ni();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.nullValue=n.int32();continue}case 2:{if(a!==17)break;s.numberValue=n.double();continue}case 3:{if(a!==26)break;s.stringValue=n.string();continue}case 4:{if(a!==32)break;s.boolValue=n.bool();continue}case 5:{if(a!==42)break;s.structValue=ds.unwrap(ds.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.listValue=fs.unwrap(fs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ve.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i;const o=ni();return o.nullValue=(t=e.nullValue)!=null?t:void 0,o.numberValue=(n=e.numberValue)!=null?n:void 0,o.stringValue=(r=e.stringValue)!=null?r:void 0,o.boolValue=(s=e.boolValue)!=null?s:void 0,o.structValue=(a=e.structValue)!=null?a:void 0,o.listValue=(i=e.listValue)!=null?i:void 0,o},wrap(e){const t=ni();if(e===null)t.nullValue=0;else if(typeof e=="boolean")t.boolValue=e;else if(typeof e=="number")t.numberValue=e;else if(typeof e=="string")t.stringValue=e;else if(globalThis.Array.isArray(e))t.listValue=e;else if(typeof e=="object")t.structValue=e;else if(typeof e<"u")throw new globalThis.Error("Unsupported any value type: "+typeof e);return t},unwrap(e){if(e.stringValue!==void 0)return e.stringValue;if(e?.numberValue!==void 0)return e.numberValue;if(e?.boolValue!==void 0)return e.boolValue;if(e?.structValue!==void 0)return e.structValue;if(e?.listValue!==void 0)return e.listValue;if(e?.nullValue!==void 0)return null}};function ri(){return{values:[]}}var fs={encode(e,t=new Ae){for(const n of e.values)ve.encode(ve.wrap(n),t.uint32(10).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ri();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.values.push(ve.unwrap(ve.decode(n,n.uint32())));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return fs.fromPartial(e??{})},fromPartial(e){var t;const n=ri();return n.values=((t=e.values)==null?void 0:t.map(r=>r))||[],n},wrap(e){const t=ri();return t.values=e??[],t},unwrap(e){return e?.hasOwnProperty("values")&&globalThis.Array.isArray(e.values)?e.values:e}},ud=(e=>(e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.REPLACE=2]="REPLACE",e[e.MOVE=3]="MOVE",e[e.COPY=4]="COPY",e[e.TEST=5]="TEST",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(ud||{});function _l(){return{op:0,path:"",from:void 0,value:void 0}}var zs={encode(e,t=new Ae){return e.op!==0&&t.uint32(8).int32(e.op),e.path!==""&&t.uint32(18).string(e.path),e.from!==void 0&&t.uint32(26).string(e.from),e.value!==void 0&&ve.encode(ve.wrap(e.value),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=_l();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.op=n.int32();continue}case 2:{if(a!==18)break;s.path=n.string();continue}case 3:{if(a!==26)break;s.from=n.string();continue}case 4:{if(a!==34)break;s.value=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return zs.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=_l();return a.op=(t=e.op)!=null?t:0,a.path=(n=e.path)!=null?n:"",a.from=(r=e.from)!=null?r:void 0,a.value=(s=e.value)!=null?s:void 0,a}};function ml(){return{id:"",type:"",function:void 0}}var js={encode(e,t=new Ae){return e.id!==""&&t.uint32(10).string(e.id),e.type!==""&&t.uint32(18).string(e.type),e.function!==void 0&&Gs.encode(e.function,t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=ml();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.type=n.string();continue}case 3:{if(a!==26)break;s.function=Gs.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return js.fromPartial(e??{})},fromPartial(e){var t,n;const r=ml();return r.id=(t=e.id)!=null?t:"",r.type=(n=e.type)!=null?n:"",r.function=e.function!==void 0&&e.function!==null?Gs.fromPartial(e.function):void 0,r}};function yl(){return{name:"",arguments:""}}var Gs={encode(e,t=new Ae){return e.name!==""&&t.uint32(10).string(e.name),e.arguments!==""&&t.uint32(18).string(e.arguments),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=yl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.name=n.string();continue}case 2:{if(a!==18)break;s.arguments=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Gs.fromPartial(e??{})},fromPartial(e){var t,n;const r=yl();return r.name=(t=e.name)!=null?t:"",r.arguments=(n=e.arguments)!=null?n:"",r}};function bl(){return{id:"",role:"",content:void 0,name:void 0,toolCalls:[],toolCallId:void 0,error:void 0}}var Bs={encode(e,t=new Ae){e.id!==""&&t.uint32(10).string(e.id),e.role!==""&&t.uint32(18).string(e.role),e.content!==void 0&&t.uint32(26).string(e.content),e.name!==void 0&&t.uint32(34).string(e.name);for(const n of e.toolCalls)js.encode(n,t.uint32(42).fork()).join();return e.toolCallId!==void 0&&t.uint32(50).string(e.toolCallId),e.error!==void 0&&t.uint32(58).string(e.error),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=bl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.role=n.string();continue}case 3:{if(a!==26)break;s.content=n.string();continue}case 4:{if(a!==34)break;s.name=n.string();continue}case 5:{if(a!==42)break;s.toolCalls.push(js.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.toolCallId=n.string();continue}case 7:{if(a!==58)break;s.error=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Bs.fromPartial(e??{})},fromPartial(e){var t,n,r,s,a,i,o;const l=bl();return l.id=(t=e.id)!=null?t:"",l.role=(n=e.role)!=null?n:"",l.content=(r=e.content)!=null?r:void 0,l.name=(s=e.name)!=null?s:void 0,l.toolCalls=((a=e.toolCalls)==null?void 0:a.map(u=>js.fromPartial(u)))||[],l.toolCallId=(i=e.toolCallId)!=null?i:void 0,l.error=(o=e.error)!=null?o:void 0,l}},cd=(e=>(e[e.TEXT_MESSAGE_START=0]="TEXT_MESSAGE_START",e[e.TEXT_MESSAGE_CONTENT=1]="TEXT_MESSAGE_CONTENT",e[e.TEXT_MESSAGE_END=2]="TEXT_MESSAGE_END",e[e.TOOL_CALL_START=3]="TOOL_CALL_START",e[e.TOOL_CALL_ARGS=4]="TOOL_CALL_ARGS",e[e.TOOL_CALL_END=5]="TOOL_CALL_END",e[e.STATE_SNAPSHOT=6]="STATE_SNAPSHOT",e[e.STATE_DELTA=7]="STATE_DELTA",e[e.MESSAGES_SNAPSHOT=8]="MESSAGES_SNAPSHOT",e[e.RAW=9]="RAW",e[e.CUSTOM=10]="CUSTOM",e[e.RUN_STARTED=11]="RUN_STARTED",e[e.RUN_FINISHED=12]="RUN_FINISHED",e[e.RUN_ERROR=13]="RUN_ERROR",e[e.STEP_STARTED=14]="STEP_STARTED",e[e.STEP_FINISHED=15]="STEP_FINISHED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED",e))(cd||{});function Sl(){return{type:0,timestamp:void 0,rawEvent:void 0}}var K={encode(e,t=new Ae){return e.type!==0&&t.uint32(8).int32(e.type),e.timestamp!==void 0&&t.uint32(16).int64(e.timestamp),e.rawEvent!==void 0&&ve.encode(ve.wrap(e.rawEvent),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Sl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.type=n.int32();continue}case 2:{if(a!==16)break;s.timestamp=Lg(n.int64());continue}case 3:{if(a!==26)break;s.rawEvent=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return K.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Sl();return s.type=(t=e.type)!=null?t:0,s.timestamp=(n=e.timestamp)!=null?n:void 0,s.rawEvent=(r=e.rawEvent)!=null?r:void 0,s}};function wl(){return{baseEvent:void 0,messageId:"",role:void 0}}var Fs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=wl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Fs.fromPartial(e??{})},fromPartial(e){var t,n;const r=wl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.role=(n=e.role)!=null?n:void 0,r}};function kl(){return{baseEvent:void 0,messageId:"",delta:""}}var Vs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=kl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Vs.fromPartial(e??{})},fromPartial(e){var t,n;const r=kl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.messageId=(t=e.messageId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function El(){return{baseEvent:void 0,messageId:""}}var qs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==""&&t.uint32(18).string(e.messageId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=El();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return qs.fromPartial(e??{})},fromPartial(e){var t;const n=El();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.messageId=(t=e.messageId)!=null?t:"",n}};function xl(){return{baseEvent:void 0,toolCallId:"",toolCallName:"",parentMessageId:void 0}}var Hs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.toolCallName!==""&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=xl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Hs.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=xl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,s.toolCallId=(t=e.toolCallId)!=null?t:"",s.toolCallName=(n=e.toolCallName)!=null?n:"",s.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,s}};function Tl(){return{baseEvent:void 0,toolCallId:"",delta:""}}var Zs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),e.delta!==""&&t.uint32(26).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Tl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Zs.fromPartial(e??{})},fromPartial(e){var t,n;const r=Tl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.toolCallId=(t=e.toolCallId)!=null?t:"",r.delta=(n=e.delta)!=null?n:"",r}};function Al(){return{baseEvent:void 0,toolCallId:""}}var Xs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==""&&t.uint32(18).string(e.toolCallId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Al();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Xs.fromPartial(e??{})},fromPartial(e){var t;const n=Al();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.toolCallId=(t=e.toolCallId)!=null?t:"",n}};function Il(){return{baseEvent:void 0,snapshot:void 0}}var Ks={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.snapshot!==void 0&&ve.encode(ve.wrap(e.snapshot),t.uint32(18).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Il();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.snapshot=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ks.fromPartial(e??{})},fromPartial(e){var t;const n=Il();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.snapshot=(t=e.snapshot)!=null?t:void 0,n}};function Cl(){return{baseEvent:void 0,delta:[]}}var Js={encode(e,t=new Ae){e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.delta)zs.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Cl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.delta.push(zs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Js.fromPartial(e??{})},fromPartial(e){var t;const n=Cl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.delta=((t=e.delta)==null?void 0:t.map(r=>zs.fromPartial(r)))||[],n}};function Nl(){return{baseEvent:void 0,messages:[]}}var Ys={encode(e,t=new Ae){e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join();for(const n of e.messages)Bs.encode(n,t.uint32(18).fork()).join();return t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Nl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messages.push(Bs.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ys.fromPartial(e??{})},fromPartial(e){var t;const n=Nl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.messages=((t=e.messages)==null?void 0:t.map(r=>Bs.fromPartial(r)))||[],n}};function Rl(){return{baseEvent:void 0,event:void 0,source:void 0}}var Ws={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.event!==void 0&&ve.encode(ve.wrap(e.event),t.uint32(18).fork()).join(),e.source!==void 0&&t.uint32(26).string(e.source),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Rl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.event=ve.unwrap(ve.decode(n,n.uint32()));continue}case 3:{if(a!==26)break;s.source=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Ws.fromPartial(e??{})},fromPartial(e){var t,n;const r=Rl();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.event=(t=e.event)!=null?t:void 0,r.source=(n=e.source)!=null?n:void 0,r}};function Ol(){return{baseEvent:void 0,name:"",value:void 0}}var Qs={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.name!==""&&t.uint32(18).string(e.name),e.value!==void 0&&ve.encode(ve.wrap(e.value),t.uint32(26).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Ol();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.name=n.string();continue}case 3:{if(a!==26)break;s.value=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return Qs.fromPartial(e??{})},fromPartial(e){var t,n;const r=Ol();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.name=(t=e.name)!=null?t:"",r.value=(n=e.value)!=null?n:void 0,r}};function Ml(){return{baseEvent:void 0,threadId:"",runId:""}}var ea={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Ml();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ea.fromPartial(e??{})},fromPartial(e){var t,n;const r=Ml();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.threadId=(t=e.threadId)!=null?t:"",r.runId=(n=e.runId)!=null?n:"",r}};function Pl(){return{baseEvent:void 0,threadId:"",runId:"",result:void 0}}var ta={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.threadId!==""&&t.uint32(18).string(e.threadId),e.runId!==""&&t.uint32(26).string(e.runId),e.result!==void 0&&ve.encode(ve.wrap(e.result),t.uint32(34).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Pl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}case 4:{if(a!==34)break;s.result=ve.unwrap(ve.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ta.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Pl();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,s.threadId=(t=e.threadId)!=null?t:"",s.runId=(n=e.runId)!=null?n:"",s.result=(r=e.result)!=null?r:void 0,s}};function Ll(){return{baseEvent:void 0,code:void 0,message:""}}var na={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.code!==void 0&&t.uint32(18).string(e.code),e.message!==""&&t.uint32(26).string(e.message),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Ll();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.code=n.string();continue}case 3:{if(a!==26)break;s.message=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return na.fromPartial(e??{})},fromPartial(e){var t,n;const r=Ll();return r.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,r.code=(t=e.code)!=null?t:void 0,r.message=(n=e.message)!=null?n:"",r}};function Dl(){return{baseEvent:void 0,stepName:""}}var ra={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Dl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ra.fromPartial(e??{})},fromPartial(e){var t;const n=Dl();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function $l(){return{baseEvent:void 0,stepName:""}}var sa={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.stepName!==""&&t.uint32(18).string(e.stepName),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=$l();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return sa.fromPartial(e??{})},fromPartial(e){var t;const n=$l();return n.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,n.stepName=(t=e.stepName)!=null?t:"",n}};function Ul(){return{baseEvent:void 0,messageId:void 0,role:void 0,delta:void 0}}var aa={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.messageId!==void 0&&t.uint32(18).string(e.messageId),e.role!==void 0&&t.uint32(26).string(e.role),e.delta!==void 0&&t.uint32(34).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=Ul();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}case 4:{if(a!==34)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return aa.fromPartial(e??{})},fromPartial(e){var t,n,r;const s=Ul();return s.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,s.messageId=(t=e.messageId)!=null?t:void 0,s.role=(n=e.role)!=null?n:void 0,s.delta=(r=e.delta)!=null?r:void 0,s}};function zl(){return{baseEvent:void 0,toolCallId:void 0,toolCallName:void 0,parentMessageId:void 0,delta:void 0}}var ia={encode(e,t=new Ae){return e.baseEvent!==void 0&&K.encode(e.baseEvent,t.uint32(10).fork()).join(),e.toolCallId!==void 0&&t.uint32(18).string(e.toolCallId),e.toolCallName!==void 0&&t.uint32(26).string(e.toolCallName),e.parentMessageId!==void 0&&t.uint32(34).string(e.parentMessageId),e.delta!==void 0&&t.uint32(42).string(e.delta),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=zl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=K.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}case 5:{if(a!==42)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return ia.fromPartial(e??{})},fromPartial(e){var t,n,r,s;const a=zl();return a.baseEvent=e.baseEvent!==void 0&&e.baseEvent!==null?K.fromPartial(e.baseEvent):void 0,a.toolCallId=(t=e.toolCallId)!=null?t:void 0,a.toolCallName=(n=e.toolCallName)!=null?n:void 0,a.parentMessageId=(r=e.parentMessageId)!=null?r:void 0,a.delta=(s=e.delta)!=null?s:void 0,a}};function jl(){return{textMessageStart:void 0,textMessageContent:void 0,textMessageEnd:void 0,toolCallStart:void 0,toolCallArgs:void 0,toolCallEnd:void 0,stateSnapshot:void 0,stateDelta:void 0,messagesSnapshot:void 0,raw:void 0,custom:void 0,runStarted:void 0,runFinished:void 0,runError:void 0,stepStarted:void 0,stepFinished:void 0,textMessageChunk:void 0,toolCallChunk:void 0}}var dd={encode(e,t=new Ae){return e.textMessageStart!==void 0&&Fs.encode(e.textMessageStart,t.uint32(10).fork()).join(),e.textMessageContent!==void 0&&Vs.encode(e.textMessageContent,t.uint32(18).fork()).join(),e.textMessageEnd!==void 0&&qs.encode(e.textMessageEnd,t.uint32(26).fork()).join(),e.toolCallStart!==void 0&&Hs.encode(e.toolCallStart,t.uint32(34).fork()).join(),e.toolCallArgs!==void 0&&Zs.encode(e.toolCallArgs,t.uint32(42).fork()).join(),e.toolCallEnd!==void 0&&Xs.encode(e.toolCallEnd,t.uint32(50).fork()).join(),e.stateSnapshot!==void 0&&Ks.encode(e.stateSnapshot,t.uint32(58).fork()).join(),e.stateDelta!==void 0&&Js.encode(e.stateDelta,t.uint32(66).fork()).join(),e.messagesSnapshot!==void 0&&Ys.encode(e.messagesSnapshot,t.uint32(74).fork()).join(),e.raw!==void 0&&Ws.encode(e.raw,t.uint32(82).fork()).join(),e.custom!==void 0&&Qs.encode(e.custom,t.uint32(90).fork()).join(),e.runStarted!==void 0&&ea.encode(e.runStarted,t.uint32(98).fork()).join(),e.runFinished!==void 0&&ta.encode(e.runFinished,t.uint32(106).fork()).join(),e.runError!==void 0&&na.encode(e.runError,t.uint32(114).fork()).join(),e.stepStarted!==void 0&&ra.encode(e.stepStarted,t.uint32(122).fork()).join(),e.stepFinished!==void 0&&sa.encode(e.stepFinished,t.uint32(130).fork()).join(),e.textMessageChunk!==void 0&&aa.encode(e.textMessageChunk,t.uint32(138).fork()).join(),e.toolCallChunk!==void 0&&ia.encode(e.toolCallChunk,t.uint32(146).fork()).join(),t},decode(e,t){const n=e instanceof Z?e:new Z(e),r=t===void 0?n.len:n.pos+t,s=jl();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.textMessageStart=Fs.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.textMessageContent=Vs.decode(n,n.uint32());continue}case 3:{if(a!==26)break;s.textMessageEnd=qs.decode(n,n.uint32());continue}case 4:{if(a!==34)break;s.toolCallStart=Hs.decode(n,n.uint32());continue}case 5:{if(a!==42)break;s.toolCallArgs=Zs.decode(n,n.uint32());continue}case 6:{if(a!==50)break;s.toolCallEnd=Xs.decode(n,n.uint32());continue}case 7:{if(a!==58)break;s.stateSnapshot=Ks.decode(n,n.uint32());continue}case 8:{if(a!==66)break;s.stateDelta=Js.decode(n,n.uint32());continue}case 9:{if(a!==74)break;s.messagesSnapshot=Ys.decode(n,n.uint32());continue}case 10:{if(a!==82)break;s.raw=Ws.decode(n,n.uint32());continue}case 11:{if(a!==90)break;s.custom=Qs.decode(n,n.uint32());continue}case 12:{if(a!==98)break;s.runStarted=ea.decode(n,n.uint32());continue}case 13:{if(a!==106)break;s.runFinished=ta.decode(n,n.uint32());continue}case 14:{if(a!==114)break;s.runError=na.decode(n,n.uint32());continue}case 15:{if(a!==122)break;s.stepStarted=ra.decode(n,n.uint32());continue}case 16:{if(a!==130)break;s.stepFinished=sa.decode(n,n.uint32());continue}case 17:{if(a!==138)break;s.textMessageChunk=aa.decode(n,n.uint32());continue}case 18:{if(a!==146)break;s.toolCallChunk=ia.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(e){return dd.fromPartial(e??{})},fromPartial(e){const t=jl();return t.textMessageStart=e.textMessageStart!==void 0&&e.textMessageStart!==null?Fs.fromPartial(e.textMessageStart):void 0,t.textMessageContent=e.textMessageContent!==void 0&&e.textMessageContent!==null?Vs.fromPartial(e.textMessageContent):void 0,t.textMessageEnd=e.textMessageEnd!==void 0&&e.textMessageEnd!==null?qs.fromPartial(e.textMessageEnd):void 0,t.toolCallStart=e.toolCallStart!==void 0&&e.toolCallStart!==null?Hs.fromPartial(e.toolCallStart):void 0,t.toolCallArgs=e.toolCallArgs!==void 0&&e.toolCallArgs!==null?Zs.fromPartial(e.toolCallArgs):void 0,t.toolCallEnd=e.toolCallEnd!==void 0&&e.toolCallEnd!==null?Xs.fromPartial(e.toolCallEnd):void 0,t.stateSnapshot=e.stateSnapshot!==void 0&&e.stateSnapshot!==null?Ks.fromPartial(e.stateSnapshot):void 0,t.stateDelta=e.stateDelta!==void 0&&e.stateDelta!==null?Js.fromPartial(e.stateDelta):void 0,t.messagesSnapshot=e.messagesSnapshot!==void 0&&e.messagesSnapshot!==null?Ys.fromPartial(e.messagesSnapshot):void 0,t.raw=e.raw!==void 0&&e.raw!==null?Ws.fromPartial(e.raw):void 0,t.custom=e.custom!==void 0&&e.custom!==null?Qs.fromPartial(e.custom):void 0,t.runStarted=e.runStarted!==void 0&&e.runStarted!==null?ea.fromPartial(e.runStarted):void 0,t.runFinished=e.runFinished!==void 0&&e.runFinished!==null?ta.fromPartial(e.runFinished):void 0,t.runError=e.runError!==void 0&&e.runError!==null?na.fromPartial(e.runError):void 0,t.stepStarted=e.stepStarted!==void 0&&e.stepStarted!==null?ra.fromPartial(e.stepStarted):void 0,t.stepFinished=e.stepFinished!==void 0&&e.stepFinished!==null?sa.fromPartial(e.stepFinished):void 0,t.textMessageChunk=e.textMessageChunk!==void 0&&e.textMessageChunk!==null?aa.fromPartial(e.textMessageChunk):void 0,t.toolCallChunk=e.toolCallChunk!==void 0&&e.toolCallChunk!==null?ia.fromPartial(e.toolCallChunk):void 0,t}};function Lg(e){const t=globalThis.Number(e.toString());if(t>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(t<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return t}function Dg(e){var t;const n=dd.decode(e),r=Object.values(n).find(s=>s!==void 0);if(!r)throw new Error("Invalid event");if(r.type=cd[r.baseEvent.type],r.timestamp=r.baseEvent.timestamp,r.rawEvent=r.baseEvent.rawEvent,r.type===O.MESSAGES_SNAPSHOT)for(const s of r.messages){const a=s;((t=a.toolCalls)==null?void 0:t.length)===0&&(a.toolCalls=void 0)}if(r.type===O.STATE_DELTA)for(const s of r.delta)s.op=ud[s.op].toLowerCase(),Object.keys(s).forEach(a=>{s[a]===void 0&&delete s[a]});return Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),Dc.parse(r)}var $g="application/vnd.ag-ui.event+proto";const Ug=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,Gl=e=>{if(typeof e!="string")throw new TypeError("Invalid argument expected string");const t=e.match(Ug);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},Bl=e=>e==="*"||e==="x"||e==="X",Fl=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},zg=(e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t],jg=(e,t)=>{if(Bl(e)||Bl(t))return 0;const[n,r]=zg(Fl(e),Fl(t));return n>r?1:n<r?-1:0},Vl=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const r=jg(e[n]||"0",t[n]||"0");if(r!==0)return r}return 0},Gg=(e,t)=>{const n=Gl(e),r=Gl(t),s=n.pop(),a=r.pop(),i=Vl(n,r);return i!==0?i:s&&a?Vl(s.split("."),a.split(".")):s||a?s?-1:1:0};var Bg={},Fg=Object.defineProperty,Vg=Object.defineProperties,qg=Object.getOwnPropertyDescriptors,xa=Object.getOwnPropertySymbols,fd=Object.prototype.hasOwnProperty,vd=Object.prototype.propertyIsEnumerable,ql=(e,t,n)=>t in e?Fg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lt=(e,t)=>{for(var n in t||(t={}))fd.call(t,n)&&ql(e,n,t[n]);if(xa)for(var n of xa(t))vd.call(t,n)&&ql(e,n,t[n]);return e},Yn=(e,t)=>Vg(e,qg(t)),Hg=(e,t)=>{var n={};for(var r in e)fd.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&xa)for(var r of xa(e))t.indexOf(r)<0&&vd.call(e,r)&&(n[r]=e[r]);return n},Te=e=>{if(typeof structuredClone=="function")return structuredClone(e);try{return JSON.parse(JSON.stringify(e))}catch{return lt({},e)}};async function ze(e,t,n,r){let s=t,a=n,i;for(let o of e)try{let l=await r(o,Te(s),Te(a));if(l===void 0)continue;if(l.messages!==void 0&&(s=l.messages),l.state!==void 0&&(a=l.state),i=l.stopPropagation,i===!0)break}catch(l){Bg.JEST_WORKER_ID!==void 0||console.error("Subscriber error:",l);continue}return lt(lt(lt({},JSON.stringify(s)!==JSON.stringify(t)?{messages:s}:{}),JSON.stringify(a)!==JSON.stringify(n)?{state:a}:{}),i!==void 0?{stopPropagation:i}:{})}var hd=(e,t,n,r)=>{let s=Te(n.messages),a=Te(e.state),i={},o=u=>{u.messages!==void 0&&(s=u.messages,i.messages=u.messages),u.state!==void 0&&(a=u.state,i.state=u.state)},l=()=>{let u=Te(i);return i={},u.messages!==void 0||u.state!==void 0?He(u):rd};return t.pipe(nd(async u=>{var c,f,h,v;let p=await ze(r,s,a,(m,_,k)=>{var S;return(S=m.onEvent)==null?void 0:S.call(m,{event:u,agent:n,input:e,messages:_,state:k})});if(o(p),p.stopPropagation===!0)return l();switch(u.type){case O.TEXT_MESSAGE_START:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onTextMessageStartEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:_,role:k="assistant"}=u,S={id:_,role:k,content:""};s.push(S),o({messages:s})}return l()}case O.TEXT_MESSAGE_CONTENT:{let{messageId:m,delta:_}=u,k=s.find(w=>w.id===m);if(!k)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${m}'`),l();let S=await ze(r,s,a,(w,T,C)=>{var A;return(A=w.onTextMessageContentEvent)==null?void 0:A.call(w,{event:u,messages:T,state:C,agent:n,input:e,textMessageBuffer:typeof k.content=="string"?k.content:""})});if(o(S),S.stopPropagation!==!0){let w=typeof k.content=="string"?k.content:"";k.content=`${w}${_}`,o({messages:s})}return l()}case O.TEXT_MESSAGE_END:{let{messageId:m}=u,_=s.find(S=>S.id===m);if(!_)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${m}'`),l();let k=await ze(r,s,a,(S,w,T)=>{var C;return(C=S.onTextMessageEndEvent)==null?void 0:C.call(S,{event:u,messages:w,state:T,agent:n,input:e,textMessageBuffer:typeof _.content=="string"?_.content:""})});return o(k),await Promise.all(r.map(S=>{var w;(w=S.onNewMessage)==null||w.call(S,{message:_,messages:s,state:a,agent:n,input:e})})),l()}case O.TOOL_CALL_START:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onToolCallStartEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{toolCallId:_,toolCallName:k,parentMessageId:S}=u,w;S&&s.length>0&&s[s.length-1].id===S?w=s[s.length-1]:(w={id:S||_,role:"assistant",toolCalls:[]},s.push(w)),w.toolCalls!=null||(w.toolCalls=[]),w.toolCalls.push({id:_,type:"function",function:{name:k,arguments:""}}),o({messages:s})}return l()}case O.TOOL_CALL_ARGS:{let{toolCallId:m,delta:_}=u,k=s.find(T=>{var C;return(C=T.toolCalls)==null?void 0:C.some(A=>A.id===m)});if(!k)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${m}'`),l();let S=k.toolCalls.find(T=>T.id===m);if(!S)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${m}'`),l();let w=await ze(r,s,a,(T,C,A)=>{var R;let U=S.function.arguments,$=S.function.name,I={};try{I=ad(U)}catch{}return(R=T.onToolCallArgsEvent)==null?void 0:R.call(T,{event:u,messages:C,state:A,agent:n,input:e,toolCallBuffer:U,toolCallName:$,partialToolCallArgs:I})});return o(w),w.stopPropagation!==!0&&(S.function.arguments+=_,o({messages:s})),l()}case O.TOOL_CALL_END:{let{toolCallId:m}=u,_=s.find(w=>{var T;return(T=w.toolCalls)==null?void 0:T.some(C=>C.id===m)});if(!_)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${m}'`),l();let k=_.toolCalls.find(w=>w.id===m);if(!k)return console.warn(`TOOL_CALL_END: No tool call found with ID '${m}'`),l();let S=await ze(r,s,a,(w,T,C)=>{var A;let R=k.function.arguments,U=k.function.name,$={};try{$=JSON.parse(R)}catch{}return(A=w.onToolCallEndEvent)==null?void 0:A.call(w,{event:u,messages:T,state:C,agent:n,input:e,toolCallName:U,toolCallArgs:$})});return o(S),await Promise.all(r.map(w=>{var T;(T=w.onNewToolCall)==null||T.call(w,{toolCall:k,messages:s,state:a,agent:n,input:e})})),l()}case O.TOOL_CALL_RESULT:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onToolCallResultEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messageId:_,toolCallId:k,content:S,role:w}=u,T={id:_,toolCallId:k,role:w||"tool",content:S};s.push(T),await Promise.all(r.map(C=>{var A;(A=C.onNewMessage)==null||A.call(C,{message:T,messages:s,state:a,agent:n,input:e})})),o({messages:s})}return l()}case O.STATE_SNAPSHOT:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onStateSnapshotEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{snapshot:_}=u;a=_,o({state:a})}return l()}case O.STATE_DELTA:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onStateDeltaEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{delta:_}=u;try{a=Hr(a,_,!0,!1).newDocument,o({state:a})}catch(k){let S=k instanceof Error?k.message:String(k);console.warn(`Failed to apply state patch:
Current state: ${JSON.stringify(a,null,2)}
Patch operations: ${JSON.stringify(_,null,2)}
Error: ${S}`)}}return l()}case O.MESSAGES_SNAPSHOT:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onMessagesSnapshotEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let{messages:_}=u;s=_,o({messages:s})}return l()}case O.ACTIVITY_SNAPSHOT:{let m=u,_=s.findIndex(C=>C.id===m.messageId),k=_>=0?s[_]:void 0,S=k?.role==="activity"?k:void 0,w=(c=m.replace)!=null?c:!0,T=await ze(r,s,a,(C,A,R)=>{var U;return(U=C.onActivitySnapshotEvent)==null?void 0:U.call(C,{event:m,messages:A,state:R,agent:n,input:e,activityMessage:S,existingMessage:k})});if(o(T),T.stopPropagation!==!0){let C={id:m.messageId,role:"activity",activityType:m.activityType,content:Te(m.content)},A;_===-1?(s.push(C),A=C):S?w&&(s[_]=Yn(lt({},S),{activityType:m.activityType,content:Te(m.content)})):w&&(s[_]=C,A=C),o({messages:s}),A&&await Promise.all(r.map(R=>{var U;return(U=R.onNewMessage)==null?void 0:U.call(R,{message:A,messages:s,state:a,agent:n,input:e})}))}return l()}case O.ACTIVITY_DELTA:{let m=u,_=s.findIndex(T=>T.id===m.messageId);if(_===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${m.messageId}' to apply patch`),l();let k=s[_];if(k.role!=="activity")return console.warn(`ACTIVITY_DELTA: Message '${m.messageId}' is not an activity message`),l();let S=k,w=await ze(r,s,a,(T,C,A)=>{var R;return(R=T.onActivityDeltaEvent)==null?void 0:R.call(T,{event:m,messages:C,state:A,agent:n,input:e,activityMessage:S})});if(o(w),w.stopPropagation!==!0)try{let T=Te((f=S.content)!=null?f:{}),C=Hr(T,(h=m.patch)!=null?h:[],!0,!1).newDocument;s[_]=Yn(lt({},S),{content:Te(C),activityType:m.activityType}),o({messages:s})}catch(T){let C=T instanceof Error?T.message:String(T);console.warn(`Failed to apply activity patch for '${m.messageId}': ${C}`)}return l()}case O.RAW:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onRawEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});return o(m),l()}case O.CUSTOM:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onCustomEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});return o(m),l()}case O.RUN_STARTED:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onRunStartedEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});if(o(m),m.stopPropagation!==!0){let _=u;if((v=_.input)!=null&&v.messages){for(let k of _.input.messages)s.find(S=>S.id===k.id)||s.push(k);o({messages:s})}}return l()}case O.RUN_FINISHED:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onRunFinishedEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e,result:u.result})});return o(m),l()}case O.RUN_ERROR:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onRunErrorEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});return o(m),l()}case O.STEP_STARTED:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onStepStartedEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});return o(m),l()}case O.STEP_FINISHED:{let m=await ze(r,s,a,(_,k,S)=>{var w;return(w=_.onStepFinishedEvent)==null?void 0:w.call(_,{event:u,messages:k,state:S,agent:n,input:e})});return o(m),l()}case O.TEXT_MESSAGE_CHUNK:throw new Error("TEXT_MESSAGE_CHUNK must be tranformed before being applied");case O.TOOL_CALL_CHUNK:throw new Error("TOOL_CALL_CHUNK must be tranformed before being applied");case O.THINKING_START:return l();case O.THINKING_END:return l();case O.THINKING_TEXT_MESSAGE_START:return l();case O.THINKING_TEXT_MESSAGE_CONTENT:return l();case O.THINKING_TEXT_MESSAGE_END:return l()}return u.type,l()}),vg(),r.length>0?pg({}):u=>u)},si=e=>t=>{let n=new Map,r=new Map,s=!1,a=!1,i=!1,o=new Map,l=!1,u=!1,c=!1,f=()=>{n.clear(),r.clear(),o.clear(),l=!1,u=!1,s=!1,a=!1,c=!0};return t.pipe(Jn(h=>{let v=h.type;if(e&&console.debug("[VERIFY]:",JSON.stringify(h)),a)return Ue(()=>new Be(`Cannot send event type '${v}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(s&&v!==O.RUN_ERROR&&v!==O.RUN_STARTED)return Ue(()=>new Be(`Cannot send event type '${v}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(i){if(v===O.RUN_STARTED){if(c&&!s)return Ue(()=>new Be("Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run."));s&&f()}}else if(i=!0,v!==O.RUN_STARTED&&v!==O.RUN_ERROR)return Ue(()=>new Be("First event must be 'RUN_STARTED'"));switch(v){case O.TEXT_MESSAGE_START:{let p=h.messageId;return n.has(p)?Ue(()=>new Be(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${p}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(p,!0),He(h))}case O.TEXT_MESSAGE_CONTENT:{let p=h.messageId;return n.has(p)?He(h):Ue(()=>new Be(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${p}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case O.TEXT_MESSAGE_END:{let p=h.messageId;return n.has(p)?(n.delete(p),He(h)):Ue(()=>new Be(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${p}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case O.TOOL_CALL_START:{let p=h.toolCallId;return r.has(p)?Ue(()=>new Be(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${p}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(r.set(p,!0),He(h))}case O.TOOL_CALL_ARGS:{let p=h.toolCallId;return r.has(p)?He(h):Ue(()=>new Be(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${p}'. Start a tool call with 'TOOL_CALL_START' first.`))}case O.TOOL_CALL_END:{let p=h.toolCallId;return r.has(p)?(r.delete(p),He(h)):Ue(()=>new Be(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${p}'. A 'TOOL_CALL_START' event must be sent first.`))}case O.STEP_STARTED:{let p=h.stepName;return o.has(p)?Ue(()=>new Be(`Step "${p}" is already active for 'STEP_STARTED'`)):(o.set(p,!0),He(h))}case O.STEP_FINISHED:{let p=h.stepName;return o.has(p)?(o.delete(p),He(h)):Ue(()=>new Be(`Cannot send 'STEP_FINISHED' for step "${p}" that was not started`))}case O.RUN_STARTED:return c=!0,He(h);case O.RUN_FINISHED:{if(o.size>0){let p=Array.from(o.keys()).join(", ");return Ue(()=>new Be(`Cannot send 'RUN_FINISHED' while steps are still active: ${p}`))}if(n.size>0){let p=Array.from(n.keys()).join(", ");return Ue(()=>new Be(`Cannot send 'RUN_FINISHED' while text messages are still active: ${p}`))}if(r.size>0){let p=Array.from(r.keys()).join(", ");return Ue(()=>new Be(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${p}`))}return s=!0,He(h)}case O.RUN_ERROR:return a=!0,He(h);case O.CUSTOM:return He(h);case O.THINKING_TEXT_MESSAGE_START:return l?u?Ue(()=>new Be("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.")):(u=!0,He(h)):Ue(()=>new Be("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first."));case O.THINKING_TEXT_MESSAGE_CONTENT:return u?He(h):Ue(()=>new Be("Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first."));case O.THINKING_TEXT_MESSAGE_END:return u?(u=!1,He(h)):Ue(()=>new Be("Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first."));case O.THINKING_START:return l?Ue(()=>new Be("Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.")):(l=!0,He(h));case O.THINKING_END:return l?(l=!1,He(h)):Ue(()=>new Be("Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first."));default:return He(h)}}))},Zg=(e,t)=>yg(()=>Ea(fetch(e,t))).pipe(_g(n=>{var r;if(!n.ok){let i=n.headers.get("content-type")||"";return Ea(n.text()).pipe(Jn(o=>{let l=o;if(i.includes("application/json"))try{l=JSON.parse(o)}catch{}let u=new Error(`HTTP ${n.status}: ${typeof l=="string"?l:JSON.stringify(l)}`);return u.status=n.status,u.payload=l,Ue(()=>u)}))}let s={type:"headers",status:n.status,headers:n.headers},a=(r=n.body)==null?void 0:r.getReader();return a?new pt(i=>(i.next(s),(async()=>{try{for(;;){let{done:o,value:l}=await a.read();if(o)break;let u={type:"data",data:l};i.next(u)}i.complete()}catch(o){i.error(o)}})(),()=>{a.cancel().catch(o=>{if(o?.name!=="AbortError")throw o})})):Ue(()=>new Error("Failed to getReader() from response"))})),Xg=e=>{let t=new Sr,n=new TextDecoder("utf-8",{fatal:!1}),r="";e.subscribe({next:a=>{if(a.type!=="headers"&&a.type==="data"&&a.data){let i=n.decode(a.data,{stream:!0});r+=i;let o=r.split(/\n\n/);r=o.pop()||"";for(let l of o)s(l)}},error:a=>t.error(a),complete:()=>{r&&(r+=n.decode(),s(r)),t.complete()}});function s(a){let i=a.split(`
`),o=[];for(let l of i)l.startsWith("data: ")&&o.push(l.slice(6));if(o.length>0)try{let l=o.join(`
`),u=JSON.parse(l);t.next(u)}catch(l){t.error(l)}}return t.asObservable()},Kg=e=>{let t=new Sr,n=new Uint8Array(0);e.subscribe({next:s=>{if(s.type!=="headers"&&s.type==="data"&&s.data){let a=new Uint8Array(n.length+s.data.length);a.set(n,0),a.set(s.data,n.length),n=a,r()}},error:s=>t.error(s),complete:()=>{if(n.length>0)try{r()}catch{console.warn("Incomplete or invalid protocol buffer data at stream end")}t.complete()}});function r(){for(;n.length>=4;){let s=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<s)break;try{let a=n.slice(4,s),i=Dg(a);t.next(i),n=n.slice(s)}catch(a){let i=a instanceof Error?a.message:String(a);t.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return t.asObservable()},Jg=e=>{let t=new Sr,n=new sd,r=!1;return e.subscribe({next:s=>{n.next(s),s.type==="headers"&&!r?(r=!0,s.headers.get("content-type")===$g?Kg(n).subscribe({next:a=>t.next(a),error:a=>t.error(a),complete:()=>t.complete()}):Xg(n).subscribe({next:a=>{try{let i=Dc.parse(a);t.next(i)}catch(i){t.error(i)}},error:a=>{if(a?.name==="AbortError"){t.next({type:O.RUN_ERROR,rawEvent:a}),t.complete();return}return t.error(a)},complete:()=>t.complete()})):r||t.error(new Error("No headers event received before data events"))},error:s=>{n.error(s),t.error(s)},complete:()=>{n.complete()}}),t.asObservable()},Re=Nc(["TextMessageStart","TextMessageContent","TextMessageEnd","ActionExecutionStart","ActionExecutionArgs","ActionExecutionEnd","ActionExecutionResult","AgentStateMessage","MetaEvent","RunStarted","RunFinished","RunError","NodeStarted","NodeFinished"]),Yg=Nc(["LangGraphInterruptEvent","PredictState","Exit"]),Wg=De({type:H(Re.enum.TextMessageStart),messageId:L(),parentMessageId:L().optional(),role:L().optional()}),Qg=De({type:H(Re.enum.TextMessageContent),messageId:L(),content:L()}),e_=De({type:H(Re.enum.TextMessageEnd),messageId:L()}),t_=De({type:H(Re.enum.ActionExecutionStart),actionExecutionId:L(),actionName:L(),parentMessageId:L().optional()}),n_=De({type:H(Re.enum.ActionExecutionArgs),actionExecutionId:L(),args:L()}),r_=De({type:H(Re.enum.ActionExecutionEnd),actionExecutionId:L()}),s_=De({type:H(Re.enum.ActionExecutionResult),actionName:L(),actionExecutionId:L(),result:L()}),a_=De({type:H(Re.enum.AgentStateMessage),threadId:L(),agentName:L(),nodeName:L(),runId:L(),active:Ti(),role:L(),state:L(),running:Ti()}),i_=De({type:H(Re.enum.MetaEvent),name:Yg,value:ht()}),o_=De({type:H(Re.enum.RunError),message:L(),code:L().optional()});La("type",[Wg,Qg,e_,t_,n_,r_,s_,a_,i_,o_]);De({id:L(),role:L(),content:L(),parentMessageId:L().optional()});De({id:L(),name:L(),arguments:ht(),parentMessageId:L().optional()});De({id:L(),result:ht(),actionExecutionId:L(),actionName:L()});var l_=e=>{if(typeof e=="string")return e;if(!Array.isArray(e))return;let t=e.filter(n=>n.type==="text").map(n=>n.text).filter(n=>n.length>0);if(t.length!==0)return t.join(`
`)},u_=(e,t,n)=>r=>{let s={},a=!0,i=!0,o="",l=null,u=null,c=[],f={},h=v=>{typeof v=="object"&&v!==null&&("messages"in v&&delete v.messages,s=v)};return r.pipe(Jn(v=>{switch(v.type){case O.TEXT_MESSAGE_START:{let p=v;return[{type:Re.enum.TextMessageStart,messageId:p.messageId,role:p.role}]}case O.TEXT_MESSAGE_CONTENT:{let p=v;return[{type:Re.enum.TextMessageContent,messageId:p.messageId,content:p.delta}]}case O.TEXT_MESSAGE_END:{let p=v;return[{type:Re.enum.TextMessageEnd,messageId:p.messageId}]}case O.TOOL_CALL_START:{let p=v;return c.push({id:p.toolCallId,type:"function",function:{name:p.toolCallName,arguments:""}}),i=!0,f[p.toolCallId]=p.toolCallName,[{type:Re.enum.ActionExecutionStart,actionExecutionId:p.toolCallId,actionName:p.toolCallName,parentMessageId:p.parentMessageId}]}case O.TOOL_CALL_ARGS:{let p=v,m=c.find(k=>k.id===p.toolCallId);if(!m)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${p.toolCallId}'`),[];m.function.arguments+=p.delta;let _=!1;if(u){let k=u.find(S=>S.tool==m.function.name);if(k)try{let S=JSON.parse(ad(m.function.arguments));k.tool_argument&&k.tool_argument in S?(h(Yn(lt({},s),{[k.state_key]:S[k.tool_argument]})),_=!0):k.tool_argument||(h(Yn(lt({},s),{[k.state_key]:S})),_=!0)}catch{}}return[{type:Re.enum.ActionExecutionArgs,actionExecutionId:p.toolCallId,args:p.delta},..._?[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]:[]]}case O.TOOL_CALL_END:{let p=v;return[{type:Re.enum.ActionExecutionEnd,actionExecutionId:p.toolCallId}]}case O.TOOL_CALL_RESULT:{let p=v;return[{type:Re.enum.ActionExecutionResult,actionExecutionId:p.toolCallId,result:p.content,actionName:f[p.toolCallId]||"unknown"}]}case O.RAW:return[];case O.CUSTOM:{let p=v;switch(p.name){case"Exit":a=!1;break;case"PredictState":u=p.value;break}return[{type:Re.enum.MetaEvent,name:p.name,value:p.value}]}case O.STATE_SNAPSHOT:return h(v.snapshot),[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}];case O.STATE_DELTA:{let p=Hr(s,v.delta,!0,!1);return p?(h(p.newDocument),[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:i}]):[]}case O.MESSAGES_SNAPSHOT:return l=v.messages,[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(lt(lt({},s),l?{messages:l}:{})),active:!0}];case O.RUN_STARTED:return[];case O.RUN_FINISHED:return l&&(s.messages=l),Object.keys(s).length===0?[]:[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(lt(lt({},s),l?{messages:c_(l)}:{})),active:!1}];case O.RUN_ERROR:{let p=v;return[{type:Re.enum.RunError,message:p.message,code:p.code}]}case O.STEP_STARTED:return o=v.stepName,c=[],u=null,[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!0}];case O.STEP_FINISHED:return c=[],u=null,[{type:Re.enum.AgentStateMessage,threadId:e,agentName:n,nodeName:o,runId:t,running:a,role:"assistant",state:JSON.stringify(s),active:!1}];default:return[]}}))};function c_(e){var t;let n=[];for(let r of e)if(r.role==="assistant"||r.role==="user"||r.role==="system"){let s=l_(r.content);if(s){let a={id:r.id,role:r.role,content:s};n.push(a)}if(r.role==="assistant"&&r.toolCalls&&r.toolCalls.length>0)for(let a of r.toolCalls){let i={id:a.id,name:a.function.name,arguments:JSON.parse(a.function.arguments),parentMessageId:r.id};n.push(i)}}else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"&&(t=i.toolCalls)!=null&&t.length){for(let o of i.toolCalls)if(o.id===r.toolCallId){s=o.function.name;break}}let a={id:r.id,result:r.content,actionExecutionId:r.toolCallId,actionName:s};n.push(a)}return n}var oa=e=>t=>{let n,r,s,a=()=>{if(!n||s!=="text")throw new Error("No text message to close");let l={type:O.TEXT_MESSAGE_END,messageId:n.messageId};return s=void 0,n=void 0,e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_END",JSON.stringify(l)),l},i=()=>{if(!r||s!=="tool")throw new Error("No tool call to close");let l={type:O.TOOL_CALL_END,toolCallId:r.toolCallId};return s=void 0,r=void 0,e&&console.debug("[TRANSFORM]: TOOL_CALL_END",JSON.stringify(l)),l},o=()=>s==="text"?[a()]:s==="tool"?[i()]:[];return t.pipe(Jn(l=>{switch(l.type){case O.TEXT_MESSAGE_START:case O.TEXT_MESSAGE_CONTENT:case O.TEXT_MESSAGE_END:case O.TOOL_CALL_START:case O.TOOL_CALL_ARGS:case O.TOOL_CALL_END:case O.TOOL_CALL_RESULT:case O.STATE_SNAPSHOT:case O.STATE_DELTA:case O.MESSAGES_SNAPSHOT:case O.CUSTOM:case O.RUN_STARTED:case O.RUN_FINISHED:case O.RUN_ERROR:case O.STEP_STARTED:case O.STEP_FINISHED:case O.THINKING_START:case O.THINKING_END:case O.THINKING_TEXT_MESSAGE_START:case O.THINKING_TEXT_MESSAGE_CONTENT:case O.THINKING_TEXT_MESSAGE_END:return[...o(),l];case O.RAW:case O.ACTIVITY_SNAPSHOT:case O.ACTIVITY_DELTA:return[l];case O.TEXT_MESSAGE_CHUNK:let u=l,c=[];if((s!=="text"||u.messageId!==void 0&&u.messageId!==n?.messageId)&&c.push(...o()),s!=="text"){if(u.messageId===void 0)throw new Error("First TEXT_MESSAGE_CHUNK must have a messageId");n={messageId:u.messageId},s="text";let v={type:O.TEXT_MESSAGE_START,messageId:u.messageId,role:u.role||"assistant"};c.push(v),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_START",JSON.stringify(v))}if(u.delta!==void 0){let v={type:O.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:u.delta};c.push(v),e&&console.debug("[TRANSFORM]: TEXT_MESSAGE_CONTENT",JSON.stringify(v))}return c;case O.TOOL_CALL_CHUNK:let f=l,h=[];if((s!=="tool"||f.toolCallId!==void 0&&f.toolCallId!==r?.toolCallId)&&h.push(...o()),s!=="tool"){if(f.toolCallId===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallId");if(f.toolCallName===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallName");r={toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId},s="tool";let v={type:O.TOOL_CALL_START,toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId};h.push(v),e&&console.debug("[TRANSFORM]: TOOL_CALL_START",JSON.stringify(v))}if(f.delta!==void 0){let v={type:O.TOOL_CALL_ARGS,toolCallId:r.toolCallId,delta:f.delta};h.push(v),e&&console.debug("[TRANSFORM]: TOOL_CALL_ARGS",JSON.stringify(v))}return h}return l.type,[]}),Li(()=>{o()}))},pd=class{runNext(t,n){return n.run(t).pipe(oa(!1))}runNextWithState(t,n){let r=Te(t.messages||[]),s=Te(t.state||{}),a=new sd;return hd(t,a,n,[]).subscribe(i=>{i.messages!==void 0&&(r=i.messages),i.state!==void 0&&(s=i.state)}),this.runNext(t,n).pipe(nd(async i=>(a.next(i),await new Promise(o=>setTimeout(o,0)),{event:i,messages:Te(r),state:Te(s)})))}},d_=class extends pd{constructor(t){super(),this.fn=t}run(t,n){return this.fn(t,n)}};function f_(e){let t=e.content;if(Array.isArray(t)){let n=t.filter(r=>typeof r=="object"&&r!==null&&"type"in r&&r.type==="text"&&typeof r.text=="string").map(r=>r.text).join("");return Yn(lt({},e),{content:n})}return typeof t=="string"?e:Yn(lt({},e),{content:""})}var v_=class extends pd{run(t,n){let r=t,{parentRunId:s}=r,a=Hg(r,["parentRunId"]),i=Yn(lt({},a),{messages:a.messages.map(f_)});return this.runNext(i,n)}},h_={version:"0.0.42"},p_=class{constructor({agentId:t,description:n,threadId:r,initialMessages:s,initialState:a,debug:i}={}){this.debug=!1,this.subscribers=[],this.isRunning=!1,this.middlewares=[],this.agentId=t,this.description=n??"",this.threadId=r??as(),this.messages=Te(s??[]),this.state=Te(a??{}),this.debug=i??!1,Gg(this.maxVersion,"0.0.39")<=0&&this.middlewares.unshift(new v_)}get maxVersion(){return h_.version}subscribe(t){return this.subscribers.push(t),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==t)}}}use(...t){let n=t.map(r=>typeof r=="function"?new d_(r):r);return this.middlewares.push(...n),this}async runAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:as();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new Sr;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=nl(()=>this.middlewares.length===0?this.run(s):this.middlewares.reduceRight((f,h)=>({run:v=>h.run(v,f)}),this).run(s),oa(this.debug),si(this.debug),f=>f.pipe(al(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),Mi(f=>(this.isRunning=!1,this.onError(s,f,o))),Li(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await il(u(He(null)));let c=Te(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}connect(t){throw new el}async connectAgent(t,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:as();let s=this.prepareRunAgentInput(t),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new Sr;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=nl(()=>this.connect(s),oa(this.debug),si(this.debug),f=>f.pipe(al(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),Mi(f=>(this.isRunning=!1,f instanceof el?rd:this.onError(s,f,o))),Li(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await il(u(He(null)));let c=Te(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}abortRun(){}async detachActiveRun(){var t,n;if(!this.activeRunDetach$)return;let r=(t=this.activeRunCompletionPromise)!=null?t:Promise.resolve();this.activeRunDetach$.next(),(n=this.activeRunDetach$)==null||n.complete(),await r}apply(t,n,r){return hd(t,n,this,r)}processApplyEvents(t,n,r){return n.pipe(mg(s=>{s.messages&&(this.messages=s.messages,r.forEach(a=>{var i;(i=a.onMessagesChanged)==null||i.call(a,{messages:this.messages,state:this.state,agent:this,input:t})})),s.state&&(this.state=s.state,r.forEach(a=>{var i;(i=a.onStateChanged)==null||i.call(a,{state:this.state,messages:this.messages,agent:this,input:t})}))}))}prepareRunAgentInput(t){var n,r,s;let a=Te(this.messages).filter(i=>i.role!=="activity");return{threadId:this.threadId,runId:t?.runId||as(),tools:Te((n=t?.tools)!=null?n:[]),context:Te((r=t?.context)!=null?r:[]),forwardedProps:Te((s=t?.forwardedProps)!=null?s:{}),state:Te(this.state),messages:a}}async onInitialize(t,n){let r=await ze(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunInitialized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages&&(this.messages=r.messages,t.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state&&(this.state=r.state,t.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}onError(t,n,r){return Ea(ze(r,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFailed)==null?void 0:o.call(s,{error:n,messages:a,state:i,agent:this,input:t})})).pipe(Pi(s=>{let a=s;if((a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,r.forEach(i=>{var o;(o=i.onMessagesChanged)==null||o.call(i,{messages:this.messages,state:this.state,agent:this,input:t})})),a.state!==void 0&&(this.state=a.state,r.forEach(i=>{var o;(o=i.onStateChanged)==null||o.call(i,{state:this.state,messages:this.messages,agent:this,input:t})}))),a.stopPropagation!==!0)throw console.error("Agent execution failed:",n),n;return{}}))}async onFinalize(t,n){let r=await ze(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFinalized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:t})});(r.messages!==void 0||r.state!==void 0)&&(r.messages!==void 0&&(this.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:t})})),r.state!==void 0&&(this.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:t})})))}clone(){let t=Object.create(Object.getPrototypeOf(this));return t.agentId=this.agentId,t.description=this.description,t.threadId=this.threadId,t.messages=Te(this.messages),t.state=Te(this.state),t.debug=this.debug,t.isRunning=this.isRunning,t.subscribers=[...this.subscribers],t.middlewares=[...this.middlewares],t}addMessage(t){this.messages.push(t),(async()=>{var n,r,s;for(let a of this.subscribers)await((n=a.onNewMessage)==null?void 0:n.call(a,{message:t,messages:this.messages,state:this.state,agent:this}));if(t.role==="assistant"&&t.toolCalls)for(let a of t.toolCalls)for(let i of this.subscribers)await((r=i.onNewToolCall)==null?void 0:r.call(i,{toolCall:a,messages:this.messages,state:this.state,agent:this}));for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(t){this.messages.push(...t),(async()=>{var n,r,s;for(let a of t){for(let i of this.subscribers)await((n=i.onNewMessage)==null?void 0:n.call(i,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role==="assistant"&&a.toolCalls)for(let i of a.toolCalls)for(let o of this.subscribers)await((r=o.onNewToolCall)==null?void 0:r.call(o,{toolCall:i,messages:this.messages,state:this.state,agent:this}))}for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(t){this.messages=Te(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onMessagesChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}setState(t){this.state=Te(t),(async()=>{var n;for(let r of this.subscribers)await((n=r.onStateChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(t){var n;this.agentId=(n=this.agentId)!=null?n:as();let r=this.prepareRunAgentInput(t);return(this.middlewares.length===0?this.run(r):this.middlewares.reduceRight((s,a)=>({run:i=>a.run(i,s)}),this).run(r)).pipe(oa(this.debug),si(this.debug),u_(this.threadId,r.runId,this.agentId),s=>s.pipe(Pi(a=>(this.debug&&console.debug("[LEGACY]:",JSON.stringify(a)),a))))}},Hl=class extends p_{constructor(e){var t;super(e),this.abortController=new AbortController,this.url=e.url,this.headers=Te((t=e.headers)!=null?t:{})}requestInit(e){return{method:"POST",headers:Yn(lt({},this.headers),{"Content-Type":"application/json",Accept:"text/event-stream"}),body:JSON.stringify(e),signal:this.abortController.signal}}runAgent(e,t){var n;return this.abortController=(n=e?.abortController)!=null?n:new AbortController,super.runAgent(e,t)}abortRun(){this.abortController.abort(),super.abortRun()}run(e){let t=Zg(this.url,this.requestInit(e));return Jg(t)}clone(){var e;let t=super.clone();t.url=this.url,t.headers=Te((e=this.headers)!=null?e:{});let n=new AbortController,r=this.abortController.signal;return r.aborted&&n.abort(r.reason),t.abortController=n,t}};class g_{constructor(t){this.stores=t}eventSource=null;agentMsgId=null;aguiSubscription=null;aguiMessageMap=new Map;aguiMappedPlaceholder=!1;aguiRunId=null;aguiSessionId=null;aguiCompleted=!1;aguiToolCalls=new Map;sseToolCalls=new Map;sseMessageMap=new Map;sseMappedPlaceholder=!1;start(t,n,r,s,a,i="sse"){if(this.close(),i==="agui"){this.startAgui(t,n,r,s,a);return}const o=this.stores.chatStore.addAgentMessage();this.agentMsgId=o.id;const l=new URL("/chat/stream",window.location.origin);l.searchParams.set("query",t),l.searchParams.set("session_id",n),Object.keys(r).length&&l.searchParams.set("tool_context",JSON.stringify(r)),Object.keys(s).length&&l.searchParams.set("llm_context",JSON.stringify(s)),this.eventSource=new EventSource(l.toString()),["chunk","artifact_chunk","artifact_stored","llm_stream_chunk","step","event","state_update","tool_call_start","tool_call_args","tool_call_end","done","error"].forEach(c=>{this.eventSource.addEventListener(c,f=>{this.handleEvent(c,f,a)})}),this.eventSource.onerror=()=>{const c=this.findAgentMsg();c&&this.stores.chatStore.updateMessage(c.id,{isStreaming:!1}),a.onError("Connection lost"),this.close()}}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.agentMsgId=null,this.aguiSubscription&&(this.aguiSubscription.unsubscribe(),this.aguiSubscription=null),this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1,this.aguiToolCalls.clear(),this.sseToolCalls.clear(),this.sseMessageMap.clear(),this.sseMappedPlaceholder=!1}findAgentMsg(){return this.agentMsgId?this.stores.chatStore.findMessage(this.agentMsgId):void 0}handleEvent(t,n,r){const s=Wi(n.data);if(!s)return;const a=this.findAgentMsg();if(a)switch(t){case"chunk":case"llm_stream_chunk":this.handleChunk(a,s,t);break;case"artifact_chunk":this.handleArtifactChunk(s);break;case"artifact_stored":this.handleArtifactStored(s);break;case"step":case"event":this.handleStepEvent(a,s,t);break;case"state_update":this.handleStateUpdate(s);break;case"tool_call_start":this.handleSseToolCallStart(s);break;case"tool_call_args":this.handleSseToolCallArgs(s);break;case"tool_call_end":this.handleSseToolCallEnd(s);break;case"done":this.handleDone(a,s,r);break;case"error":this.handleError(a,s,r);break}}handleStateUpdate(t){if(this.stores.tasksStore.applyUpdate(t),t.update_type==="NOTIFICATION"){const r=t.content,s=String(r?.severity??"info"),a=String(r?.body??""),i=String(r?.title??""),o=i?`${i}: ${a}`:a,l=r?.actions,u=Array.isArray(l)?l.filter(c=>c&&typeof c=="object").map(c=>({id:String(c.id??""),label:String(c.label??"Action"),payload:c.payload})).filter(c=>c.id):void 0;this.stores.notificationsStore.add(o||"Notification",s,u)}}ensureSseMessage(t){if(!t)return this.agentMsgId??"";const n=this.sseMessageMap.get(t);if(n)return n;if(!this.sseMappedPlaceholder&&this.agentMsgId)return this.sseMappedPlaceholder=!0,this.sseMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.sseMessageMap.set(t,r.id),r.id}handleSseToolCallStart(t){const n=t.tool_call_id,r=t.tool_name,s=t.message_id;if(n&&r){const a=s?this.ensureSseMessage(s):this.agentMsgId??void 0;this.sseToolCalls.set(n,{name:r,args:"",messageId:a})}this.stores.eventsStore.addEvent(t,"tool_call_start")}handleSseToolCallArgs(t){const n=t.tool_call_id,r=t.delta;if(n&&r){const s=this.sseToolCalls.get(n);s&&(s.args+=r)}this.stores.eventsStore.addEvent(t,"tool_call_args")}handleSseToolCallEnd(t){const n=t.tool_call_id;if(n){const r=this.sseToolCalls.get(n);r&&(this.handleInteractiveToolCall(n,r.name,r.args,r.messageId),this.sseToolCalls.delete(n))}this.stores.eventsStore.addEvent(t,"tool_call_end")}handleChunk(t,n,r){const s=n.message_id,a=s?this.ensureSseMessage(s):t.id,i=this.stores.chatStore.findMessage(a)??t,o=n.channel??"thinking",l=n.phase??(r==="chunk"?"observation":void 0),u=n.text??"",c=!!n.done;if(o==="thinking"&&l==="action"){this.stores.chatStore.updateMessage(i.id,{isThinking:!c});return}if(o==="thinking"){u?this.stores.chatStore.updateMessage(i.id,{observations:`${i.observations??""}${u}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(i.id,{isThinking:!1});return}if(o==="revision"){const f={isThinking:!1,isStreaming:!0};i.revisionStreamActive||(f.revisionStreamActive=!0,f.text=""),u&&(f.text=`${i.revisionStreamActive?i.text:""}${u}`),this.stores.chatStore.updateMessage(i.id,f);return}if(o==="answer"){const f=i.answerActionSeq??Mr,h=n.action_seq;if(f===Mr){this.stores.chatStore.updateMessage(i.id,{answerStreamDone:c,isStreaming:!c,isThinking:!1});return}if(h!==void 0&&h!==f){this.stores.chatStore.updateMessage(i.id,{isThinking:!1});return}const v={isThinking:!1,isStreaming:!c};u&&(v.text=`${i.text}${u}`),c&&(v.answerStreamDone=!0),this.stores.chatStore.updateMessage(i.id,v);return}u?this.stores.chatStore.updateMessage(i.id,{observations:`${i.observations??""}${u}`,showObservations:!0,isThinking:!1}):this.stores.chatStore.updateMessage(i.id,{isThinking:!1})}handleArtifactChunk(t){const n=Zl(t);if(n.artifact_type==="ui_component"){this.stores.interactionsStore.addArtifactChunk(n,{message_id:this.agentMsgId??void 0}),this.stores.eventsStore.addEvent(t,"artifact_chunk");return}const r=n.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(r,n.chunk),this.stores.eventsStore.addEvent(t,"artifact_chunk")}handleArtifactStored(t){const n=__(t);n&&this.stores.artifactsStore.addArtifact(n),this.stores.eventsStore.addEvent(t,"artifact_stored")}handleStepEvent(t,n,r){const s=n.event;if(s==="step_start"){const a=n.action_seq;this.stores.chatStore.updateMessage(t.id,{answerActionSeq:typeof a=="number"?a:Mr})}if(s==="tool_call_start"){const a=n.tool_call_id,i=n.tool_name,o=n.args_json;a&&i&&this.handleInteractiveToolCall(a,i,o??"",this.agentMsgId??void 0)}this.stores.eventsStore.addEvent(n,r)}handleDone(t,n,r){const s=n.pause,a=n.trace_id??null;if(s){this.handlePause(t,n,s,a,r);return}const i=n.answer_action_seq,o=t.answerActionSeq??Mr;o!==Mr&&(i===void 0||i===o)&&n.answer&&typeof n.answer=="string"&&this.stores.chatStore.updateMessage(t.id,{text:n.answer}),this.stores.chatStore.updateMessage(t.id,{isStreaming:!1,isThinking:!1}),r.onDone(a),this.close()}handlePause(t,n,r,s,a){const i=mn(r.payload)??{},o=Oe(i.auth_url)||Oe(i.url)||"",l=Oe(i.provider)||"",u=Oe(r.reason)||"pause",c=Oe(r.resume_token),f=Oe(i.component),h=mn(i.props);f&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Oe(i.tool)??"ui_pause",component:f,props:h,message_id:t.id,resume_token:c,created_at:Date.now()}):c&&this.stores.interactionsStore.updatePendingInteraction({resume_token:c});let v=`Planner paused (${u})`;l&&(v+=` for ${l}`),o&&(v+=`
[Open auth link](${o})`),c&&!f&&(v+=`
Resume token: \`${c}\``),this.stores.chatStore.updateMessage(t.id,{pause:{reason:u,payload:i,resume_token:c},traceId:s??void 0,text:v,isStreaming:!1,isThinking:!1}),a.onDone(s),this.close()}handleError(t,n,r){const s=n.error??"Unexpected error";this.stores.chatStore.updateMessage(t.id,{text:s,isStreaming:!1,isThinking:!1}),r.onError(s),this.close()}handleInteractiveToolCall(t,n,r,s){const a=this.mapInteractiveComponent(n);if(!a)return;let i={};if(r)try{const o=JSON.parse(r);o&&typeof o=="object"&&(i=o)}catch{i={}}this.stores.interactionsStore.setPendingInteraction({tool_call_id:t,tool_name:n,component:a,props:i,message_id:s,created_at:Date.now()})}mapInteractiveComponent(t){return t==="ui_form"?"form":t==="ui_confirm"?"confirm":t==="ui_select_option"?"select_option":null}startAgui(t,n,r,s,a){const i=this.buildHistory();!i.some(v=>v.role==="user"&&this.hasTextContent(v.content))&&t.trim()&&i.push({id:`msg_${Date.now()}`,role:"user",content:t});const l=this.stores.chatStore.addAgentMessage();this.agentMsgId=l.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const u=new URL("/agui/agent",window.location.origin),c={threadId:n,runId:`run_${Date.now()}`,messages:i,tools:[],context:[],state:{},forwardedProps:{penguiflow:{llm_context:s,tool_context:r}}};this.aguiRunId=c.runId,this.aguiSessionId=n,console.log("[AG-UI] Sending request:",JSON.stringify(c,null,2));const h=new Hl({url:u.toString()}).run(c);this.aguiSubscription=h.subscribe({next:v=>this.handleAguiEvent(v,a),error:v=>{const p=this.findAgentMsg();p&&this.stores.chatStore.updateMessage(p.id,{isStreaming:!1}),a.onError(v.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}resumeAgui(t,n,r,s,a){if(!t.resume_token){a.onError("Resume token missing");return}this.close();const i=this.stores.chatStore.addAgentMessage();this.agentMsgId=i.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const o=new URL("/agui/resume",window.location.origin),l={resume_token:t.resume_token,thread_id:r,run_id:`run_${Date.now()}`,tool_name:t.tool_name,component:t.component,result:n,tool_context:s};this.aguiRunId=l.run_id,this.aguiSessionId=r;const c=new Hl({url:o.toString()}).run(l);this.aguiSubscription=c.subscribe({next:f=>this.handleAguiEvent(f,a),error:f=>{const h=this.findAgentMsg();h&&this.stores.chatStore.updateMessage(h.id,{isStreaming:!1}),a.onError(f.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}handleAguiEvent(t,n){const r=t;switch(console.log("[AG-UI] Received event:",r.type,r),r.type){case O.RUN_STARTED:{const s=r;this.aguiRunId=s.runId??this.aguiRunId;return}case O.RUN_FINISHED:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onDone(s.runId??this.aguiRunId),this.aguiCompleted=!0;return}case O.RUN_ERROR:{const s=r,a=this.findAgentMsg();a&&this.stores.chatStore.updateMessage(a.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onError(s.message||"Run error"),this.aguiCompleted=!0;return}case O.TEXT_MESSAGE_START:{const s=r;if(s.role!=="assistant")return;this.ensureAguiMessage(s.messageId);return}case O.TEXT_MESSAGE_CONTENT:{const s=r,a=this.ensureAguiMessage(s.messageId),i=this.stores.chatStore.findMessage(a);i&&s.delta&&this.stores.chatStore.updateMessage(i.id,{text:`${i.text}${s.delta}`,isStreaming:!0});return}case O.TEXT_MESSAGE_END:{const s=r,a=this.ensureAguiMessage(s.messageId);this.stores.chatStore.updateMessage(a,{isStreaming:!1});return}case O.TOOL_CALL_START:{const s=r,a=s.toolCallId,i=s.toolCallName,o=s.parentMessageId,l=o?this.ensureAguiMessage(o):this.agentMsgId??void 0;this.aguiToolCalls.set(a,{name:i,args:"",messageId:l}),this.stores.eventsStore.addEvent({tool_call_id:a,tool_call_name:i},"tool_call_start");return}case O.TOOL_CALL_ARGS:{const s=r,a=s.toolCallId,i=this.aguiToolCalls.get(a);i&&(i.args+=s.delta??""),this.stores.eventsStore.addEvent({tool_call_id:a,delta:s.delta},"tool_call_args");return}case O.TOOL_CALL_END:{const a=r.toolCallId,i=this.aguiToolCalls.get(a);i&&(this.handleInteractiveToolCall(a,i.name,i.args,i.messageId),this.aguiToolCalls.delete(a)),this.stores.eventsStore.addEvent({tool_call_id:a},"tool_call_end");return}case O.TOOL_CALL_RESULT:{const s=r,a=s.toolCallId;this.stores.eventsStore.addEvent({tool_call_id:a,content:s.content},"tool_call_result");return}case O.CUSTOM:{const s=r,a=s.name,i=s.value,o=mn(i);if(a==="state_update"&&o&&(this.stores.tasksStore.applyUpdate(o),o.update_type==="NOTIFICATION")){const c=o.content,f=String(c?.severity??"info"),h=String(c?.body??""),v=String(c?.title??""),p=v?`${v}: ${h}`:h,m=c?.actions,_=Array.isArray(m)?m.filter(k=>k&&typeof k=="object").map(k=>({id:String(k.id??""),label:String(k.label??"Action"),payload:k.payload})).filter(k=>k.id):void 0;this.stores.notificationsStore.add(p||"Notification",f,_)}if(a==="artifact_stored"&&o){const u=mn(o.artifact),c=u?m_(u,this.aguiRunId,this.aguiSessionId):null;c&&this.stores.artifactsStore.addArtifact(c)}if(a==="artifact_chunk"&&o){const u=Zl(o);if(u.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(u,{message_id:this.agentMsgId??void 0});else{const c=u.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(c,u.chunk)}}if(a==="thinking"&&o){const u=this.findAgentMsg();if(u){const c=Oe(o.text)??"";Oe(o.phase)==="action"?this.stores.chatStore.updateMessage(u.id,{isThinking:!0}):c&&this.stores.chatStore.updateMessage(u.id,{observations:`${u.observations??""}${c}`,showObservations:!0,isThinking:!1})}}if(a==="revision"&&o){const u=this.findAgentMsg();if(u){const c=Oe(o.text)??"",h={isThinking:!1,isStreaming:!(gd(o.done)??!1)};u.revisionStreamActive||(h.revisionStreamActive=!0,h.text=""),c&&(h.text=`${u.revisionStreamActive?u.text:""}${c}`),this.stores.chatStore.updateMessage(u.id,h)}}if(a==="pause"&&o){const u=this.findAgentMsg();u&&this.handlePause(u,{},o,this.aguiRunId,n);const c=mn(o.payload),f=c?Oe(c.component):void 0,h=c?mn(c.props):void 0;c&&f&&h&&!this.stores.interactionsStore.pendingInteraction?this.stores.interactionsStore.setPendingInteraction({tool_call_id:`pause_${Date.now()}`,tool_name:Oe(c.tool)??"ui_pause",component:f,props:h,message_id:this.agentMsgId??void 0,resume_token:Oe(o.resume_token),created_at:Date.now()}):Oe(o.resume_token)&&this.stores.interactionsStore.updatePendingInteraction({resume_token:Oe(o.resume_token)}),this.aguiCompleted=!0}const l=o??{value:i};this.stores.eventsStore.addEvent(l,a);return}default:return}}ensureAguiMessage(t){const n=this.aguiMessageMap.get(t);if(n)return n;if(!this.aguiMappedPlaceholder&&this.agentMsgId)return this.aguiMappedPlaceholder=!0,this.aguiMessageMap.set(t,this.agentMsgId),this.agentMsgId;const r=this.stores.chatStore.addAgentMessage();return this.aguiMessageMap.set(t,r.id),r.id}buildHistory(){console.log("[AG-UI] Building history from this.stores.chatStore.messages:",this.stores.chatStore.messages.length,"messages");const t=this.stores.chatStore.messages.filter(n=>n.role==="user"||n.role==="agent").map(n=>({id:n.id,role:n.role==="agent"?"assistant":"user",content:n.text}));return console.log("[AG-UI] Built history:",t),t}hasTextContent(t){return typeof t=="string"?t.trim().length>0:Array.isArray(t)?t.some(n=>typeof n=="object"&&n!==null&&"text"in n):!1}}function mn(e){return!e||typeof e!="object"||Array.isArray(e)?null:e}function Oe(e){return typeof e=="string"?e:void 0}function ks(e){return typeof e=="number"?e:void 0}function gd(e){return typeof e=="boolean"?e:void 0}function Zl(e){return{stream_id:Oe(e.stream_id),seq:ks(e.seq),done:gd(e.done),artifact_type:Oe(e.artifact_type),chunk:e.chunk,meta:mn(e.meta)??void 0,ts:ks(e.ts)}}function __(e){const t=Oe(e.artifact_id),n=Oe(e.mime_type),r=ks(e.size_bytes),s=Oe(e.filename),a=Oe(e.trace_id),i=Oe(e.session_id),o=ks(e.ts);return!t||!n||r===void 0||!s||!a||!i||o===void 0?null:{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:mn(e.source)??{},trace_id:a,session_id:i,ts:o}}function m_(e,t,n){if(!t||!n)return null;const r=Oe(e.id),s=Oe(e.mime_type),a=ks(e.size_bytes),i=Oe(e.filename);return!r||!s||a===void 0||!i?null:{artifact_id:r,mime_type:s,size_bytes:a,filename:i,source:mn(e.source)??{},trace_id:t,session_id:n,ts:Date.now()}}function y_(e){return new g_(e)}class b_{constructor(t){this.stores=t}eventSource=null;start(t,n){this.close();const r=new URL("/events",window.location.origin);r.searchParams.set("trace_id",t),r.searchParams.set("session_id",n),r.searchParams.set("follow","true"),this.eventSource=new EventSource(r.toString());const s=a=>{const i=Wi(a.data);if(!i)return;const o=a.type||i.event||"";if(this.stores.eventsStore.shouldProcess(o)){if(o==="artifact_chunk"){const l=S_(i);if(l.artifact_type==="ui_component")this.stores.interactionsStore.addArtifactChunk(l,{});else{const u=l.stream_id??"artifact";this.stores.trajectoryStore.addArtifactChunk(u,l.chunk)}}if(o==="artifact_stored"){const l=w_(i);l&&this.stores.artifactsStore.addArtifact(l)}o!=="llm_stream_chunk"&&this.stores.eventsStore.addEvent(i,o||"event")}};["event","step","chunk","llm_stream_chunk","artifact_chunk","artifact_stored"].forEach(a=>{this.eventSource.addEventListener(a,s)}),this.eventSource.onmessage=s,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}}function S_(e){const t=e.meta;return{stream_id:typeof e.stream_id=="string"?e.stream_id:void 0,seq:typeof e.seq=="number"?e.seq:void 0,done:typeof e.done=="boolean"?e.done:void 0,artifact_type:typeof e.artifact_type=="string"?e.artifact_type:void 0,chunk:e.chunk,meta:t&&typeof t=="object"&&!Array.isArray(t)?t:void 0,ts:typeof e.ts=="number"?e.ts:void 0}}function w_(e){const t=typeof e.artifact_id=="string"?e.artifact_id:null,n=typeof e.mime_type=="string"?e.mime_type:null,r=typeof e.size_bytes=="number"?e.size_bytes:null,s=typeof e.filename=="string"?e.filename:null,a=typeof e.trace_id=="string"?e.trace_id:null,i=typeof e.session_id=="string"?e.session_id:null,o=typeof e.ts=="number"?e.ts:null;if(!t||!n||r===null||!s||!a||!i||o===null)return null;const l=e.source;return{artifact_id:t,mime_type:n,size_bytes:r,filename:s,source:l&&typeof l=="object"&&!Array.isArray(l)?l:{},trace_id:a,session_id:i,ts:o}}function k_(e){return new b_(e)}async function E_(e,t,n,r){try{const a=await fetch("/steer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e,task_id:t,event_type:"USER_MESSAGE",payload:{text:n,active_tasks:r},source:"user"})});return a.ok?(await a.json()).accepted:(console.error("Steering message failed:",a.statusText),!1)}catch(s){return console.error("Failed to send steering message:",s),!1}}class x_{constructor(t){this.stores=t}eventSource=null;lastUpdateId=null;activeSessionId=null;start(t){this.close(),this.activeSessionId!==t&&(this.lastUpdateId=null),this.activeSessionId=t,Eh(t).then(s=>{s&&this.stores.tasksStore.setTasks(s)});const n=new URL("/session/stream",window.location.origin);n.searchParams.set("session_id",t),this.lastUpdateId&&n.searchParams.set("since_id",this.lastUpdateId),this.eventSource=new EventSource(n.toString());const r=s=>{const a=Wi(s.data);if(!a||s.type!=="state_update"&&a.update_type==null)return;const i=a;if(this.lastUpdateId=i.update_id??this.lastUpdateId,this.stores.tasksStore.applyUpdate(i),i.update_type==="NOTIFICATION"){const o=i.content;if(o&&typeof o=="object"&&!Array.isArray(o)){const l=String(o.severity??"info"),u=["info","success","warning","error"].includes(l)?l:"info",c=String(o.body??""),f=String(o.title??""),h=f?`${f}: ${c}`:c,v=o.actions,p=Array.isArray(v)?v.filter(m=>m&&typeof m=="object").map(m=>({id:String(m.id??""),label:String(m.label??"Action"),payload:m.payload})).filter(m=>m.id):void 0;this.stores.notificationsStore.add(h||"Notification",u,p)}}};this.eventSource.addEventListener("state_update",r),this.eventSource.onmessage=r,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.activeSessionId=null}}function T_(e){return new x_(e)}function ho(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Cr=ho();function _d(e){Cr=e}var ps={exec:()=>null};function pe(e,t=""){let n=typeof e=="string"?e:e.source,r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(dt.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,t)};return r}var A_=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),dt={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},I_=/^(?:[ \t]*(?:\n|$))+/,C_=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,N_=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Is=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,R_=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,po=/(?:[*+-]|\d{1,9}[.)])/,md=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,yd=pe(md).replace(/bull/g,po).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),O_=pe(md).replace(/bull/g,po).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),go=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,M_=/^[^\n]+/,_o=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,P_=pe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",_o).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),L_=pe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,po).getRegex(),Ua="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",mo=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,D_=pe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",mo).replace("tag",Ua).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),bd=pe(go).replace("hr",Is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ua).getRegex(),$_=pe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",bd).getRegex(),yo={blockquote:$_,code:C_,def:P_,fences:N_,heading:R_,hr:Is,html:D_,lheading:yd,list:L_,newline:I_,paragraph:bd,table:ps,text:M_},Xl=pe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ua).getRegex(),U_={...yo,lheading:O_,table:Xl,paragraph:pe(go).replace("hr",Is).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Xl).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ua).getRegex()},z_={...yo,html:pe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",mo).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ps,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:pe(go).replace("hr",Is).replace("heading",` *#{1,6} *[^
]`).replace("lheading",yd).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},j_=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,G_=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Sd=/^( {2,}|\\)\n(?!\s*$)/,B_=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,za=/[\p{P}\p{S}]/u,bo=/[\s\p{P}\p{S}]/u,wd=/[^\s\p{P}\p{S}]/u,F_=pe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,bo).getRegex(),kd=/(?!~)[\p{P}\p{S}]/u,V_=/(?!~)[\s\p{P}\p{S}]/u,q_=/(?:[^\s\p{P}\p{S}]|~)/u,H_=pe(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",A_?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Ed=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Z_=pe(Ed,"u").replace(/punct/g,za).getRegex(),X_=pe(Ed,"u").replace(/punct/g,kd).getRegex(),xd="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",K_=pe(xd,"gu").replace(/notPunctSpace/g,wd).replace(/punctSpace/g,bo).replace(/punct/g,za).getRegex(),J_=pe(xd,"gu").replace(/notPunctSpace/g,q_).replace(/punctSpace/g,V_).replace(/punct/g,kd).getRegex(),Y_=pe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,wd).replace(/punctSpace/g,bo).replace(/punct/g,za).getRegex(),W_=pe(/\\(punct)/,"gu").replace(/punct/g,za).getRegex(),Q_=pe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),em=pe(mo).replace("(?:-->|$)","-->").getRegex(),tm=pe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",em).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Ta=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,nm=pe(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Ta).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Td=pe(/^!?\[(label)\]\[(ref)\]/).replace("label",Ta).replace("ref",_o).getRegex(),Ad=pe(/^!?\[(ref)\](?:\[\])?/).replace("ref",_o).getRegex(),rm=pe("reflink|nolink(?!\\()","g").replace("reflink",Td).replace("nolink",Ad).getRegex(),Kl=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,So={_backpedal:ps,anyPunctuation:W_,autolink:Q_,blockSkip:H_,br:Sd,code:G_,del:ps,emStrongLDelim:Z_,emStrongRDelimAst:K_,emStrongRDelimUnd:Y_,escape:j_,link:nm,nolink:Ad,punctuation:F_,reflink:Td,reflinkSearch:rm,tag:tm,text:B_,url:ps},sm={...So,link:pe(/^!?\[(label)\]\((.*?)\)/).replace("label",Ta).getRegex(),reflink:pe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Ta).getRegex()},$i={...So,emStrongRDelimAst:J_,emStrongLDelim:X_,url:pe(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Kl).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:pe(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Kl).getRegex()},am={...$i,br:pe(Sd).replace("{2,}","*").getRegex(),text:pe($i.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ls={normal:yo,gfm:U_,pedantic:z_},is={normal:So,gfm:$i,breaks:am,pedantic:sm},im={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jl=e=>im[e];function gn(e,t){if(t){if(dt.escapeTest.test(e))return e.replace(dt.escapeReplace,Jl)}else if(dt.escapeTestNoEncode.test(e))return e.replace(dt.escapeReplaceNoEncode,Jl);return e}function Yl(e){try{e=encodeURI(e).replace(dt.percentDecode,"%")}catch{return null}return e}function Wl(e,t){let n=e.replace(dt.findPipe,(a,i,o)=>{let l=!1,u=i;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(dt.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(dt.slashPipe,"|");return r}function os(e,t,n){let r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function om(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function Ql(e,t,n,r,s){let a=t.href,i=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:i,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function lm(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(r===null)return t;let s=r[1];return t.split(`
`).map(a=>{let i=a.match(n.other.beginningSpace);if(i===null)return a;let[o]=i;return o.length>=s.length?a.slice(s.length):a}).join(`
`)}var Aa=class{options;rules;lexer;constructor(e){this.options=e||Cr}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:os(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=lm(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=os(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:os(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=os(t[0],`
`).split(`
`),r="",s="",a=[];for(;n.length>0;){let i=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),i=!0;else if(!i)o.push(n[l]);else break;n=n.slice(l);let u=o.join(`
`),c=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${u}`:u,s=s?`${s}
${c}`:c;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,a,!0),this.lexer.state.top=f,n.length===0)break;let h=a.at(-1);if(h?.type==="code")break;if(h?.type==="blockquote"){let v=h,p=v.raw+`
`+n.join(`
`),m=this.blockquote(p);a[a.length-1]=m,r=r.substring(0,r.length-v.raw.length)+m.raw,s=s.substring(0,s.length-v.text.length)+m.text;break}else if(h?.type==="list"){let v=h,p=v.raw+`
`+n.join(`
`),m=this.list(p);a[a.length-1]=m,r=r.substring(0,r.length-h.raw.length)+m.raw,s=s.substring(0,s.length-v.raw.length)+m.raw,n=p.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:a,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let a=this.rules.other.listItemRegex(n),i=!1;for(;e;){let l=!1,u="",c="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),h=e.split(`
`,1)[0],v=!f.trim(),p=0;if(this.options.pedantic?(p=2,c=f.trimStart()):v?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,c=f.slice(p),p+=t[1].length),v&&this.rules.other.blankLine.test(h)&&(u+=h+`
`,e=e.substring(h.length+1),l=!0),!l){let m=this.rules.other.nextBulletRegex(p),_=this.rules.other.hrRegex(p),k=this.rules.other.fencesBeginRegex(p),S=this.rules.other.headingBeginRegex(p),w=this.rules.other.htmlBeginRegex(p);for(;e;){let T=e.split(`
`,1)[0],C;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),C=h):C=h.replace(this.rules.other.tabCharGlobal,"    "),k.test(h)||S.test(h)||w.test(h)||m.test(h)||_.test(h))break;if(C.search(this.rules.other.nonSpaceChar)>=p||!h.trim())c+=`
`+C.slice(p);else{if(v||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||k.test(f)||S.test(f)||_.test(f))break;c+=`
`+h}!v&&!h.trim()&&(v=!0),u+=T+`
`,e=e.substring(T.length+1),f=C.slice(p)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),s.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(c),loose:!1,text:c,tokens:[]}),s.raw+=u}let o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let c=this.lexer.inlineQueue.length-1;c>=0;c--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[c].src)){this.lexer.inlineQueue[c].src=this.lexer.inlineQueue[c].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(l.raw);if(u){let c={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};l.checked=c.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=c.raw+l.tokens[0].raw,l.tokens[0].text=c.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(c)):l.tokens.unshift({type:"paragraph",raw:c.raw,text:c.raw,tokens:[c]}):l.tokens.unshift(c)}}if(!s.loose){let u=l.tokens.filter(f=>f.type==="space"),c=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));s.loose=c}}if(s.loose)for(let l of s.items){l.loose=!0;for(let u of l.tokens)u.type==="text"&&(u.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Wl(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?a.align.push("right"):this.rules.other.tableAlignCenter.test(i)?a.align.push("center"):this.rules.other.tableAlignLeft.test(i)?a.align.push("left"):a.align.push(null);for(let i=0;i<n.length;i++)a.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:a.align[i]});for(let i of s)a.rows.push(Wl(i,a.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:a.align[l]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=os(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=om(t[2],"()");if(a===-2)return;if(a>-1){let i=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,i).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(r);a&&(r=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Ql(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return Ql(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,a,i,o=s,l=0,u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(i=[...a].length,r[3]||r[4]){o+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(o-=i,o>0)continue;i=Math.min(i,i+o+l);let c=[...r[0]][0].length,f=e.slice(0,s+r.index+c+i);if(Math.min(s,i)%2){let v=f.slice(1,-1);return{type:"em",raw:f,text:v,tokens:this.lexer.inlineTokens(v)}}let h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]==="@")n=t[0],r="mailto:"+n;else{let s;do s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??"";while(s!==t[0]);n=t[0],t[1]==="www."?r="http://"+t[0]:r=t[0]}return{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Ft=class Ui{tokens;options;state;inlineQueue;tokenizer;constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Cr,this.options.tokenizer=this.options.tokenizer||new Aa,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:dt,block:Ls.normal,inline:is.normal};this.options.pedantic?(n.block=Ls.pedantic,n.inline=is.pedantic):this.options.gfm&&(n.block=Ls.gfm,this.options.breaks?n.inline=is.breaks:n.inline=is.gfm),this.tokenizer.rules=n}static get rules(){return{block:Ls,inline:is}}static lex(t,n){return new Ui(n).lex(t)}static lexInline(t,n){return new Ui(n).inlineTokens(t)}lex(t){t=t.replace(dt.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){for(this.options.pedantic&&(t=t.replace(dt.tabCharGlobal,"    ").replace(dt.spaceLine,""));t;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},t,n))?(t=t.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),n.push(s);continue}let a=t;if(this.options.extensions?.startBlock){let i=1/0,o=t.slice(1),l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(a=t.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=a.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(t){let i="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){let r=t,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)a=s[2]?s[2].length:0,r=r.slice(0,s.index+a)+"["+"a".repeat(s[0].length-a-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,o="";for(;t;){i||(o=""),i=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(l.raw.length);let c=n.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(t,r,o)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(t)){t=t.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(t))){t=t.substring(l.raw.length),n.push(l);continue}let u=t;if(this.options.extensions?.startInline){let c=1/0,f=t.slice(1),h;this.options.extensions.startInline.forEach(v=>{h=v.call({lexer:this},f),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(u=t.substring(0,c+1))}if(l=this.tokenizer.inlineText(u)){t=t.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),i=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},Ia=class{options;parser;constructor(e){this.options=e||Cr}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(dt.notSpaceStart)?.[0],s=e.replace(dt.endingNewline,"")+`
`;return r?'<pre><code class="language-'+gn(r)+'">'+(n?s:gn(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:gn(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,r="";for(let i=0;i<e.items.length;i++){let o=e.items[i];r+=this.listitem(o)}let s=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+r+"</"+s+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];n="";for(let i=0;i<a.length;i++)n+=this.tablecell(a[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${gn(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=Yl(e);if(s===null)return r;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+gn(t)+'"'),a+=">"+r+"</a>",a}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=Yl(e);if(s===null)return gn(n);e=s;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${gn(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:gn(e.text)}},wo=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},Vt=class zi{options;renderer;textRenderer;constructor(t){this.options=t||Cr,this.options.renderer=this.options.renderer||new Ia,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new wo}static parse(t,n){return new zi(n).parse(t)}static parseInline(t,n){return new zi(n).parseInline(t)}parse(t){let n="";for(let r=0;r<t.length;r++){let s=t[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,o=this.options.extensions.renderers[i.type].call({parser:this},i);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=o||"";continue}}let a=s;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(t,n=this.renderer){let r="";for(let s=0;s<t.length;s++){let a=t[s];if(this.options.extensions?.renderers?.[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=o||"";continue}}let i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},vs=class{options;block;constructor(e){this.options=e||Cr}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?Ft.lex:Ft.lexInline}provideParser(){return this.block?Vt.parse:Vt.parseInline}},um=class{defaults=ho();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Vt;Renderer=Ia;TextRenderer=wo;Lexer=Ft;Tokenizer=Aa;Hooks=vs;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let s=r;for(let a of s.header)n=n.concat(this.walkTokens(a.tokens,t));for(let a of s.rows)for(let i of a)n=n.concat(this.walkTokens(i.tokens,t));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{let i=s[a].flat(1/0);n=n.concat(this.walkTokens(i,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=t.renderers[s.name];a?t.renderers[s.name]=function(...i){let o=s.renderer.apply(this,i);return o===!1&&(o=a.apply(this,i)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){let s=this.defaults.renderer||new Ia(this.defaults);for(let a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let i=a,o=n.renderer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new Aa(this.defaults);for(let a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let i=a,o=n.tokenizer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new vs;for(let a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let i=a,o=n.hooks[i],l=s[i];vs.passThroughHooks.has(a)?s[i]=u=>{if(this.defaults.async&&vs.passThroughHooksRespectAsync.has(a))return(async()=>{let f=await o.call(s,u);return l.call(s,f)})();let c=o.call(s,u);return l.call(s,c)}:s[i]=(...u)=>{if(this.defaults.async)return(async()=>{let f=await o.apply(s,u);return f===!1&&(f=await l.apply(s,u)),f})();let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(i){let o=[];return o.push(a.call(this,i)),s&&(o=o.concat(s.call(this,i))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ft.lex(e,t??this.defaults)}parser(e,t){return Vt.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(t):t,o=await(s.hooks?await s.hooks.provideLexer():e?Ft.lex:Ft.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(o):o;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let u=await(s.hooks?await s.hooks.provideParser():e?Vt.parse:Vt.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(u):u})().catch(a);try{s.hooks&&(t=s.hooks.preprocess(t));let i=(s.hooks?s.hooks.provideLexer():e?Ft.lex:Ft.lexInline)(t,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let o=(s.hooks?s.hooks.provideParser():e?Vt.parse:Vt.parseInline)(i,s);return s.hooks&&(o=s.hooks.postprocess(o)),o}catch(i){return a(i)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let r="<p>An error occurred:</p><pre>"+gn(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},wr=new um;function Se(e,t){return wr.parse(e,t)}Se.options=Se.setOptions=function(e){return wr.setOptions(e),Se.defaults=wr.defaults,_d(Se.defaults),Se};Se.getDefaults=ho;Se.defaults=Cr;Se.use=function(...e){return wr.use(...e),Se.defaults=wr.defaults,_d(Se.defaults),Se};Se.walkTokens=function(e,t){return wr.walkTokens(e,t)};Se.parseInline=wr.parseInline;Se.Parser=Vt;Se.parser=Vt.parse;Se.Renderer=Ia;Se.TextRenderer=wo;Se.Lexer=Ft;Se.lexer=Ft.lex;Se.Tokenizer=Aa;Se.Hooks=vs;Se.parse=Se;Se.options;Se.setOptions;Se.use;Se.walkTokens;Se.parseInline;Vt.parse;Ft.lex;Se.setOptions({breaks:!0,gfm:!0});function Id(e){if(!e)return"";try{return Se.parse(e,{async:!1})}catch{return e}}let eu=!1;function cm(){eu||typeof window>"u"||(eu=!0,window.addEventListener("error",e=>{console.error("[playground-ui] Unhandled error:",e.error??e.message)}),window.addEventListener("unhandledrejection",e=>{console.error("[playground-ui] Unhandled rejection:",e.reason)}))}var dm=E("<div><!></div>");function ko(e,t){let n=We(t,"position",3,"center"),r=We(t,"class",3,"");var s=dm(),a=g(s);kt(a,()=>t.children??Ke),P(()=>Ee(s,1,`column ${n()??""} ${r()??""}`,"svelte-1k9hy8f")),b(e,s)}var fm=E('<div class="page svelte-1g511ye"><!></div>');function vm(e,t){var n=fm(),r=g(n);kt(r,()=>t.children??Ke),b(e,n)}function hm(e,t){ko(e,{position:"left",children:(n,r)=>{var s=Ze(),a=ne(s);kt(a,()=>t.children??Ke),b(n,s)},$$slots:{default:!0}})}pf();var pm=E("<div><!></div>");function On(e,t){let n=We(t,"class",3,"");var r=pm(),s=g(r);kt(s,()=>t.children??Ke),P(()=>Ee(r,1,`card ${n()??""}`,"svelte-4n6w97")),b(e,r)}var gm=E('<button type="button"> </button>'),_m=E('<div class="tabs svelte-1nusxqd"><!> <!></div>');function mm(e,t){oe(t,!0);var n=_m(),r=g(n);Me(r,17,()=>t.tabs,a=>a.id,(a,i)=>{var o=gm();let l;o.__click=()=>t.onchange?.(d(i).id);var u=g(o);P(()=>{l=Ee(o,1,"tab svelte-1nusxqd",null,l,{active:t.active===d(i).id}),N(u,d(i).label)}),b(a,o)});var s=y(r,2);kt(s,()=>t.right??Ke),b(e,n),le()}Tt(["click"]);var ym=E('<div class="icon svelte-12nvmli"> </div>'),bm=E('<div class="subtitle svelte-12nvmli"> </div>'),Sm=E('<div><!> <div class="title svelte-12nvmli"> </div> <!></div>');function ja(e,t){let n=We(t,"inline",3,!1);var r=Sm();let s;var a=g(r);{var i=f=>{var h=ym(),v=g(h);P(()=>N(v,t.icon)),b(f,h)};M(a,f=>{t.icon&&f(i)})}var o=y(a,2),l=g(o),u=y(o,2);{var c=f=>{var h=bm(),v=g(h);P(()=>N(v,t.subtitle)),b(f,h)};M(u,f=>{t.subtitle&&f(c)})}P(()=>{s=Ee(r,1,"empty svelte-12nvmli",null,s,{inline:n()}),N(l,t.title)}),b(e,r)}var wm=E('<div class="error-row svelte-1bc74kj"> </div>'),km=E('<div class="errors svelte-1bc74kj"></div>');function Cd(e,t){oe(t,!0);var n=Ze(),r=ne(n);{var s=a=>{var i=km();Me(i,21,()=>t.errors,o=>o.id,(o,l)=>{var u=wm(),c=g(u);P(()=>N(c,`Warning ${d(l).message??""}`)),b(o,u)}),b(a,i)};M(r,a=>{t.errors.length>0&&a(s)})}b(e,n),le()}var Em=E('<div class="label svelte-1hc9aln"> </div>'),xm=E('<div class="code-block svelte-1hc9aln"><!> <pre class="svelte-1hc9aln"> </pre></div>');function tu(e,t){let n=We(t,"maxHeight",3,"100px");const r=ue(()=>typeof t.content=="string"?t.content:JSON.stringify(t.content,null,2));var s=xm(),a=g(s);{var i=u=>{var c=Em(),f=g(c);P(()=>N(f,t.label)),b(u,c)};M(a,u=>{t.label&&u(i)})}var o=y(a,2),l=g(o);P(()=>{fi(o,`max-height: ${n()??""}`),N(l,d(r))}),b(e,s)}var Tm=E("<span><!></span>");function ft(e,t){let n=We(t,"variant",3,"default"),r=We(t,"size",3,"default"),s=We(t,"class",3,"");var a=Tm(),i=g(a);kt(i,()=>t.children??Ke),P(()=>Ee(a,1,`pill ${n()??""} ${r()??""} ${s()??""}`,"svelte-1qe3l4g")),b(e,a)}var Am=E("<span><!></span>");function Im(e,t){var n=Am(),r=g(n);{var s=a=>{var i=tt();P(()=>N(i,t.label)),b(a,i)};M(r,a=>{t.label&&a(s)})}P(()=>Ee(n,1,`status-dot ${t.status??""}`,"svelte-1506mec")),b(e,n)}var Cm=E('<button class="icon-btn svelte-w50x32"><!></button>');function Nm(e,t){var n=Cm();n.__click=function(...s){t.onclick?.apply(this,s)};var r=g(n);kt(r,()=>t.children??Ke),P(()=>et(n,"title",t.title)),b(e,n)}Tt(["click"]);var Rm=E('<div class="row space-between align-center svelte-1683ey6"><div><div class="title svelte-1683ey6"> </div> <div class="muted svelte-1683ey6"> </div></div> <!></div> <div class="badges svelte-1683ey6"></div> <div class="stats-row svelte-1683ey6"><div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">TOOLS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">FLOWS</div> <div class="stat-value svelte-1683ey6"> </div></div> <div class="stat svelte-1683ey6"><div class="stat-label svelte-1683ey6">SVCS</div> <div class="stat-value svelte-1683ey6"> </div></div></div>',1);function nu(e,t){oe(t,!1);const n=Qr();At(),On(e,{class:"project-card",children:(r,s)=>{var a=Rm(),i=ne(a),o=g(i),l=g(o),u=g(l),c=y(l,2),f=g(c),h=y(o,2);ft(h,{variant:"subtle",children:(U,$)=>{var I=tt();P(()=>N(I,n.meta.version||n.meta.template)),b(U,I)},$$slots:{default:!0}});var v=y(i,2);Me(v,5,()=>n.meta.flags,qr,(U,$)=>{ft(U,{variant:"ghost",children:(I,j)=>{var B=tt();P(()=>N(B,d($))),b(I,B)},$$slots:{default:!0}})});var p=y(v,2),m=g(p),_=y(g(m),2),k=g(_),S=y(m,2),w=y(g(S),2),T=g(w),C=y(S,2),A=y(g(C),2),R=g(A);P(()=>{N(u,n.meta.name),N(f,n.meta.description),N(k,n.meta.tools),N(T,n.meta.flows),N(R,n.services.length)}),b(r,a)},$$slots:{default:!0}}),le()}var Om=E('<div class="tabs svelte-1t9psp2"><div class="tab active svelte-1t9psp2">Spec YAML</div> <div class="tab svelte-1t9psp2">Validation</div> <!></div> <pre class="spec-view svelte-1t9psp2"> </pre> <!>',1);function ru(e,t){oe(t,!0);const n=ah(),r=ue(()=>n.status==="valid"?"Valid":n.status==="error"?"Errors":"Pending");On(e,{class:"spec-card",children:(s,a)=>{var i=Om(),o=ne(i),l=y(g(o),4);Im(l,{get status(){return n.status},get label(){return d(r)}});var u=y(o,2),c=g(u),f=y(u,2);Cd(f,{get errors(){return n.errors}}),P(()=>N(c,n.content)),b(s,i)},$$slots:{default:!0}}),le()}Tt(["click"]);var Mm=E('<span class="dot active svelte-15dukw8"></span> ',1),Pm=E('<div class="chat-header svelte-15dukw8"><!> <!></div>');function Lm(e,t){oe(t,!1);const n=Qr();At();var r=Pm(),s=g(r);ft(s,{class:"header-pill",children:(i,o)=>{var l=Mm(),u=y(ne(l));P(()=>N(u,` ${n.meta.name??""}`)),b(i,l)},$$slots:{default:!0}});var a=y(s,2);ft(a,{variant:"ghost",children:(i,o)=>{var l=tt("DEV PLAYGROUND");b(i,l)},$$slots:{default:!0}}),b(e,r),le()}var Dm=E('<details class="thinking-panel svelte-1xc7ue3"><summary class="thinking-summary svelte-1xc7ue3"> </summary> <div class="thinking-body svelte-1xc7ue3"><div class="markdown-content"><!></div></div></details>');function $m(e,t){oe(t,!0);const n=u=>{const c=u.currentTarget;t.ontoggle?.(c.open)};var r=Dm(),s=g(r),a=g(s),i=y(s,2),o=g(i),l=g(o);ec(l,()=>Id(t.observations)),P(()=>{r.open=t.open,N(a,t.isStreaming?"Thinking...":"Thought")}),Vf("toggle",r,n),b(e,r),le()}var Um=E('<a class="pause-link svelte-sbh9b9" target="_blank" rel="noreferrer">Open authorization link</a>'),zm=E('<div class="pause-token svelte-sbh9b9"> </div>'),jm=E('<div class="pause-card svelte-sbh9b9"><div class="pause-title svelte-sbh9b9">Action required</div> <!> <!> <div class="pause-meta svelte-sbh9b9"> <!></div></div>');function Gm(e,t){oe(t,!0);const n=ue(()=>t.pause.payload?.auth_url||t.pause.payload?.url||""),r=ue(()=>t.pause.payload?.provider||"");var s=jm(),a=y(g(s),2);{var i=v=>{var p=Um();P(()=>et(p,"href",d(n))),b(v,p)};M(a,v=>{d(n)&&v(i)})}var o=y(a,2);{var l=v=>{var p=zm(),m=g(p);P(()=>N(m,`Resume token: ${t.pause.resume_token??""}`)),b(v,p)};M(o,v=>{t.pause.resume_token&&v(l)})}var u=y(o,2),c=g(u),f=y(c);{var h=v=>{var p=tt();P(()=>N(p,`- provider: ${d(r)??""}`)),b(v,p)};M(f,v=>{d(r)&&v(h)})}P(()=>N(c,`${t.pause.reason?`reason: ${t.pause.reason}`:"paused"} `)),b(e,s),le()}var Bm=E('<div class="typing svelte-1gl9kj5"><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span><span class="svelte-1gl9kj5"></span></div>');function Fm(e){var t=Bm();b(e,t)}const Vm="modulepreload",qm=function(e){return"/"+e},su={},qe=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=i?.nonce||i?.getAttribute("nonce");s=l(n.map(u=>{if(u=qm(u),u in su)return;su[u]=!0;const c=u.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Vm,c||(h.as="script"),h.crossOrigin="",h.href=u,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((v,p)=>{h.addEventListener("load",v),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function Eo(e,t=[]){if(!e||typeof e!="object"||Array.isArray(e))return fa(new Error("Props must be an object."));const n=e;for(const r of t)if(!(r in n))return fa(new Error(`Missing required prop: ${r}`));return to(n)}function Hm(e,t){const n=e[t];return typeof n!="string"||!n.trim()?fa(new Error(`Invalid or missing string prop: ${t}`)):to(e)}function Zm(e,t){const n=e[t];return!n||typeof n!="object"||Array.isArray(n)?fa(new Error(`Invalid or missing object prop: ${t}`)):to(e)}const Ye=e=>Eo(e),Xm=e=>{const t=Eo(e,["option"]);return t.ok?Zm(t.data,"option"):t},Km=e=>{const t=Eo(e,["code"]);return t.ok?Hm(t.data,"code"):t},Jm={echarts:{load:()=>qe(()=>import("./ECharts-CqupL3i4.js"),__vite__mapDeps([0,1])),validateProps:Xm},mermaid:{load:()=>qe(()=>import("./Mermaid-DHuKDyIY.js").then(e=>e.bA),__vite__mapDeps([2,3,4,5])),validateProps:Km},plotly:{load:()=>qe(()=>import("./Plotly-iT82rl3a.js"),__vite__mapDeps([6,3,7])),validateProps:Ye},datagrid:{load:()=>qe(()=>import("./DataGrid-D3lJVewU.js"),__vite__mapDeps([8,9])),validateProps:Ye},json:{load:()=>qe(()=>import("./Json-Di4htBNe.js"),__vite__mapDeps([10,11])),validateProps:Ye},metric:{load:()=>qe(()=>import("./Metric-DC9rxsFz.js"),__vite__mapDeps([12,13])),validateProps:Ye},markdown:{load:()=>qe(()=>import("./Markdown-D5s2FDMZ.js"),__vite__mapDeps([14,4,15,16,17])),validateProps:Ye},code:{load:()=>qe(()=>import("./Code-BXjCgb-K.js"),__vite__mapDeps([18,19])),validateProps:Ye},latex:{load:()=>qe(()=>import("./Latex-B937GLtl.js"),__vite__mapDeps([20,15,21,17])),validateProps:Ye},callout:{load:()=>qe(()=>import("./Callout-7s_UdIVM.js"),__vite__mapDeps([22,14,4,15,16,17,23])),validateProps:Ye},form:{load:()=>qe(()=>import("./Form-CzNQ41Oz.js"),__vite__mapDeps([24,25])),validateProps:Ye},confirm:{load:()=>qe(()=>import("./Confirm-BWXifF4R.js"),__vite__mapDeps([26,14,4,15,16,17,27])),validateProps:Ye},select_option:{load:()=>qe(()=>import("./SelectOption--qSfevVe.js"),__vite__mapDeps([28,29])),validateProps:Ye},report:{load:()=>qe(()=>import("./Report-C0BYhrrP.js"),__vite__mapDeps([30,14,4,15,16,17,31])),validateProps:Ye},grid:{load:()=>qe(()=>import("./Grid-XnG42vjI.js"),__vite__mapDeps([32,33])),validateProps:Ye},tabs:{load:()=>qe(()=>import("./Tabs-9kyMOLjb.js"),__vite__mapDeps([34,14,4,15,16,17,35])),validateProps:Ye},accordion:{load:()=>qe(()=>import("./Accordion-BCTs7xhQ.js"),__vite__mapDeps([36,14,4,15,16,17,37])),validateProps:Ye},image:{load:()=>qe(()=>import("./Image-Cvir6sQN.js"),__vite__mapDeps([38,39])),validateProps:Ye},html:{load:()=>qe(()=>import("./Html-CxrbKPpz.js"),__vite__mapDeps([40,41])),validateProps:Ye},video:{load:()=>qe(()=>import("./Video-BGd9HufX.js"),__vite__mapDeps([42,43])),validateProps:Ye},embed:{load:()=>qe(()=>import("./Embed-CuYtRI1M.js"),__vite__mapDeps([44,45])),validateProps:Ye}};var Ym=E("<div><!></div>"),Wm=E('<div class="artifact-error svelte-1ly7nl2"><strong> </strong> <pre class="svelte-1ly7nl2"> </pre></div>'),Qm=E('<div class="renderer-loading svelte-1ly7nl2">Loading...</div>');function ji(e,t){oe(t,!0);let n=We(t,"props",19,()=>({})),r=We(t,"onResult",3,void 0);const s=so(),a=ue(()=>s.getComponent(t.component)),i=ue(()=>d(a)?.interactive??!1),o=ue(async()=>{const c=Jm[t.component];if(!c)return{ok:!1,error:new Error(`Renderer not found: ${t.component}`)};try{const f=await c.load(),h=c.validateProps(n());return h.ok?{ok:!0,data:{Renderer:f.default,props:h.data}}:h}catch(f){return{ok:!1,error:zv(f,`Failed to load renderer: ${t.component}`)}}});var l=Ze(),u=ne(l);Yf(u,()=>d(o),c=>{var f=Qm();b(c,f)},(c,f)=>{var h=Ze(),v=ne(h);{var p=_=>{const k=ue(()=>d(f).data.Renderer);var S=Ym();let w;var T=g(S);rv(T,()=>d(k),(C,A)=>{A(C,_v(()=>d(f).data.props,{get onResult(){return r()}}))}),P(()=>{w=Ee(S,1,"artifact svelte-1ly7nl2",null,w,{interactive:d(i)}),et(S,"data-component",t.component)}),b(_,S)},m=_=>{var k=Wm(),S=g(k),w=g(S),T=y(S),C=y(T),A=g(C);P(R=>{N(w,`Failed to render ${t.component??""}:`),N(T,` ${d(f).error.message??""} `),N(A,R)},[()=>JSON.stringify(n(),null,2)]),b(_,k)};M(v,_=>{d(f).ok?_(p):_(m,!1)})}b(c,h)}),b(e,l),le()}var ey=E('<div class="artifact-title svelte-1dv1zra"> </div>'),ty=E("<!> <!>",1),ny=E('<div class="component-artifacts svelte-1dv1zra"></div>'),ry=E('<div class="component-interaction svelte-1dv1zra"><!></div>'),sy=E('<span class="link svelte-1dv1zra"> </span>'),ay=E('<div><div><!> <div class="markdown-content"><!></div> <!> <!> <!> <!></div> <div class="meta-row svelte-1dv1zra"><span> </span> <!></div></div>');function iy(e,t){oe(t,!0);let n=We(t,"message",7);const r=ue(()=>n().role==="agent"&&n().observations&&n().observations.trim()!==""),s=ro(),a=ue(()=>s.artifacts.filter(I=>I.message_id===n().id)),i=ue(()=>{const I=s.pendingInteraction;return!I||I.message_id!==n().id?null:I});var o=ay(),l=g(o),u=g(l);{var c=I=>{{let j=ue(()=>n().showObservations??!1),B=ue(()=>n().isStreaming??!1);$m(I,{get observations(){return n().observations},get open(){return d(j)},get isStreaming(){return d(B)},ontoggle:q=>{n().showObservations=q}})}};M(u,I=>{d(r)&&I(c)})}var f=y(u,2),h=g(f);ec(h,()=>Id(n().text));var v=y(f,2);{var p=I=>{var j=ny();Me(j,21,()=>d(a),B=>B.id,(B,q)=>{var Q=ty(),ee=ne(Q);{var re=ot=>{var Ne=ey(),jt=g(Ne);P(()=>N(jt,d(q).title)),b(ot,Ne)};M(ee,ot=>{d(q).title&&ot(re)})}var we=y(ee,2);ji(we,{get component(){return d(q).component},get props(){return d(q).props}}),b(B,Q)}),b(I,j)};M(v,I=>{n().role==="agent"&&d(a).length>0&&I(p)})}var m=y(v,2);{var _=I=>{var j=ry(),B=g(j);ji(B,{get component(){return d(i).component},get props(){return d(i).props},onResult:q=>t.onInteractionResult?.(d(i),q)}),b(I,j)};M(m,I=>{n().role==="agent"&&d(i)&&I(_)})}var k=y(m,2);{var S=I=>{Gm(I,{get pause(){return n().pause}})};M(k,I=>{n().pause&&I(S)})}var w=y(k,2);{var T=I=>{Fm(I)};M(w,I=>{(n().isStreaming||n().isThinking)&&I(T)})}var C=y(l,2),A=g(C),R=g(A),U=y(A,2);{var $=I=>{var j=sy(),B=g(j);P(()=>N(B,`#${n().traceId??""}`)),b(I,j)};M(U,I=>{n().traceId&&I($)})}P(I=>{Ee(o,1,`message-row ${n().role==="agent"?"agent":"user"}`,"svelte-1dv1zra"),Ee(l,1,`bubble ${n().role}`,"svelte-1dv1zra"),N(R,I)},[()=>bv(n().ts)]),b(e,o),le()}var oy=E('<div class="chat-body svelte-mwyedf"><!></div>');function ly(e,t){oe(t,!0);const n=cc();let r=We(t,"chatBodyEl",15,null);var s=oy(),a=g(s);{var i=l=>{ja(l,{icon:"*",title:"Ready to test agent behavior.",subtitle:"Type a message below to start a run."})},o=l=>{var u=Ze(),c=ne(u);Me(c,17,()=>n.messages,f=>f.id,(f,h)=>{iy(f,{get message(){return d(h)},get onInteractionResult(){return t.onInteractionResult}})}),b(l,u)};M(a,l=>{n.isEmpty?l(i):l(o,!1)})}ys(s,l=>r(l),()=>r()),b(e,s),le()}var uy=E('<div class="steering-indicator svelte-esbonz"><span class="steering-dot svelte-esbonz"></span> Steering...</div>'),cy=E('<div><!> <textarea class="svelte-esbonz"></textarea> <button> </button></div>');function dy(e,t){oe(t,!0);const n=cc(),r=Ar(),s=gc();let a=G(!1);const i=ue(()=>s.tasks.some(A=>A.task_type==="FOREGROUND"&&A.status==="RUNNING")),o=ue(()=>s.tasks.filter(A=>A.task_type==="BACKGROUND"&&(A.status==="RUNNING"||A.status==="PENDING"||A.status==="PAUSED"))),l=ue(()=>s.tasks.find(A=>A.task_type==="FOREGROUND"&&A.status==="RUNNING")),u=ue(()=>d(i)),c=A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),f())},f=async()=>{d(u)?await h():t.onsubmit()},h=async()=>{const A=n.input.trim();if(!A||!d(l))return;x(a,!0);const R=d(o).map(U=>({task_id:U.task_id,description:U.description||"",status:U.status,task_type:U.task_type,priority:U.priority??0}));try{await E_(r.sessionId,d(l).task_id,A,R)&&n.clearInput()}finally{setTimeout(()=>{x(a,!1)},300)}},v=ue(()=>d(u)?!n.input.trim()||d(a):r.isSending||!n.input.trim());var p=cy();let m;var _=g(p);{var k=A=>{var R=uy();b(A,R)};M(_,A=>{d(a)&&A(k)})}var S=y(_,2);S.__keydown=c;var w=y(S,2);let T;w.__click=f;var C=g(w);P(()=>{m=Ee(p,1,"chat-input svelte-esbonz",null,m,{"steering-mode":d(u)}),et(S,"placeholder",d(u)?"Steer the agent with new instructions...":"Ask your agent something..."),T=Ee(w,1,"send-btn svelte-esbonz",null,T,{"steer-btn":d(u)}),w.disabled=d(v),et(w,"title",d(u)?"Send steering instruction to running task":"Send message"),N(C,d(u)?"!":">")}),lr(S,()=>n.input,A=>n.input=A),b(e,p),le()}Tt(["keydown","click"]);const Nd=Symbol("agui");function fy(e){xt(Nd,e)}function Rd(){const e=Mt(Nd);if(!e)throw new Error("AGUIProvider not found");return e}var vy=E('<span class="dots svelte-z9q8sr">...</span>'),hy=E('<div class="result svelte-z9q8sr"><div class="label svelte-z9q8sr">Result</div> <pre class="svelte-z9q8sr"> </pre></div>'),py=E('<div><div class="header svelte-z9q8sr"><span class="icon svelte-z9q8sr">tool</span> <strong class="svelte-z9q8sr"> </strong> <!></div> <pre class="args svelte-z9q8sr"> </pre> <!></div>');function gy(e,t){oe(t,!1);const n=Tn();let r=We(t,"toolCall",8);$u(()=>bt(r()),()=>{x(n,(()=>{try{return JSON.parse(r().arguments)}catch{return null}})())}),Uu(),At();var s=py();let a;var i=g(s),o=y(g(i),2),l=g(o),u=y(o,2);{var c=m=>{var _=vy();b(m,_)};M(u,m=>{bt(r()),ye(()=>r().isStreaming)&&m(c)})}var f=y(i,2),h=g(f),v=y(f,2);{var p=m=>{var _=hy(),k=y(g(_),2),S=g(k);P(()=>N(S,(bt(r()),ye(()=>r().result)))),b(m,_)};M(v,m=>{bt(r()),ye(()=>r().result)&&m(p)})}P(m=>{a=Ee(s,1,"agui-tool-call svelte-z9q8sr",null,a,{streaming:r().isStreaming}),N(l,(bt(r()),ye(()=>r().name))),N(h,`${m??""}
  `)},[()=>(d(n),bt(r()),ye(()=>d(n)?JSON.stringify(d(n),null,2):r().arguments))]),b(e,s),le()}var _y=E('<span class="cursor svelte-19eh49q">|</span>'),my=E('<div class="agui-tool-calls svelte-19eh49q"></div>'),yy=E('<div><div><div class="agui-role svelte-19eh49q"> </div> <div class="agui-message-content svelte-19eh49q"> <!></div> <!></div></div>');function by(e,t){oe(t,!1);let n=We(t,"message",8);At();var r=yy(),s=g(r),a=g(s),i=g(a),o=y(a,2),l=g(o),u=y(l);{var c=v=>{var p=_y();b(v,p)};M(u,v=>{bt(n()),ye(()=>n().isStreaming)&&v(c)})}var f=y(o,2);{var h=v=>{var p=my();Me(p,5,()=>(bt(n()),ye(()=>n().toolCalls)),m=>m.id,(m,_)=>{gy(m,{get toolCall(){return d(_)}})}),b(v,p)};M(f,v=>{bt(n()),ye(()=>n().toolCalls.length>0)&&v(h)})}P(()=>{Ee(r,1,(bt(n()),ye(()=>`agui-message-row ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),Ee(s,1,(bt(n()),ye(()=>`agui-bubble ${n().role==="user"?"user":"assistant"}`)),"svelte-19eh49q"),N(i,(bt(n()),ye(()=>n().role))),N(l,(bt(n()),ye(()=>n().content)))}),b(e,r),le()}var Sy=E('<p class="agui-empty svelte-15on836">No messages yet</p>'),wy=E('<div class="agui-message-list svelte-15on836"><!> <!></div>');function ky(e,t){oe(t,!1);const n=()=>us(a,"$messages",r),[r,s]=sc(),{messages:a}=Rd();let i=Tn();$u(()=>(n(),d(i)),()=>{n().length&&d(i)&&requestAnimationFrame(()=>{d(i)&&Gn(i,d(i).scrollTop=d(i).scrollHeight)})}),Uu(),At();var o=wy(),l=g(o);Me(l,1,n,f=>f.id,(f,h)=>{by(f,{get message(){return d(h)}})});var u=y(l,2);{var c=f=>{var h=Ze(),v=ne(h);nv(v,t,"empty",{},p=>{var m=Sy();b(p,m)}),b(f,h)};M(u,f=>{n(),ye(()=>n().length===0)&&f(c)})}ys(o,f=>x(i,f),()=>d(i)),b(e,o),le(),s()}var Ey=E("<li> </li>"),xy=E('<section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Active Steps</h4> <ul class="svelte-rwecvr"></ul></section>'),Ty=E('<section class="error svelte-rwecvr"><h4 class="svelte-rwecvr">Error</h4> <pre class="svelte-rwecvr"> </pre></section>'),Ay=E('<details class="agui-debugger svelte-rwecvr"><summary class="svelte-rwecvr">AG-UI Debug <span> </span></summary> <div class="content svelte-rwecvr"><section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Thread / Run</h4> <code class="svelte-rwecvr"> </code></section> <!> <section class="svelte-rwecvr"><h4 class="svelte-rwecvr">Agent State</h4> <pre class="svelte-rwecvr"> </pre></section> <!></div></details>');function Iy(e,t){oe(t,!1);const n=()=>us(u,"$status",i),r=()=>us(l,"$state",i),s=()=>us(f,"$activeSteps",i),a=()=>us(c,"$agentState",i),[i,o]=sc(),{state:l,status:u,agentState:c,activeSteps:f}=Rd();let h=We(t,"expanded",12,!1);At();var v=Ay(),p=g(v),m=y(g(p));let _;var k=g(m),S=y(p,2),w=g(S),T=y(g(w),2),C=g(T),A=y(w,2);{var R=q=>{var Q=xy(),ee=y(g(Q),2);Me(ee,5,s,qr,(re,we)=>{var ot=Ey(),Ne=g(ot);P(()=>N(Ne,(d(we),ye(()=>d(we).name)))),b(re,ot)}),b(q,Q)};M(A,q=>{s(),ye(()=>s().length>0)&&q(R)})}var U=y(A,2),$=y(g(U),2),I=g($),j=y(U,2);{var B=q=>{var Q=Ty(),ee=y(g(Q),2),re=g(ee);P(we=>N(re,we),[()=>(r(),ye(()=>JSON.stringify(r().error,null,2)))]),b(q,Q)};M(j,q=>{r(),ye(()=>r().error)&&q(B)})}P(q=>{_=Ee(m,1,"status svelte-rwecvr",null,_,{running:n()==="running",error:n()==="error"}),N(k,n()),N(C,`${r(),ye(()=>r().threadId??"â")??""} / ${r(),ye(()=>r().runId??"â")??""}`),N(I,q)},[()=>(a(),ye(()=>JSON.stringify(a(),null,2)))]),fv("open","toggle",v,h,h),b(e,v),le(),o()}var Cy=E('<div class="muted tiny svelte-asidmd"> </div>'),Ny=E('<div><div class="label svelte-asidmd"> </div> <!> <!></div>');function Or(e,t){let n=We(t,"full",3,!1);var r=Ny();let s;var a=g(r),i=g(a),o=y(a,2);kt(o,()=>t.children??Ke);var l=y(o,2);{var u=c=>{var f=Cy(),h=g(f);P(()=>N(h,t.hint)),b(c,f)};M(l,c=>{t.hint&&c(u)})}P(()=>{s=Ee(r,1,"setup-field svelte-asidmd",null,s,{full:n()}),N(i,t.label)}),b(e,r)}var Ry=E('<div class="row gap svelte-18icuuu"><input class="setup-input svelte-18icuuu"/> <button class="ghost-btn small svelte-18icuuu">New</button></div>'),Oy=E('<input class="setup-input svelte-18icuuu"/>'),My=E('<input class="setup-input svelte-18icuuu"/>'),Py=E('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),Ly=E('<textarea class="setup-textarea svelte-18icuuu"></textarea>'),Dy=E('<label class="toggle-row svelte-18icuuu"><input class="toggle-input svelte-18icuuu" type="checkbox"/> <span>Use AG-UI</span></label>'),$y=E('<div class="agui-preview svelte-18icuuu"><div class="agui-preview-title svelte-18icuuu">AG-UI Preview</div> <!> <!></div>'),Uy=E('<div class="setup-body svelte-18icuuu"><div class="setup-grid svelte-18icuuu"><!> <!> <!> <!> <!> <!></div> <!> <!></div>');function zy(e,t){oe(t,!1);const n={messages:ir([{id:"preview-msg",role:"assistant",content:"AG-UI preview message with a tool call.",isStreaming:!1,toolCalls:[{id:"preview-call",name:"search",arguments:'{"query":"preview"}',isStreaming:!1,result:"ok"}]}]),state:ir({status:"idle",threadId:"preview-thread",runId:"preview-run",messages:[],agentState:{mode:"preview"},activeSteps:[],error:null}),status:ir("idle"),agentState:ir({mode:"preview"}),isRunning:ir(!1),error:ir(null),activeSteps:ir([]),sendMessage:async()=>{},cancel:()=>{},reset:()=>{}},r=Tn(Ar()),s=Tn(lh()),a=Pa(),i=no(),o=ro();fy(n),At();var l=Uy(),u=g(l),c=g(u);Or(c,{label:"Session ID",hint:"Used to scope short-term memory and trajectory lookups.",children:(T,C)=>{var A=Ry(),R=g(A),U=y(R,2);U.__click=()=>{d(r).newSession(),a.clear(),i.clear(),o.clear()},lr(R,()=>d(r).sessionId,$=>Gn(r,d(r).sessionId=$)),b(T,A)},$$slots:{default:!0}});var f=y(c,2);Or(f,{label:"Tenant ID",children:(T,C)=>{var A=Oy();lr(A,()=>d(s).tenantId,R=>Gn(s,d(s).tenantId=R)),b(T,A)},$$slots:{default:!0}});var h=y(f,2);Or(h,{label:"User ID",children:(T,C)=>{var A=My();lr(A,()=>d(s).userId,R=>Gn(s,d(s).userId=R)),b(T,A)},$$slots:{default:!0}});var v=y(h,2);Or(v,{label:"Tool Context (JSON)",hint:"Merged with tenant/user and injected as runtime tool_context.",full:!0,children:(T,C)=>{var A=Py();et(A,"placeholder",'{"any_runtime_key": "value"}'),lr(A,()=>d(s).toolContextRaw,R=>Gn(s,d(s).toolContextRaw=R)),b(T,A)},$$slots:{default:!0}});var p=y(v,2);Or(p,{label:"LLM Context (JSON)",hint:"Only used when the playground wraps a planner entry point.",full:!0,children:(T,C)=>{var A=Ly();et(A,"placeholder","{}"),lr(A,()=>d(s).llmContextRaw,R=>Gn(s,d(s).llmContextRaw=R)),b(T,A)},$$slots:{default:!0}});var m=y(p,2);Or(m,{label:"Streaming Protocol",hint:"Enable AG-UI streaming for the playground.",full:!0,children:(T,C)=>{var A=Dy(),R=g(A);cv(R,()=>d(s).useAgui,U=>Gn(s,d(s).useAgui=U)),b(T,A)},$$slots:{default:!0}});var _=y(u,2);{var k=T=>{{let C=Oa(()=>[{id:"setup-err",message:d(s).error}]);Cd(T,{get errors(){return d(C)}})}};M(_,T=>{d(s).error&&T(k)})}var S=y(_,2);{var w=T=>{var C=$y(),A=y(g(C),2);ky(A,{});var R=y(A,2);Iy(R,{}),b(T,C)};M(S,T=>{d(s).useAgui&&T(w)})}b(e,l),le()}Tt(["click"]);var jy=E('<span class="badge active svelte-184tvz6">Active</span>'),Gy=E('<span class="badge svelte-184tvz6">Disabled</span>'),By=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6">Summary</h4> <div class="summary-text svelte-184tvz6"> </div></div>'),Fy=E('<span class="digest-item svelte-184tvz6"> </span>'),Vy=E('<span class="digest-item svelte-184tvz6"> </span>'),qy=E('<div class="turn-digest svelte-184tvz6"><!> <!></div>'),Hy=E('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div> <!></div>'),Zy=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list svelte-184tvz6"></div></div>'),Xy=E('<div class="turn-item svelte-184tvz6"><div class="turn-header svelte-184tvz6"></div> <div class="turn-row svelte-184tvz6"><span class="turn-label user svelte-184tvz6">User</span> <span class="turn-content svelte-184tvz6"> </span></div> <div class="turn-row svelte-184tvz6"><span class="turn-label assistant svelte-184tvz6">Assistant</span> <span class="turn-content svelte-184tvz6"> </span></div></div>'),Ky=E('<div class="memory-block svelte-184tvz6"><h4 class="svelte-184tvz6"> </h4> <div class="turns-list pending svelte-184tvz6"></div></div>'),Jy=E("<!> <!> <!>",1),Yy=E('<div class="empty-section svelte-184tvz6">Short-term memory is not enabled or no conversation history exists.</div>'),Wy=E('<div class="section-content svelte-184tvz6"><!></div>'),Qy=E('<pre class="json-block svelte-184tvz6"> </pre>'),eb=E('<div class="empty-section svelte-184tvz6">No additional LLM context was injected (besides memory).</div>'),tb=E('<div class="section-content svelte-184tvz6"><!></div>'),nb=E('<pre class="json-block svelte-184tvz6"> </pre>'),rb=E('<div class="empty-section svelte-184tvz6">No tool context was passed.</div>'),sb=E('<div class="section-content svelte-184tvz6"><!></div>'),ab=E('<section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Conversation Memory <!></span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">LLM Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section> <section class="context-section svelte-184tvz6"><button class="section-header svelte-184tvz6"><span class="section-title svelte-184tvz6">Tool Context</span> <span><svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor"><path d="M4 5L6 7L8 5" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round"></path></svg></span></button> <!></section>',1),ib=E('<div class="context-body svelte-184tvz6"><!></div>');function ob(e,t){oe(t,!0);const n=Pa();let r=G(!0),s=G(!0),a=G(!1);const i=ue(()=>{if(!n.llmContext)return null;const{conversation_memory:v,...p}=n.llmContext;return Object.keys(p).length>0?p:null}),o=v=>{try{return JSON.stringify(v,null,2)}catch{return String(v)}},l=(v,p=100)=>v.length<=p?v:v.slice(0,p)+"...";var u=ib(),c=g(u);{var f=v=>{ja(v,{icon:"*",title:"No context yet",subtitle:"Send a prompt to see injected context."})},h=v=>{var p=ab(),m=ne(p),_=g(m);_.__click=()=>x(r,!d(r));var k=g(_),S=y(g(k));{var w=ge=>{var Ge=jy();b(ge,Ge)},T=ge=>{var Ge=Gy();b(ge,Ge)};M(S,ge=>{n.hasMemory?ge(w):ge(T,!1)})}var C=y(k,2);let A;var R=y(_,2);{var U=ge=>{var Ge=Wy(),Pt=g(Ge);{var It=_e=>{var xe=Jy(),X=ne(xe);{var Qe=me=>{var Je=By(),gt=y(g(Je),2),Xt=g(gt);P(()=>N(Xt,n.conversationMemory.summary)),b(me,Je)};M(X,me=>{n.conversationMemory.summary&&me(Qe)})}var Zt=y(X,2);{var Mn=me=>{var Je=Zy(),gt=g(Je),Xt=g(gt),Ln=y(gt,2);Me(Ln,21,()=>n.conversationMemory.recent_turns,qr,(Dn,_t,er)=>{var un=Hy(),Gt=g(un);Gt.textContent=`Turn ${er+1}`;var cn=y(Gt,2),$n=y(g(cn),2),tr=g($n),dn=y(cn,2),Un=y(g(dn),2),zn=g(Un),nr=y(dn,2);{var ae=he=>{var Le=qy(),mt=g(Le);{var fn=yt=>{var J=Fy(),ie=g(J);P(Ie=>N(ie,`Tools: ${Ie??""}`),[()=>d(_t).trajectory_digest.tools_invoked.join(", ")]),b(yt,J)};M(mt,yt=>{d(_t).trajectory_digest.tools_invoked?.length&&yt(fn)})}var rr=y(mt,2);{var sr=yt=>{var J=Vy(),ie=g(J);P(Ie=>N(ie,`Obs: ${Ie??""}`),[()=>l(d(_t).trajectory_digest.observations_summary,80)]),b(yt,J)};M(rr,yt=>{d(_t).trajectory_digest.observations_summary&&yt(sr)})}b(he,Le)};M(nr,he=>{d(_t).trajectory_digest&&he(ae)})}P((he,Le)=>{N(tr,he),N(zn,Le)},[()=>l(d(_t).user,150),()=>l(d(_t).assistant,150)]),b(Dn,un)}),P(()=>N(Xt,`Recent Turns (${n.conversationMemory.recent_turns.length??""})`)),b(me,Je)};M(Zt,me=>{n.conversationMemory.recent_turns?.length&&me(Mn)})}var Pn=y(Zt,2);{var ln=me=>{var Je=Ky(),gt=g(Je),Xt=g(gt),Ln=y(gt,2);Me(Ln,21,()=>n.conversationMemory.pending_turns,qr,(Dn,_t,er)=>{var un=Xy(),Gt=g(un);Gt.textContent=`Pending ${er+1}`;var cn=y(Gt,2),$n=y(g(cn),2),tr=g($n),dn=y(cn,2),Un=y(g(dn),2),zn=g(Un);P((nr,ae)=>{N(tr,nr),N(zn,ae)},[()=>l(d(_t).user,100),()=>l(d(_t).assistant,100)]),b(Dn,un)}),P(()=>N(Xt,`Pending Turns (${n.conversationMemory.pending_turns.length??""})`)),b(me,Je)};M(Pn,me=>{n.conversationMemory.pending_turns?.length&&me(ln)})}b(_e,xe)},te=_e=>{var xe=Yy();b(_e,xe)};M(Pt,_e=>{n.conversationMemory?_e(It):_e(te,!1)})}b(ge,Ge)};M(R,ge=>{d(r)&&ge(U)})}var $=y(m,2),I=g($);I.__click=()=>x(s,!d(s));var j=y(g(I),2);let B;var q=y(I,2);{var Q=ge=>{var Ge=tb(),Pt=g(Ge);{var It=_e=>{var xe=Qy(),X=g(xe);P(Qe=>N(X,Qe),[()=>o(d(i))]),b(_e,xe)},te=_e=>{var xe=eb();b(_e,xe)};M(Pt,_e=>{d(i)?_e(It):_e(te,!1)})}b(ge,Ge)};M(q,ge=>{d(s)&&ge(Q)})}var ee=y($,2),re=g(ee);re.__click=()=>x(a,!d(a));var we=y(g(re),2);let ot;var Ne=y(re,2);{var jt=ge=>{var Ge=sb(),Pt=g(Ge);{var It=_e=>{var xe=nb(),X=g(xe);P(Qe=>N(X,Qe),[()=>o(n.toolContext)]),b(_e,xe)},te=_e=>{var xe=rb();b(_e,xe)};M(Pt,_e=>{n.toolContext&&Object.keys(n.toolContext).length>0?_e(It):_e(te,!1)})}b(ge,Ge)};M(Ne,ge=>{d(a)&&ge(jt)})}P(()=>{et(_,"aria-expanded",d(r)),A=Ee(C,1,"chevron svelte-184tvz6",null,A,{expanded:d(r)}),et(I,"aria-expanded",d(s)),B=Ee(j,1,"chevron svelte-184tvz6",null,B,{expanded:d(s)}),et(re,"aria-expanded",d(a)),ot=Ee(we,1,"chevron svelte-184tvz6",null,ot,{expanded:d(a)})}),b(v,p)};M(c,v=>{n.hasContext?v(h,!1):v(f)})}b(e,u),le()}Tt(["click"]);var lb=E('<button><span class="name svelte-al447k"> </span> <span class="meta svelte-al447k"> </span></button>'),ub=E('<div class="error svelte-al447k"> </div>'),cb=E('<div class="empty svelte-al447k">Fix payload to preview.</div>'),db=E('<header class="svelte-al447k"><div><h2 class="svelte-al447k"> </h2> <p class="svelte-al447k"> </p></div> <div class="actions svelte-al447k"><button class="svelte-al447k">Use Example</button> <button class="svelte-al447k">Use Last Artifact</button> <button class="svelte-al447k">Reset</button></div></header> <div class="detail-grid svelte-al447k"><div class="schema svelte-al447k"><h4 class="svelte-al447k">Props Schema</h4> <pre class="svelte-al447k"> </pre></div> <div class="example svelte-al447k"><h4 class="svelte-al447k">Example</h4> <pre class="svelte-al447k"> </pre></div></div> <div class="editor svelte-al447k"><h4 class="svelte-al447k">Payload</h4> <textarea class="svelte-al447k"></textarea> <!></div> <div class="preview svelte-al447k"><h4 class="svelte-al447k">Preview</h4> <!></div>',1),fb=E('<div class="empty svelte-al447k">No registry loaded.</div>'),vb=E('<div class="component-lab svelte-al447k"><aside class="component-list svelte-al447k"><h3 class="svelte-al447k">Components</h3> <div class="component-scroll svelte-al447k"></div></aside> <section class="component-detail svelte-al447k"><!></section></div>');function hb(e,t){oe(t,!0);const n=so(),r=ro(),s=ue(()=>Object.values(n.components||{})),a=ue(()=>[...d(s)].sort((R,U)=>`${R.category}-${R.name}`.localeCompare(`${U.category}-${U.name}`)));let i=G(null),o=G("");gr(()=>{if(!d(i)&&d(a).length){const[R]=d(a);R&&x(i,R.name,!0)}}),gr(()=>{if(d(i)&&!d(o)){const U=n.getComponent(d(i))?.example?.props??{};x(o,JSON.stringify({component:d(i),props:U},null,2),!0)}});const l=ue(()=>d(i)?n.getComponent(d(i)):void 0),u=ue(()=>{try{const R=JSON.parse(d(o));return!R||typeof R!="object"?{preview:null,error:"Payload must be a JSON object."}:!R.component||!R.props?{preview:null,error:"Payload must include component and props keys."}:{preview:R,error:null}}catch(R){return{preview:null,error:R instanceof Error?R.message:"Invalid JSON."}}}),c=ue(()=>d(u).preview),f=ue(()=>d(u).error);function h(){d(l)&&x(o,JSON.stringify({component:d(l).name,props:d(l).example?.props??{}},null,2),!0)}function v(){const R=r.lastArtifact;R&&x(o,JSON.stringify({component:R.component,props:R.props},null,2),!0)}function p(){x(o,"")}function m(R){x(i,R,!0),x(o,"")}var _=vb(),k=g(_),S=y(g(k),2);Me(S,21,()=>d(a),qr,(R,U)=>{var $=lb();$.__click=()=>m(d(U).name);var I=g($),j=g(I),B=y(I,2),q=g(B);P(()=>{Ee($,1,`component-item ${d(i)===d(U).name?"active":""}`,"svelte-al447k"),N(j,d(U).name),N(q,`${d(U).category??""}${d(U).interactive?" â¢ interactive":""}`)}),b(R,$)});var w=y(k,2),T=g(w);{var C=R=>{var U=db(),$=ne(U),I=g($),j=g(I),B=g(j),q=y(j,2),Q=g(q),ee=y(I,2),re=g(ee);re.__click=h;var we=y(re,2);we.__click=v;var ot=y(we,2);ot.__click=p;var Ne=y($,2),jt=g(Ne),ge=y(g(jt),2),Ge=g(ge),Pt=y(jt,2),It=y(g(Pt),2),te=g(It),_e=y(Ne,2),xe=y(g(_e),2),X=y(xe,2);{var Qe=me=>{var Je=ub(),gt=g(Je);P(()=>N(gt,d(f))),b(me,Je)};M(X,me=>{d(f)&&me(Qe)})}var Zt=y(_e,2),Mn=y(g(Zt),2);{var Pn=me=>{ji(me,{get component(){return d(c).component},get props(){return d(c).props}})},ln=me=>{var Je=cb();b(me,Je)};M(Mn,me=>{d(c)?me(Pn):me(ln,!1)})}P((me,Je)=>{N(B,d(l).name),N(Q,d(l).description),we.disabled=!r.lastArtifact,N(Ge,me),N(te,Je)},[()=>JSON.stringify(d(l).propsSchema,null,2),()=>JSON.stringify(d(l).example?.props??{},null,2)]),lr(xe,()=>d(o),me=>x(o,me)),b(R,U)},A=R=>{var U=fb();b(R,U)};M(T,R=>{d(l)?R(C):R(A,!1)})}b(e,_),le()}Tt(["click"]);var pb=E("<!> <!>",1),gb=E("<!> <!> <!>",1);function Od(e,t){oe(t,!0);let n=We(t,"chatBodyEl",15,null),r=G("chat");const s=so(),a=ue(()=>{const l=[{id:"chat",label:"Chat"},{id:"setup",label:"Setup"},{id:"context",label:"Context"}];return s.enabled&&l.push({id:"components",label:"Components"}),l});var o={switchToSetup:()=>{x(r,"setup")}};return On(e,{class:"chat-card",children:(l,u)=>{var c=gb(),f=ne(c);Lm(f,{});var h=y(f,2);mm(h,{get tabs(){return d(a)},get active(){return d(r)},onchange:_=>{x(r,_,!0)}});var v=y(h,2);{var p=_=>{zy(_,{})},m=_=>{var k=Ze(),S=ne(k);{var w=C=>{ob(C,{})},T=C=>{var A=Ze(),R=ne(A);{var U=I=>{hb(I,{})},$=I=>{var j=pb(),B=ne(j);ly(B,{get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(Q){n(Q)}});var q=y(B,2);dy(q,{get onsubmit(){return t.onSendChat}}),b(I,j)};M(R,I=>{d(r)==="components"?I(U):I($,!1)},!0)}b(C,A)};M(S,C=>{d(r)==="context"?C(w):C(T,!1)},!0)}b(_,k)};M(v,_=>{d(r)==="setup"?_(p):_(m,!1)})}b(l,c)},$$slots:{default:!0}}),le(o)}var _b=E('<details class="svelte-1pjwbaq"><summary class="svelte-1pjwbaq">Details</summary> <!> <!></details>');function mb(e,t){var n=_b(),r=y(g(n),2);{var s=o=>{tu(o,{label:"args",get content(){return t.args}})};M(r,o=>{t.args&&o(s)})}var a=y(r,2);{var i=o=>{tu(o,{label:"result",get content(){return t.result}})};M(a,o=>{t.result&&o(i)})}b(e,n)}var yb=E('<div class="thought svelte-kirucq"> </div>'),bb=E('<div class="timeline-item svelte-kirucq"><div class="line svelte-kirucq"></div> <div></div> <div class="timeline-body svelte-kirucq"><div class="row space-between align-center svelte-kirucq"><div class="step-name svelte-kirucq"> </div> <!></div> <!> <!></div></div>');function Sb(e,t){oe(t,!0);var n=bb(),r=y(g(n),2),s=y(r,2),a=g(s),i=g(a),o=g(i),l=y(i,2);{var u=v=>{ft(v,{variant:"subtle",size:"small",children:(p,m)=>{var _=tt();P(()=>N(_,`${t.step.latencyMs??""} ms`)),b(p,_)},$$slots:{default:!0}})};M(l,v=>{t.step.latencyMs&&v(u)})}var c=y(a,2);{var f=v=>{var p=yb(),m=g(p);P(()=>N(m,`"${t.step.thought??""}"`)),b(v,p)};M(c,v=>{t.step.thought&&v(f)})}var h=y(c,2);mb(h,{get args(){return t.step.args},get result(){return t.step.result}}),P(()=>{Ee(r,1,`dot ${t.step.status??""}`,"svelte-kirucq"),N(o,t.step.name)}),b(e,n),le()}var wb=E('<div class="timeline svelte-a305uj"></div>');function kb(e,t){var n=wb();Me(n,21,()=>t.steps,r=>r.id,(r,s)=>{Sb(r,{get step(){return d(s)}})}),b(e,n)}var Eb=E('<div class="trajectory-header svelte-a3gaf7"><div class="title-small svelte-a3gaf7">Execution Trajectory</div> <!></div> <!>',1);function Md(e,t){oe(t,!1);const n=Ar(),r=Pa();At(),On(e,{class:"trajectory-card",children:(s,a)=>{var i=Eb(),o=ne(i),l=y(g(o),2);{var u=v=>{ft(v,{variant:"subtle",size:"small",children:(p,m)=>{var _=tt();P(k=>N(_,`trace ${k??""}`),[()=>n.activeTraceId.slice(0,8)]),b(p,_)},$$slots:{default:!0}})};M(l,v=>{n.activeTraceId&&v(u)})}var c=y(o,2);{var f=v=>{ja(v,{inline:!0,title:"No trajectory yet",subtitle:"Send a prompt to see steps."})},h=v=>{var p=Ze(),m=ne(p);Wf(m,()=>n.activeTraceId,_=>{kb(_,{get steps(){return r.steps}})}),b(v,p)};M(c,v=>{r.isEmpty?v(f):v(h,!1)})}b(s,i)},$$slots:{default:!0}}),le()}var xb=E("<!> <!>",1);function Tb(e,t){oe(t,!0);let n=We(t,"chatBodyEl",15,null),r;var a={switchToSetup:()=>{r?.switchToSetup()}};return ko(e,{position:"center",children:(i,o)=>{var l=xb(),u=ne(l);ys(Od(u,{get onSendChat(){return t.onSendChat},get onInteractionResult(){return t.onInteractionResult},get chatBodyEl(){return n()},set chatBodyEl(f){n(f)}}),f=>r=f,()=>r);var c=y(u,2);Md(c,{}),b(i,l)},$$slots:{default:!0}}),le(a)}var Ab=E('<div class="events-header svelte-1d58ppa"><div class="title-small svelte-1d58ppa">Planner Events</div> <div class="icon-row svelte-1d58ppa"><!> <select class="filter svelte-1d58ppa"><option>All</option><option>step</option><option>event</option><option>chunk</option><option>artifact_chunk</option></select></div></div>');function Ib(e,t){oe(t,!1);const n=Tn(no());At();var r=Ab(),s=y(g(r),2),a=g(s);Nm(a,{onclick:()=>{Gn(n,d(n).paused=!d(n).paused)},children:(h,v)=>{var p=tt();P(()=>N(p,d(n).paused?">":"||")),b(h,p)}});var i=y(a,2);i.__change=h=>{const v=h.currentTarget.value;d(n).setFilter(v||null)};var o=g(i);o.value=o.__value="";var l=y(o);l.value=l.__value="step";var u=y(l);u.value=u.__value="event";var c=y(u);c.value=c.__value="chunk";var f=y(c);f.value=f.__value="artifact_chunk",b(e,r),le()}Tt(["change"]);var Cb=E('<div class="event-desc svelte-1tjxgju"> </div>'),Nb=E('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Args:</span> </div>'),Rb=E('<div class="event-detail svelte-1tjxgju"><span class="label svelte-1tjxgju">Result:</span> </div>'),Ob=E('<div><div class="event-icon svelte-1tjxgju"> </div> <div class="event-main svelte-1tjxgju"><div class="event-header svelte-1tjxgju"><span class="event-name svelte-1tjxgju"> </span> <!></div> <!> <!> <!></div> <!></div>');function Mb(e,t){oe(t,!0);let n=We(t,"alt",3,!1);const r={step:{icon:"â¶",variant:"ghost"},tool_call:{icon:"ð§",variant:"subtle"},artifact:{icon:"ð",variant:"subtle"},other:{icon:"â¢",variant:"ghost"}};let s=ue(()=>r[t.event.type]??r.other);function a($){return $?$<1e3?`${$.toFixed(0)}ms`:`${($/1e3).toFixed(2)}s`:""}var i=Ob();let o;var l=g(i),u=g(l),c=y(l,2),f=g(c),h=g(f),v=g(h),p=y(h,2);{var m=$=>{ft($,{variant:"subtle",size:"small",children:(I,j)=>{var B=tt("tool");b(I,B)},$$slots:{default:!0}})},_=$=>{var I=Ze(),j=ne(I);{var B=q=>{ft(q,{variant:"subtle",size:"small",children:(Q,ee)=>{var re=tt("artifact");b(Q,re)},$$slots:{default:!0}})};M(j,q=>{t.event.type==="artifact"&&q(B)},!0)}b($,I)};M(p,$=>{t.event.type==="tool_call"?$(m):$(_,!1)})}var k=y(f,2);{var S=$=>{var I=Cb(),j=g(I);P(()=>N(j,t.event.description)),b($,I)};M(k,$=>{t.event.description&&$(S)})}var w=y(k,2);{var T=$=>{var I=Nb(),j=y(g(I));P(()=>N(j,` ${t.event.args??""}`)),b($,I)};M(w,$=>{t.event.type==="tool_call"&&t.event.args&&$(T)})}var C=y(w,2);{var A=$=>{var I=Rb(),j=y(g(I));P(()=>N(j,` ${t.event.result??""}`)),b($,I)};M(C,$=>{t.event.type==="tool_call"&&t.event.result&&$(A)})}var R=y(c,2);{var U=$=>{ft($,{variant:"subtle",size:"small",children:(I,j)=>{var B=tt();P(q=>N(B,q),[()=>a(t.event.duration_ms)]),b(I,B)},$$slots:{default:!0}})};M(R,$=>{t.event.duration_ms&&$(U)})}P(()=>{o=Ee(i,1,"event-row svelte-1tjxgju",null,o,{alt:n()}),N(u,d(s).icon),N(v,t.event.name)}),b(e,i),le()}var Pb=E('<div class="events-body svelte-f0vs81"><!></div>');function Lb(e,t){oe(t,!0);const n=no();let r=ue(()=>n.displayEvents);var s=Pb(),a=g(s);{var i=l=>{ja(l,{inline:!0,title:"No events yet",subtitle:"Events will appear during runs."})},o=l=>{var u=Ze(),c=ne(u);Me(c,19,()=>d(r),f=>f.id,(f,h,v)=>{{let p=ue(()=>d(v)%2===0);Mb(f,{get event(){return d(h)},get alt(){return d(p)}})}}),b(l,u)};M(a,l=>{d(r).length===0?l(i):l(o,!1)})}b(e,s),le()}var Db=E('<div class="artifact-row svelte-ko4yy5"><!> <pre class="svelte-ko4yy5"> </pre></div>'),$b=E('<div class="section svelte-ko4yy5"><div class="title-small svelte-ko4yy5">Artifact Streams</div> <!></div>');function Ub(e,t){oe(t,!1);const n=Pa();At();var r=Ze(),s=ne(r);{var a=i=>{var o=$b(),l=y(g(o),2);Me(l,1,()=>Object.entries(n.artifactStreams),([u,c])=>u,(u,c)=>{var f=ue(()=>Fd(d(c),2));let h=()=>d(f)[0],v=()=>d(f)[1];var p=Db(),m=g(p);ft(m,{variant:"ghost",size:"small",children:(S,w)=>{var T=tt();P(()=>N(T,h())),b(S,T)},$$slots:{default:!0}});var _=y(m,2),k=g(_);P(S=>N(k,S),[()=>JSON.stringify(v()[v().length-1],null,2)]),b(u,p)}),b(i,o)};M(s,i=>{n.hasArtifacts&&i(a)})}b(e,r),le()}var zb=E("<!> <!> <!>",1);function Pd(e){On(e,{class:"events-card",children:(t,n)=>{var r=zb(),s=ne(r);Ib(s,{});var a=y(s,2);Lb(a,{});var i=y(a,2);Ub(i,{}),b(t,r)},$$slots:{default:!0}})}var jb=E('<span class="spinner svelte-tbolst"></span>'),Gb=Hf('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12L3 7L4.4 5.55L7 8.15V1H9V8.15L11.6 5.55L13 7L8 12Z" fill="currentColor"></path><path d="M2 14V11H4V13H12V11H14V14C14 14.55 13.55 15 13 15H3C2.45 15 2 14.55 2 14Z" fill="currentColor"></path></svg>'),Bb=E('<span class="artifact-error svelte-tbolst" role="alert"> </span>'),Fb=E('<div class="artifact-item svelte-tbolst"><div class="artifact-info svelte-tbolst"><span class="artifact-icon svelte-tbolst"></span> <div class="artifact-details svelte-tbolst"><span class="artifact-name svelte-tbolst"> </span> <span class="artifact-meta svelte-tbolst"> <!></span></div></div> <button type="button" class="download-btn svelte-tbolst"><!></button> <!></div>');function Vb(e,t){oe(t,!0);const n=Ar();let r=G(!1),s=G(null);async function a(){x(r,!0),x(s,null);try{await kc(t.artifact.id,n.sessionId,t.artifact.filename??void 0)}catch(A){x(s,A instanceof Error?A.message:"Download failed",!0)}finally{x(r,!1)}}var i=Fb(),o=g(i),l=g(o),u=y(l,2),c=g(u),f=g(c),h=y(c,2),v=g(h),p=y(v);{var m=A=>{ft(A,{size:"small",variant:"subtle",children:(R,U)=>{var $=tt();P(I=>N($,I),[()=>kv(t.artifact.mime_type)]),b(R,$)},$$slots:{default:!0}})};M(p,A=>{t.artifact.mime_type&&A(m)})}var _=y(o,2);_.__click=a;var k=g(_);{var S=A=>{var R=jb();b(A,R)},w=A=>{var R=Gb();b(A,R)};M(k,A=>{d(r)?A(S):A(w,!1)})}var T=y(_,2);{var C=A=>{var R=Bb(),U=g(R);P(()=>N(U,d(s))),b(A,R)};M(T,A=>{d(s)&&A(C)})}P((A,R)=>{et(l,"data-type",A),et(c,"title",t.artifact.filename||t.artifact.id),N(f,t.artifact.filename||t.artifact.id),N(v,`${R??""} `),et(_,"title",d(r)?"Downloading...":"Download"),_.disabled=d(r),et(_,"aria-label",d(r)?"Downloading":`Download ${t.artifact.filename||"artifact"}`)},[()=>wv(t.artifact.mime_type),()=>Sv(t.artifact.size_bytes)]),b(e,i),le()}Tt(["click"]);var qb=E('<span class="count-badge svelte-1cjy38f"> </span>'),Hb=E('<span class="spinner svelte-1cjy38f"></span> Downloading...',1),Zb=E('<button type="button" class="download-all-btn svelte-1cjy38f"><!></button>'),Xb=E('<p class="no-artifacts svelte-1cjy38f">No artifacts yet. Artifacts will appear here when tools generate downloadable files.</p>'),Kb=E('<div class="artifacts-list svelte-1cjy38f"></div>'),Jb=E('<div class="artifacts-header svelte-1cjy38f"><h3 class="artifacts-title svelte-1cjy38f">Artifacts <!></h3> <!></div> <div class="artifacts-body svelte-1cjy38f"><!></div>',1);function Ld(e,t){oe(t,!0);let n=G(!1);const r=Hv(),s=Ar();async function a(){x(n,!0);for(const i of r.list)try{await kc(i.id,s.sessionId,i.filename??void 0),await new Promise(o=>setTimeout(o,300))}catch{}x(n,!1)}On(e,{class:"artifacts-card",children:(i,o)=>{var l=Jb(),u=ne(l),c=g(u),f=y(g(c));{var h=w=>{var T=qb(),C=g(T);P(()=>N(C,r.count)),b(w,T)};M(f,w=>{r.count>0&&w(h)})}var v=y(c,2);{var p=w=>{var T=Zb();T.__click=a;var C=g(T);{var A=U=>{var $=Hb();b(U,$)},R=U=>{var $=tt("Download All");b(U,$)};M(C,U=>{d(n)?U(A):U(R,!1)})}P(()=>{T.disabled=d(n),et(T,"aria-label",d(n)?"Downloading all artifacts":"Download all artifacts")}),b(w,T)};M(v,w=>{r.count>1&&w(p)})}var m=y(u,2),_=g(m);{var k=w=>{var T=Xb();b(w,T)},S=w=>{var T=Kb();Me(T,21,()=>r.list,C=>C.id,(C,A)=>{Vb(C,{get artifact(){return d(A)}})}),b(w,T)};M(_,w=>{r.count===0?w(k):w(S,!1)})}b(i,l)},$$slots:{default:!0}}),le()}Tt(["click"]);var Yb=E('<span class="count-badge svelte-1l2utx3"> </span>'),Wb=E('<span class="foreground-indicator svelte-1l2utx3"><span class="running-dot svelte-1l2utx3"></span> Active</span>'),Qb=E('<p class="no-tasks svelte-1l2utx3">No active tasks yet.</p>'),e0=E('<span class="task-time svelte-1l2utx3"> </span>'),t0=E('<span class="svelte-1l2utx3"> </span>'),n0=E('<div class="task-progress svelte-1l2utx3"><div class="progress-meta svelte-1l2utx3"><span class="svelte-1l2utx3"> </span> <!></div> <div class="progress-bar svelte-1l2utx3"><div class="progress-bar-fill svelte-1l2utx3"></div></div></div>'),r0=E('<div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Trace:</span> <span class="detail-value mono svelte-1l2utx3"> </span></div>'),s0=E('<div class="detail-row error svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Error:</span> <span class="detail-value svelte-1l2utx3"> </span></div>'),a0=E('<div class="task-result svelte-1l2utx3"><div class="task-result-title svelte-1l2utx3">Result</div> <div class="task-result-body svelte-1l2utx3"> </div></div>'),i0=E('<div class="task-details svelte-1l2utx3"><!> <div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Priority:</span> <span class="detail-value svelte-1l2utx3"> </span></div> <!> <!></div>'),o0=E('<button type="button" class="task-btn danger svelte-1l2utx3">Cancel</button>'),l0=E('<button type="button" class="task-btn svelte-1l2utx3">Pause</button>'),u0=E('<button type="button" class="task-btn primary svelte-1l2utx3">Resume</button>'),c0=E('<button type="button" class="task-btn primary svelte-1l2utx3">Apply</button>'),d0=E('<div role="button" tabindex="0"><div class="task-main svelte-1l2utx3"><div class="task-header-row svelte-1l2utx3"><div class="task-title svelte-1l2utx3"> </div> <!></div> <div class="task-meta svelte-1l2utx3"><span class="task-id svelte-1l2utx3"> </span> <!></div> <!> <!></div> <div class="task-actions svelte-1l2utx3"><!> <!> <!> <!></div></div>'),f0=E('<div class="tasks-section svelte-1l2utx3"><div class="section-header svelte-1l2utx3"><span class="section-label svelte-1l2utx3">Foreground</span></div> <div class="tasks-list svelte-1l2utx3"></div></div>'),v0=E('<span class="section-count svelte-1l2utx3"> </span>'),h0=E('<span class="task-priority svelte-1l2utx3"> </span>'),p0=E('<span class="task-time svelte-1l2utx3"> </span>'),g0=E('<span class="svelte-1l2utx3"> </span>'),_0=E('<div class="task-progress svelte-1l2utx3"><div class="progress-meta svelte-1l2utx3"><span class="svelte-1l2utx3"> </span> <!></div> <div class="progress-bar svelte-1l2utx3"><div class="progress-bar-fill svelte-1l2utx3"></div></div></div>'),m0=E('<div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Trace:</span> <span class="detail-value mono svelte-1l2utx3"> </span></div>'),y0=E('<div class="detail-row error svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Error:</span> <span class="detail-value svelte-1l2utx3"> </span></div>'),b0=E('<div class="task-result svelte-1l2utx3"><div class="task-result-title svelte-1l2utx3">Result</div> <div class="task-result-body svelte-1l2utx3"> </div></div>'),S0=E('<div class="task-details svelte-1l2utx3"><!> <div class="detail-row svelte-1l2utx3"><span class="detail-label svelte-1l2utx3">Priority:</span> <span class="detail-value svelte-1l2utx3"> </span></div> <!> <!></div>'),w0=E('<button type="button" class="task-btn danger svelte-1l2utx3">X</button>'),k0=E('<button type="button" class="task-btn svelte-1l2utx3">||</button>'),E0=E('<button type="button" class="task-btn primary svelte-1l2utx3">></button>'),x0=E('<button type="button" class="task-btn primary svelte-1l2utx3">Apply</button>'),T0=E('<div role="button" tabindex="0"><div class="task-main svelte-1l2utx3"><div class="task-header-row svelte-1l2utx3"><div class="task-title svelte-1l2utx3"> </div> <!></div> <div class="task-meta svelte-1l2utx3"><span class="task-id svelte-1l2utx3"> </span> <!> <!></div> <!> <!></div> <div class="task-actions svelte-1l2utx3"><div class="priority-controls svelte-1l2utx3"><button type="button" class="task-btn small svelte-1l2utx3" aria-label="Increase task priority">+</button> <button type="button" class="task-btn small svelte-1l2utx3" aria-label="Decrease task priority">-</button></div> <!> <!> <!> <!></div></div>'),A0=E('<div class="tasks-section svelte-1l2utx3"><div class="section-header svelte-1l2utx3"><span class="section-label svelte-1l2utx3">Background</span> <!></div> <div class="tasks-list svelte-1l2utx3"></div></div>'),I0=E("<!> <!>",1),C0=E('<div class="tasks-header svelte-1l2utx3"><h3 class="tasks-title svelte-1l2utx3">Tasks <!></h3> <!></div> <div class="tasks-body svelte-1l2utx3"><!></div>',1);function N0(e,t){oe(t,!0);const n=gc(),r=Ar();let s=G(null);const a=ue(()=>n.tasks.filter(S=>S.task_type==="FOREGROUND")),i=ue(()=>n.tasks.filter(S=>S.task_type==="BACKGROUND")),o=ue(()=>d(a).some(S=>S.status==="RUNNING")),l=ue(()=>d(i).filter(S=>S.status==="RUNNING"||S.status==="PENDING"||S.status==="PAUSED").length);function u(S){return`status-${S.toLowerCase()}`}function c(S){x(s,d(s)===S?null:S,!0)}async function f(S,w){w.stopPropagation(),await Ms(r.sessionId,S,"CANCEL",{reason:"user_cancelled"})}async function h(S,w){w.stopPropagation(),await Ms(r.sessionId,S,"PAUSE",{})}async function v(S,w){w.stopPropagation(),await Ms(r.sessionId,S,"RESUME",{})}async function p(S,w,T){T.stopPropagation();const A=n.tasks.find(R=>R.task_id===S)?.priority??0;await Ms(r.sessionId,S,"PRIORITIZE",{priority:A+w})}async function m(S,w,T){if(T.stopPropagation(),await Ec(r.sessionId,w,"apply")){const A=n.tasks.find(R=>R.task_id===S);A&&(A.patch_id=null)}}function _(S){return!S?.total||S.total<=0||S.current==null?null:Math.min(100,Math.max(0,Math.round(S.current/S.total*100)))}function k(S){return S?new Date(S).toLocaleTimeString():""}On(e,{class:"tasks-card",children:(S,w)=>{var T=C0(),C=ne(T),A=g(C),R=y(g(A));{var U=ee=>{var re=Yb(),we=g(re);P(()=>N(we,n.count)),b(ee,re)};M(R,ee=>{n.count>0&&ee(U)})}var $=y(A,2);{var I=ee=>{var re=Wb();b(ee,re)};M($,ee=>{d(o)&&ee(I)})}var j=y(C,2),B=g(j);{var q=ee=>{var re=Qb();b(ee,re)},Q=ee=>{var re=I0(),we=ne(re);{var ot=ge=>{var Ge=f0(),Pt=y(g(Ge),2);Me(Pt,21,()=>d(a),It=>It.task_id,(It,te)=>{var _e=d0();let xe;_e.__click=()=>c(d(te).task_id),_e.__keydown=ae=>ae.key==="Enter"&&c(d(te).task_id);var X=g(_e),Qe=g(X),Zt=g(Qe),Mn=g(Zt),Pn=y(Zt,2);{let ae=ue(()=>u(d(te).status));ft(Pn,{variant:"ghost",size:"small",get class(){return d(ae)},children:(he,Le)=>{var mt=tt();P(()=>N(mt,d(te).status)),b(he,mt)},$$slots:{default:!0}})}var ln=y(Qe,2),me=g(ln),Je=g(me),gt=y(me,2);{var Xt=ae=>{var he=e0(),Le=g(he);P(mt=>N(Le,mt),[()=>k(d(te).updated_at)]),b(ae,he)};M(gt,ae=>{d(te).updated_at&&ae(Xt)})}var Ln=y(ln,2);{var Dn=ae=>{var he=n0(),Le=g(he),mt=g(Le),fn=g(mt),rr=y(mt,2);{var sr=ie=>{var Ie=t0(),$e=g(Ie);P(ut=>N($e,`${ut??""}%`),[()=>_(d(te).progress)]),b(ie,Ie)};M(rr,ie=>{_(d(te).progress)&&ie(sr)})}var yt=y(Le,2),J=g(yt);P(ie=>{N(fn,d(te).progress.label??"Progress"),fi(J,ie)},[()=>`width: ${_(d(te).progress)??0}%`]),b(ae,he)};M(Ln,ae=>{d(te).progress&&ae(Dn)})}var _t=y(Ln,2);{var er=ae=>{var he=i0(),Le=g(he);{var mt=$e=>{var ut=r0(),vn=y(g(ut),2),hn=g(vn);P(jn=>N(hn,`${jn??""}...`),[()=>d(te).trace_id.slice(0,12)]),b($e,ut)};M(Le,$e=>{d(te).trace_id&&$e(mt)})}var fn=y(Le,2),rr=y(g(fn),2),sr=g(rr),yt=y(fn,2);{var J=$e=>{var ut=s0(),vn=y(g(ut),2),hn=g(vn);P(()=>N(hn,d(te).error)),b($e,ut)};M(yt,$e=>{d(te).error&&$e(J)})}var ie=y(yt,2);{var Ie=$e=>{var ut=a0(),vn=y(g(ut),2),hn=g(vn);P((jn,ts)=>N(hn,`${jn??""}${ts??""}`),[()=>JSON.stringify(d(te).result).slice(0,240),()=>JSON.stringify(d(te).result).length>240?"...":""]),b($e,ut)};M(ie,$e=>{d(te).result&&$e(Ie)})}P(()=>N(sr,d(te).priority)),b(ae,he)};M(_t,ae=>{d(s)===d(te).task_id&&ae(er)})}var un=y(X,2),Gt=g(un);{var cn=ae=>{var he=o0();he.__click=Le=>f(d(te).task_id,Le),b(ae,he)};M(Gt,ae=>{(d(te).status==="RUNNING"||d(te).status==="PAUSED")&&ae(cn)})}var $n=y(Gt,2);{var tr=ae=>{var he=l0();he.__click=Le=>h(d(te).task_id,Le),b(ae,he)};M($n,ae=>{d(te).status==="RUNNING"&&ae(tr)})}var dn=y($n,2);{var Un=ae=>{var he=u0();he.__click=Le=>v(d(te).task_id,Le),b(ae,he)};M(dn,ae=>{d(te).status==="PAUSED"&&ae(Un)})}var zn=y(dn,2);{var nr=ae=>{var he=c0();he.__click=Le=>m(d(te).task_id,d(te).patch_id,Le),b(ae,he)};M(zn,ae=>{d(te).patch_id&&ae(nr)})}P((ae,he)=>{xe=Ee(_e,1,"task-row svelte-1l2utx3",null,xe,{expanded:d(s)===d(te).task_id,"task-running":d(te).status==="RUNNING"}),N(Mn,ae),N(Je,he)},[()=>d(te).description??`Task ${d(te).task_id.slice(0,8)}`,()=>d(te).task_id.slice(0,8)]),b(It,_e)}),b(ge,Ge)};M(we,ge=>{d(a).length>0&&ge(ot)})}var Ne=y(we,2);{var jt=ge=>{var Ge=A0(),Pt=g(Ge),It=y(g(Pt),2);{var te=xe=>{var X=v0(),Qe=g(X);P(()=>N(Qe,`${d(l)??""} active`)),b(xe,X)};M(It,xe=>{d(l)>0&&xe(te)})}var _e=y(Pt,2);Me(_e,21,()=>d(i),xe=>xe.task_id,(xe,X)=>{var Qe=T0();let Zt;Qe.__click=()=>c(d(X).task_id),Qe.__keydown=J=>J.key==="Enter"&&c(d(X).task_id);var Mn=g(Qe),Pn=g(Mn),ln=g(Pn),me=g(ln),Je=y(ln,2);{let J=ue(()=>u(d(X).status));ft(Je,{variant:"ghost",size:"small",get class(){return d(J)},children:(ie,Ie)=>{var $e=tt();P(()=>N($e,d(X).status)),b(ie,$e)},$$slots:{default:!0}})}var gt=y(Pn,2),Xt=g(gt),Ln=g(Xt),Dn=y(Xt,2);{var _t=J=>{var ie=h0(),Ie=g(ie);P(()=>N(Ie,`P${d(X).priority??""}`)),b(J,ie)};M(Dn,J=>{d(X).priority!==0&&J(_t)})}var er=y(Dn,2);{var un=J=>{var ie=p0(),Ie=g(ie);P($e=>N(Ie,$e),[()=>k(d(X).updated_at)]),b(J,ie)};M(er,J=>{d(X).updated_at&&J(un)})}var Gt=y(gt,2);{var cn=J=>{var ie=_0(),Ie=g(ie),$e=g(Ie),ut=g($e),vn=y($e,2);{var hn=ar=>{var Cs=g0(),Ct=g(Cs);P(Kt=>N(Ct,`${Kt??""}%`),[()=>_(d(X).progress)]),b(ar,Cs)};M(vn,ar=>{_(d(X).progress)&&ar(hn)})}var jn=y(Ie,2),ts=g(jn);P(ar=>{N(ut,d(X).progress.label??"Progress"),fi(ts,ar)},[()=>`width: ${_(d(X).progress)??0}%`]),b(J,ie)};M(Gt,J=>{d(X).progress&&J(cn)})}var $n=y(Gt,2);{var tr=J=>{var ie=S0(),Ie=g(ie);{var $e=Ct=>{var Kt=m0(),ns=y(g(Kt),2),rs=g(ns);P(Ga=>N(rs,`${Ga??""}...`),[()=>d(X).trace_id.slice(0,12)]),b(Ct,Kt)};M(Ie,Ct=>{d(X).trace_id&&Ct($e)})}var ut=y(Ie,2),vn=y(g(ut),2),hn=g(vn),jn=y(ut,2);{var ts=Ct=>{var Kt=y0(),ns=y(g(Kt),2),rs=g(ns);P(()=>N(rs,d(X).error)),b(Ct,Kt)};M(jn,Ct=>{d(X).error&&Ct(ts)})}var ar=y(jn,2);{var Cs=Ct=>{var Kt=b0(),ns=y(g(Kt),2),rs=g(ns);P((Ga,$d)=>N(rs,`${Ga??""}${$d??""}`),[()=>JSON.stringify(d(X).result).slice(0,240),()=>JSON.stringify(d(X).result).length>240?"...":""]),b(Ct,Kt)};M(ar,Ct=>{d(X).result&&Ct(Cs)})}P(()=>N(hn,d(X).priority)),b(J,ie)};M($n,J=>{d(s)===d(X).task_id&&J(tr)})}var dn=y(Mn,2),Un=g(dn),zn=g(Un);zn.__click=J=>p(d(X).task_id,1,J);var nr=y(zn,2);nr.__click=J=>p(d(X).task_id,-1,J);var ae=y(Un,2);{var he=J=>{var ie=w0();ie.__click=Ie=>f(d(X).task_id,Ie),b(J,ie)};M(ae,J=>{(d(X).status==="RUNNING"||d(X).status==="PAUSED")&&J(he)})}var Le=y(ae,2);{var mt=J=>{var ie=k0();ie.__click=Ie=>h(d(X).task_id,Ie),b(J,ie)};M(Le,J=>{d(X).status==="RUNNING"&&J(mt)})}var fn=y(Le,2);{var rr=J=>{var ie=E0();ie.__click=Ie=>v(d(X).task_id,Ie),b(J,ie)};M(fn,J=>{d(X).status==="PAUSED"&&J(rr)})}var sr=y(fn,2);{var yt=J=>{var ie=x0();ie.__click=Ie=>m(d(X).task_id,d(X).patch_id,Ie),b(J,ie)};M(sr,J=>{d(X).patch_id&&J(yt)})}P((J,ie)=>{Zt=Ee(Qe,1,"task-row svelte-1l2utx3",null,Zt,{expanded:d(s)===d(X).task_id,"task-running":d(X).status==="RUNNING","task-paused":d(X).status==="PAUSED"}),N(me,J),N(Ln,ie)},[()=>d(X).description??`Task ${d(X).task_id.slice(0,8)}`,()=>d(X).task_id.slice(0,8)]),b(xe,Qe)}),b(ge,Ge)};M(Ne,ge=>{d(i).length>0&&ge(jt)})}b(ee,re)};M(B,ee=>{n.count===0?ee(q):ee(Q,!1)})}b(S,T)},$$slots:{default:!0}}),le()}Tt(["click","keydown"]);var R0=E('<p class="no-notifications svelte-1a2fxqj">No notifications yet.</p>'),O0=E('<button type="button" class="notification-btn svelte-1a2fxqj"> </button>'),M0=E('<div class="notification-actions svelte-1a2fxqj"></div>'),P0=E('<div><div class="notification-message svelte-1a2fxqj"> </div> <time class="notification-time svelte-1a2fxqj"> </time> <!> <button type="button" class="notification-dismiss svelte-1a2fxqj" aria-label="Dismiss notification">Dismiss</button></div>'),L0=E('<div class="notifications-list svelte-1a2fxqj"></div>'),D0=E('<div class="notifications-header svelte-1a2fxqj"><h3 class="notifications-title svelte-1a2fxqj">Notifications</h3></div> <div class="notifications-body svelte-1a2fxqj"><!></div>',1);function $0(e,t){oe(t,!1);const n=mh(),r=Ar();function s(i){return`level-${i}`}async function a(i){if(i.id==="apply_context_patch"){const o=i.payload?.patch_id;o&&await Ec(r.sessionId,o,"apply")}}At(),On(e,{class:"notifications-card",children:(i,o)=>{var l=D0(),u=y(ne(l),2),c=g(u);{var f=v=>{var p=R0();b(v,p)},h=v=>{var p=L0();Me(p,5,()=>n.items,m=>m.id,(m,_)=>{var k=P0(),S=g(k),w=g(S),T=y(S,2),C=g(T),A=y(T,2);{var R=$=>{var I=M0();Me(I,5,()=>d(_).actions,qr,(j,B)=>{var q=O0();q.__click=()=>a(d(B));var Q=g(q);P(()=>N(Q,d(B).label)),b(j,q)}),b($,I)};M(A,$=>{d(_).actions&&d(_).actions.length>0&&$(R)})}var U=y(A,2);U.__click=()=>n.remove(d(_).id),P(($,I)=>{Ee(k,1,`notification-row ${$??""}`,"svelte-1a2fxqj"),N(w,d(_).message),et(T,"datetime",d(_).ts),N(C,I)},[()=>s(d(_).level),()=>new Date(d(_).ts).toLocaleTimeString()]),b(m,k)}),b(v,p)};M(c,v=>{n.items.length===0?v(f):v(h,!1)})}b(i,l)},$$slots:{default:!0}}),le()}Tt(["click"]);var U0=E("<!> <!> <!> <!>",1);function z0(e){ko(e,{position:"right",children:(t,n)=>{var r=U0(),s=ne(r);$0(s,{});var a=y(s,2);Pd(a);var i=y(a,2);N0(i,{});var o=y(i,2);Ld(o,{}),b(t,r)},$$slots:{default:!0}})}var j0=E('<div class="tile svelte-9qt9q6"><div class="tile-label svelte-9qt9q6"> </div> <div class="tile-value svelte-9qt9q6"> </div></div>'),G0=E('<div class="section svelte-9qt9q6"><div class="section-label svelte-9qt9q6">Planner Config</div> <div class="tile-grid svelte-9qt9q6"></div></div>');function B0(e,t){oe(t,!1);const n=Qr();At();var r=G0(),s=y(g(r),2);Me(s,5,()=>n.plannerConfig,a=>a.label,(a,i)=>{var o=j0(),l=g(o),u=g(l),c=y(l,2),f=g(c);P(()=>{N(u,d(i).label),N(f,d(i).value)}),b(a,o)}),b(e,r),le()}var F0=E('<div class="service-row svelte-k5f3xe"><div><div class="service-name svelte-k5f3xe"> </div> <div class="muted tiny svelte-k5f3xe"> </div></div> <!></div>');function V0(e,t){oe(t,!0);var n=F0(),r=g(n),s=g(r),a=g(s),i=y(s,2),o=g(i),l=y(r,2);{let u=ue(()=>t.service.status==="enabled"?"subtle":"ghost");ft(l,{get variant(){return d(u)},size:"small",children:(c,f)=>{var h=tt();P(()=>N(h,t.service.status)),b(c,h)},$$slots:{default:!0}})}P(()=>{N(a,t.service.name),N(o,t.service.url||"not configured")}),b(e,n),le()}var q0=E('<div class="section svelte-1eltd2"><div class="section-label svelte-1eltd2">Services</div> <!></div>');function H0(e,t){oe(t,!1);const n=Qr();At();var r=q0(),s=y(g(r),2);Me(s,1,()=>n.services,a=>a.name,(a,i)=>{V0(a,{get service(){return d(i)}})}),b(e,r),le()}var Z0=E('<div class="tool-row svelte-8lkzhn"><div><div class="tool-name svelte-8lkzhn"> </div> <div class="muted tiny svelte-8lkzhn"> </div></div> <div class="tag-row svelte-8lkzhn"></div></div>');function X0(e,t){oe(t,!0);var n=Z0(),r=g(n),s=g(r),a=g(s),i=y(s,2),o=g(i),l=y(r,2);Me(l,23,()=>t.tool.tags,(u,c)=>`${t.tool.name}-${c}`,(u,c)=>{ft(u,{variant:"ghost",size:"small",children:(f,h)=>{var v=tt();P(()=>N(v,d(c))),b(f,v)},$$slots:{default:!0}})}),P(()=>{N(a,t.tool.name),N(o,t.tool.desc)}),b(e,n),le()}var K0=E('<div class="section svelte-njx06l"><div class="section-label svelte-njx06l">Tool Catalog</div> <!></div>');function J0(e,t){oe(t,!1);const n=Qr();At();var r=K0(),s=y(g(r),2);Me(s,1,()=>n.catalog,a=>a.name,(a,i)=>{X0(a,{get tool(){return d(i)}})}),b(e,r),le()}var Y0=E('<div class="title-small svelte-kxiy41">Config & Catalog</div> <!> <!> <!>',1);function au(e){On(e,{class:"config-card",children:(t,n)=>{var r=Y0(),s=y(ne(r),2);B0(s,{});var a=y(s,2);H0(a,{});var i=y(a,2);J0(i,{}),b(t,r)},$$slots:{default:!0}})}var W0=E('<button type="button"> </button>'),Q0=E('<div class="drawer svelte-1g84vkc"><div class="drawer-tabs svelte-1g84vkc"></div> <div class="drawer-content svelte-1g84vkc"><!></div></div>'),eS=E('<button type="button" class="backdrop svelte-1g84vkc" aria-label="Close menu"></button>'),tS=E('<header class="mobile-header svelte-1g84vkc"><div class="header-bar svelte-1g84vkc"><button type="button" class="menu-btn svelte-1g84vkc" aria-label="Toggle menu"><span><span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span> <span class="svelte-1g84vkc"></span></span></button> <h1 class="agent-name svelte-1g84vkc"> </h1> <div class="header-spacer svelte-1g84vkc"></div></div> <!></header> <!>',1);function nS(e,t){oe(t,!0);const n=Qr();let r=G(!1),s=G("info");const a=[{id:"info",label:"Info"},{id:"spec",label:"Spec"},{id:"config",label:"Config"}],i=()=>{x(r,!1)};var o=tS(),l=ne(o),u=g(l),c=g(u);c.__click=()=>x(r,!d(r));var f=g(c);let h;var v=y(c,2),p=g(v),m=y(u,2);{var _=w=>{var T=Q0(),C=g(T);Me(C,21,()=>a,I=>I.id,(I,j)=>{var B=W0();let q;B.__click=()=>x(s,d(j).id,!0);var Q=g(B);P(()=>{q=Ee(B,1,"drawer-tab svelte-1g84vkc",null,q,{active:d(s)===d(j).id}),N(Q,d(j).label)}),b(I,B)});var A=y(C,2),R=g(A);{var U=I=>{var j=Ze(),B=ne(j);kt(B,()=>t.infoContent??Ke),b(I,j)},$=I=>{var j=Ze(),B=ne(j);{var q=ee=>{var re=Ze(),we=ne(re);kt(we,()=>t.specContent??Ke),b(ee,re)},Q=ee=>{var re=Ze(),we=ne(re);kt(we,()=>t.configContent??Ke),b(ee,re)};M(B,ee=>{d(s)==="spec"?ee(q):ee(Q,!1)},!0)}b(I,j)};M(R,I=>{d(s)==="info"?I(U):I($,!1)})}b(w,T)};M(m,w=>{d(r)&&w(_)})}var k=y(l,2);{var S=w=>{var T=eS();T.__click=i,b(w,T)};M(k,w=>{d(r)&&w(S)})}P(()=>{h=Ee(f,1,"hamburger svelte-1g84vkc",null,h,{open:d(r)}),N(p,n.meta.name)}),b(e,o),le()}Tt(["click"]);var rS=E('<button type="button"> </button>'),sS=E('<div class="panel-tabs svelte-1wcjmjk"></div> <div class="panel-content svelte-1wcjmjk"><!></div>',1),aS=E('<div><button type="button" class="toggle-bar svelte-1wcjmjk"><div class="toggle-handle svelte-1wcjmjk"></div> <span class="toggle-label svelte-1wcjmjk"> </span></button> <!></div>');function iS(e,t){let n=G(!1),r=G("trajectory");const s=[{id:"trajectory",label:"Steps"},{id:"events",label:"Events"},{id:"artifacts",label:"Artifacts"}];var a=aS();let i;var o=g(a);o.__click=()=>x(n,!d(n));var l=y(g(o),2),u=g(l),c=y(o,2);{var f=h=>{var v=sS(),p=ne(v);Me(p,21,()=>s,w=>w.id,(w,T)=>{var C=rS();let A;C.__click=()=>x(r,d(T).id,!0);var R=g(C);P(()=>{A=Ee(C,1,"panel-tab svelte-1wcjmjk",null,A,{active:d(r)===d(T).id}),N(R,d(T).label)}),b(w,C)});var m=y(p,2),_=g(m);{var k=w=>{var T=Ze(),C=ne(T);kt(C,()=>t.trajectoryContent??Ke),b(w,T)},S=w=>{var T=Ze(),C=ne(T);{var A=U=>{var $=Ze(),I=ne($);kt(I,()=>t.eventsContent??Ke),b(U,$)},R=U=>{var $=Ze(),I=ne($);kt(I,()=>t.artifactsContent??Ke),b(U,$)};M(C,U=>{d(r)==="events"?U(A):U(R,!1)},!0)}b(w,T)};M(_,w=>{d(r)==="trajectory"?w(k):w(S,!1)})}b(h,v)};M(c,h=>{d(n)&&h(f)})}P(()=>{i=Ee(a,1,"bottom-panel svelte-1wcjmjk",null,i,{open:d(n)}),et(o,"aria-label",d(n)?"Hide details panel":"Show details panel"),et(o,"aria-expanded",d(n)),N(u,d(n)?"Hide Details":"Show Details")}),b(e,a)}Tt(["click"]);var oS=E('<div class="mobile-layout svelte-1n46o8q"><!> <main class="mobile-main svelte-1n46o8q"><!></main> <!></div>'),lS=E("<!> <!> <!>",1),uS=E("<!> <!> <!>",1);function cS(e,t){oe(t,!0);const n=yh(),{sessionStore:r,chatStore:s,trajectoryStore:a,agentStore:i,specStore:o,setupStore:l,componentRegistryStore:u,interactionsStore:c}=n,f=y_(n),h=k_(n),v=T_(n);let p=G(null),m=G(void 0),_=G(void 0),k=G(!1);const S=()=>{x(k,window.innerWidth<=1200)};gr(()=>{s.messages.length;const I=s.messages.find(j=>j.isStreaming);I&&`${I.text}${I.observations??""}`,d(p)&&requestAnimationFrame(()=>{d(p)&&(d(p).scrollTop=d(p).scrollHeight)})}),ac(()=>(S(),window.addEventListener("resize",S),w(),()=>{window.removeEventListener("resize",S),f.close(),h.close(),v.close()})),gr(()=>{const I=r.sessionId;I&&v.start(I)});const w=async()=>{const[I,j,B]=await Promise.all([Sh(),kh(),wh()]);I&&i.setFromResponse(I),j&&o.setFromSpecData(j),B&&u.setFromPayload(B)},T=()=>{const I=s.input.trim();if(!I||r.isSending)return;l.clearError();const j=l.parseContexts();if(!j){d(k)?d(_)?.switchToSetup():d(m)?.switchToSetup();return}const{toolContext:B,llmContext:q}=j;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),s.addUserMessage(I),s.clearInput(),f.start(I,r.sessionId,B,q,{onDone:async Q=>{if(r.activeTraceId=Q,Q){const ee=await Vo(Q,r.sessionId);ee&&r.activeTraceId===Q&&a.setFromPayload(ee),h.start(Q,r.sessionId)}r.isSending=!1},onError:()=>{r.isSending=!1}},l.useAgui?"agui":"sse")},C=(I,j)=>{if(!l.useAgui){l.error="Interactive components require AG-UI streaming.";return}if(!I.resume_token){l.error="Cannot submit: session expired or interrupted. Please resend your message.",c.clearPendingInteraction();return}const B=l.parseContexts();if(!B){d(k)?d(_)?.switchToSetup():d(m)?.switchToSetup();return}const{toolContext:q}=B;r.isSending=!0,a.clearArtifacts(),c.clearPendingInteraction(),f.resumeAgui(I,j,r.sessionId,q,{onDone:async Q=>{if(r.activeTraceId=Q,Q){const ee=await Vo(Q,r.sessionId);ee&&r.activeTraceId===Q&&a.setFromPayload(ee),h.start(Q,r.sessionId)}r.isSending=!1},onError:Q=>{l.error=Q||"Failed to submit response. Please try again.",r.isSending=!1}})};var A=Ze(),R=ne(A);{var U=I=>{var j=oS(),B=g(j);nS(B,{infoContent:Ne=>{nu(Ne,{})},specContent:Ne=>{ru(Ne,{})},configContent:Ne=>{au(Ne)},$$slots:{infoContent:!0,specContent:!0,configContent:!0}});var q=y(B,2),Q=g(q);ys(Od(Q,{onSendChat:T,onInteractionResult:C,get chatBodyEl(){return d(p)},set chatBodyEl(re){x(p,re,!0)}}),re=>x(_,re,!0),()=>d(_));var ee=y(q,2);iS(ee,{trajectoryContent:Ne=>{Md(Ne,{})},eventsContent:Ne=>{Pd(Ne)},artifactsContent:Ne=>{Ld(Ne,{})}}),b(I,j)},$=I=>{vm(I,{children:(j,B)=>{var q=uS(),Q=ne(q);hm(Q,{children:(we,ot)=>{var Ne=lS(),jt=ne(Ne);nu(jt,{});var ge=y(jt,2);ru(ge,{});var Ge=y(ge,2);au(Ge),b(we,Ne)}});var ee=y(Q,2);ys(Tb(ee,{onSendChat:T,onInteractionResult:C,get chatBodyEl(){return d(p)},set chatBodyEl(we){x(p,we,!0)}}),we=>x(m,we,!0),()=>d(m));var re=y(ee,2);z0(re),b(j,q)}})};M(R,I=>{d(k)?I(U):I($,!1)})}b(e,A),le()}cm();const Dd=document.getElementById("app");if(!Dd)throw new Error("Missing #app element");Zf(cS,{target:Dd});export{ne as A,ec as B,vS as C,Ze as D,zv as E,et as F,ji as G,ac as H,Se as I,Xi as J,ke as K,Pf as L,Ds as M,iu as N,fS as O,Af as P,Ts as Q,Vf as R,cv as S,pS as T,ys as U,gS as V,qe as _,We as a,je as b,ue as c,x as d,g as e,E as f,d as g,y as h,M as i,Me as j,fi as k,Ee as l,N as m,b as n,qr as o,oe as p,hS as q,le as r,G as s,P as t,gr as u,as as v,lr as w,Tt as x,Fd as y,tt as z};
