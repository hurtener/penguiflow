(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Hs=!1;var Po=Array.isArray,qu=Array.prototype.indexOf,xa=Array.from,Lo=Object.defineProperty,In=Object.getOwnPropertyDescriptor,$o=Object.getOwnPropertyDescriptors,Xu=Object.prototype,Ku=Array.prototype,Ta=Object.getPrototypeOf,si=Object.isExtensible;const Se=()=>{};function Ju(t){return t()}function Zs(t){for(var e=0;e<t.length;e++)t[e]()}function Do(){var t,e,n=new Promise((r,s)=>{t=r,e=s});return{promise:n,resolve:t,reject:e}}function Wu(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const n=[];for(const r of t)if(n.push(r),n.length===e)break;return n}const Le=2,Aa=4,bs=8,Yu=1<<24,Gt=16,Bt=32,gn=64,ws=128,gt=512,Re=1024,Je=2048,Tt=4096,et=8192,Pt=16384,Ia=32768,on=65536,ai=1<<17,Uo=1<<18,Bn=1<<19,zo=1<<20,ln=32768,qs=1<<21,Ca=1<<22,Ht=1<<23,tn=Symbol("$state"),Qu=Symbol("legacy props"),ec=Symbol(""),Tn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Go(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function tc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function nc(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function rc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function sc(t){throw new Error("https://svelte.dev/e/effect_orphan")}function ac(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ic(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function oc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function lc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function uc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function cc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Bo=1,Fo=2,Vo=4,dc=8,fc=16,hc=1,vc=2,pc=4,gc=8,mc=16,_c=1,yc=2,$e=Symbol(),bc="http://www.w3.org/1999/xhtml";function wc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function jo(t){return t===this.v}function Ho(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Zo(t){return!Ho(t,this.v)}let Fn=!1,Ec=!1;function kc(){Fn=!0}let fe=null;function On(t){fe=t}function Sc(t){return qo().get(t)}function xc(t,e){return qo().set(t,e),e}function W(t,e=!1,n){fe={p:fe,i:!1,c:null,e:null,s:t,x:null,l:Fn&&!e?{s:null,u:null,$:[]}:null}}function Y(t){var e=fe,n=e.e;if(n!==null){e.e=null;for(var r of n)ul(r)}return t!==void 0&&(e.x=t),e.i=!0,fe=e.p,t??{}}function Vn(){return!Fn||fe!==null&&fe.l===null}function qo(t){return fe===null&&Go(),fe.c??=new Map(Tc(fe)||void 0)}function Tc(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}let en=[];function Xo(){var t=en;en=[],Zs(t)}function jn(t){if(en.length===0&&!ar){var e=en;queueMicrotask(()=>{e===en&&Xo()})}en.push(t)}function Ac(){for(;en.length>0;)Xo()}function Ko(t){var e=ae;if(e===null)return ee.f|=Ht,t;if((e.f&Ia)===0){if((e.f&ws)===0)throw t;e.b.error(t)}else Mn(t,e)}function Mn(t,e){for(;e!==null;){if((e.f&ws)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t}const yr=new Set;let le=null,xr=null,ot=null,st=[],Es=null,Xs=!1,ar=!1;class yt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#l=null;#a=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(e){st=[],xr=null,this.apply();var n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const r of e)this.#i(r,n);this.is_fork||this.#c(),this.is_deferred()?(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects)):(xr=this,le=null,ii(n.render_effects),ii(n.effects),xr=null,this.#l?.resolve()),ot=null}#i(e,n){e.f^=Re;for(var r=e.first;r!==null;){var s=r.f,a=(s&(Bt|gn))!==0,i=a&&(s&Re)!==0,o=i||(s&et)!==0||this.skipped_effects.has(r);if((r.f&ws)!==0&&r.b?.is_pending()&&(n={parent:n,effect:r,effects:[],render_effects:[],block_effects:[]}),!o&&r.fn!==null){a?r.f^=Re:(s&Aa)!==0?n.effects.push(r):Hn(r)&&((r.f&Gt)!==0&&n.block_effects.push(r),Ln(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===n.effect&&(this.#o(n.effects),this.#o(n.render_effects),this.#o(n.block_effects),n=n.parent),r=u.next,u=u.parent}}#o(e){for(const n of e)((n.f&Je)!==0?this.#a:this.#s).push(n),this.#u(n.deps),Me(n,Re)}#u(e){if(e!==null)for(const n of e)(n.f&Le)===0||(n.f&ln)===0||(n.f^=ln,this.#u(n.deps))}capture(e,n){this.previous.has(e)||this.previous.set(e,n),(e.f&Ht)===0&&(this.current.set(e,e.v),ot?.set(e,e.v))}activate(){le=this,this.apply()}deactivate(){le===this&&(le=null,ot=null)}flush(){if(this.activate(),st.length>0){if(Jo(),le!==null&&le!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#t)e(this);this.#t.clear()}#c(){if(this.#n===0){for(const e of this.#e)e();this.#e.clear()}this.#r===0&&this.#d()}#d(){if(yr.size>1){this.previous.clear();var e=ot,n=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of yr){if(a===this){n=!1;continue}const i=[];for(const[l,u]of this.current){if(a.current.has(l))if(n&&u!==a.current.get(l))a.current.set(l,u);else continue;i.push(l)}if(i.length===0)continue;const o=[...a.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var s=st;st=[];const l=new Set,u=new Map;for(const c of i)Wo(c,o,l,u);if(st.length>0){le=a,a.apply();for(const c of st)a.#i(c,r);a.deactivate()}st=s}}le=null,ot=e}this.committed=!0,yr.delete(this)}increment(e){this.#r+=1,e&&(this.#n+=1)}decrement(e){this.#r-=1,e&&(this.#n-=1),this.revive()}revive(){for(const e of this.#a)Me(e,Je),un(e);for(const e of this.#s)Me(e,Tt),un(e);this.#a=[],this.#s=[],this.flush()}oncommit(e){this.#e.add(e)}ondiscard(e){this.#t.add(e)}settled(){return(this.#l??=Do()).promise}static ensure(){if(le===null){const e=le=new yt;yr.add(le),ar||yt.enqueue(()=>{le===e&&e.flush()})}return le}static enqueue(e){jn(e)}apply(){}}function Ic(t){var e=ar;ar=!0;try{for(var n;;){if(Ac(),st.length===0&&(le?.flush(),st.length===0))return Es=null,n;Jo()}}finally{ar=e}}function Jo(){var t=nn;Xs=!0;var e=null;try{var n=0;for(es(!0);st.length>0;){var r=yt.ensure();if(n++>1e3){var s,a;Cc()}r.process(st),Zt.clear()}}finally{Xs=!1,es(t),Es=null}}function Cc(){try{ac()}catch(t){Mn(t,Es)}}let Ot=null;function ii(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var r=t[n++];if((r.f&(Pt|et))===0&&Hn(r)&&(Ot=new Set,Ln(r),r.deps===null&&r.first===null&&r.nodes===null&&(r.teardown===null&&r.ac===null?pl(r):r.fn=null),Ot?.size>0)){Zt.clear();for(const s of Ot){if((s.f&(Pt|et))!==0)continue;const a=[s];let i=s.parent;for(;i!==null;)Ot.has(i)&&(Ot.delete(i),a.push(i)),i=i.parent;for(let o=a.length-1;o>=0;o--){const l=a[o];(l.f&(Pt|et))===0&&Ln(l)}}Ot.clear()}}Ot=null}}function Wo(t,e,n,r){if(!n.has(t)&&(n.add(t),t.reactions!==null))for(const s of t.reactions){const a=s.f;(a&Le)!==0?Wo(s,e,n,r):(a&(Ca|Gt))!==0&&(a&Je)===0&&Yo(s,e,r)&&(Me(s,Je),un(s))}}function Yo(t,e,n){const r=n.get(t);if(r!==void 0)return r;if(t.deps!==null)for(const s of t.deps){if(e.includes(s))return!0;if((s.f&Le)!==0&&Yo(s,e,n))return n.set(s,!0),!0}return n.set(t,!1),!1}function un(t){for(var e=Es=t;e.parent!==null;){e=e.parent;var n=e.f;if(Xs&&e===ae&&(n&Gt)!==0&&(n&Uo)===0)return;if((n&(gn|Bt))!==0){if((n&Re)===0)return;e.f^=Re}}st.push(e)}function Nc(t){let e=0,n=Xt(0),r;return()=>{lr()&&(y(n),mn(()=>(e===0&&(r=ie(()=>t(()=>ir(n)))),e+=1,()=>{jn(()=>{e-=1,e===0&&(r?.(),r=void 0,ir(n))})})))}}var Rc=on|Bn|ws;function Oc(t,e,n){new Mc(t,e,n)}class Mc{parent;#e=!1;#t;#r=null;#n;#l;#a;#s=null;#i=null;#o=null;#u=null;#c=null;#d=0;#f=0;#v=!1;#h=null;#y=Nc(()=>(this.#h=Xt(this.#d),()=>{this.#h=null}));constructor(e,n,r){this.#t=e,this.#n=n,this.#l=r,this.parent=ae.b,this.#e=!!this.#n.pending,this.#a=gr(()=>{ae.b=this;{var s=this.#m();try{this.#s=at(()=>r(s))}catch(a){this.error(a)}this.#f>0?this.#g():this.#e=!1}return()=>{this.#c?.remove()}},Rc)}#b(){try{this.#s=at(()=>this.#l(this.#t))}catch(e){this.error(e)}this.#e=!1}#w(){const e=this.#n.pending;e&&(this.#i=at(()=>e(this.#t)),yt.enqueue(()=>{var n=this.#m();this.#s=this.#p(()=>(yt.ensure(),at(()=>this.#l(n)))),this.#f>0?this.#g():(Cn(this.#i,()=>{this.#i=null}),this.#e=!1)}))}#m(){var e=this.#t;return this.#e&&(this.#c=Dt(),this.#t.before(this.#c),e=this.#c),e}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(e){var n=ae,r=ee,s=fe;kt(this.#a),qe(this.#a),On(this.#a.ctx);try{return e()}catch(a){return Ko(a),null}finally{kt(n),qe(r),On(s)}}#g(){const e=this.#n.pending;this.#s!==null&&(this.#u=document.createDocumentFragment(),this.#u.append(this.#c),_l(this.#s,this.#u)),this.#i===null&&(this.#i=at(()=>e(this.#t)))}#_(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(e);return}this.#f+=e,this.#f===0&&(this.#e=!1,this.#i&&Cn(this.#i,()=>{this.#i=null}),this.#u&&(this.#t.before(this.#u),this.#u=null))}update_pending_count(e){this.#_(e),this.#d+=e,this.#h&&Pn(this.#h,this.#d)}get_effect_pending(){return this.#y(),y(this.#h)}error(e){var n=this.#n.onerror;let r=this.#n.failed;if(this.#v||!n&&!r)throw e;this.#s&&(Xe(this.#s),this.#s=null),this.#i&&(Xe(this.#i),this.#i=null),this.#o&&(Xe(this.#o),this.#o=null);var s=!1,a=!1;const i=()=>{if(s){wc();return}s=!0,a&&cc(),yt.ensure(),this.#d=0,this.#o!==null&&Cn(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#v=!1,at(()=>this.#l(this.#t)))),this.#f>0?this.#g():this.#e=!1};var o=ee;try{qe(null),a=!0,n?.(e,i),a=!1}catch(l){Mn(l,this.#a&&this.#a.parent)}finally{qe(o)}r&&jn(()=>{this.#o=this.#p(()=>{yt.ensure(),this.#v=!0;try{return at(()=>{r(this.#t,()=>e,()=>i)})}catch(l){return Mn(l,this.#a.parent),null}finally{this.#v=!1}})})}}function Pc(t,e,n,r){const s=Vn()?vr:ks;if(n.length===0&&t.length===0){r(e.map(s));return}var a=le,i=ae,o=Lc();function l(){Promise.all(n.map(u=>$c(u))).then(u=>{o();try{r([...e.map(s),...u])}catch(c){(i.f&Pt)===0&&Mn(c,i)}a?.deactivate(),Yr()}).catch(u=>{Mn(u,i)})}t.length>0?Promise.all(t).then(()=>{o();try{return l()}finally{a?.deactivate(),Yr()}}):l()}function Lc(){var t=ae,e=ee,n=fe,r=le;return function(a=!0){kt(t),qe(e),On(n),a&&r?.activate()}}function Yr(){kt(null),qe(null),On(null)}function vr(t){var e=Le|Je,n=ee!==null&&(ee.f&Le)!==0?ee:null;return ae!==null&&(ae.f|=Bn),{ctx:fe,deps:null,effects:null,equals:jo,f:e,fn:t,reactions:null,rv:0,v:$e,wv:0,parent:n??ae,ac:null}}function $c(t,e){let n=ae;n===null&&tc();var r=n.b,s=void 0,a=Xt($e),i=!ee,o=new Map;return qc(()=>{var l=Do();s=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{u===le&&u.committed&&u.deactivate(),Yr()})}catch(v){l.reject(v),Yr()}var u=le;if(i){var c=!r.is_pending();r.update_pending_count(1),u.increment(c),o.get(u)?.reject(Tn),o.delete(u),o.set(u,l)}const f=(v,d=void 0)=>{if(u.activate(),d)d!==Tn&&(a.f|=Ht,Pn(a,d));else{(a.f&Ht)!==0&&(a.f^=Ht),Pn(a,v);for(const[h,p]of o){if(o.delete(h),h===u)break;p.reject(Tn)}}i&&(r.update_pending_count(-1),u.decrement(c))};l.promise.then(f,v=>f(null,v||"unknown"))}),Ts(()=>{for(const l of o.values())l.reject(Tn)}),new Promise(l=>{function u(c){function f(){c===s?l(a):u(s)}c.then(f,f)}u(s)})}function lt(t){const e=vr(t);return yl(e),e}function ks(t){const e=vr(t);return e.equals=Zo,e}function Qo(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Xe(e[n])}}function Dc(t){for(var e=t.parent;e!==null;){if((e.f&Le)===0)return(e.f&Pt)===0?e:null;e=e.parent}return null}function Na(t){var e,n=ae;kt(Dc(t));try{t.f&=~ln,Qo(t),e=kl(t)}finally{kt(n)}return e}function el(t){var e=Na(t);if(t.equals(e)||(le?.is_fork||(t.v=e),t.wv=wl()),!_n)if(ot!==null)(lr()||le?.is_fork)&&ot.set(t,e);else{var n=(t.f&gt)===0?Tt:Re;Me(t,n)}}let Ks=new Set;const Zt=new Map;let tl=!1;function Xt(t,e){var n={f:0,v:t,reactions:null,equals:jo,rv:0,wv:0};return n}function j(t,e){const n=Xt(t);return yl(n),n}function Ss(t,e=!1,n=!0){const r=Xt(t);return e||(r.equals=Zo),Fn&&n&&fe!==null&&fe.l!==null&&(fe.l.s??=[]).push(r),r}function Uc(t,e){return N(t,ie(()=>y(t))),e}function N(t,e,n=!1){ee!==null&&(!wt||(ee.f&ai)!==0)&&Vn()&&(ee.f&(Le|Gt|Ca|ai))!==0&&!Lt?.includes(t)&&uc();let r=n?Te(e):e;return Pn(t,r)}function Pn(t,e){if(!t.equals(e)){var n=t.v;_n?Zt.set(t,e):Zt.set(t,n),t.v=e;var r=yt.ensure();r.capture(t,n),(t.f&Le)!==0&&((t.f&Je)!==0&&Na(t),Me(t,(t.f&gt)!==0?Re:Tt)),t.wv=wl(),nl(t,Je),Vn()&&ae!==null&&(ae.f&Re)!==0&&(ae.f&(Bt|gn))===0&&(rt===null?Kc([t]):rt.push(t)),!r.is_fork&&Ks.size>0&&!tl&&zc()}return e}function zc(){tl=!1;var t=nn;es(!0);const e=Array.from(Ks);try{for(const n of e)(n.f&Re)!==0&&Me(n,Tt),Hn(n)&&Ln(n)}finally{es(t)}Ks.clear()}function ir(t){N(t,t.v+1)}function nl(t,e){var n=t.reactions;if(n!==null)for(var r=Vn(),s=n.length,a=0;a<s;a++){var i=n[a],o=i.f;if(!(!r&&i===ae)){var l=(o&Je)===0;if(l&&Me(i,e),(o&Le)!==0){var u=i;ot?.delete(u),(o&ln)===0&&(o&gt&&(i.f|=ln),nl(u,Tt))}else l&&((o&Gt)!==0&&Ot!==null&&Ot.add(i),un(i))}}}function Te(t){if(typeof t!="object"||t===null||tn in t)return t;const e=Ta(t);if(e!==Xu&&e!==Ku)return t;var n=new Map,r=Po(t),s=j(0),a=rn,i=o=>{if(rn===a)return o();var l=ee,u=rn;qe(null),ci(a);var c=o();return qe(l),ci(u),c};return r&&n.set("length",j(t.length)),new Proxy(t,{defineProperty(o,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&oc();var c=n.get(l);return c===void 0?c=i(()=>{var f=j(u.value);return n.set(l,f),f}):N(c,u.value,!0),!0},deleteProperty(o,l){var u=n.get(l);if(u===void 0){if(l in o){const c=i(()=>j($e));n.set(l,c),ir(s)}}else N(u,$e),ir(s);return!0},get(o,l,u){if(l===tn)return t;var c=n.get(l),f=l in o;if(c===void 0&&(!f||In(o,l)?.writable)&&(c=i(()=>{var d=Te(f?o[l]:$e),h=j(d);return h}),n.set(l,c)),c!==void 0){var v=y(c);return v===$e?void 0:v}return Reflect.get(o,l,u)},getOwnPropertyDescriptor(o,l){var u=Reflect.getOwnPropertyDescriptor(o,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=y(c))}else if(u===void 0){var f=n.get(l),v=f?.v;if(f!==void 0&&v!==$e)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return u},has(o,l){if(l===tn)return!0;var u=n.get(l),c=u!==void 0&&u.v!==$e||Reflect.has(o,l);if(u!==void 0||ae!==null&&(!c||In(o,l)?.writable)){u===void 0&&(u=i(()=>{var v=c?Te(o[l]):$e,d=j(v);return d}),n.set(l,u));var f=y(u);if(f===$e)return!1}return c},set(o,l,u,c){var f=n.get(l),v=l in o;if(r&&l==="length")for(var d=u;d<f.v;d+=1){var h=n.get(d+"");h!==void 0?N(h,$e):d in o&&(h=i(()=>j($e)),n.set(d+"",h))}if(f===void 0)(!v||In(o,l)?.writable)&&(f=i(()=>j(void 0)),N(f,Te(u)),n.set(l,f));else{v=f.v!==$e;var p=i(()=>Te(u));N(f,p)}var g=Reflect.getOwnPropertyDescriptor(o,l);if(g?.set&&g.set.call(c,u),!v){if(r&&typeof l=="string"){var m=n.get("length"),b=Number(l);Number.isInteger(b)&&b>=m.v&&N(m,b+1)}ir(s)}return!0},ownKeys(o){y(s);var l=Reflect.ownKeys(o).filter(f=>{var v=n.get(f);return v===void 0||v.v!==$e});for(var[u,c]of n)c.v!==$e&&!(u in o)&&l.push(u);return l},setPrototypeOf(){lc()}})}var oi,rl,sl,al;function Gc(){if(oi===void 0){oi=window,rl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;sl=In(e,"firstChild").get,al=In(e,"nextSibling").get,si(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),si(n)&&(n.__t=void 0)}}function Dt(t=""){return document.createTextNode(t)}function bt(t){return sl.call(t)}function pr(t){return al.call(t)}function w(t,e){return bt(t)}function ne(t,e=!1){{var n=bt(t);return n instanceof Comment&&n.data===""?pr(n):n}}function k(t,e=1,n=!1){let r=t;for(;e--;)r=pr(r);return r}function Bc(t){t.textContent=""}function il(){return!1}let li=!1;function Fc(){li||(li=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function xs(t){var e=ee,n=ae;qe(null),kt(null);try{return t()}finally{qe(e),kt(n)}}function ol(t,e,n,r=n){t.addEventListener(e,()=>xs(n));const s=t.__on_r;s?t.__on_r=()=>{s(),r(!0)}:t.__on_r=()=>r(!0),Fc()}function ll(t){ae===null&&(ee===null&&sc(),rc()),_n&&nc()}function Vc(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function At(t,e,n){var r=ae;r!==null&&(r.f&et)!==0&&(t|=et);var s={ctx:fe,deps:null,nodes:null,f:t|Je|gt,first:null,fn:e,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Ln(s),s.f|=Ia}catch(o){throw Xe(s),o}else e!==null&&un(s);var a=s;if(n&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&Bn)===0&&(a=a.first,(t&Gt)!==0&&(t&on)!==0&&a!==null&&(a.f|=on)),a!==null&&(a.parent=r,r!==null&&Vc(a,r),ee!==null&&(ee.f&Le)!==0&&(t&gn)===0)){var i=ee;(i.effects??=[]).push(a)}return s}function lr(){return ee!==null&&!wt}function Ts(t){const e=At(bs,null,!1);return Me(e,Re),e.teardown=t,e}function Qr(t){ll();var e=ae.f,n=!ee&&(e&Bt)!==0&&(e&Ia)===0;if(n){var r=fe;(r.e??=[]).push(t)}else return ul(t)}function ul(t){return At(Aa|zo,t,!1)}function jc(t){return ll(),At(bs|zo,t,!0)}function Hc(t){yt.ensure();const e=At(gn|Bn,t,!0);return(n={})=>new Promise(r=>{n.outro?Cn(e,()=>{Xe(e),r(void 0)}):(Xe(e),r(void 0))})}function Zc(t){return At(Aa,t,!1)}function cl(t,e){var n=fe,r={effect:null,ran:!1,deps:t};n.l.$.push(r),r.effect=mn(()=>{t(),!r.ran&&(r.ran=!0,ie(e))})}function dl(){var t=fe;mn(()=>{for(var e of t.l.$){e.deps();var n=e.effect;(n.f&Re)!==0&&Me(n,Tt),Hn(n)&&Ln(n),e.ran=!1}})}function qc(t){return At(Ca|Bn,t,!0)}function mn(t,e=0){return At(bs|e,t,!0)}function $(t,e=[],n=[],r=[]){Pc(r,e,n,s=>{At(bs,()=>t(...s.map(y)),!0)})}function gr(t,e=0){var n=At(Gt|e,t,!0);return n}function at(t){return At(Bt|Bn,t,!0)}function fl(t){var e=t.teardown;if(e!==null){const n=_n,r=ee;ui(!0),qe(null);try{e.call(null)}finally{ui(n),qe(r)}}}function hl(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){const s=n.ac;s!==null&&xs(()=>{s.abort(Tn)});var r=n.next;(n.f&gn)!==0?n.parent=null:Xe(n,e),n=r}}function Xc(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Bt)===0&&Xe(e),e=n}}function Xe(t,e=!0){var n=!1;(e||(t.f&Uo)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(vl(t.nodes.start,t.nodes.end),n=!0),hl(t,e&&!n),ts(t,0),Me(t,Pt);var r=t.nodes&&t.nodes.t;if(r!==null)for(const a of r)a.stop();fl(t);var s=t.parent;s!==null&&s.first!==null&&pl(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function vl(t,e){for(;t!==null;){var n=t===e?null:pr(t);t.remove(),t=n}}function pl(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function Cn(t,e,n=!0){var r=[];Ra(t,r,!0),gl(r,()=>{n&&Xe(t),e&&e()})}function gl(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var s of t)s.out(r)}else e()}function Ra(t,e,n){if((t.f&et)===0){t.f^=et;var r=t.nodes&&t.nodes.t;if(r!==null)for(const o of r)(o.is_global||n)&&e.push(o);for(var s=t.first;s!==null;){var a=s.next,i=(s.f&on)!==0||(s.f&Bt)!==0&&(t.f&Gt)!==0;Ra(s,e,i?n:!1),s=a}}}function Oa(t){ml(t,!0)}function ml(t,e){if((t.f&et)!==0){t.f^=et,(t.f&Re)===0&&(Me(t,Je),un(t));for(var n=t.first;n!==null;){var r=n.next,s=(n.f&on)!==0||(n.f&Bt)!==0;ml(n,s?e:!1),n=r}var a=t.nodes&&t.nodes.t;if(a!==null)for(const i of a)(i.is_global||e)&&i.in()}}function _l(t,e){if(t.nodes)for(var n=t.nodes.start,r=t.nodes.end;n!==null;){var s=n===r?null:pr(n);e.append(n),n=s}}let nn=!1;function es(t){nn=t}let _n=!1;function ui(t){_n=t}let ee=null,wt=!1;function qe(t){ee=t}let ae=null;function kt(t){ae=t}let Lt=null;function yl(t){ee!==null&&(Lt===null?Lt=[t]:Lt.push(t))}let Ge=null,Ye=0,rt=null;function Kc(t){rt=t}let bl=1,ur=0,rn=ur;function ci(t){rn=t}function wl(){return++bl}function Hn(t){var e=t.f;if((e&Je)!==0)return!0;if(e&Le&&(t.f&=~ln),(e&Tt)!==0){var n=t.deps;if(n!==null)for(var r=n.length,s=0;s<r;s++){var a=n[s];if(Hn(a)&&el(a),a.wv>t.wv)return!0}(e&gt)!==0&&ot===null&&Me(t,Re)}return!1}function El(t,e,n=!0){var r=t.reactions;if(r!==null&&!Lt?.includes(t))for(var s=0;s<r.length;s++){var a=r[s];(a.f&Le)!==0?El(a,e,!1):e===a&&(n?Me(a,Je):(a.f&Re)!==0&&Me(a,Tt),un(a))}}function kl(t){var e=Ge,n=Ye,r=rt,s=ee,a=Lt,i=fe,o=wt,l=rn,u=t.f;Ge=null,Ye=0,rt=null,ee=(u&(Bt|gn))===0?t:null,Lt=null,On(t.ctx),wt=!1,rn=++ur,t.ac!==null&&(xs(()=>{t.ac.abort(Tn)}),t.ac=null);try{t.f|=qs;var c=t.fn,f=c(),v=t.deps;if(Ge!==null){var d;if(ts(t,Ye),v!==null&&Ye>0)for(v.length=Ye+Ge.length,d=0;d<Ge.length;d++)v[Ye+d]=Ge[d];else t.deps=v=Ge;if(lr()&&(t.f&gt)!==0)for(d=Ye;d<v.length;d++)(v[d].reactions??=[]).push(t)}else v!==null&&Ye<v.length&&(ts(t,Ye),v.length=Ye);if(Vn()&&rt!==null&&!wt&&v!==null&&(t.f&(Le|Tt|Je))===0)for(d=0;d<rt.length;d++)El(rt[d],t);return s!==null&&s!==t&&(ur++,rt!==null&&(r===null?r=rt:r.push(...rt))),(t.f&Ht)!==0&&(t.f^=Ht),f}catch(h){return Ko(h)}finally{t.f^=qs,Ge=e,Ye=n,rt=r,ee=s,Lt=a,On(i),wt=o,rn=l}}function Jc(t,e){let n=e.reactions;if(n!==null){var r=qu.call(n,t);if(r!==-1){var s=n.length-1;s===0?n=e.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(e.f&Le)!==0&&(Ge===null||!Ge.includes(e))&&(Me(e,Tt),(e.f&gt)!==0&&(e.f^=gt,e.f&=~ln),Qo(e),ts(e,0))}function ts(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)Jc(t,n[r])}function Ln(t){var e=t.f;if((e&Pt)===0){Me(t,Re);var n=ae,r=nn;ae=t,nn=!0;try{(e&(Gt|Yu))!==0?Xc(t):hl(t),fl(t);var s=kl(t);t.teardown=typeof s=="function"?s:null,t.wv=bl;var a;Hs&&Ec&&(t.f&Je)!==0&&t.deps}finally{nn=r,ae=n}}}async function Wc(){await Promise.resolve(),Ic()}function y(t){var e=t.f,n=(e&Le)!==0;if(ee!==null&&!wt){var r=ae!==null&&(ae.f&Pt)!==0;if(!r&&!Lt?.includes(t)){var s=ee.deps;if((ee.f&qs)!==0)t.rv<ur&&(t.rv=ur,Ge===null&&s!==null&&s[Ye]===t?Ye++:Ge===null?Ge=[t]:Ge.includes(t)||Ge.push(t));else{(ee.deps??=[]).push(t);var a=t.reactions;a===null?t.reactions=[ee]:a.includes(ee)||a.push(ee)}}}if(_n){if(Zt.has(t))return Zt.get(t);if(n){var i=t,o=i.v;return((i.f&Re)===0&&i.reactions!==null||xl(i))&&(o=Na(i)),Zt.set(i,o),o}}else n&&(!ot?.has(t)||le?.is_fork&&!lr())&&(i=t,Hn(i)&&el(i),nn&&lr()&&(i.f&gt)===0&&Sl(i));if(ot?.has(t))return ot.get(t);if((t.f&Ht)!==0)throw t.v;return t.v}function Sl(t){if(t.deps!==null){t.f^=gt;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&Le)!==0&&(e.f&gt)===0&&Sl(e)}}function xl(t){if(t.v===$e)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Zt.has(e)||(e.f&Le)!==0&&xl(e))return!0;return!1}function ie(t){var e=wt;try{return wt=!0,t()}finally{wt=e}}const Yc=-7169;function Me(t,e){t.f=t.f&Yc|e}function Ze(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(tn in t)Js(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&tn in n&&Js(n)}}}function Js(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let r in t)try{Js(t[r],e)}catch{}const n=Ta(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=$o(n);for(let s in r){const a=r[s].get;if(a)try{a.call(t)}catch{}}}}}const Qc=["touchstart","touchmove"];function ed(t){return Qc.includes(t)}const Tl=new Set,Ws=new Set;function td(t,e,n,r={}){function s(a){if(r.capture||Qn.call(e,a),!a.cancelBubble)return xs(()=>n?.call(this,a))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?jn(()=>{e.addEventListener(t,s,r)}):e.addEventListener(t,s,r),s}function nd(t,e,n,r,s){var a={capture:r,passive:s},i=td(t,e,n,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Ts(()=>{e.removeEventListener(t,i,a)})}function It(t){for(var e=0;e<t.length;e++)Tl.add(t[e]);for(var n of Ws)n(t)}let di=null;function Qn(t){var e=this,n=e.ownerDocument,r=t.type,s=t.composedPath?.()||[],a=s[0]||t.target;di=t;var i=0,o=di===t&&t.__root;if(o){var l=s.indexOf(o);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=s.indexOf(e);if(u===-1)return;l<=u&&(i=l)}if(a=s[i]||t.target,a!==e){Lo(t,"currentTarget",{configurable:!0,get(){return a||n}});var c=ee,f=ae;qe(null),kt(null);try{for(var v,d=[];a!==null;){var h=a.assignedSlot||a.parentNode||a.host||null;try{var p=a["__"+r];p!=null&&(!a.disabled||t.target===a)&&p.call(a,t)}catch(g){v?d.push(g):v=g}if(t.cancelBubble||h===e||h===null)break;a=h}if(v){for(let g of d)queueMicrotask(()=>{throw g});throw v}}finally{t.__root=e,delete t.currentTarget,qe(c),kt(f)}}}function Ma(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function $n(t,e){var n=ae;n.nodes===null&&(n.nodes={start:t,end:e,a:null,t:null})}function A(t,e){var n=(e&_c)!==0,r=(e&yc)!==0,s,a=!t.startsWith("<!>");return()=>{s===void 0&&(s=Ma(a?t:"<!>"+t),n||(s=bt(s)));var i=r||rl?document.importNode(s,!0):s.cloneNode(!0);if(n){var o=bt(i),l=i.lastChild;$n(o,l)}else $n(i,i);return i}}function rd(t,e,n="svg"){var r=!t.startsWith("<!>"),s=`<${n}>${r?t:"<!>"+t}</${n}>`,a;return()=>{if(!a){var i=Ma(s),o=bt(i);a=bt(o)}var l=a.cloneNode(!0);return $n(l,l),l}}function sd(t,e){return rd(t,e,"svg")}function ze(t=""){{var e=Dt(t+"");return $n(e,e),e}}function Oe(){var t=document.createDocumentFragment(),e=document.createComment(""),n=Dt();return t.append(e,n),$n(e,n),t}function E(t,e){t!==null&&t.before(e)}function P(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??=t.nodeValue)&&(t.__t=n,t.nodeValue=n+"")}function ad(t,e){return id(t,e)}const bn=new Map;function id(t,{target:e,anchor:n,props:r={},events:s,context:a,intro:i=!0}){Gc();var o=new Set,l=f=>{for(var v=0;v<f.length;v++){var d=f[v];if(!o.has(d)){o.add(d);var h=ed(d);e.addEventListener(d,Qn,{passive:h});var p=bn.get(d);p===void 0?(document.addEventListener(d,Qn,{passive:h}),bn.set(d,1)):bn.set(d,p+1)}}};l(xa(Tl)),Ws.add(l);var u=void 0,c=Hc(()=>{var f=n??e.appendChild(Dt());return Oc(f,{pending:()=>{}},v=>{if(a){W({});var d=fe;d.c=a}s&&(r.$$events=s),u=t(v,r)||{},a&&Y()}),()=>{for(var v of o){e.removeEventListener(v,Qn);var d=bn.get(v);--d===0?(document.removeEventListener(v,Qn),bn.delete(v)):bn.set(v,d)}Ws.delete(l),f!==n&&f.parentNode?.removeChild(f)}});return od.set(u,c),u}let od=new WeakMap;class Pa{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#l=!0;constructor(e,n=!0){this.anchor=e,this.#l=n}#a=()=>{var e=le;if(this.#e.has(e)){var n=this.#e.get(e),r=this.#t.get(n);if(r)Oa(r),this.#n.delete(n);else{var s=this.#r.get(n);s&&(this.#t.set(n,s.effect),this.#r.delete(n),s.fragment.lastChild.remove(),this.anchor.before(s.fragment),r=s.effect)}for(const[a,i]of this.#e){if(this.#e.delete(a),a===e)break;const o=this.#r.get(i);o&&(Xe(o.effect),this.#r.delete(i))}for(const[a,i]of this.#t){if(a===n||this.#n.has(a))continue;const o=()=>{if(Array.from(this.#e.values()).includes(a)){var u=document.createDocumentFragment();_l(i,u),u.append(Dt()),this.#r.set(a,{effect:i,fragment:u})}else Xe(i);this.#n.delete(a),this.#t.delete(a)};this.#l||!r?(this.#n.add(a),Cn(i,o,!1)):o()}}};#s=e=>{this.#e.delete(e);const n=Array.from(this.#e.values());for(const[r,s]of this.#r)n.includes(r)||(Xe(s.effect),this.#r.delete(r))};ensure(e,n){var r=le,s=il();if(n&&!this.#t.has(e)&&!this.#r.has(e))if(s){var a=document.createDocumentFragment(),i=Dt();a.append(i),this.#r.set(e,{effect:at(()=>n(i)),fragment:a})}else this.#t.set(e,at(()=>n(this.anchor)));if(this.#e.set(r,e),s){for(const[o,l]of this.#t)o===e?r.skipped_effects.delete(l):r.skipped_effects.add(l);for(const[o,l]of this.#r)o===e?r.skipped_effects.delete(l.effect):r.skipped_effects.add(l.effect);r.oncommit(this.#a),r.ondiscard(this.#s)}else this.#a()}}function B(t,e,n=!1){var r=new Pa(t),s=n?on:0;function a(i,o){r.ensure(i,o)}gr(()=>{var i=!1;e((o,l=!0)=>{i=!0,a(l,o)}),i||a(!1,null)},s)}function ld(t,e,n){var r=new Pa(t),s=!Vn();gr(()=>{var a=e();s&&a!==null&&typeof a=="object"&&(a={}),r.ensure(a,n)})}function Al(t,e){return e}function ud(t,e,n){for(var r=[],s=e.length,a=0;a<s;a++)Ra(e[a].e,r,!0);gl(r,()=>{var i=r.length===0&&n!==null;if(i){var o=n,l=o.parentNode;Bc(l),l.append(o),t.items.clear(),dt(t,e[0].prev,e[s-1].next)}for(var u=0;u<s;u++){var c=e[u];i||(t.items.delete(c.k),dt(t,c.prev,c.next)),Xe(c.e,!i)}t.first===e[0]&&(t.first=e[0].prev)})}function Ie(t,e,n,r,s,a=null){var i=t,o=new Map,l=null,u=(e&Vo)!==0,c=(e&Bo)!==0,f=(e&Fo)!==0;if(u){var v=t;i=v.appendChild(Dt())}var d=null,h=ks(()=>{var x=n();return Po(x)?x:x==null?[]:xa(x)}),p,g=!0;function m(){cd(_,p,i,e,r),d!==null&&(p.length===0?(d.fragment?(i.before(d.fragment),d.fragment=null):Oa(d.effect),b.first=d.effect):Cn(d.effect,()=>{d=null}))}var b=gr(()=>{p=y(h);for(var x=p.length,I=new Set,R=le,H=null,q=il(),O=0;O<x;O+=1){var Z=p[O],Q=r(Z,O),ve=g?null:o.get(Q);ve?(c&&Pn(ve.v,Z),f&&Pn(ve.i,O),q&&R.skipped_effects.delete(ve.e)):(ve=dd(g?i:null,H,Z,Q,O,s,e,n),g&&(ve.o=!0,H===null?l=ve:H.next=ve,H=ve),o.set(Q,ve)),I.add(Q)}if(x===0&&a&&!d)if(g)d={fragment:null,effect:at(()=>a(i))};else{var _e=document.createDocumentFragment(),Ce=Dt();_e.append(Ce),d={fragment:_e,effect:at(()=>a(Ce))}}if(!g)if(q){for(const[nt,ct]of o)I.has(nt)||R.skipped_effects.add(ct.e);R.oncommit(m),R.ondiscard(()=>{})}else m();y(h)}),_={effect:b,items:o,first:l};g=!1}function cd(t,e,n,r,s){var a=(r&dc)!==0,i=e.length,o=t.items,l=t.first,u,c=null,f,v=[],d=[],h,p,g,m;if(a)for(m=0;m<i;m+=1)h=e[m],p=s(h,m),g=o.get(p),g.o&&(g.e.nodes?.a?.measure(),(f??=new Set).add(g));for(m=0;m<i;m+=1){if(h=e[m],p=s(h,m),g=o.get(p),t.first??=g,!g.o){g.o=!0;var b=c?c.next:l;dt(t,c,g),dt(t,g,b),Os(g,b,n),c=g,v=[],d=[],l=c.next;continue}if((g.e.f&et)!==0&&(Oa(g.e),a&&(g.e.nodes?.a?.unfix(),(f??=new Set).delete(g))),g!==l){if(u!==void 0&&u.has(g)){if(v.length<d.length){var _=d[0],x;c=_.prev;var I=v[0],R=v[v.length-1];for(x=0;x<v.length;x+=1)Os(v[x],_,n);for(x=0;x<d.length;x+=1)u.delete(d[x]);dt(t,I.prev,R.next),dt(t,c,I),dt(t,R,_),l=_,c=R,m-=1,v=[],d=[]}else u.delete(g),Os(g,l,n),dt(t,g.prev,g.next),dt(t,g,c===null?t.first:c.next),dt(t,c,g),c=g;continue}for(v=[],d=[];l!==null&&l!==g;)(l.e.f&et)===0&&(u??=new Set).add(l),d.push(l),l=l.next;if(l===null)continue;g=l}v.push(g),c=g,l=g.next}let H=o.size>i;if(l!==null||u!==void 0){for(var q=u===void 0?[]:xa(u);l!==null;)(l.e.f&et)===0&&q.push(l),l=l.next;var O=q.length;if(H=o.size-O>i,O>0){var Z=(r&Vo)!==0&&i===0?n:null;if(a){for(m=0;m<O;m+=1)q[m].e.nodes?.a?.measure();for(m=0;m<O;m+=1)q[m].e.nodes?.a?.fix()}ud(t,q,Z)}}if(H)for(const Q of o.values())Q.o||(dt(t,c,Q),c=Q);t.effect.last=c&&c.e,a&&jn(()=>{if(f!==void 0)for(g of f)g.e.nodes?.a?.apply()})}function dd(t,e,n,r,s,a,i,o){var l=(i&Bo)!==0,u=(i&fc)===0,c=l?u?Ss(n,!1,!1):Xt(n):n,f=(i&Fo)===0?s:Xt(s),v={i:f,v:c,k:r,e:null,o:!1,prev:e,next:null};if(t===null){var d=document.createDocumentFragment();d.append(t=Dt())}return v.e=at(()=>a(t,c,f,o)),e!==null&&(e.next=v),v}function Os(t,e,n){if(t.e.nodes)for(var r=t.next?t.next.e.nodes.start:n,s=e?e.e.nodes.start:n,a=t.e.nodes.start;a!==null&&a!==r;){var i=pr(a);s.before(a),a=i}}function dt(t,e,n){e===null?(t.first=n,t.effect.first=n&&n.e):(e.e.next&&(e.e.next.prev=null),e.next=n,e.e.next=n&&n.e),n!==null&&(n.e.prev&&(n.e.prev.next=null),n.prev=e,n.e.prev=e&&e.e)}function Il(t,e,n=!1,r=!1,s=!1){var a=t,i="";$(()=>{var o=ae;if(i!==(i=e()??"")&&(o.nodes!==null&&(vl(o.nodes.start,o.nodes.end),o.nodes=null),i!=="")){var l=i+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=Ma(l);if((n||r)&&(u=bt(u)),$n(bt(u),u.lastChild),n||r)for(;bt(u);)a.before(bt(u));else a.before(u)}})}function fd(t,e,n,r,s){var a=e.$$slots?.[n],i=!1;a===!0&&(a=e[n],i=!0),a===void 0?s!==null&&s(t):a(t,i?()=>r:r)}function Ke(t,e,...n){var r=new Pa(t);gr(()=>{const s=e()??null;r.ensure(s,s&&(a=>s(a,...n)))},on)}const fi=[...` 	
\r\fÂ \v\uFEFF`];function hd(t,e,n){var r=t==null?"":""+t;if(e&&(r=r?r+" "+e:e),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,i=0;(i=r.indexOf(s,i))>=0;){var o=i+a;(i===0||fi.includes(r[i-1]))&&(o===r.length||fi.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function vd(t,e){return t==null?null:String(t)}function xe(t,e,n,r,s,a){var i=t.__className;if(i!==n||i===void 0){var o=hd(n,r,a);o==null?t.removeAttribute("class"):t.className=o,t.__className=n}else if(a&&s!==a)for(var l in a){var u=!!a[l];(s==null||u!==!!s[l])&&t.classList.toggle(l,u)}return a}function pd(t,e,n,r){var s=t.__style;if(s!==e){var a=vd(e);a==null?t.removeAttribute("style"):t.style.cssText=a,t.__style=e}return r}const gd=Symbol("is custom element"),md=Symbol("is html");function pt(t,e,n,r){var s=_d(t);s[e]!==(s[e]=n)&&(e==="loading"&&(t[ec]=n),n==null?t.removeAttribute(e):typeof n!="string"&&yd(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function _d(t){return t.__attributes??={[gd]:t.nodeName.includes("-"),[md]:t.namespaceURI===bc}}var hi=new Map;function yd(t){var e=t.getAttribute("is")||t.nodeName,n=hi.get(e);if(n)return n;hi.set(e,n=[]);for(var r,s=t,a=Element.prototype;a!==s;){r=$o(s);for(var i in r)r[i].set&&n.push(i);s=Ta(s)}return n}function kn(t,e,n=e){var r=new WeakSet;ol(t,"input",async s=>{var a=s?t.defaultValue:t.value;if(a=Ms(t)?Ps(a):a,n(a),le!==null&&r.add(le),await Wc(),a!==(a=e())){var i=t.selectionStart,o=t.selectionEnd,l=t.value.length;if(t.value=a??"",o!==null){var u=t.value.length;i===o&&o===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=i,t.selectionEnd=Math.min(o,u))}}}),ie(e)==null&&t.value&&(n(Ms(t)?Ps(t.value):t.value),le!==null&&r.add(le)),mn(()=>{var s=e();if(t===document.activeElement){var a=xr??le;if(r.has(a))return}Ms(t)&&s===Ps(t.value)||t.type==="date"&&!s&&!t.value||s!==t.value&&(t.value=s??"")})}function bd(t,e,n=e){ol(t,"change",r=>{var s=r?t.defaultChecked:t.checked;n(s)}),ie(e)==null&&n(t.checked),mn(()=>{var r=e();t.checked=!!r})}function Ms(t){var e=t.type;return e==="number"||e==="range"}function Ps(t){return t===""?null:+t}function vi(t,e){return t===e||t?.[tn]===e}function cr(t={},e,n,r){return Zc(()=>{var s,a;return mn(()=>{s=a,a=[],ie(()=>{t!==n(...a)&&(e(t,...a),s&&vi(n(...s),t)&&e(null,...s))})}),()=>{jn(()=>{a&&vi(n(...a),t)&&e(null,...a)})}}),t}function wd(t,e,n,r,s){var a=()=>{r(n[t])};n.addEventListener(e,a),s?mn(()=>{n[t]=s()}):a(),(n===document.body||n===window||n===document)&&Ts(()=>{n.removeEventListener(e,a)})}function We(t=!1){const e=fe,n=e.l.u;if(!n)return;let r=()=>Ze(e.s);if(t){let s=0,a={};const i=vr(()=>{let o=!1;const l=e.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],o=!0);return o&&s++,s});r=()=>y(i)}n.b.length&&jc(()=>{pi(e,r),Zs(n.b)}),Qr(()=>{const s=ie(()=>n.m.map(Ju));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&Qr(()=>{pi(e,r),Zs(n.a)})}function pi(t,e){if(t.l.s)for(const n of t.l.s)y(n);e()}function La(t){var e=Xt(0);return function(){return arguments.length===1?(N(e,y(e)+1),arguments[0]):(y(e),t())}}function Cl(t,e,n){if(t==null)return e(void 0),Se;const r=ie(()=>t.subscribe(e,n));return r.unsubscribe?()=>r.unsubscribe():r}const wn=[];function Xn(t,e){return{subscribe:Ed(t,e).subscribe}}function Ed(t,e=Se){let n=null;const r=new Set;function s(o){if(Ho(t,o)&&(t=o,n)){const l=!wn.length;for(const u of r)u[1](),wn.push(u,t);if(l){for(let u=0;u<wn.length;u+=2)wn[u][0](wn[u+1]);wn.length=0}}}function a(o){s(o(t))}function i(o,l=Se){const u=[o,l];return r.add(u),r.size===1&&(n=e(s,a)||Se),o(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:i}}function kd(t){let e;return Cl(t,n=>e=n)(),e}let br=!1,Ys=Symbol();function er(t,e,n){const r=n[e]??={store:null,source:Ss(void 0),unsubscribe:Se};if(r.store!==t&&!(Ys in n))if(r.unsubscribe(),r.store=t??null,t==null)r.source.v=void 0,r.unsubscribe=Se;else{var s=!0;r.unsubscribe=Cl(t,a=>{s?r.source.v=a:N(r.source,a)}),s=!1}return t&&Ys in n?kd(t):y(r.source)}function Nl(){const t={};function e(){Ts(()=>{for(var n in t)t[n].unsubscribe();Lo(t,Ys,{enumerable:!1,value:!0})})}return[t,e]}function Sd(t){var e=br;try{return br=!1,[t(),br]}finally{br=e}}function Pe(t,e,n,r){var s=!Fn||(n&vc)!==0,a=(n&gc)!==0,i=(n&mc)!==0,o=r,l=!0,u=()=>(l&&(l=!1,o=i?ie(r):r),o),c;if(a){var f=tn in t||Qu in t;c=In(t,e)?.set??(f&&e in t?_=>t[e]=_:void 0)}var v,d=!1;a?[v,d]=Sd(()=>t[e]):v=t[e],v===void 0&&r!==void 0&&(v=u(),c&&(s&&ic(),c(v)));var h;if(s?h=()=>{var _=t[e];return _===void 0?u():(l=!0,_)}:h=()=>{var _=t[e];return _!==void 0&&(o=void 0),_===void 0?o:_},s&&(n&pc)===0)return h;if(c){var p=t.$$legacy;return(function(_,x){return arguments.length>0?((!s||!x||p||d)&&c(x?h():_),_):h()})}var g=!1,m=((n&hc)!==0?vr:ks)(()=>(g=!1,h()));a&&y(m);var b=ae;return(function(_,x){if(arguments.length>0){const I=x?y(m):s&&a?Te(_):_;return N(m,I),g=!0,o!==void 0&&(o=I),_}return _n&&g||(b.f&Pt)!==0?m.v:y(m)})}function xd(t){fe===null&&Go(),Fn&&fe.l!==null?Td(fe).m.push(t):Qr(()=>{const e=ie(t);if(typeof e=="function")return e})}function Td(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const Ad="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Ad);const Id=t=>new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Nn=()=>crypto.randomUUID(),Rl=t=>{try{return JSON.parse(t)}catch{return null}},gi=(t,e)=>{const{label:n}=e,r=t.trim();if(!r)return{};let s;try{s=JSON.parse(r)}catch{throw new Error(`${n} must be valid JSON.`)}if(s===null||Array.isArray(s)||typeof s!="object")throw new Error(`${n} must be a JSON object.`);return s},Sn=-1,mi=200;function Cd(t){return t?t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`:"Unknown size"}function Nd(t){return t?t.startsWith("image/")?"image":t==="application/pdf"?"pdf":t.includes("spreadsheet")||t.includes("excel")?"spreadsheet":t.includes("presentation")||t.includes("powerpoint")?"presentation":"file":"file"}function Rd(t){if(!t)return"file";const e=t.split("/");return e[1]||e[0]}function Od(){let t=j(Te(new Map));return{get artifacts(){return y(t)},get list(){return Array.from(y(t).values())},get count(){return y(t).size},has(e){return y(t).has(e)},get(e){return y(t).get(e)},addArtifact(e){const n={id:e.artifact_id,mime_type:e.mime_type,size_bytes:e.size_bytes,filename:e.filename,sha256:null,source:e.source},r=new Map(y(t));r.set(e.artifact_id,n),N(t,r,!0)},remove(e){if(!y(t).has(e))return!1;const n=new Map(y(t));return n.delete(e),N(t,n,!0),!0},clear(){N(t,new Map,!0)}}}const ft=Od();function Md(){let t=j(Te(Nn())),e=j(null),n=j(!1);return{get sessionId(){return y(t)},set sessionId(r){N(t,r,!0)},get activeTraceId(){return y(e)},set activeTraceId(r){N(e,r,!0)},get isSending(){return y(n)},set isSending(r){N(n,r,!0)},reset(){N(t,Nn(),!0),N(e,null),N(n,!1),ft.clear()},newSession(){N(t,Nn(),!0),N(e,null),ft.clear()}}}const De=Md();function Pd(){let t=j(Te([])),e=j("");return{get messages(){return y(t)},get input(){return y(e)},set input(n){N(e,n,!0)},get isEmpty(){return y(t).length===0},addUserMessage(n){const r={id:Nn(),role:"user",text:n,ts:Date.now()};return y(t).push(r),r},addAgentMessage(){const n={id:Nn(),role:"agent",text:"",observations:"",showObservations:!1,isStreaming:!0,isThinking:!1,answerStreamDone:!1,revisionStreamActive:!1,answerActionSeq:Sn,ts:Date.now()};return y(t).push(n),n},findMessage(n){return y(t).find(r=>r.id===n)},updateMessage(n,r){const s=y(t).find(a=>a.id===n);s&&Object.assign(s,r)},clearInput(){N(e,"")},clear(){N(t,[],!0),N(e,"")}}}const K=Pd(),Ld=new Set(["thinking","revision","tool_call_start","tool_call_args","tool_call_end","tool_call_result","llm_stream_chunk"]),$d=new Set(["step","step_start","step_complete"]);function Dd(){let t=j(Te([])),e=j(Te(new Set)),n=j(!1),r=j(Te(new Map));function s(){const a=[],i=new Set;for(const o of y(t)){const l=o.event?.toLowerCase()??"";if(!Ld.has(l)){if($d.has(l)||l==="event"){(l==="step_complete"||o.latency_ms)&&a.push({id:o.id,type:"step",name:o.node??"step",description:o.thought?wr(o.thought,100):void 0,duration_ms:o.latency_ms,ts:o.ts??Date.now()});continue}if(l==="artifact_stored"||l==="artifact_chunk"){a.push({id:o.id,type:"artifact",name:o.artifact_id??"artifact",description:o.mime_type,ts:o.ts??Date.now()});continue}a.push({id:o.id,type:"other",name:l,description:o.thought?wr(o.thought,80):void 0,ts:o.ts??Date.now()})}}for(const[o,l]of y(r))l.endTs&&!i.has(o)&&(a.push({id:`tc_${o}`,type:"tool_call",name:l.name,args:l.args?wr(l.args,100):void 0,result:l.result?wr(l.result,100):void 0,duration_ms:l.endTs-l.startTs,ts:l.startTs}),i.add(o));return a.sort((o,l)=>l.ts-o.ts),a}return{get events(){return y(t)},get displayEvents(){return s()},get filter(){return y(e)},get paused(){return y(n)},set paused(a){N(n,a,!0)},get isEmpty(){return y(t).length===0},setFilter(a){a?N(e,new Set([a]),!0):N(e,new Set,!0)},addEvent(a,i){const o=a.tool_call_id,l=i.toLowerCase();if(o){if(l==="tool_call_start")y(r).set(o,{id:o,name:a.tool_call_name??"tool",args:"",result:"",startTs:Date.now()});else if(l==="tool_call_args"){const f=y(r).get(o);f&&(f.args+=a.delta??"")}else if(l==="tool_call_result"){const f=y(r).get(o);f&&(f.result=a.content??"")}else if(l==="tool_call_end"){const f=y(r).get(o);f&&(f.endTs=Date.now())}}const u=`${a.event??""}|${a.step??""}|${a.ts??""}`;y(t).some(f=>`${f.event??""}|${f.step??""}|${f.ts??""}`===u)||(y(t).unshift({id:Nn(),...a,event:i}),y(t).length>mi&&(y(t).length=mi))},shouldProcess(a){return y(n)?!1:y(e).size===0?!0:y(e).has(a)},clear(){N(t,[],!0),N(r,new Map,!0)}}}function wr(t,e){return t.length<=e?t:t.slice(0,e-3)+"..."}const mt=Dd();function Ud(){let t=j(Te([])),e=j(Te({}));return{get steps(){return y(t)},get artifactStreams(){return y(e)},get isEmpty(){return y(t).length===0},get hasArtifacts(){return Object.keys(y(e)).length>0},setFromPayload(n){const r=n?.steps??[];N(t,r.map((s,a)=>{const i=s.action??{};return{id:`step-${a}`,name:i.next_node??i.plan?.[0]?.node??"step",thought:i.thought,args:i.args,result:s.observation,latencyMs:s.latency_ms??void 0,reflectionScore:s.metadata?.reflection?.score??void 0,status:s.error?"error":"ok"}}),!0)},addArtifactChunk(n,r){const s=y(e)[n]??[];y(e)[n]=[...s,r]},clearArtifacts(){N(e,{},!0)},clear(){N(t,[],!0),N(e,{},!0)}}}const Ut=Ud(),_i={name:"loading_agent",description:"",template:"",version:"",flags:[],tools:0,flows:0};function zd(){let t=j(Te({..._i})),e=j(Te([])),n=j(Te([])),r=j(Te([]));return{get meta(){return y(t)},get plannerConfig(){return y(e)},get services(){return y(n)},get catalog(){return y(r)},setFromResponse(s){const a=s.agent??{};N(t,{name:a.name??"agent",description:a.description??"",template:a.template??"",version:a.version??"",flags:a.flags??[],tools:(s.tools??[]).length,flows:(s.flows??[]).length},!0),N(e,s.planner&&Object.keys(s.planner).length?Object.entries(s.planner).map(([i,o])=>({label:i,value:o})):[],!0),N(n,s.services?.map(i=>({name:i.name,status:i.enabled?"enabled":"disabled",url:i.url??null}))??[],!0),N(r,s.tools?.map(i=>({name:i.name,desc:i.description,tags:i.tags??[]}))??[],!0)},reset(){N(t,{..._i},!0),N(e,[],!0),N(n,[],!0),N(r,[],!0)}}}const He=zd();function Gd(){let t=j(""),e=j("pending"),n=j(Te([]));return{get content(){return y(t)},set content(r){N(t,r,!0)},get status(){return y(e)},set status(r){N(e,r,!0)},get errors(){return y(n)},get isValid(){return y(e)==="valid"},get hasErrors(){return y(n).length>0},setFromSpecData(r){N(t,r.content,!0),N(e,r.valid?"valid":"error",!0),N(n,(r.errors??[]).map((s,a)=>({id:`err-${a}`,message:s.message,line:s.line})),!0)},setValidationResult(r){N(e,r.valid?"valid":"error",!0),N(n,(r.errors??[]).map((s,a)=>({id:`val-err-${a}`,message:s.message,line:s.line})),!0)},setGenerationErrors(r){N(e,"error"),N(n,r.map((s,a)=>({id:`gen-err-${a}`,message:s.message,line:s.line})),!0)},markValid(){N(e,"valid"),N(n,[],!0)},reset(){N(t,""),N(e,"pending"),N(n,[],!0)}}}const it=Gd();function Bd(){let t=j("playground-tenant"),e=j("playground-user"),n=j("{}"),r=j("{}"),s=j(null),a=j(!1);return{get tenantId(){return y(t)},set tenantId(i){N(t,i,!0)},get userId(){return y(e)},set userId(i){N(e,i,!0)},get toolContextRaw(){return y(n)},set toolContextRaw(i){N(n,i,!0)},get llmContextRaw(){return y(r)},set llmContextRaw(i){N(r,i,!0)},get error(){return y(s)},set error(i){N(s,i,!0)},get useAgui(){return y(a)},set useAgui(i){N(a,i,!0)},parseContexts(){try{const i=gi(y(n),{label:"Tool context"}),o={tenant_id:y(t),user_id:y(e),...i},l=gi(y(r),{label:"LLM context"});return N(s,null),{toolContext:o,llmContext:l}}catch(i){return N(s,i instanceof Error?i.message:"Invalid setup configuration.",!0),null}},clearError(){N(s,null)},reset(){N(t,"playground-tenant"),N(e,"playground-user"),N(n,"{}"),N(r,"{}"),N(s,null),N(a,!1)}}}const Tr=Bd(),Zn="";function Fd(t){if(!t)return null;const e=t.match(/filename="(.+?)"/);if(e)return e[1];const n=t.match(/filename=([^;\s]+)/);return n?n[1]:null}async function Vd(){try{const t=await fetch(`${Zn}/ui/meta`);return t.ok?await t.json():null}catch(t){return console.error("meta load failed",t),null}}async function jd(){try{const t=await fetch(`${Zn}/ui/spec`);return t.ok?await t.json():null}catch(t){return console.error("spec load failed",t),null}}async function Hd(t){try{return await(await fetch(`${Zn}/ui/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spec_text:t})})).json()}catch(e){return console.error("validate failed",e),null}}async function Zd(t){try{const e=await fetch(`${Zn}/ui/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spec_text:t})});return e.ok?!0:await e.json()}catch(e){return console.error("generate failed",e),null}}async function qd(t,e){try{const n=await fetch(`${Zn}/trajectory/${t}?session_id=${encodeURIComponent(e)}`);return n.ok?await n.json():null}catch(n){return console.error("trajectory fetch failed",n),null}}async function Ol(t,e,n){const r=await fetch(`${Zn}/artifacts/${t}`,{headers:{"X-Session-ID":e}});if(!r.ok)throw new Error(`Download failed: ${r.status} ${r.statusText}`);const s=await r.blob(),a=r.headers.get("Content-Disposition"),i=n||Fd(a)||`artifact-${t}`,o=URL.createObjectURL(s),l=document.createElement("a");l.href=o,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}var te;(function(t){t.assertEqual=s=>{};function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},t.getValidEnumValues=s=>{const a=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return t.objectValues(i)},t.objectValues=s=>t.objectKeys(s).map(function(a){return s[a]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},t.find=(s,a)=>{for(const i of s)if(a(i))return i},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}t.joinValues=r,t.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(te||(te={}));var yi;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(yi||(yi={}));const L=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Vt=t=>{switch(typeof t){case"undefined":return L.undefined;case"string":return L.string;case"number":return Number.isNaN(t)?L.nan:L.number;case"boolean":return L.boolean;case"function":return L.function;case"bigint":return L.bigint;case"symbol":return L.symbol;case"object":return Array.isArray(t)?L.array:t===null?L.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?L.promise:typeof Map<"u"&&t instanceof Map?L.map:typeof Set<"u"&&t instanceof Set?L.set:typeof Date<"u"&&t instanceof Date?L.date:L.object;default:return L.unknown}},C=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class zt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)r._errors.push(n(i));else{let o=r,l=0;for(;l<i.path.length;){const u=i.path[l];l===i.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(n(i))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return s(this),r}static assert(e){if(!(e instanceof zt))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];n[a]=n[a]||[],n[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}zt.create=t=>new zt(t);const Qs=(t,e)=>{let n;switch(t.code){case C.invalid_type:t.received===L.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case C.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,te.jsonStringifyReplacer)}`;break;case C.unrecognized_keys:n=`Unrecognized key(s) in object: ${te.joinValues(t.keys,", ")}`;break;case C.invalid_union:n="Invalid input";break;case C.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${te.joinValues(t.options)}`;break;case C.invalid_enum_value:n=`Invalid enum value. Expected ${te.joinValues(t.options)}, received '${t.received}'`;break;case C.invalid_arguments:n="Invalid function arguments";break;case C.invalid_return_type:n="Invalid function return type";break;case C.invalid_date:n="Invalid date";break;case C.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:te.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case C.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case C.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case C.custom:n="Invalid input";break;case C.invalid_intersection_types:n="Intersection results could not be merged";break;case C.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case C.not_finite:n="Number must be finite";break;default:n=e.defaultError,te.assertNever(t)}return{message:n}};let Xd=Qs;function Kd(){return Xd}const Jd=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,a=[...n,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)o=u(i,{data:e,defaultError:o}).message;return{...s,path:a,message:o}};function M(t,e){const n=Kd(),r=Jd({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Qs?void 0:Qs].filter(s=>!!s)});t.common.issues.push(r)}class Fe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return F;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const a=await s.key,i=await s.value;r.push({key:a,value:i})}return Fe.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return F;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(r[a.value]=i.value)}return{status:e.value,value:r}}}const F=Object.freeze({status:"aborted"}),tr=t=>({status:"dirty",value:t}),ut=t=>({status:"valid",value:t}),bi=t=>t.status==="aborted",wi=t=>t.status==="dirty",Dn=t=>t.status==="valid",ns=t=>typeof Promise<"u"&&t instanceof Promise;var D;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(D||(D={}));class St{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ei=(t,e)=>{if(Dn(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new zt(t.common.issues);return this._error=n,this._error}}};function X(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,o)=>{const{message:l}=t;return i.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class J{get description(){return this._def.description}_getType(e){return Vt(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Vt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Fe,ctx:{common:e.parent.common,data:e.data,parsedType:Vt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ns(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vt(e)},s=this._parseSync({data:e,path:r.path,parent:r});return Ei(r,s)}"~validate"(e){const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vt(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:n});return Dn(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(r=>Dn(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Vt(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(ns(s)?s:Promise.resolve(s));return Ei(r,a)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,a)=>{const i=e(s),o=()=>a.addIssue({code:C.custom,...r(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(l=>l?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new fn({schema:this,typeName:V.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return $t.create(this,this._def)}nullable(){return hn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Et.create(this)}promise(){return us.create(this,this._def)}or(e){return ss.create([this,e],this._def)}and(e){return as.create(this,e,this._def)}transform(e){return new fn({...X(this._def),schema:this,typeName:V.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new cs({...X(this._def),innerType:this,defaultValue:n,typeName:V.ZodDefault})}brand(){return new $l({typeName:V.ZodBranded,type:this,...X(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new ds({...X(this._def),innerType:this,catchValue:n,typeName:V.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Da.create(this,e)}readonly(){return fs.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Wd=/^c[^\s-]{8,}$/i,Yd=/^[0-9a-z]+$/,Qd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ef=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tf=/^[a-z0-9_-]{21}$/i,nf=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,rf=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sf=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,af="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Ls;const of=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,lf=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,uf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,cf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,df=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ff=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ml="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",hf=new RegExp(`^${Ml}$`);function Pl(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function vf(t){return new RegExp(`^${Pl(t)}$`)}function pf(t){let e=`${Ml}T${Pl(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function gf(t,e){return!!((e==="v4"||!e)&&of.test(t)||(e==="v6"||!e)&&uf.test(t))}function mf(t,e){if(!nf.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function _f(t,e){return!!((e==="v4"||!e)&&lf.test(t)||(e==="v6"||!e)&&cf.test(t))}class Mt extends J{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==L.string){const a=this._getOrReturnCtx(e);return M(a,{code:C.invalid_type,expected:L.string,received:a.parsedType}),F}const r=new Fe;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(e,s),i?M(s,{code:C.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&M(s,{code:C.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")sf.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"email",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")Ls||(Ls=new RegExp(af,"u")),Ls.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"emoji",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")ef.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"uuid",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")tf.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"nanoid",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Wd.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")Yd.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cuid2",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")Qd.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ulid",code:C.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),M(s,{validation:"url",code:C.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"regex",code:C.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?pf(a).test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?hf.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?vf(a).test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{code:C.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?rf.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"duration",code:C.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?gf(e.data,a.version)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"ip",code:C.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?mf(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"jwt",code:C.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?_f(e.data,a.version)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"cidr",code:C.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?df.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"base64",code:C.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?ff.test(e.data)||(s=this._getOrReturnCtx(e,s),M(s,{validation:"base64url",code:C.invalid_string,message:a.message}),r.dirty()):te.assertNever(a);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:C.invalid_string,...D.errToObj(r)})}_addCheck(e){return new Mt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...D.errToObj(e)})}url(e){return this._addCheck({kind:"url",...D.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...D.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...D.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...D.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...D.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...D.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...D.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...D.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...D.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...D.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...D.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...D.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...D.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...D.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...D.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...D.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...D.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...D.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...D.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...D.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...D.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...D.errToObj(n)})}nonempty(e){return this.min(1,D.errToObj(e))}trim(){return new Mt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Mt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Mt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Mt.create=t=>new Mt({checks:[],typeName:V.ZodString,coerce:t?.coerce??!1,...X(t)});function yf(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,a=Number.parseInt(t.toFixed(s).replace(".","")),i=Number.parseInt(e.toFixed(s).replace(".",""));return a%i/10**s}class Un extends J{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==L.number){const a=this._getOrReturnCtx(e);return M(a,{code:C.invalid_type,expected:L.number,received:a.parsedType}),F}let r;const s=new Fe;for(const a of this._def.checks)a.kind==="int"?te.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:C.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?yf(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_finite,message:a.message}),s.dirty()):te.assertNever(a);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,D.toString(n))}gt(e,n){return this.setLimit("min",e,!1,D.toString(n))}lte(e,n){return this.setLimit("max",e,!0,D.toString(n))}lt(e,n){return this.setLimit("max",e,!1,D.toString(n))}setLimit(e,n,r,s){return new Un({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:D.toString(s)}]})}_addCheck(e){return new Un({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:D.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:D.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:D.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:D.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:D.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&te.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Un.create=t=>new Un({checks:[],typeName:V.ZodNumber,coerce:t?.coerce||!1,...X(t)});class dr extends J{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==L.bigint)return this._getInvalidInput(e);let r;const s=new Fe;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),M(r,{code:C.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):te.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return M(n,{code:C.invalid_type,expected:L.bigint,received:n.parsedType}),F}gte(e,n){return this.setLimit("min",e,!0,D.toString(n))}gt(e,n){return this.setLimit("min",e,!1,D.toString(n))}lte(e,n){return this.setLimit("max",e,!0,D.toString(n))}lt(e,n){return this.setLimit("max",e,!1,D.toString(n))}setLimit(e,n,r,s){return new dr({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:D.toString(s)}]})}_addCheck(e){return new dr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:D.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:D.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:D.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:D.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:D.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}dr.create=t=>new dr({checks:[],typeName:V.ZodBigInt,coerce:t?.coerce??!1,...X(t)});class ea extends J{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==L.boolean){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.boolean,received:r.parsedType}),F}return ut(e.data)}}ea.create=t=>new ea({typeName:V.ZodBoolean,coerce:t?.coerce||!1,...X(t)});class rs extends J{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==L.date){const a=this._getOrReturnCtx(e);return M(a,{code:C.invalid_type,expected:L.date,received:a.parsedType}),F}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return M(a,{code:C.invalid_date}),F}const r=new Fe;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),M(s,{code:C.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):te.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new rs({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:D.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:D.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}rs.create=t=>new rs({checks:[],coerce:t?.coerce||!1,typeName:V.ZodDate,...X(t)});class ki extends J{_parse(e){if(this._getType(e)!==L.symbol){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.symbol,received:r.parsedType}),F}return ut(e.data)}}ki.create=t=>new ki({typeName:V.ZodSymbol,...X(t)});class ta extends J{_parse(e){if(this._getType(e)!==L.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.undefined,received:r.parsedType}),F}return ut(e.data)}}ta.create=t=>new ta({typeName:V.ZodUndefined,...X(t)});class na extends J{_parse(e){if(this._getType(e)!==L.null){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.null,received:r.parsedType}),F}return ut(e.data)}}na.create=t=>new na({typeName:V.ZodNull,...X(t)});class ra extends J{constructor(){super(...arguments),this._any=!0}_parse(e){return ut(e.data)}}ra.create=t=>new ra({typeName:V.ZodAny,...X(t)});class Si extends J{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ut(e.data)}}Si.create=t=>new Si({typeName:V.ZodUnknown,...X(t)});class Kt extends J{_parse(e){const n=this._getOrReturnCtx(e);return M(n,{code:C.invalid_type,expected:L.never,received:n.parsedType}),F}}Kt.create=t=>new Kt({typeName:V.ZodNever,...X(t)});class xi extends J{_parse(e){if(this._getType(e)!==L.undefined){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.void,received:r.parsedType}),F}return ut(e.data)}}xi.create=t=>new xi({typeName:V.ZodVoid,...X(t)});class Et extends J{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==L.array)return M(n,{code:C.invalid_type,expected:L.array,received:n.parsedType}),F;if(s.exactLength!==null){const i=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(i||o)&&(M(n,{code:i?C.too_big:C.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(M(n,{code:C.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(M(n,{code:C.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((i,o)=>s.type._parseAsync(new St(n,i,n.path,o)))).then(i=>Fe.mergeArray(r,i));const a=[...n.data].map((i,o)=>s.type._parseSync(new St(n,i,n.path,o)));return Fe.mergeArray(r,a)}get element(){return this._def.type}min(e,n){return new Et({...this._def,minLength:{value:e,message:D.toString(n)}})}max(e,n){return new Et({...this._def,maxLength:{value:e,message:D.toString(n)}})}length(e,n){return new Et({...this._def,exactLength:{value:e,message:D.toString(n)}})}nonempty(e){return this.min(1,e)}}Et.create=(t,e)=>new Et({type:t,minLength:null,maxLength:null,exactLength:null,typeName:V.ZodArray,...X(e)});function xn(t){if(t instanceof ke){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=$t.create(xn(r))}return new ke({...t._def,shape:()=>e})}else return t instanceof Et?new Et({...t._def,type:xn(t.element)}):t instanceof $t?$t.create(xn(t.unwrap())):t instanceof hn?hn.create(xn(t.unwrap())):t instanceof cn?cn.create(t.items.map(e=>xn(e))):t}class ke extends J{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=te.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==L.object){const u=this._getOrReturnCtx(e);return M(u,{code:C.invalid_type,expected:L.object,received:u.parsedType}),F}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Kt&&this._def.unknownKeys==="strip"))for(const u in s.data)i.includes(u)||o.push(u);const l=[];for(const u of i){const c=a[u],f=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new St(s,f,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Kt){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")o.length>0&&(M(s,{code:C.unrecognized_keys,keys:o}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const f=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new St(s,f,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const f=await c.key,v=await c.value;u.push({key:f,value:v,alwaysSet:c.alwaysSet})}return u}).then(u=>Fe.mergeObjectSync(r,u)):Fe.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return D.errToObj,new ke({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{const s=this._def.errorMap?.(n,r).message??r.defaultError;return n.code==="unrecognized_keys"?{message:D.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new ke({...this._def,unknownKeys:"strip"})}passthrough(){return new ke({...this._def,unknownKeys:"passthrough"})}extend(e){return new ke({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ke({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:V.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new ke({...this._def,catchall:e})}pick(e){const n={};for(const r of te.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new ke({...this._def,shape:()=>n})}omit(e){const n={};for(const r of te.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new ke({...this._def,shape:()=>n})}deepPartial(){return xn(this)}partial(e){const n={};for(const r of te.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}return new ke({...this._def,shape:()=>n})}required(e){const n={};for(const r of te.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof $t;)a=a._def.innerType;n[r]=a}return new ke({...this._def,shape:()=>n})}keyof(){return Ll(te.objectKeys(this.shape))}}ke.create=(t,e)=>new ke({shape:()=>t,unknownKeys:"strip",catchall:Kt.create(),typeName:V.ZodObject,...X(e)});ke.strictCreate=(t,e)=>new ke({shape:()=>t,unknownKeys:"strict",catchall:Kt.create(),typeName:V.ZodObject,...X(e)});ke.lazycreate=(t,e)=>new ke({shape:t,unknownKeys:"strip",catchall:Kt.create(),typeName:V.ZodObject,...X(e)});class ss extends J{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new zt(o.ctx.common.issues));return M(n,{code:C.invalid_union,unionErrors:i}),F}if(n.common.async)return Promise.all(r.map(async a=>{const i={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!a&&(a={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(l=>new zt(l));return M(n,{code:C.invalid_union,unionErrors:o}),F}}get options(){return this._def.options}}ss.create=(t,e)=>new ss({options:t,typeName:V.ZodUnion,...X(e)});const Nt=t=>t instanceof aa?Nt(t.schema):t instanceof fn?Nt(t.innerType()):t instanceof os?[t.value]:t instanceof dn?t.options:t instanceof ls?te.objectValues(t.enum):t instanceof cs?Nt(t._def.innerType):t instanceof ta?[void 0]:t instanceof na?[null]:t instanceof $t?[void 0,...Nt(t.unwrap())]:t instanceof hn?[null,...Nt(t.unwrap())]:t instanceof $l||t instanceof fs?Nt(t.unwrap()):t instanceof ds?Nt(t._def.innerType):[];class $a extends J{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==L.object)return M(n,{code:C.invalid_type,expected:L.object,received:n.parsedType}),F;const r=this.discriminator,s=n.data[r],a=this.optionsMap.get(s);return a?n.common.async?a._parseAsync({data:n.data,path:n.path,parent:n}):a._parseSync({data:n.data,path:n.path,parent:n}):(M(n,{code:C.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),F)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const a of n){const i=Nt(a.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,a)}}return new $a({typeName:V.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...X(r)})}}function sa(t,e){const n=Vt(t),r=Vt(e);if(t===e)return{valid:!0,data:t};if(n===L.object&&r===L.object){const s=te.objectKeys(e),a=te.objectKeys(t).filter(o=>s.indexOf(o)!==-1),i={...t,...e};for(const o of a){const l=sa(t[o],e[o]);if(!l.valid)return{valid:!1};i[o]=l.data}return{valid:!0,data:i}}else if(n===L.array&&r===L.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<t.length;a++){const i=t[a],o=e[a],l=sa(i,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===L.date&&r===L.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class as extends J{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(a,i)=>{if(bi(a)||bi(i))return F;const o=sa(a.value,i.value);return o.valid?((wi(a)||wi(i))&&n.dirty(),{status:n.value,value:o.data}):(M(r,{code:C.invalid_intersection_types}),F)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}as.create=(t,e,n)=>new as({left:t,right:e,typeName:V.ZodIntersection,...X(n)});class cn extends J{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.array)return M(r,{code:C.invalid_type,expected:L.array,received:r.parsedType}),F;if(r.data.length<this._def.items.length)return M(r,{code:C.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),F;!this._def.rest&&r.data.length>this._def.items.length&&(M(r,{code:C.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...r.data].map((i,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new St(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(a).then(i=>Fe.mergeArray(n,i)):Fe.mergeArray(n,a)}get items(){return this._def.items}rest(e){return new cn({...this._def,rest:e})}}cn.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new cn({items:t,typeName:V.ZodTuple,rest:null,...X(e)})};class is extends J{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.object)return M(r,{code:C.invalid_type,expected:L.object,received:r.parsedType}),F;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in r.data)s.push({key:a._parse(new St(r,o,r.path,o)),value:i._parse(new St(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Fe.mergeObjectAsync(n,s):Fe.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof J?new is({keyType:e,valueType:n,typeName:V.ZodRecord,...X(r)}):new is({keyType:Mt.create(),valueType:e,typeName:V.ZodRecord,...X(n)})}}class Ti extends J{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.map)return M(r,{code:C.invalid_type,expected:L.map,received:r.parsedType}),F;const s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([o,l],u)=>({key:s._parse(new St(r,o,r.path,[u,"key"])),value:a._parse(new St(r,l,r.path,[u,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of i){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return F;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of i){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return F;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(u.value,c.value)}return{status:n.value,value:o}}}}Ti.create=(t,e,n)=>new Ti({valueType:e,keyType:t,typeName:V.ZodMap,...X(n)});class fr extends J{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==L.set)return M(r,{code:C.invalid_type,expected:L.set,received:r.parsedType}),F;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(M(r,{code:C.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(M(r,{code:C.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const a=this._def.valueType;function i(l){const u=new Set;for(const c of l){if(c.status==="aborted")return F;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const o=[...r.data.values()].map((l,u)=>a._parse(new St(r,l,r.path,u)));return r.common.async?Promise.all(o).then(l=>i(l)):i(o)}min(e,n){return new fr({...this._def,minSize:{value:e,message:D.toString(n)}})}max(e,n){return new fr({...this._def,maxSize:{value:e,message:D.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}fr.create=(t,e)=>new fr({valueType:t,minSize:null,maxSize:null,typeName:V.ZodSet,...X(e)});class aa extends J{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}aa.create=(t,e)=>new aa({getter:t,typeName:V.ZodLazy,...X(e)});class os extends J{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return M(n,{received:n.data,code:C.invalid_literal,expected:this._def.value}),F}return{status:"valid",value:e.data}}get value(){return this._def.value}}os.create=(t,e)=>new os({value:t,typeName:V.ZodLiteral,...X(e)});function Ll(t,e){return new dn({values:t,typeName:V.ZodEnum,...X(e)})}class dn extends J{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return M(n,{expected:te.joinValues(r),received:n.parsedType,code:C.invalid_type}),F}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return M(n,{received:n.data,code:C.invalid_enum_value,options:r}),F}return ut(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return dn.create(e,{...this._def,...n})}exclude(e,n=this._def){return dn.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}dn.create=Ll;class ls extends J{_parse(e){const n=te.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==L.string&&r.parsedType!==L.number){const s=te.objectValues(n);return M(r,{expected:te.joinValues(s),received:r.parsedType,code:C.invalid_type}),F}if(this._cache||(this._cache=new Set(te.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=te.objectValues(n);return M(r,{received:r.data,code:C.invalid_enum_value,options:s}),F}return ut(e.data)}get enum(){return this._def.values}}ls.create=(t,e)=>new ls({values:t,typeName:V.ZodNativeEnum,...X(e)});class us extends J{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==L.promise&&n.common.async===!1)return M(n,{code:C.invalid_type,expected:L.promise,received:n.parsedType}),F;const r=n.parsedType===L.promise?n.data:Promise.resolve(n.data);return ut(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}us.create=(t,e)=>new us({type:t,typeName:V.ZodPromise,...X(e)});class fn extends J{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===V.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:i=>{M(r,i),i.fatal?n.abort():n.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(r.data,a);if(r.common.async)return Promise.resolve(i).then(async o=>{if(n.value==="aborted")return F;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?F:l.status==="dirty"||n.value==="dirty"?tr(l.value):l});{if(n.value==="aborted")return F;const o=this._def.schema._parseSync({data:i,path:r.path,parent:r});return o.status==="aborted"?F:o.status==="dirty"||n.value==="dirty"?tr(o.value):o}}if(s.type==="refinement"){const i=o=>{const l=s.refinement(o,a);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?F:(o.status==="dirty"&&n.dirty(),i(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?F:(o.status==="dirty"&&n.dirty(),i(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Dn(i))return F;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>Dn(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:n.value,value:o})):F);te.assertNever(s)}}fn.create=(t,e,n)=>new fn({schema:t,typeName:V.ZodEffects,effect:e,...X(n)});fn.createWithPreprocess=(t,e,n)=>new fn({schema:e,effect:{type:"preprocess",transform:t},typeName:V.ZodEffects,...X(n)});class $t extends J{_parse(e){return this._getType(e)===L.undefined?ut(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$t.create=(t,e)=>new $t({innerType:t,typeName:V.ZodOptional,...X(e)});class hn extends J{_parse(e){return this._getType(e)===L.null?ut(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hn.create=(t,e)=>new hn({innerType:t,typeName:V.ZodNullable,...X(e)});class cs extends J{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===L.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}cs.create=(t,e)=>new cs({innerType:t,typeName:V.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...X(e)});class ds extends J{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ns(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new zt(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new zt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ds.create=(t,e)=>new ds({innerType:t,typeName:V.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...X(e)});class Ai extends J{_parse(e){if(this._getType(e)!==L.nan){const r=this._getOrReturnCtx(e);return M(r,{code:C.invalid_type,expected:L.nan,received:r.parsedType}),F}return{status:"valid",value:e.data}}}Ai.create=t=>new Ai({typeName:V.ZodNaN,...X(t)});class $l extends J{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Da extends J{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?F:a.status==="dirty"?(n.dirty(),tr(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?F:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new Da({in:e,out:n,typeName:V.ZodPipeline})}}class fs extends J{_parse(e){const n=this._def.innerType._parse(e),r=s=>(Dn(s)&&(s.value=Object.freeze(s.value)),s);return ns(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}fs.create=(t,e)=>new fs({innerType:t,typeName:V.ZodReadonly,...X(e)});var V;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(V||(V={}));const T=Mt.create,bf=Un.create,ia=ea.create,Ve=ra.create;Kt.create;const qt=Et.create,pe=ke.create,Ua=ss.create,As=$a.create;as.create;cn.create;const Dl=is.create,U=os.create,Ul=dn.create,wf=ls.create;us.create;$t.create;hn.create;var Ef=pe({name:T(),arguments:T()}),kf=pe({id:T(),type:U("function"),function:Ef}),Is=pe({id:T(),role:T(),content:T().optional(),name:T().optional()}),Sf=pe({type:U("text"),text:T()}),zl=pe({type:U("binary"),mimeType:T(),id:T().optional(),url:T().optional(),data:T().optional(),filename:T().optional()}),Gl=(t,e)=>{!t.id&&!t.url&&!t.data&&e.addIssue({code:C.custom,message:"BinaryInputContent requires at least one of id, url, or data.",path:["id"]})};zl.superRefine((t,e)=>{Gl(t,e)});var xf=As("type",[Sf,zl]),Tf=xf.superRefine((t,e)=>{t.type==="binary"&&Gl(t,e)}),Af=Is.extend({role:U("developer"),content:T()}),If=Is.extend({role:U("system"),content:T()}),Cf=Is.extend({role:U("assistant"),content:T().optional(),toolCalls:qt(kf).optional()}),Nf=Is.extend({role:U("user"),content:Ua([T(),qt(Tf)])}),Rf=pe({id:T(),content:T(),role:U("tool"),toolCallId:T(),error:T().optional()}),Of=pe({id:T(),role:U("activity"),activityType:T(),content:Dl(Ve())}),Bl=As("role",[Af,If,Cf,Nf,Rf,Of]);Ua([U("developer"),U("system"),U("assistant"),U("user"),U("tool"),U("activity")]);var Mf=pe({description:T(),value:T()}),Pf=pe({name:T(),description:T(),parameters:Ve()}),Lf=pe({threadId:T(),runId:T(),parentRunId:T().optional(),state:Ve(),messages:qt(Bl),tools:qt(Pf),context:qt(Mf),forwardedProps:Ve()}),$f=Ve(),ye=class extends Error{constructor(t){super(t)}},Ii=class extends ye{constructor(){super("Connect not implemented. This method is not supported by the current agent.")}},Fl=Ua([U("developer"),U("system"),U("assistant"),U("user")]),S=(t=>(t.TEXT_MESSAGE_START="TEXT_MESSAGE_START",t.TEXT_MESSAGE_CONTENT="TEXT_MESSAGE_CONTENT",t.TEXT_MESSAGE_END="TEXT_MESSAGE_END",t.TEXT_MESSAGE_CHUNK="TEXT_MESSAGE_CHUNK",t.THINKING_TEXT_MESSAGE_START="THINKING_TEXT_MESSAGE_START",t.THINKING_TEXT_MESSAGE_CONTENT="THINKING_TEXT_MESSAGE_CONTENT",t.THINKING_TEXT_MESSAGE_END="THINKING_TEXT_MESSAGE_END",t.TOOL_CALL_START="TOOL_CALL_START",t.TOOL_CALL_ARGS="TOOL_CALL_ARGS",t.TOOL_CALL_END="TOOL_CALL_END",t.TOOL_CALL_CHUNK="TOOL_CALL_CHUNK",t.TOOL_CALL_RESULT="TOOL_CALL_RESULT",t.THINKING_START="THINKING_START",t.THINKING_END="THINKING_END",t.STATE_SNAPSHOT="STATE_SNAPSHOT",t.STATE_DELTA="STATE_DELTA",t.MESSAGES_SNAPSHOT="MESSAGES_SNAPSHOT",t.ACTIVITY_SNAPSHOT="ACTIVITY_SNAPSHOT",t.ACTIVITY_DELTA="ACTIVITY_DELTA",t.RAW="RAW",t.CUSTOM="CUSTOM",t.RUN_STARTED="RUN_STARTED",t.RUN_FINISHED="RUN_FINISHED",t.RUN_ERROR="RUN_ERROR",t.STEP_STARTED="STEP_STARTED",t.STEP_FINISHED="STEP_FINISHED",t))(S||{}),he=pe({type:wf(S),timestamp:bf().optional(),rawEvent:Ve().optional()}),Df=he.extend({type:U("TEXT_MESSAGE_START"),messageId:T(),role:Fl.default("assistant")}),Vl=he.extend({type:U("TEXT_MESSAGE_CONTENT"),messageId:T(),delta:T().refine(t=>t.length>0,"Delta must not be an empty string")}),Uf=he.extend({type:U("TEXT_MESSAGE_END"),messageId:T()}),zf=he.extend({type:U("TEXT_MESSAGE_CHUNK"),messageId:T().optional(),role:Fl.optional(),delta:T().optional()}),Gf=he.extend({type:U("THINKING_TEXT_MESSAGE_START")}),Bf=Vl.omit({messageId:!0,type:!0}).extend({type:U("THINKING_TEXT_MESSAGE_CONTENT")}),Ff=he.extend({type:U("THINKING_TEXT_MESSAGE_END")}),Vf=he.extend({type:U("TOOL_CALL_START"),toolCallId:T(),toolCallName:T(),parentMessageId:T().optional()}),jf=he.extend({type:U("TOOL_CALL_ARGS"),toolCallId:T(),delta:T()}),Hf=he.extend({type:U("TOOL_CALL_END"),toolCallId:T()}),Zf=he.extend({messageId:T(),type:U("TOOL_CALL_RESULT"),toolCallId:T(),content:T(),role:U("tool").optional()}),qf=he.extend({type:U("TOOL_CALL_CHUNK"),toolCallId:T().optional(),toolCallName:T().optional(),parentMessageId:T().optional(),delta:T().optional()}),Xf=he.extend({type:U("THINKING_START"),title:T().optional()}),Kf=he.extend({type:U("THINKING_END")}),Jf=he.extend({type:U("STATE_SNAPSHOT"),snapshot:$f}),Wf=he.extend({type:U("STATE_DELTA"),delta:qt(Ve())}),Yf=he.extend({type:U("MESSAGES_SNAPSHOT"),messages:qt(Bl)}),Qf=he.extend({type:U("ACTIVITY_SNAPSHOT"),messageId:T(),activityType:T(),content:Dl(Ve()),replace:ia().optional().default(!0)}),eh=he.extend({type:U("ACTIVITY_DELTA"),messageId:T(),activityType:T(),patch:qt(Ve())}),th=he.extend({type:U("RAW"),event:Ve(),source:T().optional()}),nh=he.extend({type:U("CUSTOM"),name:T(),value:Ve()}),rh=he.extend({type:U("RUN_STARTED"),threadId:T(),runId:T(),parentRunId:T().optional(),input:Lf.optional()}),sh=he.extend({type:U("RUN_FINISHED"),threadId:T(),runId:T(),result:Ve().optional()}),ah=he.extend({type:U("RUN_ERROR"),message:T(),code:T().optional()}),ih=he.extend({type:U("STEP_STARTED"),stepName:T()}),oh=he.extend({type:U("STEP_FINISHED"),stepName:T()}),jl=As("type",[Df,Vl,Uf,zf,Xf,Kf,Gf,Bf,Ff,Vf,jf,Hf,qf,Zf,Jf,Wf,Yf,Qf,eh,th,nh,rh,sh,ah,ih,oh]);function we(t){return typeof t=="function"}function lh(t){return we(t?.lift)}function Ct(t){return function(e){if(lh(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var oa=function(t,e){return oa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},oa(t,e)};function qn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");oa(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function uh(t,e,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function o(c){try{u(r.next(c))}catch(f){i(f)}}function l(c){try{u(r.throw(c))}catch(f){i(f)}}function u(c){c.done?a(c.value):s(c.value).then(o,l)}u((r=r.apply(t,e||[])).next())})}function Hl(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=o(0),i.throw=o(1),i.return=o(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function o(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(a=u[0]&2?s.return:u[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,u[1])).done)return a;switch(s=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],s=0}finally{r=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function zn(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function la(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,a=[],i;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(o){i={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function ua(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function Rn(t){return this instanceof Rn?(this.v=t,this):new Rn(t)}function ch(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(d){return function(h){return Promise.resolve(h).then(d,f)}}function o(d,h){r[d]&&(s[d]=function(p){return new Promise(function(g,m){a.push([d,p,g,m])>1||l(d,p)})},h&&(s[d]=h(s[d])))}function l(d,h){try{u(r[d](h))}catch(p){v(a[0][3],p)}}function u(d){d.value instanceof Rn?Promise.resolve(d.value.v).then(c,f):v(a[0][2],d)}function c(d){l("next",d)}function f(d){l("throw",d)}function v(d,h){d(h),a.shift(),a.length&&l(a[0][0],a[0][1])}}function dh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof zn=="function"?zn(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(i){return new Promise(function(o,l){i=t[a](i),s(o,l,i.done,i.value)})}}function s(a,i,o,l){Promise.resolve(l).then(function(u){a({value:u,done:o})},i)}}var Zl=(function(t){return t&&typeof t.length=="number"&&typeof t!="function"});function ql(t){return we(t?.then)}function za(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var $s=za(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function ca(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Cs=(function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,s,a;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=zn(i),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(we(c))try{c()}catch(p){a=p instanceof $s?p.errors:[p]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var v=zn(f),d=v.next();!d.done;d=v.next()){var h=d.value;try{Ci(h)}catch(p){a=a??[],p instanceof $s?a=ua(ua([],la(a)),la(p.errors)):a.push(p)}}}catch(p){r={error:p}}finally{try{d&&!d.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}}if(a)throw new $s(a)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)Ci(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&ca(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&ca(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=(function(){var e=new t;return e.closed=!0,e})(),t})(),Xl=Cs.EMPTY;function Kl(t){return t instanceof Cs||t&&"closed"in t&&we(t.remove)&&we(t.add)&&we(t.unsubscribe)}function Ci(t){we(t)?t():t.unsubscribe()}var fh={Promise:void 0},hh={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,ua([t,e],la(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function Jl(t){hh.setTimeout(function(){throw t})}function da(){}function Ar(t){t()}var Ga=(function(t){qn(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Kl(n)&&n.add(r)):r.destination=gh,r}return e.create=function(n,r,s){return new fa(n,r,s)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(Cs),vh=(function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Er(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Er(r)}else Er(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Er(n)}},t})(),fa=(function(t){qn(e,t);function e(n,r,s){var a=t.call(this)||this,i;return we(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,a.destination=new vh(i),a}return e})(Ga);function Er(t){Jl(t)}function ph(t){throw t}var gh={closed:!0,next:da,error:ph,complete:da},Ba=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Fa(t){return t}function Ni(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wl(t)}function Wl(t){return t.length===0?Fa:t.length===1?t[0]:function(n){return t.reduce(function(r,s){return s(r)},n)}}var je=(function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var s=this,a=_h(e)?e:new fa(e,n,r);return Ar(function(){var i=s,o=i.operator,l=i.source;a.add(o?o.call(a,l):l?s._subscribe(a):s._trySubscribe(a))}),a},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=Ri(n),new n(function(s,a){var i=new fa({next:function(o){try{e(o)}catch(l){a(l),i.unsubscribe()}},error:a,complete:s});r.subscribe(i)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Ba]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Wl(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=Ri(e),new e(function(r,s){var a;n.subscribe(function(i){return a=i},function(i){return s(i)},function(){return r(a)})})},t.create=function(e){return new t(e)},t})();function Ri(t){var e;return(e=t??fh.Promise)!==null&&e!==void 0?e:Promise}function mh(t){return t&&we(t.next)&&we(t.error)&&we(t.complete)}function _h(t){return t&&t instanceof Ga||mh(t)&&Kl(t)}function Yl(t){return we(t[Ba])}function Ql(t){return Symbol.asyncIterator&&we(t?.[Symbol.asyncIterator])}function eu(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function yh(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var tu=yh();function nu(t){return we(t?.[tu])}function ru(t){return ch(this,arguments,function(){var n,r,s,a;return Hl(this,function(i){switch(i.label){case 0:n=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,Rn(n.read())];case 3:return r=i.sent(),s=r.value,a=r.done,a?[4,Rn(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,Rn(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function su(t){return we(t?.getReader)}function Ft(t){if(t instanceof je)return t;if(t!=null){if(Yl(t))return bh(t);if(Zl(t))return wh(t);if(ql(t))return Eh(t);if(Ql(t))return au(t);if(nu(t))return kh(t);if(su(t))return Sh(t)}throw eu(t)}function bh(t){return new je(function(e){var n=t[Ba]();if(we(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function wh(t){return new je(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Eh(t){return new je(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Jl)})}function kh(t){return new je(function(e){var n,r;try{for(var s=zn(t),a=s.next();!a.done;a=s.next()){var i=a.value;if(e.next(i),e.closed)return}}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()})}function au(t){return new je(function(e){xh(t,e).catch(function(n){return e.error(n)})})}function Sh(t){return au(ru(t))}function xh(t,e){var n,r,s,a;return uh(this,void 0,void 0,function(){var i,o;return Hl(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=dh(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,e.next(i),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),s={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function xt(t,e,n,r,s){return new Th(t,e,n,r,s)}var Th=(function(t){qn(e,t);function e(n,r,s,a,i,o){var l=t.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=o,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:t.prototype._next,l._error=a?function(u){try{a(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e})(Ga),iu={now:function(){return(iu.delegate||Date).now()},delegate:void 0};function Ah(t){return t&&we(t.schedule)}function Ih(t){return t[t.length-1]}function Ch(t){return Ah(Ih(t))?t.pop():void 0}function sn(t,e,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var a=e.schedule(function(){n(),s?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(a),!s)return a}function ha(t){return Ct(function(e,n){var r=null,s=!1,a;r=e.subscribe(xt(n,void 0,void 0,function(i){a=Ft(t(i,ha(t)(e))),r?(r.unsubscribe(),r=null,a.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,a.subscribe(n))})}function ou(t,e){return e===void 0&&(e=0),Ct(function(n,r){n.subscribe(xt(r,function(s){return sn(r,t,function(){return r.next(s)},e)},function(){return sn(r,t,function(){return r.complete()},e)},function(s){return sn(r,t,function(){return r.error(s)},e)}))})}function lu(t,e){return e===void 0&&(e=0),Ct(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function Nh(t,e){return Ft(t).pipe(lu(e),ou(e))}function Rh(t,e){return Ft(t).pipe(lu(e),ou(e))}function Oh(t,e){return new je(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Mh(t,e){return new je(function(n){var r;return sn(n,e,function(){r=t[tu](),sn(n,e,function(){var s,a,i;try{s=r.next(),a=s.value,i=s.done}catch(o){n.error(o);return}i?n.complete():n.next(a)},0,!0)}),function(){return we(r?.return)&&r.return()}})}function uu(t,e){if(!t)throw new Error("Iterable cannot be null");return new je(function(n){sn(n,e,function(){var r=t[Symbol.asyncIterator]();sn(n,e,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function Ph(t,e){return uu(ru(t),e)}function Lh(t,e){if(t!=null){if(Yl(t))return Nh(t,e);if(Zl(t))return Oh(t,e);if(ql(t))return Rh(t,e);if(Ql(t))return uu(t,e);if(nu(t))return Mh(t,e);if(su(t))return Ph(t,e)}throw eu(t)}function hs(t,e){return e?Lh(t,e):Ft(t)}function va(t,e){return Ct(function(n,r){var s=0;n.subscribe(xt(r,function(a){r.next(t.call(e,a,s++))}))})}function $h(t,e,n,r,s,a,i,o){var l=[],u=0,c=0,f=!1,v=function(){f&&!l.length&&!u&&e.complete()},d=function(p){return u<r?h(p):l.push(p)},h=function(p){u++;var g=!1;Ft(n(p,c++)).subscribe(xt(e,function(m){e.next(m)},function(){g=!0},void 0,function(){if(g)try{u--;for(var m=function(){var b=l.shift();i||h(b)};l.length&&u<r;)m();v()}catch(b){e.error(b)}}))};return t.subscribe(xt(e,d,function(){f=!0,v()})),function(){}}function Jt(t,e,n){return n===void 0&&(n=1/0),we(e)?Jt(function(r,s){return va(function(a,i){return e(r,a,s,i)})(Ft(t(r,s)))},n):(typeof e=="number"&&(n=e),Ct(function(r,s){return $h(r,s,t,n)}))}function Dh(t){return t===void 0&&(t=1/0),Jt(Fa,t)}function cu(t,e){return we(e)?Jt(t,e,1):Jt(t,1)}var Uh=za(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),vn=(function(t){qn(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new Oi(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Uh},e.prototype.next=function(n){var r=this;Ar(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=zn(r.currentObservers),o=i.next();!o.done;o=i.next()){var l=o.value;l.next(n)}}catch(u){s={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(s)throw s.error}}}})},e.prototype.error=function(n){var r=this;Ar(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},e.prototype.complete=function(){var n=this;Ar(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,s=this,a=s.hasError,i=s.isStopped,o=s.observers;return a||i?Xl:(this.currentObservers=null,o.push(n),new Cs(function(){r.currentObservers=null,ca(o,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,a=r.thrownError,i=r.isStopped;s?n.error(a):i&&n.complete()},e.prototype.asObservable=function(){var n=new je;return n.source=this,n},e.create=function(n,r){return new Oi(n,r)},e})(je),Oi=(function(t){qn(e,t);function e(n,r){var s=t.call(this)||this;return s.destination=n,s.source=r,s}return e.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},e.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:Xl},e})(vn);function zh(t){return Ct(function(e,n){var r=!1;e.subscribe(xt(n,function(s){r=!0,n.next(s)},function(){r||n.next(t),n.complete()}))})}var du=new je(function(t){return t.complete()});function Ee(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Ch(t);return hs(t,n)}function ge(t,e){var n=we(t)?t:function(){return t},r=function(s){return s.error(n())};return new je(r)}var Gh=za(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function pa(t){return Ct(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}var fu=(function(t){qn(e,t);function e(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=iu);var a=t.call(this)||this;return a._bufferSize=n,a._windowTime=r,a._timestampProvider=s,a._buffer=[],a._infiniteTimeWindow=!0,a._infiniteTimeWindow=r===1/0,a._bufferSize=Math.max(1,n),a._windowTime=Math.max(1,r),a}return e.prototype.next=function(n){var r=this,s=r.isStopped,a=r._buffer,i=r._infiniteTimeWindow,o=r._timestampProvider,l=r._windowTime;s||(a.push(n),!i&&a.push(o.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},e.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,a=s._infiniteTimeWindow,i=s._buffer,o=i.slice(),l=0;l<o.length&&!n.closed;l+=a?1:2)n.next(o[l]);return this._checkFinalizedStatuses(n),r},e.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,a=n._buffer,i=n._infiniteTimeWindow,o=(i?1:2)*r;if(r<1/0&&o<a.length&&a.splice(0,a.length-o),!i){for(var l=s.now(),u=0,c=1;c<a.length&&a[c]<=l;c+=2)u=c;u&&a.splice(0,u+1)}},e})(vn);function Bh(t,e){return Ct(function(n,r){var s=null,a=0,i=!1,o=function(){return i&&!s&&r.complete()};n.subscribe(xt(r,function(l){s?.unsubscribe();var u=0,c=a++;Ft(t(l,c)).subscribe(s=xt(r,function(f){return r.next(e?e(l,f,c,u++):f)},function(){s=null,o()}))},function(){i=!0,o()}))})}function Mi(t){return Ct(function(e,n){Ft(t).subscribe(xt(n,function(){return n.complete()},da)),!n.closed&&e.subscribe(n)})}function Fh(t,e,n){var r=we(t)||e||n?{next:t,error:e,complete:n}:t;return r?Ct(function(s,a){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var o=!0;s.subscribe(xt(a,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),a.next(l)},function(){var l;o=!1,(l=r.complete)===null||l===void 0||l.call(r),a.complete()},function(l){var u;o=!1,(u=r.error)===null||u===void 0||u.call(r,l),a.error(l)},function(){var l,u;o&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Fa}function Pi(t,e){return new Promise(function(n,r){var s=!1,a;t.subscribe({next:function(i){a=i,s=!0},error:r,complete:function(){s?n(a):r(new Gh)}})})}function Vh(t){return new je(function(e){Ft(t()).subscribe(e)})}const Ne=[];for(let t=0;t<256;++t)Ne.push((t+256).toString(16).slice(1));function jh(t,e=0){return(Ne[t[e+0]]+Ne[t[e+1]]+Ne[t[e+2]]+Ne[t[e+3]]+"-"+Ne[t[e+4]]+Ne[t[e+5]]+"-"+Ne[t[e+6]]+Ne[t[e+7]]+"-"+Ne[t[e+8]]+Ne[t[e+9]]+"-"+Ne[t[e+10]]+Ne[t[e+11]]+Ne[t[e+12]]+Ne[t[e+13]]+Ne[t[e+14]]+Ne[t[e+15]]).toLowerCase()}let Ds;const Hh=new Uint8Array(16);function Zh(){if(!Ds){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ds=crypto.getRandomValues.bind(crypto)}return Ds(Hh)}const qh=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Li={randomUUID:qh};function Kn(t,e,n){if(Li.randomUUID&&!t)return Li.randomUUID();t=t||{};const r=t.random??t.rng?.()??Zh();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,jh(r)}var Xh=(function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}})(),Kh=Object.prototype.hasOwnProperty;function ga(t,e){return Kh.call(t,e)}function ma(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var s in t)ga(t,s)&&r.push(s);return r}function Qe(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function _a(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Qt(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function hu(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function ya(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(ya(t[e]))return!0}else if(typeof t=="object"){for(var r=ma(t),s=r.length,a=0;a<s;a++)if(ya(t[r[a]]))return!0}}return!1}function $i(t,e){var n=[t];for(var r in e){var s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&n.push(r+": "+s)}return n.join(`
`)}var vu=(function(t){Xh(e,t);function e(n,r,s,a,i){var o=this.constructor,l=t.call(this,$i(n,{name:r,index:s,operation:a,tree:i}))||this;return l.name=r,l.index=s,l.operation=a,l.tree=i,Object.setPrototypeOf(l,o.prototype),l.message=$i(n,{name:r,index:s,operation:a,tree:i}),l}return e})(Error),be=vu,Jh=Qe,An={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=vs(n,this.path);r&&(r=Qe(r));var s=an(n,{op:"remove",path:this.from}).removed;return an(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=vs(n,this.from);return an(n,{op:"add",path:this.path,value:Qe(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:hr(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},Wh={add:function(t,e,n){return _a(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:An.move,copy:An.copy,test:An.test,_get:An._get};function vs(t,e){if(e=="")return t;var n={op:"_get",path:e};return an(t,n),n.value}function an(t,e,n,r,s,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),s===void 0&&(s=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(e,0,t,e.path):ps(e,0)),e.path===""){var i={newDocument:t};if(e.op==="add")return i.newDocument=e.value,i;if(e.op==="replace")return i.newDocument=e.value,i.removed=t,i;if(e.op==="move"||e.op==="copy")return i.newDocument=vs(t,e.from),e.op==="move"&&(i.removed=t),i;if(e.op==="test"){if(i.test=hr(t,e.value),i.test===!1)throw new be("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return i.newDocument=t,i}else{if(e.op==="remove")return i.removed=t,i.newDocument=null,i;if(e.op==="_get")return e.value=t,i;if(n)throw new be("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,t);return i}}else{r||(t=Qe(t));var o=e.path||"",l=o.split("/"),u=t,c=1,f=l.length,v=void 0,d=void 0,h=void 0;for(typeof n=="function"?h=n:h=ps;;){if(d=l[c],d&&d.indexOf("~")!=-1&&(d=hu(d)),s&&(d=="__proto__"||d=="prototype"&&c>0&&l[c-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&v===void 0&&(u[d]===void 0?v=l.slice(0,c).join("/"):c==f-1&&(v=e.path),v!==void 0&&h(e,0,t,v)),c++,Array.isArray(u)){if(d==="-")d=u.length;else{if(n&&!_a(d))throw new be("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,t);_a(d)&&(d=~~d)}if(c>=f){if(n&&e.op==="add"&&d>u.length)throw new be("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,t);var i=Wh[e.op].call(e,u,d,t);if(i.test===!1)throw new be("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return i}}else if(c>=f){var i=An[e.op].call(e,u,d,t);if(i.test===!1)throw new be("Test operation failed","TEST_OPERATION_FAILED",a,e,t);return i}if(u=u[d],n&&c<f&&(!u||typeof u!="object"))throw new be("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,t)}}}function Gn(t,e,n,r,s){if(r===void 0&&(r=!0),s===void 0&&(s=!0),n&&!Array.isArray(e))throw new be("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Qe(t));for(var a=new Array(e.length),i=0,o=e.length;i<o;i++)a[i]=an(t,e[i],n,!0,s,i),t=a[i].newDocument;return a.newDocument=t,a}function Yh(t,e,n){var r=an(t,e);if(r.test===!1)throw new be("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function ps(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new be("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(An[t.op]){if(typeof t.path!="string")throw new be("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new be('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new be("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new be("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&ya(t.value))throw new be("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var s=t.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new be("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new be("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var i={op:"_get",path:t.from,value:void 0},o=pu([i],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new be("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new be("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function pu(t,e,n){try{if(!Array.isArray(t))throw new be("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Gn(Qe(e),Qe(t),n||!0);else{n=n||ps;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(s){if(s instanceof be)return s;throw s}}function hr(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),s,a,i;if(n&&r){if(a=t.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!hr(t[s],e[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(t);if(a=o.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!e.hasOwnProperty(o[s]))return!1;for(s=a;s--!==0;)if(i=o[s],!hr(t[i],e[i]))return!1;return!0}return t!==t&&e!==e}const Qh=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:be,_areEquals:hr,applyOperation:an,applyPatch:Gn,applyReducer:Yh,deepClone:Jh,getValueByPointer:vs,validate:pu,validator:ps},Symbol.toStringTag,{value:"Module"}));var Va=new WeakMap,ev=(function(){function t(e){this.observers=new Map,this.obj=e}return t})(),tv=(function(){function t(e,n){this.callback=e,this.observer=n}return t})();function nv(t){return Va.get(t)}function rv(t,e){return t.observers.get(e)}function sv(t,e){t.observers.delete(e.callback)}function av(t,e){e.unobserve()}function iv(t,e){var n=[],r,s=nv(t);if(!s)s=new ev(t),Va.set(t,s);else{var a=rv(s,e);r=a&&a.observer}if(r)return r;if(r={},s.value=Qe(t),e){r.callback=e,r.next=null;var i=function(){ba(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(i)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=n,r.object=t,r.unobserve=function(){ba(r),clearTimeout(r.next),sv(s,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},s.observers.set(e,new tv(e,r)),r}function ba(t,e){e===void 0&&(e=!1);var n=Va.get(t.object);ja(n.value,t.object,t.patches,"",e),t.patches.length&&Gn(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function ja(t,e,n,r,s){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=ma(e),i=ma(t),o=!1,l=i.length-1;l>=0;l--){var u=i[l],c=t[u];if(ga(e,u)&&!(e[u]===void 0&&c!==void 0&&Array.isArray(e)===!1)){var f=e[u];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?ja(c,f,n,r+"/"+Qt(u),s):c!==f&&(s&&n.push({op:"test",path:r+"/"+Qt(u),value:Qe(c)}),n.push({op:"replace",path:r+"/"+Qt(u),value:Qe(f)}))}else Array.isArray(t)===Array.isArray(e)?(s&&n.push({op:"test",path:r+"/"+Qt(u),value:Qe(c)}),n.push({op:"remove",path:r+"/"+Qt(u)}),o=!0):(s&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!o&&a.length==i.length))for(var l=0;l<a.length;l++){var u=a[l];!ga(t,u)&&e[u]!==void 0&&n.push({op:"add",path:r+"/"+Qt(u),value:Qe(e[u])})}}}function ov(t,e,n){n===void 0&&(n=!1);var r=[];return ja(t,e,r,"",n),r}const lv=Object.freeze(Object.defineProperty({__proto__:null,compare:ov,generate:ba,observe:iv,unobserve:av},Symbol.toStringTag,{value:"Module"}));Object.assign({},Qh,lv,{JsonPatchError:vu,deepClone:Qe,escapePathComponent:Qt,unescapePathComponent:hu});function Di(t){return` \r
	`.indexOf(t)>=0}function gu(t){for(var e=["topLevel"],n=0,r,s,a,i=function(b){return e.push(b)},o=function(b){return e[e.length-1]=b},l=function(b){r==null&&(r=n,s=e.length,a=b)},u=function(b){b===a&&(r=void 0,s=void 0,a=void 0)},c=function(){return e.pop()},f=function(){return n--},v=function(b){if("0"<=b&&b<="9"){i("number");return}switch(b){case'"':i("string");return;case"-":i("numberNeedsDigit");return;case"t":i("true");return;case"f":i("false");return;case"n":i("null");return;case"[":i("arrayNeedsValue");return;case"{":i("objectNeedsKey");return}},d=t.length;n<d;n++){var h=t[n];switch(e[e.length-1]){case"topLevel":v(h);break;case"string":switch(h){case'"':c();break;case"\\":l("stringEscape"),i("stringEscaped");break}break;case"stringEscaped":h==="u"?i("stringUnicode"):(u("stringEscape"),c());break;case"stringUnicode":n-t.lastIndexOf("u",n)===4&&(u("stringEscape"),c());break;case"number":h==="."?o("numberNeedsDigit"):h==="e"||h==="E"?o("numberNeedsExponent"):(h<"0"||h>"9")&&(f(),c());break;case"numberNeedsDigit":o("number");break;case"numberNeedsExponent":o(h==="+"||h==="-"?"numberNeedsDigit":"number");break;case"true":case"false":case"null":(h<"a"||h>"z")&&(f(),c());break;case"arrayNeedsValue":h==="]"?c():Di(h)||(u("collectionItem"),o("arrayNeedsComma"),v(h));break;case"arrayNeedsComma":h==="]"?c():h===","&&(l("collectionItem"),o("arrayNeedsValue"));break;case"objectNeedsKey":h==="}"?c():h==='"'&&(l("collectionItem"),o("objectNeedsColon"),i("string"));break;case"objectNeedsColon":h===":"&&o("objectNeedsValue");break;case"objectNeedsValue":Di(h)||(u("collectionItem"),o("objectNeedsComma"),v(h));break;case"objectNeedsComma":h==="}"?c():h===","&&(l("collectionItem"),o("objectNeedsKey"));break}}s!=null&&(e.length=s);for(var p=[r!=null?t.slice(0,r):t],g=function(b){return p.push(b.slice(t.length-t.lastIndexOf(b[0])))},m=e.length-1;m>=0;m--)switch(e[m]){case"string":p.push('"');break;case"numberNeedsDigit":case"numberNeedsExponent":p.push("0");break;case"true":g("true");break;case"false":g("false");break;case"null":g("null");break;case"arrayNeedsValue":case"arrayNeedsComma":p.push("]");break;case"objectNeedsKey":case"objectNeedsColon":case"objectNeedsValue":case"objectNeedsComma":p.push("}");break}return p.join("")}function uv(){let t=0,e=0;for(let r=0;r<28;r+=7){let s=this.buf[this.pos++];if(t|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let s=this.buf[this.pos++];if(e|=(s&127)<<r,(s&128)==0)return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Us(t,e,n){for(let a=0;a<28;a=a+7){const i=t>>>a,o=!(!(i>>>7)&&e==0),l=(o?i|128:i)&255;if(n.push(l),!o)return}const r=t>>>28&15|(e&7)<<4,s=e>>3!=0;if(n.push((s?r|128:r)&255),!!s){for(let a=3;a<31;a=a+7){const i=e>>>a,o=!!(i>>>7),l=(o?i|128:i)&255;if(n.push(l),!o)return}n.push(e>>>31&1)}}const Ir=4294967296;function Ui(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,s=0;function a(i,o){const l=Number(t.slice(i,o));s*=n,r=r*n+l,r>=Ir&&(s=s+(r/Ir|0),r=r%Ir)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),e?_u(r,s):Ha(r,s)}function cv(t,e){let n=Ha(t,e);const r=n.hi&2147483648;r&&(n=_u(n.lo,n.hi));const s=mu(n.lo,n.hi);return r?"-"+s:s}function mu(t,e){if({lo:t,hi:e}=dv(t,e),e<=2097151)return String(Ir*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,s=e>>16&65535;let a=n+r*6777216+s*6710656,i=r+s*8147497,o=s*2;const l=1e7;return a>=l&&(i+=Math.floor(a/l),a%=l),i>=l&&(o+=Math.floor(i/l),i%=l),o.toString()+zi(i)+zi(a)}function dv(t,e){return{lo:t>>>0,hi:e>>>0}}function Ha(t,e){return{lo:t|0,hi:e|0}}function _u(t,e){return e=~e,t?t=~t+1:e+=1,Ha(t,e)}const zi=t=>{const e=String(t);return"0000000".slice(e.length)+e};function Gi(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function fv(){let t=this.buf[this.pos++],e=t&127;if((t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,(t&128)==0)return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;(t&128)!==0&&n<10;n++)t=this.buf[this.pos++];if((t&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var Bi={};const _t=hv();function hv(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(!!globalThis.Deno||typeof process!="object"||typeof Bi!="object"||Bi.BUF_BIGINT_DISABLE!=="1")){const n=BigInt("-9223372036854775808"),r=BigInt("9223372036854775807"),s=BigInt("0"),a=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>r||o<n)throw new Error(`invalid int64: ${i}`);return o},uParse(i){const o=typeof i=="bigint"?i:BigInt(i);if(o>a||o<s)throw new Error(`invalid uint64: ${i}`);return o},enc(i){return t.setBigInt64(0,this.parse(i),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(i){return t.setBigInt64(0,this.uParse(i),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(i,o){return t.setInt32(0,i,!0),t.setInt32(4,o,!0),t.getBigInt64(0,!0)},uDec(i,o){return t.setInt32(0,i,!0),t.setInt32(4,o,!0),t.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(n){return typeof n!="string"&&(n=n.toString()),Fi(n),n},uParse(n){return typeof n!="string"&&(n=n.toString()),Vi(n),n},enc(n){return typeof n!="string"&&(n=n.toString()),Fi(n),Ui(n)},uEnc(n){return typeof n!="string"&&(n=n.toString()),Vi(n),Ui(n)},dec(n,r){return cv(n,r)},uDec(n,r){return mu(n,r)}}}function Fi(t){if(!/^-?[0-9]+$/.test(t))throw new Error("invalid int64: "+t)}function Vi(t){if(!/^[0-9]+$/.test(t))throw new Error("invalid uint64: "+t)}const zs=Symbol.for("@bufbuild/protobuf/text-encoding");function yu(){if(globalThis[zs]==null){const t=new globalThis.TextEncoder,e=new globalThis.TextDecoder;globalThis[zs]={encodeUtf8(n){return t.encode(n)},decodeUtf8(n){return e.decode(n)},checkUtf8(n){try{return encodeURIComponent(n),!0}catch{return!1}}}}return globalThis[zs]}var jt;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(jt||(jt={}));const vv=34028234663852886e22,pv=-34028234663852886e22,gv=4294967295,mv=2147483647,_v=-2147483648;class ce{constructor(e=yu().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let s=0;s<this.chunks.length;s++)e+=this.chunks[s].length;let n=new Uint8Array(e),r=0;for(let s=0;s<this.chunks.length;s++)n.set(this.chunks[s],r),r+=this.chunks[s].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ji(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Gs(e),Gi(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.encodeUtf8(e);return this.uint32(n.byteLength),this.raw(n)}float(e){yv(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){ji(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Gs(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Gs(e),e=(e<<1^e>>31)>>>0,Gi(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),s=_t.enc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),s=_t.uEnc(e);return r.setInt32(0,s.lo,!0),r.setInt32(4,s.hi,!0),this.raw(n)}int64(e){let n=_t.enc(e);return Us(n.lo,n.hi,this.buf),this}sint64(e){const n=_t.enc(e),r=n.hi>>31,s=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Us(s,a,this.buf),this}uint64(e){const n=_t.uEnc(e);return Us(n.lo,n.hi,this.buf),this}}class z{constructor(e,n=yu().decodeUtf8){this.decodeUtf8=n,this.varint64=uv,this.uint32=fv,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case jt.Varint:for(;this.buf[this.pos++]&128;);break;case jt.Bit64:this.pos+=4;case jt.Bit32:this.pos+=4;break;case jt.LengthDelimited:let s=this.uint32();this.pos+=s;break;case jt.StartGroup:for(;;){const[a,i]=this.tag();if(i===jt.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(i,a)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return _t.dec(...this.varint64())}uint64(){return _t.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,_t.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return _t.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return _t.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.decodeUtf8(this.bytes())}}function Gs(t){if(typeof t=="string")t=Number(t);else if(typeof t!="number")throw new Error("invalid int32: "+typeof t);if(!Number.isInteger(t)||t>mv||t<_v)throw new Error("invalid int32: "+t)}function ji(t){if(typeof t=="string")t=Number(t);else if(typeof t!="number")throw new Error("invalid uint32: "+typeof t);if(!Number.isInteger(t)||t>gv||t<0)throw new Error("invalid uint32: "+t)}function yv(t){if(typeof t=="string"){const e=t;if(t=Number(t),Number.isNaN(t)&&e!=="NaN")throw new Error("invalid float32: "+e)}else if(typeof t!="number")throw new Error("invalid float32: "+typeof t);if(Number.isFinite(t)&&(t>vv||t<pv))throw new Error("invalid float32: "+t)}function Bs(){return{fields:{}}}var nr={encode(t,e=new ce){return Object.entries(t.fields).forEach(([n,r])=>{r!==void 0&&wa.encode({key:n,value:r},e.uint32(10).fork()).join()}),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Bs();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;const i=wa.decode(n,n.uint32());i.value!==void 0&&(s.fields[i.key]=i.value);continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return nr.fromPartial(t??{})},fromPartial(t){var e;const n=Bs();return n.fields=Object.entries((e=t.fields)!=null?e:{}).reduce((r,[s,a])=>(a!==void 0&&(r[s]=a),r),{}),n},wrap(t){const e=Bs();if(t!==void 0)for(const n of Object.keys(t))e.fields[n]=t[n];return e},unwrap(t){const e={};if(t.fields)for(const n of Object.keys(t.fields))e[n]=t.fields[n];return e}};function Hi(){return{key:"",value:void 0}}var wa={encode(t,e=new ce){return t.key!==""&&e.uint32(10).string(t.key),t.value!==void 0&&re.encode(re.wrap(t.value),e.uint32(18).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Hi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.key=n.string();continue}case 2:{if(a!==18)break;s.value=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return wa.fromPartial(t??{})},fromPartial(t){var e,n;const r=Hi();return r.key=(e=t.key)!=null?e:"",r.value=(n=t.value)!=null?n:void 0,r}};function Fs(){return{nullValue:void 0,numberValue:void 0,stringValue:void 0,boolValue:void 0,structValue:void 0,listValue:void 0}}var re={encode(t,e=new ce){return t.nullValue!==void 0&&e.uint32(8).int32(t.nullValue),t.numberValue!==void 0&&e.uint32(17).double(t.numberValue),t.stringValue!==void 0&&e.uint32(26).string(t.stringValue),t.boolValue!==void 0&&e.uint32(32).bool(t.boolValue),t.structValue!==void 0&&nr.encode(nr.wrap(t.structValue),e.uint32(42).fork()).join(),t.listValue!==void 0&&rr.encode(rr.wrap(t.listValue),e.uint32(50).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Fs();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.nullValue=n.int32();continue}case 2:{if(a!==17)break;s.numberValue=n.double();continue}case 3:{if(a!==26)break;s.stringValue=n.string();continue}case 4:{if(a!==32)break;s.boolValue=n.bool();continue}case 5:{if(a!==42)break;s.structValue=nr.unwrap(nr.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.listValue=rr.unwrap(rr.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return re.fromPartial(t??{})},fromPartial(t){var e,n,r,s,a,i;const o=Fs();return o.nullValue=(e=t.nullValue)!=null?e:void 0,o.numberValue=(n=t.numberValue)!=null?n:void 0,o.stringValue=(r=t.stringValue)!=null?r:void 0,o.boolValue=(s=t.boolValue)!=null?s:void 0,o.structValue=(a=t.structValue)!=null?a:void 0,o.listValue=(i=t.listValue)!=null?i:void 0,o},wrap(t){const e=Fs();if(t===null)e.nullValue=0;else if(typeof t=="boolean")e.boolValue=t;else if(typeof t=="number")e.numberValue=t;else if(typeof t=="string")e.stringValue=t;else if(globalThis.Array.isArray(t))e.listValue=t;else if(typeof t=="object")e.structValue=t;else if(typeof t<"u")throw new globalThis.Error("Unsupported any value type: "+typeof t);return e},unwrap(t){if(t.stringValue!==void 0)return t.stringValue;if(t?.numberValue!==void 0)return t.numberValue;if(t?.boolValue!==void 0)return t.boolValue;if(t?.structValue!==void 0)return t.structValue;if(t?.listValue!==void 0)return t.listValue;if(t?.nullValue!==void 0)return null}};function Vs(){return{values:[]}}var rr={encode(t,e=new ce){for(const n of t.values)re.encode(re.wrap(n),e.uint32(10).fork()).join();return e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Vs();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.values.push(re.unwrap(re.decode(n,n.uint32())));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return rr.fromPartial(t??{})},fromPartial(t){var e;const n=Vs();return n.values=((e=t.values)==null?void 0:e.map(r=>r))||[],n},wrap(t){const e=Vs();return e.values=t??[],e},unwrap(t){return t?.hasOwnProperty("values")&&globalThis.Array.isArray(t.values)?t.values:t}},bu=(t=>(t[t.ADD=0]="ADD",t[t.REMOVE=1]="REMOVE",t[t.REPLACE=2]="REPLACE",t[t.MOVE=3]="MOVE",t[t.COPY=4]="COPY",t[t.TEST=5]="TEST",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(bu||{});function Zi(){return{op:0,path:"",from:void 0,value:void 0}}var Cr={encode(t,e=new ce){return t.op!==0&&e.uint32(8).int32(t.op),t.path!==""&&e.uint32(18).string(t.path),t.from!==void 0&&e.uint32(26).string(t.from),t.value!==void 0&&re.encode(re.wrap(t.value),e.uint32(34).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Zi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.op=n.int32();continue}case 2:{if(a!==18)break;s.path=n.string();continue}case 3:{if(a!==26)break;s.from=n.string();continue}case 4:{if(a!==34)break;s.value=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Cr.fromPartial(t??{})},fromPartial(t){var e,n,r,s;const a=Zi();return a.op=(e=t.op)!=null?e:0,a.path=(n=t.path)!=null?n:"",a.from=(r=t.from)!=null?r:void 0,a.value=(s=t.value)!=null?s:void 0,a}};function qi(){return{id:"",type:"",function:void 0}}var Nr={encode(t,e=new ce){return t.id!==""&&e.uint32(10).string(t.id),t.type!==""&&e.uint32(18).string(t.type),t.function!==void 0&&Rr.encode(t.function,e.uint32(26).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=qi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.type=n.string();continue}case 3:{if(a!==26)break;s.function=Rr.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Nr.fromPartial(t??{})},fromPartial(t){var e,n;const r=qi();return r.id=(e=t.id)!=null?e:"",r.type=(n=t.type)!=null?n:"",r.function=t.function!==void 0&&t.function!==null?Rr.fromPartial(t.function):void 0,r}};function Xi(){return{name:"",arguments:""}}var Rr={encode(t,e=new ce){return t.name!==""&&e.uint32(10).string(t.name),t.arguments!==""&&e.uint32(18).string(t.arguments),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Xi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.name=n.string();continue}case 2:{if(a!==18)break;s.arguments=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Rr.fromPartial(t??{})},fromPartial(t){var e,n;const r=Xi();return r.name=(e=t.name)!=null?e:"",r.arguments=(n=t.arguments)!=null?n:"",r}};function Ki(){return{id:"",role:"",content:void 0,name:void 0,toolCalls:[],toolCallId:void 0,error:void 0}}var Or={encode(t,e=new ce){t.id!==""&&e.uint32(10).string(t.id),t.role!==""&&e.uint32(18).string(t.role),t.content!==void 0&&e.uint32(26).string(t.content),t.name!==void 0&&e.uint32(34).string(t.name);for(const n of t.toolCalls)Nr.encode(n,e.uint32(42).fork()).join();return t.toolCallId!==void 0&&e.uint32(50).string(t.toolCallId),t.error!==void 0&&e.uint32(58).string(t.error),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Ki();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.id=n.string();continue}case 2:{if(a!==18)break;s.role=n.string();continue}case 3:{if(a!==26)break;s.content=n.string();continue}case 4:{if(a!==34)break;s.name=n.string();continue}case 5:{if(a!==42)break;s.toolCalls.push(Nr.decode(n,n.uint32()));continue}case 6:{if(a!==50)break;s.toolCallId=n.string();continue}case 7:{if(a!==58)break;s.error=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Or.fromPartial(t??{})},fromPartial(t){var e,n,r,s,a,i,o;const l=Ki();return l.id=(e=t.id)!=null?e:"",l.role=(n=t.role)!=null?n:"",l.content=(r=t.content)!=null?r:void 0,l.name=(s=t.name)!=null?s:void 0,l.toolCalls=((a=t.toolCalls)==null?void 0:a.map(u=>Nr.fromPartial(u)))||[],l.toolCallId=(i=t.toolCallId)!=null?i:void 0,l.error=(o=t.error)!=null?o:void 0,l}},wu=(t=>(t[t.TEXT_MESSAGE_START=0]="TEXT_MESSAGE_START",t[t.TEXT_MESSAGE_CONTENT=1]="TEXT_MESSAGE_CONTENT",t[t.TEXT_MESSAGE_END=2]="TEXT_MESSAGE_END",t[t.TOOL_CALL_START=3]="TOOL_CALL_START",t[t.TOOL_CALL_ARGS=4]="TOOL_CALL_ARGS",t[t.TOOL_CALL_END=5]="TOOL_CALL_END",t[t.STATE_SNAPSHOT=6]="STATE_SNAPSHOT",t[t.STATE_DELTA=7]="STATE_DELTA",t[t.MESSAGES_SNAPSHOT=8]="MESSAGES_SNAPSHOT",t[t.RAW=9]="RAW",t[t.CUSTOM=10]="CUSTOM",t[t.RUN_STARTED=11]="RUN_STARTED",t[t.RUN_FINISHED=12]="RUN_FINISHED",t[t.RUN_ERROR=13]="RUN_ERROR",t[t.STEP_STARTED=14]="STEP_STARTED",t[t.STEP_FINISHED=15]="STEP_FINISHED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(wu||{});function Ji(){return{type:0,timestamp:void 0,rawEvent:void 0}}var G={encode(t,e=new ce){return t.type!==0&&e.uint32(8).int32(t.type),t.timestamp!==void 0&&e.uint32(16).int64(t.timestamp),t.rawEvent!==void 0&&re.encode(re.wrap(t.rawEvent),e.uint32(26).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Ji();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==8)break;s.type=n.int32();continue}case 2:{if(a!==16)break;s.timestamp=bv(n.int64());continue}case 3:{if(a!==26)break;s.rawEvent=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return G.fromPartial(t??{})},fromPartial(t){var e,n,r;const s=Ji();return s.type=(e=t.type)!=null?e:0,s.timestamp=(n=t.timestamp)!=null?n:void 0,s.rawEvent=(r=t.rawEvent)!=null?r:void 0,s}};function Wi(){return{baseEvent:void 0,messageId:"",role:void 0}}var Mr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.messageId!==""&&e.uint32(18).string(t.messageId),t.role!==void 0&&e.uint32(26).string(t.role),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Wi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Mr.fromPartial(t??{})},fromPartial(t){var e,n;const r=Wi();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.messageId=(e=t.messageId)!=null?e:"",r.role=(n=t.role)!=null?n:void 0,r}};function Yi(){return{baseEvent:void 0,messageId:"",delta:""}}var Pr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.messageId!==""&&e.uint32(18).string(t.messageId),t.delta!==""&&e.uint32(26).string(t.delta),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Yi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Pr.fromPartial(t??{})},fromPartial(t){var e,n;const r=Yi();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.messageId=(e=t.messageId)!=null?e:"",r.delta=(n=t.delta)!=null?n:"",r}};function Qi(){return{baseEvent:void 0,messageId:""}}var Lr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.messageId!==""&&e.uint32(18).string(t.messageId),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=Qi();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Lr.fromPartial(t??{})},fromPartial(t){var e;const n=Qi();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.messageId=(e=t.messageId)!=null?e:"",n}};function eo(){return{baseEvent:void 0,toolCallId:"",toolCallName:"",parentMessageId:void 0}}var $r={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.toolCallId!==""&&e.uint32(18).string(t.toolCallId),t.toolCallName!==""&&e.uint32(26).string(t.toolCallName),t.parentMessageId!==void 0&&e.uint32(34).string(t.parentMessageId),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=eo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return $r.fromPartial(t??{})},fromPartial(t){var e,n,r;const s=eo();return s.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,s.toolCallId=(e=t.toolCallId)!=null?e:"",s.toolCallName=(n=t.toolCallName)!=null?n:"",s.parentMessageId=(r=t.parentMessageId)!=null?r:void 0,s}};function to(){return{baseEvent:void 0,toolCallId:"",delta:""}}var Dr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.toolCallId!==""&&e.uint32(18).string(t.toolCallId),t.delta!==""&&e.uint32(26).string(t.delta),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=to();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Dr.fromPartial(t??{})},fromPartial(t){var e,n;const r=to();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.toolCallId=(e=t.toolCallId)!=null?e:"",r.delta=(n=t.delta)!=null?n:"",r}};function no(){return{baseEvent:void 0,toolCallId:""}}var Ur={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.toolCallId!==""&&e.uint32(18).string(t.toolCallId),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=no();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Ur.fromPartial(t??{})},fromPartial(t){var e;const n=no();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.toolCallId=(e=t.toolCallId)!=null?e:"",n}};function ro(){return{baseEvent:void 0,snapshot:void 0}}var zr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.snapshot!==void 0&&re.encode(re.wrap(t.snapshot),e.uint32(18).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=ro();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.snapshot=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return zr.fromPartial(t??{})},fromPartial(t){var e;const n=ro();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.snapshot=(e=t.snapshot)!=null?e:void 0,n}};function so(){return{baseEvent:void 0,delta:[]}}var Gr={encode(t,e=new ce){t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join();for(const n of t.delta)Cr.encode(n,e.uint32(18).fork()).join();return e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=so();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.delta.push(Cr.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Gr.fromPartial(t??{})},fromPartial(t){var e;const n=so();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.delta=((e=t.delta)==null?void 0:e.map(r=>Cr.fromPartial(r)))||[],n}};function ao(){return{baseEvent:void 0,messages:[]}}var Br={encode(t,e=new ce){t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join();for(const n of t.messages)Or.encode(n,e.uint32(18).fork()).join();return e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=ao();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messages.push(Or.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Br.fromPartial(t??{})},fromPartial(t){var e;const n=ao();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.messages=((e=t.messages)==null?void 0:e.map(r=>Or.fromPartial(r)))||[],n}};function io(){return{baseEvent:void 0,event:void 0,source:void 0}}var Fr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.event!==void 0&&re.encode(re.wrap(t.event),e.uint32(18).fork()).join(),t.source!==void 0&&e.uint32(26).string(t.source),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=io();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.event=re.unwrap(re.decode(n,n.uint32()));continue}case 3:{if(a!==26)break;s.source=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Fr.fromPartial(t??{})},fromPartial(t){var e,n;const r=io();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.event=(e=t.event)!=null?e:void 0,r.source=(n=t.source)!=null?n:void 0,r}};function oo(){return{baseEvent:void 0,name:"",value:void 0}}var Vr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.name!==""&&e.uint32(18).string(t.name),t.value!==void 0&&re.encode(re.wrap(t.value),e.uint32(26).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=oo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.name=n.string();continue}case 3:{if(a!==26)break;s.value=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Vr.fromPartial(t??{})},fromPartial(t){var e,n;const r=oo();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.name=(e=t.name)!=null?e:"",r.value=(n=t.value)!=null?n:void 0,r}};function lo(){return{baseEvent:void 0,threadId:"",runId:""}}var jr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.threadId!==""&&e.uint32(18).string(t.threadId),t.runId!==""&&e.uint32(26).string(t.runId),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=lo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return jr.fromPartial(t??{})},fromPartial(t){var e,n;const r=lo();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.threadId=(e=t.threadId)!=null?e:"",r.runId=(n=t.runId)!=null?n:"",r}};function uo(){return{baseEvent:void 0,threadId:"",runId:"",result:void 0}}var Hr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.threadId!==""&&e.uint32(18).string(t.threadId),t.runId!==""&&e.uint32(26).string(t.runId),t.result!==void 0&&re.encode(re.wrap(t.result),e.uint32(34).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=uo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.threadId=n.string();continue}case 3:{if(a!==26)break;s.runId=n.string();continue}case 4:{if(a!==34)break;s.result=re.unwrap(re.decode(n,n.uint32()));continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Hr.fromPartial(t??{})},fromPartial(t){var e,n,r;const s=uo();return s.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,s.threadId=(e=t.threadId)!=null?e:"",s.runId=(n=t.runId)!=null?n:"",s.result=(r=t.result)!=null?r:void 0,s}};function co(){return{baseEvent:void 0,code:void 0,message:""}}var Zr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.code!==void 0&&e.uint32(18).string(t.code),t.message!==""&&e.uint32(26).string(t.message),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=co();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.code=n.string();continue}case 3:{if(a!==26)break;s.message=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Zr.fromPartial(t??{})},fromPartial(t){var e,n;const r=co();return r.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,r.code=(e=t.code)!=null?e:void 0,r.message=(n=t.message)!=null?n:"",r}};function fo(){return{baseEvent:void 0,stepName:""}}var qr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.stepName!==""&&e.uint32(18).string(t.stepName),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=fo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return qr.fromPartial(t??{})},fromPartial(t){var e;const n=fo();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.stepName=(e=t.stepName)!=null?e:"",n}};function ho(){return{baseEvent:void 0,stepName:""}}var Xr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.stepName!==""&&e.uint32(18).string(t.stepName),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=ho();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.stepName=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Xr.fromPartial(t??{})},fromPartial(t){var e;const n=ho();return n.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,n.stepName=(e=t.stepName)!=null?e:"",n}};function vo(){return{baseEvent:void 0,messageId:void 0,role:void 0,delta:void 0}}var Kr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.messageId!==void 0&&e.uint32(18).string(t.messageId),t.role!==void 0&&e.uint32(26).string(t.role),t.delta!==void 0&&e.uint32(34).string(t.delta),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=vo();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.messageId=n.string();continue}case 3:{if(a!==26)break;s.role=n.string();continue}case 4:{if(a!==34)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Kr.fromPartial(t??{})},fromPartial(t){var e,n,r;const s=vo();return s.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,s.messageId=(e=t.messageId)!=null?e:void 0,s.role=(n=t.role)!=null?n:void 0,s.delta=(r=t.delta)!=null?r:void 0,s}};function po(){return{baseEvent:void 0,toolCallId:void 0,toolCallName:void 0,parentMessageId:void 0,delta:void 0}}var Jr={encode(t,e=new ce){return t.baseEvent!==void 0&&G.encode(t.baseEvent,e.uint32(10).fork()).join(),t.toolCallId!==void 0&&e.uint32(18).string(t.toolCallId),t.toolCallName!==void 0&&e.uint32(26).string(t.toolCallName),t.parentMessageId!==void 0&&e.uint32(34).string(t.parentMessageId),t.delta!==void 0&&e.uint32(42).string(t.delta),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=po();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.baseEvent=G.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.toolCallId=n.string();continue}case 3:{if(a!==26)break;s.toolCallName=n.string();continue}case 4:{if(a!==34)break;s.parentMessageId=n.string();continue}case 5:{if(a!==42)break;s.delta=n.string();continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Jr.fromPartial(t??{})},fromPartial(t){var e,n,r,s;const a=po();return a.baseEvent=t.baseEvent!==void 0&&t.baseEvent!==null?G.fromPartial(t.baseEvent):void 0,a.toolCallId=(e=t.toolCallId)!=null?e:void 0,a.toolCallName=(n=t.toolCallName)!=null?n:void 0,a.parentMessageId=(r=t.parentMessageId)!=null?r:void 0,a.delta=(s=t.delta)!=null?s:void 0,a}};function go(){return{textMessageStart:void 0,textMessageContent:void 0,textMessageEnd:void 0,toolCallStart:void 0,toolCallArgs:void 0,toolCallEnd:void 0,stateSnapshot:void 0,stateDelta:void 0,messagesSnapshot:void 0,raw:void 0,custom:void 0,runStarted:void 0,runFinished:void 0,runError:void 0,stepStarted:void 0,stepFinished:void 0,textMessageChunk:void 0,toolCallChunk:void 0}}var Eu={encode(t,e=new ce){return t.textMessageStart!==void 0&&Mr.encode(t.textMessageStart,e.uint32(10).fork()).join(),t.textMessageContent!==void 0&&Pr.encode(t.textMessageContent,e.uint32(18).fork()).join(),t.textMessageEnd!==void 0&&Lr.encode(t.textMessageEnd,e.uint32(26).fork()).join(),t.toolCallStart!==void 0&&$r.encode(t.toolCallStart,e.uint32(34).fork()).join(),t.toolCallArgs!==void 0&&Dr.encode(t.toolCallArgs,e.uint32(42).fork()).join(),t.toolCallEnd!==void 0&&Ur.encode(t.toolCallEnd,e.uint32(50).fork()).join(),t.stateSnapshot!==void 0&&zr.encode(t.stateSnapshot,e.uint32(58).fork()).join(),t.stateDelta!==void 0&&Gr.encode(t.stateDelta,e.uint32(66).fork()).join(),t.messagesSnapshot!==void 0&&Br.encode(t.messagesSnapshot,e.uint32(74).fork()).join(),t.raw!==void 0&&Fr.encode(t.raw,e.uint32(82).fork()).join(),t.custom!==void 0&&Vr.encode(t.custom,e.uint32(90).fork()).join(),t.runStarted!==void 0&&jr.encode(t.runStarted,e.uint32(98).fork()).join(),t.runFinished!==void 0&&Hr.encode(t.runFinished,e.uint32(106).fork()).join(),t.runError!==void 0&&Zr.encode(t.runError,e.uint32(114).fork()).join(),t.stepStarted!==void 0&&qr.encode(t.stepStarted,e.uint32(122).fork()).join(),t.stepFinished!==void 0&&Xr.encode(t.stepFinished,e.uint32(130).fork()).join(),t.textMessageChunk!==void 0&&Kr.encode(t.textMessageChunk,e.uint32(138).fork()).join(),t.toolCallChunk!==void 0&&Jr.encode(t.toolCallChunk,e.uint32(146).fork()).join(),e},decode(t,e){const n=t instanceof z?t:new z(t),r=e===void 0?n.len:n.pos+e,s=go();for(;n.pos<r;){const a=n.uint32();switch(a>>>3){case 1:{if(a!==10)break;s.textMessageStart=Mr.decode(n,n.uint32());continue}case 2:{if(a!==18)break;s.textMessageContent=Pr.decode(n,n.uint32());continue}case 3:{if(a!==26)break;s.textMessageEnd=Lr.decode(n,n.uint32());continue}case 4:{if(a!==34)break;s.toolCallStart=$r.decode(n,n.uint32());continue}case 5:{if(a!==42)break;s.toolCallArgs=Dr.decode(n,n.uint32());continue}case 6:{if(a!==50)break;s.toolCallEnd=Ur.decode(n,n.uint32());continue}case 7:{if(a!==58)break;s.stateSnapshot=zr.decode(n,n.uint32());continue}case 8:{if(a!==66)break;s.stateDelta=Gr.decode(n,n.uint32());continue}case 9:{if(a!==74)break;s.messagesSnapshot=Br.decode(n,n.uint32());continue}case 10:{if(a!==82)break;s.raw=Fr.decode(n,n.uint32());continue}case 11:{if(a!==90)break;s.custom=Vr.decode(n,n.uint32());continue}case 12:{if(a!==98)break;s.runStarted=jr.decode(n,n.uint32());continue}case 13:{if(a!==106)break;s.runFinished=Hr.decode(n,n.uint32());continue}case 14:{if(a!==114)break;s.runError=Zr.decode(n,n.uint32());continue}case 15:{if(a!==122)break;s.stepStarted=qr.decode(n,n.uint32());continue}case 16:{if(a!==130)break;s.stepFinished=Xr.decode(n,n.uint32());continue}case 17:{if(a!==138)break;s.textMessageChunk=Kr.decode(n,n.uint32());continue}case 18:{if(a!==146)break;s.toolCallChunk=Jr.decode(n,n.uint32());continue}}if((a&7)===4||a===0)break;n.skip(a&7)}return s},create(t){return Eu.fromPartial(t??{})},fromPartial(t){const e=go();return e.textMessageStart=t.textMessageStart!==void 0&&t.textMessageStart!==null?Mr.fromPartial(t.textMessageStart):void 0,e.textMessageContent=t.textMessageContent!==void 0&&t.textMessageContent!==null?Pr.fromPartial(t.textMessageContent):void 0,e.textMessageEnd=t.textMessageEnd!==void 0&&t.textMessageEnd!==null?Lr.fromPartial(t.textMessageEnd):void 0,e.toolCallStart=t.toolCallStart!==void 0&&t.toolCallStart!==null?$r.fromPartial(t.toolCallStart):void 0,e.toolCallArgs=t.toolCallArgs!==void 0&&t.toolCallArgs!==null?Dr.fromPartial(t.toolCallArgs):void 0,e.toolCallEnd=t.toolCallEnd!==void 0&&t.toolCallEnd!==null?Ur.fromPartial(t.toolCallEnd):void 0,e.stateSnapshot=t.stateSnapshot!==void 0&&t.stateSnapshot!==null?zr.fromPartial(t.stateSnapshot):void 0,e.stateDelta=t.stateDelta!==void 0&&t.stateDelta!==null?Gr.fromPartial(t.stateDelta):void 0,e.messagesSnapshot=t.messagesSnapshot!==void 0&&t.messagesSnapshot!==null?Br.fromPartial(t.messagesSnapshot):void 0,e.raw=t.raw!==void 0&&t.raw!==null?Fr.fromPartial(t.raw):void 0,e.custom=t.custom!==void 0&&t.custom!==null?Vr.fromPartial(t.custom):void 0,e.runStarted=t.runStarted!==void 0&&t.runStarted!==null?jr.fromPartial(t.runStarted):void 0,e.runFinished=t.runFinished!==void 0&&t.runFinished!==null?Hr.fromPartial(t.runFinished):void 0,e.runError=t.runError!==void 0&&t.runError!==null?Zr.fromPartial(t.runError):void 0,e.stepStarted=t.stepStarted!==void 0&&t.stepStarted!==null?qr.fromPartial(t.stepStarted):void 0,e.stepFinished=t.stepFinished!==void 0&&t.stepFinished!==null?Xr.fromPartial(t.stepFinished):void 0,e.textMessageChunk=t.textMessageChunk!==void 0&&t.textMessageChunk!==null?Kr.fromPartial(t.textMessageChunk):void 0,e.toolCallChunk=t.toolCallChunk!==void 0&&t.toolCallChunk!==null?Jr.fromPartial(t.toolCallChunk):void 0,e}};function bv(t){const e=globalThis.Number(t.toString());if(e>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(e<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return e}function wv(t){var e;const n=Eu.decode(t),r=Object.values(n).find(s=>s!==void 0);if(!r)throw new Error("Invalid event");if(r.type=wu[r.baseEvent.type],r.timestamp=r.baseEvent.timestamp,r.rawEvent=r.baseEvent.rawEvent,r.type===S.MESSAGES_SNAPSHOT)for(const s of r.messages){const a=s;((e=a.toolCalls)==null?void 0:e.length)===0&&(a.toolCalls=void 0)}if(r.type===S.STATE_DELTA)for(const s of r.delta)s.op=bu[s.op].toLowerCase(),Object.keys(s).forEach(a=>{s[a]===void 0&&delete s[a]});return Object.keys(r).forEach(s=>{r[s]===void 0&&delete r[s]}),jl.parse(r)}var Ev="application/vnd.ag-ui.event+proto";const kv=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,mo=t=>{if(typeof t!="string")throw new TypeError("Invalid argument expected string");const e=t.match(kv);if(!e)throw new Error(`Invalid argument not valid semver ('${t}' received)`);return e.shift(),e},_o=t=>t==="*"||t==="x"||t==="X",yo=t=>{const e=parseInt(t,10);return isNaN(e)?t:e},Sv=(t,e)=>typeof t!=typeof e?[String(t),String(e)]:[t,e],xv=(t,e)=>{if(_o(t)||_o(e))return 0;const[n,r]=Sv(yo(t),yo(e));return n>r?1:n<r?-1:0},bo=(t,e)=>{for(let n=0;n<Math.max(t.length,e.length);n++){const r=xv(t[n]||"0",e[n]||"0");if(r!==0)return r}return 0},Tv=(t,e)=>{const n=mo(t),r=mo(e),s=n.pop(),a=r.pop(),i=bo(n,r);return i!==0?i:s&&a?bo(s.split("."),a.split(".")):s||a?s?-1:1:0};var Av={},Iv=Object.defineProperty,Cv=Object.defineProperties,Nv=Object.getOwnPropertyDescriptors,gs=Object.getOwnPropertySymbols,ku=Object.prototype.hasOwnProperty,Su=Object.prototype.propertyIsEnumerable,wo=(t,e,n)=>e in t?Iv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ue=(t,e)=>{for(var n in e||(e={}))ku.call(e,n)&&wo(t,n,e[n]);if(gs)for(var n of gs(e))Su.call(e,n)&&wo(t,n,e[n]);return t},Wt=(t,e)=>Cv(t,Nv(e)),Rv=(t,e)=>{var n={};for(var r in t)ku.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&gs)for(var r of gs(t))e.indexOf(r)<0&&Su.call(t,r)&&(n[r]=t[r]);return n},ue=t=>{if(typeof structuredClone=="function")return structuredClone(t);try{return JSON.parse(JSON.stringify(t))}catch{return Ue({},t)}};async function me(t,e,n,r){let s=e,a=n,i;for(let o of t)try{let l=await r(o,ue(s),ue(a));if(l===void 0)continue;if(l.messages!==void 0&&(s=l.messages),l.state!==void 0&&(a=l.state),i=l.stopPropagation,i===!0)break}catch(l){Av.JEST_WORKER_ID!==void 0||console.error("Subscriber error:",l);continue}return Ue(Ue(Ue({},JSON.stringify(s)!==JSON.stringify(e)?{messages:s}:{}),JSON.stringify(a)!==JSON.stringify(n)?{state:a}:{}),i!==void 0?{stopPropagation:i}:{})}var xu=(t,e,n,r)=>{let s=ue(n.messages),a=ue(t.state),i={},o=u=>{u.messages!==void 0&&(s=u.messages,i.messages=u.messages),u.state!==void 0&&(a=u.state,i.state=u.state)},l=()=>{let u=ue(i);return i={},u.messages!==void 0||u.state!==void 0?Ee(u):du};return e.pipe(cu(async u=>{var c,f,v,d;let h=await me(r,s,a,(p,g,m)=>{var b;return(b=p.onEvent)==null?void 0:b.call(p,{event:u,agent:n,input:t,messages:g,state:m})});if(o(h),h.stopPropagation===!0)return l();switch(u.type){case S.TEXT_MESSAGE_START:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onTextMessageStartEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{messageId:g,role:m="assistant"}=u,b={id:g,role:m,content:""};s.push(b),o({messages:s})}return l()}case S.TEXT_MESSAGE_CONTENT:{let{messageId:p,delta:g}=u,m=s.find(_=>_.id===p);if(!m)return console.warn(`TEXT_MESSAGE_CONTENT: No message found with ID '${p}'`),l();let b=await me(r,s,a,(_,x,I)=>{var R;return(R=_.onTextMessageContentEvent)==null?void 0:R.call(_,{event:u,messages:x,state:I,agent:n,input:t,textMessageBuffer:typeof m.content=="string"?m.content:""})});if(o(b),b.stopPropagation!==!0){let _=typeof m.content=="string"?m.content:"";m.content=`${_}${g}`,o({messages:s})}return l()}case S.TEXT_MESSAGE_END:{let{messageId:p}=u,g=s.find(b=>b.id===p);if(!g)return console.warn(`TEXT_MESSAGE_END: No message found with ID '${p}'`),l();let m=await me(r,s,a,(b,_,x)=>{var I;return(I=b.onTextMessageEndEvent)==null?void 0:I.call(b,{event:u,messages:_,state:x,agent:n,input:t,textMessageBuffer:typeof g.content=="string"?g.content:""})});return o(m),await Promise.all(r.map(b=>{var _;(_=b.onNewMessage)==null||_.call(b,{message:g,messages:s,state:a,agent:n,input:t})})),l()}case S.TOOL_CALL_START:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onToolCallStartEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{toolCallId:g,toolCallName:m,parentMessageId:b}=u,_;b&&s.length>0&&s[s.length-1].id===b?_=s[s.length-1]:(_={id:b||g,role:"assistant",toolCalls:[]},s.push(_)),_.toolCalls!=null||(_.toolCalls=[]),_.toolCalls.push({id:g,type:"function",function:{name:m,arguments:""}}),o({messages:s})}return l()}case S.TOOL_CALL_ARGS:{let{toolCallId:p,delta:g}=u,m=s.find(x=>{var I;return(I=x.toolCalls)==null?void 0:I.some(R=>R.id===p)});if(!m)return console.warn(`TOOL_CALL_ARGS: No message found containing tool call with ID '${p}'`),l();let b=m.toolCalls.find(x=>x.id===p);if(!b)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${p}'`),l();let _=await me(r,s,a,(x,I,R)=>{var H;let q=b.function.arguments,O=b.function.name,Z={};try{Z=gu(q)}catch{}return(H=x.onToolCallArgsEvent)==null?void 0:H.call(x,{event:u,messages:I,state:R,agent:n,input:t,toolCallBuffer:q,toolCallName:O,partialToolCallArgs:Z})});return o(_),_.stopPropagation!==!0&&(b.function.arguments+=g,o({messages:s})),l()}case S.TOOL_CALL_END:{let{toolCallId:p}=u,g=s.find(_=>{var x;return(x=_.toolCalls)==null?void 0:x.some(I=>I.id===p)});if(!g)return console.warn(`TOOL_CALL_END: No message found containing tool call with ID '${p}'`),l();let m=g.toolCalls.find(_=>_.id===p);if(!m)return console.warn(`TOOL_CALL_END: No tool call found with ID '${p}'`),l();let b=await me(r,s,a,(_,x,I)=>{var R;let H=m.function.arguments,q=m.function.name,O={};try{O=JSON.parse(H)}catch{}return(R=_.onToolCallEndEvent)==null?void 0:R.call(_,{event:u,messages:x,state:I,agent:n,input:t,toolCallName:q,toolCallArgs:O})});return o(b),await Promise.all(r.map(_=>{var x;(x=_.onNewToolCall)==null||x.call(_,{toolCall:m,messages:s,state:a,agent:n,input:t})})),l()}case S.TOOL_CALL_RESULT:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onToolCallResultEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{messageId:g,toolCallId:m,content:b,role:_}=u,x={id:g,toolCallId:m,role:_||"tool",content:b};s.push(x),await Promise.all(r.map(I=>{var R;(R=I.onNewMessage)==null||R.call(I,{message:x,messages:s,state:a,agent:n,input:t})})),o({messages:s})}return l()}case S.STATE_SNAPSHOT:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onStateSnapshotEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{snapshot:g}=u;a=g,o({state:a})}return l()}case S.STATE_DELTA:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onStateDeltaEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{delta:g}=u;try{a=Gn(a,g,!0,!1).newDocument,o({state:a})}catch(m){let b=m instanceof Error?m.message:String(m);console.warn(`Failed to apply state patch:
Current state: ${JSON.stringify(a,null,2)}
Patch operations: ${JSON.stringify(g,null,2)}
Error: ${b}`)}}return l()}case S.MESSAGES_SNAPSHOT:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onMessagesSnapshotEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let{messages:g}=u;s=g,o({messages:s})}return l()}case S.ACTIVITY_SNAPSHOT:{let p=u,g=s.findIndex(I=>I.id===p.messageId),m=g>=0?s[g]:void 0,b=m?.role==="activity"?m:void 0,_=(c=p.replace)!=null?c:!0,x=await me(r,s,a,(I,R,H)=>{var q;return(q=I.onActivitySnapshotEvent)==null?void 0:q.call(I,{event:p,messages:R,state:H,agent:n,input:t,activityMessage:b,existingMessage:m})});if(o(x),x.stopPropagation!==!0){let I={id:p.messageId,role:"activity",activityType:p.activityType,content:ue(p.content)},R;g===-1?(s.push(I),R=I):b?_&&(s[g]=Wt(Ue({},b),{activityType:p.activityType,content:ue(p.content)})):_&&(s[g]=I,R=I),o({messages:s}),R&&await Promise.all(r.map(H=>{var q;return(q=H.onNewMessage)==null?void 0:q.call(H,{message:R,messages:s,state:a,agent:n,input:t})}))}return l()}case S.ACTIVITY_DELTA:{let p=u,g=s.findIndex(x=>x.id===p.messageId);if(g===-1)return console.warn(`ACTIVITY_DELTA: No message found with ID '${p.messageId}' to apply patch`),l();let m=s[g];if(m.role!=="activity")return console.warn(`ACTIVITY_DELTA: Message '${p.messageId}' is not an activity message`),l();let b=m,_=await me(r,s,a,(x,I,R)=>{var H;return(H=x.onActivityDeltaEvent)==null?void 0:H.call(x,{event:p,messages:I,state:R,agent:n,input:t,activityMessage:b})});if(o(_),_.stopPropagation!==!0)try{let x=ue((f=b.content)!=null?f:{}),I=Gn(x,(v=p.patch)!=null?v:[],!0,!1).newDocument;s[g]=Wt(Ue({},b),{content:ue(I),activityType:p.activityType}),o({messages:s})}catch(x){let I=x instanceof Error?x.message:String(x);console.warn(`Failed to apply activity patch for '${p.messageId}': ${I}`)}return l()}case S.RAW:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onRawEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});return o(p),l()}case S.CUSTOM:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onCustomEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});return o(p),l()}case S.RUN_STARTED:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onRunStartedEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});if(o(p),p.stopPropagation!==!0){let g=u;if((d=g.input)!=null&&d.messages){for(let m of g.input.messages)s.find(b=>b.id===m.id)||s.push(m);o({messages:s})}}return l()}case S.RUN_FINISHED:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onRunFinishedEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t,result:u.result})});return o(p),l()}case S.RUN_ERROR:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onRunErrorEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});return o(p),l()}case S.STEP_STARTED:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onStepStartedEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});return o(p),l()}case S.STEP_FINISHED:{let p=await me(r,s,a,(g,m,b)=>{var _;return(_=g.onStepFinishedEvent)==null?void 0:_.call(g,{event:u,messages:m,state:b,agent:n,input:t})});return o(p),l()}case S.TEXT_MESSAGE_CHUNK:throw new Error("TEXT_MESSAGE_CHUNK must be tranformed before being applied");case S.TOOL_CALL_CHUNK:throw new Error("TOOL_CALL_CHUNK must be tranformed before being applied");case S.THINKING_START:return l();case S.THINKING_END:return l();case S.THINKING_TEXT_MESSAGE_START:return l();case S.THINKING_TEXT_MESSAGE_CONTENT:return l();case S.THINKING_TEXT_MESSAGE_END:return l()}return u.type,l()}),Dh(),r.length>0?zh({}):u=>u)},js=t=>e=>{let n=new Map,r=new Map,s=!1,a=!1,i=!1,o=new Map,l=!1,u=!1,c=!1,f=()=>{n.clear(),r.clear(),o.clear(),l=!1,u=!1,s=!1,a=!1,c=!0};return e.pipe(Jt(v=>{let d=v.type;if(t&&console.debug("[VERIFY]:",JSON.stringify(v)),a)return ge(()=>new ye(`Cannot send event type '${d}': The run has already errored with 'RUN_ERROR'. No further events can be sent.`));if(s&&d!==S.RUN_ERROR&&d!==S.RUN_STARTED)return ge(()=>new ye(`Cannot send event type '${d}': The run has already finished with 'RUN_FINISHED'. Start a new run with 'RUN_STARTED'.`));if(i){if(d===S.RUN_STARTED){if(c&&!s)return ge(()=>new ye("Cannot send 'RUN_STARTED' while a run is still active. The previous run must be finished with 'RUN_FINISHED' before starting a new run."));s&&f()}}else if(i=!0,d!==S.RUN_STARTED&&d!==S.RUN_ERROR)return ge(()=>new ye("First event must be 'RUN_STARTED'"));switch(d){case S.TEXT_MESSAGE_START:{let h=v.messageId;return n.has(h)?ge(()=>new ye(`Cannot send 'TEXT_MESSAGE_START' event: A text message with ID '${h}' is already in progress. Complete it with 'TEXT_MESSAGE_END' first.`)):(n.set(h,!0),Ee(v))}case S.TEXT_MESSAGE_CONTENT:{let h=v.messageId;return n.has(h)?Ee(v):ge(()=>new ye(`Cannot send 'TEXT_MESSAGE_CONTENT' event: No active text message found with ID '${h}'. Start a text message with 'TEXT_MESSAGE_START' first.`))}case S.TEXT_MESSAGE_END:{let h=v.messageId;return n.has(h)?(n.delete(h),Ee(v)):ge(()=>new ye(`Cannot send 'TEXT_MESSAGE_END' event: No active text message found with ID '${h}'. A 'TEXT_MESSAGE_START' event must be sent first.`))}case S.TOOL_CALL_START:{let h=v.toolCallId;return r.has(h)?ge(()=>new ye(`Cannot send 'TOOL_CALL_START' event: A tool call with ID '${h}' is already in progress. Complete it with 'TOOL_CALL_END' first.`)):(r.set(h,!0),Ee(v))}case S.TOOL_CALL_ARGS:{let h=v.toolCallId;return r.has(h)?Ee(v):ge(()=>new ye(`Cannot send 'TOOL_CALL_ARGS' event: No active tool call found with ID '${h}'. Start a tool call with 'TOOL_CALL_START' first.`))}case S.TOOL_CALL_END:{let h=v.toolCallId;return r.has(h)?(r.delete(h),Ee(v)):ge(()=>new ye(`Cannot send 'TOOL_CALL_END' event: No active tool call found with ID '${h}'. A 'TOOL_CALL_START' event must be sent first.`))}case S.STEP_STARTED:{let h=v.stepName;return o.has(h)?ge(()=>new ye(`Step "${h}" is already active for 'STEP_STARTED'`)):(o.set(h,!0),Ee(v))}case S.STEP_FINISHED:{let h=v.stepName;return o.has(h)?(o.delete(h),Ee(v)):ge(()=>new ye(`Cannot send 'STEP_FINISHED' for step "${h}" that was not started`))}case S.RUN_STARTED:return c=!0,Ee(v);case S.RUN_FINISHED:{if(o.size>0){let h=Array.from(o.keys()).join(", ");return ge(()=>new ye(`Cannot send 'RUN_FINISHED' while steps are still active: ${h}`))}if(n.size>0){let h=Array.from(n.keys()).join(", ");return ge(()=>new ye(`Cannot send 'RUN_FINISHED' while text messages are still active: ${h}`))}if(r.size>0){let h=Array.from(r.keys()).join(", ");return ge(()=>new ye(`Cannot send 'RUN_FINISHED' while tool calls are still active: ${h}`))}return s=!0,Ee(v)}case S.RUN_ERROR:return a=!0,Ee(v);case S.CUSTOM:return Ee(v);case S.THINKING_TEXT_MESSAGE_START:return l?u?ge(()=>new ye("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking message is already in progress. Complete it with 'THINKING_TEXT_MESSAGE_END' first.")):(u=!0,Ee(v)):ge(()=>new ye("Cannot send 'THINKING_TEXT_MESSAGE_START' event: A thinking step is not in progress. Create one with 'THINKING_START' first."));case S.THINKING_TEXT_MESSAGE_CONTENT:return u?Ee(v):ge(()=>new ye("Cannot send 'THINKING_TEXT_MESSAGE_CONTENT' event: No active thinking message found. Start a message with 'THINKING_TEXT_MESSAGE_START' first."));case S.THINKING_TEXT_MESSAGE_END:return u?(u=!1,Ee(v)):ge(()=>new ye("Cannot send 'THINKING_TEXT_MESSAGE_END' event: No active thinking message found. A 'THINKING_TEXT_MESSAGE_START' event must be sent first."));case S.THINKING_START:return l?ge(()=>new ye("Cannot send 'THINKING_START' event: A thinking step is already in progress. End it with 'THINKING_END' first.")):(l=!0,Ee(v));case S.THINKING_END:return l?(l=!1,Ee(v)):ge(()=>new ye("Cannot send 'THINKING_END' event: No active thinking step found. A 'THINKING_START' event must be sent first."));default:return Ee(v)}}))},Ov=(t,e)=>Vh(()=>hs(fetch(t,e))).pipe(Bh(n=>{var r;if(!n.ok){let i=n.headers.get("content-type")||"";return hs(n.text()).pipe(Jt(o=>{let l=o;if(i.includes("application/json"))try{l=JSON.parse(o)}catch{}let u=new Error(`HTTP ${n.status}: ${typeof l=="string"?l:JSON.stringify(l)}`);return u.status=n.status,u.payload=l,ge(()=>u)}))}let s={type:"headers",status:n.status,headers:n.headers},a=(r=n.body)==null?void 0:r.getReader();return a?new je(i=>(i.next(s),(async()=>{try{for(;;){let{done:o,value:l}=await a.read();if(o)break;let u={type:"data",data:l};i.next(u)}i.complete()}catch(o){i.error(o)}})(),()=>{a.cancel().catch(o=>{if(o?.name!=="AbortError")throw o})})):ge(()=>new Error("Failed to getReader() from response"))})),Mv=t=>{let e=new vn,n=new TextDecoder("utf-8",{fatal:!1}),r="";t.subscribe({next:a=>{if(a.type!=="headers"&&a.type==="data"&&a.data){let i=n.decode(a.data,{stream:!0});r+=i;let o=r.split(/\n\n/);r=o.pop()||"";for(let l of o)s(l)}},error:a=>e.error(a),complete:()=>{r&&(r+=n.decode(),s(r)),e.complete()}});function s(a){let i=a.split(`
`),o=[];for(let l of i)l.startsWith("data: ")&&o.push(l.slice(6));if(o.length>0)try{let l=o.join(`
`),u=JSON.parse(l);e.next(u)}catch(l){e.error(l)}}return e.asObservable()},Pv=t=>{let e=new vn,n=new Uint8Array(0);t.subscribe({next:s=>{if(s.type!=="headers"&&s.type==="data"&&s.data){let a=new Uint8Array(n.length+s.data.length);a.set(n,0),a.set(s.data,n.length),n=a,r()}},error:s=>e.error(s),complete:()=>{if(n.length>0)try{r()}catch{console.warn("Incomplete or invalid protocol buffer data at stream end")}e.complete()}});function r(){for(;n.length>=4;){let s=4+new DataView(n.buffer,n.byteOffset,4).getUint32(0,!1);if(n.length<s)break;try{let a=n.slice(4,s),i=wv(a);e.next(i),n=n.slice(s)}catch(a){let i=a instanceof Error?a.message:String(a);e.error(new Error(`Failed to decode protocol buffer message: ${i}`));return}}}return e.asObservable()},Lv=t=>{let e=new vn,n=new fu,r=!1;return t.subscribe({next:s=>{n.next(s),s.type==="headers"&&!r?(r=!0,s.headers.get("content-type")===Ev?Pv(n).subscribe({next:a=>e.next(a),error:a=>e.error(a),complete:()=>e.complete()}):Mv(n).subscribe({next:a=>{try{let i=jl.parse(a);e.next(i)}catch(i){e.error(i)}},error:a=>{if(a?.name==="AbortError"){e.next({type:S.RUN_ERROR,rawEvent:a}),e.complete();return}return e.error(a)},complete:()=>e.complete()})):r||e.error(new Error("No headers event received before data events"))},error:s=>{n.error(s),e.error(s)},complete:()=>{n.complete()}}),e.asObservable()},de=Ul(["TextMessageStart","TextMessageContent","TextMessageEnd","ActionExecutionStart","ActionExecutionArgs","ActionExecutionEnd","ActionExecutionResult","AgentStateMessage","MetaEvent","RunStarted","RunFinished","RunError","NodeStarted","NodeFinished"]),$v=Ul(["LangGraphInterruptEvent","PredictState","Exit"]),Dv=pe({type:U(de.enum.TextMessageStart),messageId:T(),parentMessageId:T().optional(),role:T().optional()}),Uv=pe({type:U(de.enum.TextMessageContent),messageId:T(),content:T()}),zv=pe({type:U(de.enum.TextMessageEnd),messageId:T()}),Gv=pe({type:U(de.enum.ActionExecutionStart),actionExecutionId:T(),actionName:T(),parentMessageId:T().optional()}),Bv=pe({type:U(de.enum.ActionExecutionArgs),actionExecutionId:T(),args:T()}),Fv=pe({type:U(de.enum.ActionExecutionEnd),actionExecutionId:T()}),Vv=pe({type:U(de.enum.ActionExecutionResult),actionName:T(),actionExecutionId:T(),result:T()}),jv=pe({type:U(de.enum.AgentStateMessage),threadId:T(),agentName:T(),nodeName:T(),runId:T(),active:ia(),role:T(),state:T(),running:ia()}),Hv=pe({type:U(de.enum.MetaEvent),name:$v,value:Ve()}),Zv=pe({type:U(de.enum.RunError),message:T(),code:T().optional()});As("type",[Dv,Uv,zv,Gv,Bv,Fv,Vv,jv,Hv,Zv]);pe({id:T(),role:T(),content:T(),parentMessageId:T().optional()});pe({id:T(),name:T(),arguments:Ve(),parentMessageId:T().optional()});pe({id:T(),result:Ve(),actionExecutionId:T(),actionName:T()});var qv=t=>{if(typeof t=="string")return t;if(!Array.isArray(t))return;let e=t.filter(n=>n.type==="text").map(n=>n.text).filter(n=>n.length>0);if(e.length!==0)return e.join(`
`)},Xv=(t,e,n)=>r=>{let s={},a=!0,i=!0,o="",l=null,u=null,c=[],f={},v=d=>{typeof d=="object"&&d!==null&&("messages"in d&&delete d.messages,s=d)};return r.pipe(Jt(d=>{switch(d.type){case S.TEXT_MESSAGE_START:{let h=d;return[{type:de.enum.TextMessageStart,messageId:h.messageId,role:h.role}]}case S.TEXT_MESSAGE_CONTENT:{let h=d;return[{type:de.enum.TextMessageContent,messageId:h.messageId,content:h.delta}]}case S.TEXT_MESSAGE_END:{let h=d;return[{type:de.enum.TextMessageEnd,messageId:h.messageId}]}case S.TOOL_CALL_START:{let h=d;return c.push({id:h.toolCallId,type:"function",function:{name:h.toolCallName,arguments:""}}),i=!0,f[h.toolCallId]=h.toolCallName,[{type:de.enum.ActionExecutionStart,actionExecutionId:h.toolCallId,actionName:h.toolCallName,parentMessageId:h.parentMessageId}]}case S.TOOL_CALL_ARGS:{let h=d,p=c.find(m=>m.id===h.toolCallId);if(!p)return console.warn(`TOOL_CALL_ARGS: No tool call found with ID '${h.toolCallId}'`),[];p.function.arguments+=h.delta;let g=!1;if(u){let m=u.find(b=>b.tool==p.function.name);if(m)try{let b=JSON.parse(gu(p.function.arguments));m.tool_argument&&m.tool_argument in b?(v(Wt(Ue({},s),{[m.state_key]:b[m.tool_argument]})),g=!0):m.tool_argument||(v(Wt(Ue({},s),{[m.state_key]:b})),g=!0)}catch{}}return[{type:de.enum.ActionExecutionArgs,actionExecutionId:h.toolCallId,args:h.delta},...g?[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(s),active:i}]:[]]}case S.TOOL_CALL_END:{let h=d;return[{type:de.enum.ActionExecutionEnd,actionExecutionId:h.toolCallId}]}case S.TOOL_CALL_RESULT:{let h=d;return[{type:de.enum.ActionExecutionResult,actionExecutionId:h.toolCallId,result:h.content,actionName:f[h.toolCallId]||"unknown"}]}case S.RAW:return[];case S.CUSTOM:{let h=d;switch(h.name){case"Exit":a=!1;break;case"PredictState":u=h.value;break}return[{type:de.enum.MetaEvent,name:h.name,value:h.value}]}case S.STATE_SNAPSHOT:return v(d.snapshot),[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(s),active:i}];case S.STATE_DELTA:{let h=Gn(s,d.delta,!0,!1);return h?(v(h.newDocument),[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(s),active:i}]):[]}case S.MESSAGES_SNAPSHOT:return l=d.messages,[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(Ue(Ue({},s),l?{messages:l}:{})),active:!0}];case S.RUN_STARTED:return[];case S.RUN_FINISHED:return l&&(s.messages=l),Object.keys(s).length===0?[]:[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(Ue(Ue({},s),l?{messages:Kv(l)}:{})),active:!1}];case S.RUN_ERROR:{let h=d;return[{type:de.enum.RunError,message:h.message,code:h.code}]}case S.STEP_STARTED:return o=d.stepName,c=[],u=null,[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(s),active:!0}];case S.STEP_FINISHED:return c=[],u=null,[{type:de.enum.AgentStateMessage,threadId:t,agentName:n,nodeName:o,runId:e,running:a,role:"assistant",state:JSON.stringify(s),active:!1}];default:return[]}}))};function Kv(t){var e;let n=[];for(let r of t)if(r.role==="assistant"||r.role==="user"||r.role==="system"){let s=qv(r.content);if(s){let a={id:r.id,role:r.role,content:s};n.push(a)}if(r.role==="assistant"&&r.toolCalls&&r.toolCalls.length>0)for(let a of r.toolCalls){let i={id:a.id,name:a.function.name,arguments:JSON.parse(a.function.arguments),parentMessageId:r.id};n.push(i)}}else if(r.role==="tool"){let s="unknown";for(let i of t)if(i.role==="assistant"&&(e=i.toolCalls)!=null&&e.length){for(let o of i.toolCalls)if(o.id===r.toolCallId){s=o.function.name;break}}let a={id:r.id,result:r.content,actionExecutionId:r.toolCallId,actionName:s};n.push(a)}return n}var Wr=t=>e=>{let n,r,s,a=()=>{if(!n||s!=="text")throw new Error("No text message to close");let l={type:S.TEXT_MESSAGE_END,messageId:n.messageId};return s=void 0,n=void 0,t&&console.debug("[TRANSFORM]: TEXT_MESSAGE_END",JSON.stringify(l)),l},i=()=>{if(!r||s!=="tool")throw new Error("No tool call to close");let l={type:S.TOOL_CALL_END,toolCallId:r.toolCallId};return s=void 0,r=void 0,t&&console.debug("[TRANSFORM]: TOOL_CALL_END",JSON.stringify(l)),l},o=()=>s==="text"?[a()]:s==="tool"?[i()]:[];return e.pipe(Jt(l=>{switch(l.type){case S.TEXT_MESSAGE_START:case S.TEXT_MESSAGE_CONTENT:case S.TEXT_MESSAGE_END:case S.TOOL_CALL_START:case S.TOOL_CALL_ARGS:case S.TOOL_CALL_END:case S.TOOL_CALL_RESULT:case S.STATE_SNAPSHOT:case S.STATE_DELTA:case S.MESSAGES_SNAPSHOT:case S.CUSTOM:case S.RUN_STARTED:case S.RUN_FINISHED:case S.RUN_ERROR:case S.STEP_STARTED:case S.STEP_FINISHED:case S.THINKING_START:case S.THINKING_END:case S.THINKING_TEXT_MESSAGE_START:case S.THINKING_TEXT_MESSAGE_CONTENT:case S.THINKING_TEXT_MESSAGE_END:return[...o(),l];case S.RAW:case S.ACTIVITY_SNAPSHOT:case S.ACTIVITY_DELTA:return[l];case S.TEXT_MESSAGE_CHUNK:let u=l,c=[];if((s!=="text"||u.messageId!==void 0&&u.messageId!==n?.messageId)&&c.push(...o()),s!=="text"){if(u.messageId===void 0)throw new Error("First TEXT_MESSAGE_CHUNK must have a messageId");n={messageId:u.messageId},s="text";let d={type:S.TEXT_MESSAGE_START,messageId:u.messageId,role:u.role||"assistant"};c.push(d),t&&console.debug("[TRANSFORM]: TEXT_MESSAGE_START",JSON.stringify(d))}if(u.delta!==void 0){let d={type:S.TEXT_MESSAGE_CONTENT,messageId:n.messageId,delta:u.delta};c.push(d),t&&console.debug("[TRANSFORM]: TEXT_MESSAGE_CONTENT",JSON.stringify(d))}return c;case S.TOOL_CALL_CHUNK:let f=l,v=[];if((s!=="tool"||f.toolCallId!==void 0&&f.toolCallId!==r?.toolCallId)&&v.push(...o()),s!=="tool"){if(f.toolCallId===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallId");if(f.toolCallName===void 0)throw new Error("First TOOL_CALL_CHUNK must have a toolCallName");r={toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId},s="tool";let d={type:S.TOOL_CALL_START,toolCallId:f.toolCallId,toolCallName:f.toolCallName,parentMessageId:f.parentMessageId};v.push(d),t&&console.debug("[TRANSFORM]: TOOL_CALL_START",JSON.stringify(d))}if(f.delta!==void 0){let d={type:S.TOOL_CALL_ARGS,toolCallId:r.toolCallId,delta:f.delta};v.push(d),t&&console.debug("[TRANSFORM]: TOOL_CALL_ARGS",JSON.stringify(d))}return v}return l.type,[]}),pa(()=>{o()}))},Tu=class{runNext(e,n){return n.run(e).pipe(Wr(!1))}runNextWithState(e,n){let r=ue(e.messages||[]),s=ue(e.state||{}),a=new fu;return xu(e,a,n,[]).subscribe(i=>{i.messages!==void 0&&(r=i.messages),i.state!==void 0&&(s=i.state)}),this.runNext(e,n).pipe(cu(async i=>(a.next(i),await new Promise(o=>setTimeout(o,0)),{event:i,messages:ue(r),state:ue(s)})))}},Jv=class extends Tu{constructor(e){super(),this.fn=e}run(e,n){return this.fn(e,n)}};function Wv(t){let e=t.content;if(Array.isArray(e)){let n=e.filter(r=>typeof r=="object"&&r!==null&&"type"in r&&r.type==="text"&&typeof r.text=="string").map(r=>r.text).join("");return Wt(Ue({},t),{content:n})}return typeof e=="string"?t:Wt(Ue({},t),{content:""})}var Yv=class extends Tu{run(e,n){let r=e,{parentRunId:s}=r,a=Rv(r,["parentRunId"]),i=Wt(Ue({},a),{messages:a.messages.map(Wv)});return this.runNext(i,n)}},Qv={version:"0.0.42"},ep=class{constructor({agentId:e,description:n,threadId:r,initialMessages:s,initialState:a,debug:i}={}){this.debug=!1,this.subscribers=[],this.isRunning=!1,this.middlewares=[],this.agentId=e,this.description=n??"",this.threadId=r??Kn(),this.messages=ue(s??[]),this.state=ue(a??{}),this.debug=i??!1,Tv(this.maxVersion,"0.0.39")<=0&&this.middlewares.unshift(new Yv)}get maxVersion(){return Qv.version}subscribe(e){return this.subscribers.push(e),{unsubscribe:()=>{this.subscribers=this.subscribers.filter(n=>n!==e)}}}use(...e){let n=e.map(r=>typeof r=="function"?new Jv(r):r);return this.middlewares.push(...n),this}async runAgent(e,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:Kn();let s=this.prepareRunAgentInput(e),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new vn;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=Ni(()=>this.middlewares.length===0?this.run(s):this.middlewares.reduceRight((f,v)=>({run:d=>v.run(d,f)}),this).run(s),Wr(this.debug),js(this.debug),f=>f.pipe(Mi(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),ha(f=>(this.isRunning=!1,this.onError(s,f,o))),pa(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await Pi(u(Ee(null)));let c=ue(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}connect(e){throw new Ii}async connectAgent(e,n){var r;try{this.isRunning=!0,this.agentId=(r=this.agentId)!=null?r:Kn();let s=this.prepareRunAgentInput(e),a,i=new Set(this.messages.map(f=>f.id)),o=[{onRunFinishedEvent:f=>{a=f.result}},...this.subscribers,n??{}];await this.onInitialize(s,o),this.activeRunDetach$=new vn;let l;this.activeRunCompletionPromise=new Promise(f=>{l=f});let u=Ni(()=>this.connect(s),Wr(this.debug),js(this.debug),f=>f.pipe(Mi(this.activeRunDetach$)),f=>this.apply(s,f,o),f=>this.processApplyEvents(s,f,o),ha(f=>(this.isRunning=!1,f instanceof Ii?du:this.onError(s,f,o))),pa(()=>{this.isRunning=!1,this.onFinalize(s,o),l?.(),l=void 0,this.activeRunCompletionPromise=void 0,this.activeRunDetach$=void 0}));await Pi(u(Ee(null)));let c=ue(this.messages).filter(f=>!i.has(f.id));return{result:a,newMessages:c}}finally{this.isRunning=!1}}abortRun(){}async detachActiveRun(){var e,n;if(!this.activeRunDetach$)return;let r=(e=this.activeRunCompletionPromise)!=null?e:Promise.resolve();this.activeRunDetach$.next(),(n=this.activeRunDetach$)==null||n.complete(),await r}apply(e,n,r){return xu(e,n,this,r)}processApplyEvents(e,n,r){return n.pipe(Fh(s=>{s.messages&&(this.messages=s.messages,r.forEach(a=>{var i;(i=a.onMessagesChanged)==null||i.call(a,{messages:this.messages,state:this.state,agent:this,input:e})})),s.state&&(this.state=s.state,r.forEach(a=>{var i;(i=a.onStateChanged)==null||i.call(a,{state:this.state,messages:this.messages,agent:this,input:e})}))}))}prepareRunAgentInput(e){var n,r,s;let a=ue(this.messages).filter(i=>i.role!=="activity");return{threadId:this.threadId,runId:e?.runId||Kn(),tools:ue((n=e?.tools)!=null?n:[]),context:ue((r=e?.context)!=null?r:[]),forwardedProps:ue((s=e?.forwardedProps)!=null?s:{}),state:ue(this.state),messages:a}}async onInitialize(e,n){let r=await me(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunInitialized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:e})});(r.messages!==void 0||r.state!==void 0)&&(r.messages&&(this.messages=r.messages,e.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:e})})),r.state&&(this.state=r.state,e.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:e})})))}onError(e,n,r){return hs(me(r,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFailed)==null?void 0:o.call(s,{error:n,messages:a,state:i,agent:this,input:e})})).pipe(va(s=>{let a=s;if((a.messages!==void 0||a.state!==void 0)&&(a.messages!==void 0&&(this.messages=a.messages,r.forEach(i=>{var o;(o=i.onMessagesChanged)==null||o.call(i,{messages:this.messages,state:this.state,agent:this,input:e})})),a.state!==void 0&&(this.state=a.state,r.forEach(i=>{var o;(o=i.onStateChanged)==null||o.call(i,{state:this.state,messages:this.messages,agent:this,input:e})}))),a.stopPropagation!==!0)throw console.error("Agent execution failed:",n),n;return{}}))}async onFinalize(e,n){let r=await me(n,this.messages,this.state,(s,a,i)=>{var o;return(o=s.onRunFinalized)==null?void 0:o.call(s,{messages:a,state:i,agent:this,input:e})});(r.messages!==void 0||r.state!==void 0)&&(r.messages!==void 0&&(this.messages=r.messages,n.forEach(s=>{var a;(a=s.onMessagesChanged)==null||a.call(s,{messages:this.messages,state:this.state,agent:this,input:e})})),r.state!==void 0&&(this.state=r.state,n.forEach(s=>{var a;(a=s.onStateChanged)==null||a.call(s,{state:this.state,messages:this.messages,agent:this,input:e})})))}clone(){let e=Object.create(Object.getPrototypeOf(this));return e.agentId=this.agentId,e.description=this.description,e.threadId=this.threadId,e.messages=ue(this.messages),e.state=ue(this.state),e.debug=this.debug,e.isRunning=this.isRunning,e.subscribers=[...this.subscribers],e.middlewares=[...this.middlewares],e}addMessage(e){this.messages.push(e),(async()=>{var n,r,s;for(let a of this.subscribers)await((n=a.onNewMessage)==null?void 0:n.call(a,{message:e,messages:this.messages,state:this.state,agent:this}));if(e.role==="assistant"&&e.toolCalls)for(let a of e.toolCalls)for(let i of this.subscribers)await((r=i.onNewToolCall)==null?void 0:r.call(i,{toolCall:a,messages:this.messages,state:this.state,agent:this}));for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}addMessages(e){this.messages.push(...e),(async()=>{var n,r,s;for(let a of e){for(let i of this.subscribers)await((n=i.onNewMessage)==null?void 0:n.call(i,{message:a,messages:this.messages,state:this.state,agent:this}));if(a.role==="assistant"&&a.toolCalls)for(let i of a.toolCalls)for(let o of this.subscribers)await((r=o.onNewToolCall)==null?void 0:r.call(o,{toolCall:i,messages:this.messages,state:this.state,agent:this}))}for(let a of this.subscribers)await((s=a.onMessagesChanged)==null?void 0:s.call(a,{messages:this.messages,state:this.state,agent:this}))})()}setMessages(e){this.messages=ue(e),(async()=>{var n;for(let r of this.subscribers)await((n=r.onMessagesChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}setState(e){this.state=ue(e),(async()=>{var n;for(let r of this.subscribers)await((n=r.onStateChanged)==null?void 0:n.call(r,{messages:this.messages,state:this.state,agent:this}))})()}legacy_to_be_removed_runAgentBridged(e){var n;this.agentId=(n=this.agentId)!=null?n:Kn();let r=this.prepareRunAgentInput(e);return(this.middlewares.length===0?this.run(r):this.middlewares.reduceRight((s,a)=>({run:i=>a.run(i,s)}),this).run(r)).pipe(Wr(this.debug),js(this.debug),Xv(this.threadId,r.runId,this.agentId),s=>s.pipe(va(a=>(this.debug&&console.debug("[LEGACY]:",JSON.stringify(a)),a))))}},tp=class extends ep{constructor(t){var e;super(t),this.abortController=new AbortController,this.url=t.url,this.headers=ue((e=t.headers)!=null?e:{})}requestInit(t){return{method:"POST",headers:Wt(Ue({},this.headers),{"Content-Type":"application/json",Accept:"text/event-stream"}),body:JSON.stringify(t),signal:this.abortController.signal}}runAgent(t,e){var n;return this.abortController=(n=t?.abortController)!=null?n:new AbortController,super.runAgent(t,e)}abortRun(){this.abortController.abort(),super.abortRun()}run(t){let e=Ov(this.url,this.requestInit(t));return Lv(e)}clone(){var t;let e=super.clone();e.url=this.url,e.headers=ue((t=this.headers)!=null?t:{});let n=new AbortController,r=this.abortController.signal;return r.aborted&&n.abort(r.reason),e.abortController=n,e}};class np{constructor(){this.eventSource=null,this.agentMsgId=null,this.aguiSubscription=null,this.aguiMessageMap=new Map,this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1}start(e,n,r,s,a,i="sse"){if(this.close(),i==="agui"){this.startAgui(e,n,r,s,a);return}const o=K.addAgentMessage();this.agentMsgId=o.id;const l=new URL("/chat/stream",window.location.origin);l.searchParams.set("query",e),l.searchParams.set("session_id",n),Object.keys(r).length&&l.searchParams.set("tool_context",JSON.stringify(r)),Object.keys(s).length&&l.searchParams.set("llm_context",JSON.stringify(s)),this.eventSource=new EventSource(l.toString()),["chunk","artifact_chunk","artifact_stored","llm_stream_chunk","step","event","done","error"].forEach(c=>{this.eventSource.addEventListener(c,f=>{this.handleEvent(c,f,a)})}),this.eventSource.onerror=()=>{const c=this.findAgentMsg();c&&K.updateMessage(c.id,{isStreaming:!1}),a.onError("Connection lost"),this.close()}}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.agentMsgId=null,this.aguiSubscription&&(this.aguiSubscription.unsubscribe(),this.aguiSubscription=null),this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiRunId=null,this.aguiSessionId=null,this.aguiCompleted=!1}findAgentMsg(){return this.agentMsgId?K.findMessage(this.agentMsgId):void 0}handleEvent(e,n,r){const s=Rl(n.data);if(!s)return;const a=this.findAgentMsg();if(a)switch(e){case"chunk":case"llm_stream_chunk":this.handleChunk(a,s,e);break;case"artifact_chunk":this.handleArtifactChunk(s);break;case"artifact_stored":this.handleArtifactStored(s);break;case"step":case"event":this.handleStepEvent(a,s,e);break;case"done":this.handleDone(a,s,r);break;case"error":this.handleError(a,s,r);break}}handleChunk(e,n,r){const s=n.channel??"thinking",a=n.phase??(r==="chunk"?"observation":void 0),i=n.text??"",o=!!n.done;if(s==="thinking"&&a==="action"){K.updateMessage(e.id,{isThinking:!o});return}if(s==="thinking"){i?K.updateMessage(e.id,{observations:`${e.observations??""}${i}`,showObservations:!0,isThinking:!1}):K.updateMessage(e.id,{isThinking:!1});return}if(s==="revision"){const l={isThinking:!1,isStreaming:!0};e.revisionStreamActive||(l.revisionStreamActive=!0,l.text=""),i&&(l.text=`${e.revisionStreamActive?e.text:""}${i}`),K.updateMessage(e.id,l);return}if(s==="answer"){const l=e.answerActionSeq??Sn,u=n.action_seq;if(l===Sn){K.updateMessage(e.id,{answerStreamDone:o,isStreaming:!o,isThinking:!1});return}if(u!==void 0&&u!==l){K.updateMessage(e.id,{isThinking:!1});return}const c={isThinking:!1,isStreaming:!o};i&&(c.text=`${e.text}${i}`),o&&(c.answerStreamDone=!0),K.updateMessage(e.id,c);return}i?K.updateMessage(e.id,{observations:`${e.observations??""}${i}`,showObservations:!0,isThinking:!1}):K.updateMessage(e.id,{isThinking:!1})}handleArtifactChunk(e){const n=e.stream_id??"artifact";Ut.addArtifactChunk(n,e.chunk),mt.addEvent(e,"artifact_chunk")}handleArtifactStored(e){ft.addArtifact({artifact_id:e.artifact_id,mime_type:e.mime_type,size_bytes:e.size_bytes,filename:e.filename,source:e.source||{},trace_id:e.trace_id,session_id:e.session_id,ts:e.ts}),mt.addEvent(e,"artifact_stored")}handleStepEvent(e,n,r){if(n.event==="step_start"){const a=n.action_seq;K.updateMessage(e.id,{answerActionSeq:typeof a=="number"?a:Sn})}mt.addEvent(n,r)}handleDone(e,n,r){const s=n.pause,a=n.trace_id??null;if(s){this.handlePause(e,n,s,a,r);return}const i=n.answer_action_seq,o=e.answerActionSeq??Sn;o!==Sn&&(i===void 0||i===o)&&n.answer&&typeof n.answer=="string"&&K.updateMessage(e.id,{text:n.answer}),K.updateMessage(e.id,{isStreaming:!1,isThinking:!1}),r.onDone(a),this.close()}handlePause(e,n,r,s,a){const i=r.payload??{},o=i.auth_url||i.url||"",l=i.provider||"";let c=`Planner paused (${r.reason||"pause"})`;l&&(c+=` for ${l}`),o&&(c+=`
[Open auth link](${o})`),r.resume_token&&(c+=`
Resume token: \`${r.resume_token}\``),K.updateMessage(e.id,{pause:r,traceId:s??void 0,text:c,isStreaming:!1,isThinking:!1}),a.onDone(s),this.close()}handleError(e,n,r){const s=n.error??"Unexpected error";K.updateMessage(e.id,{text:s,isStreaming:!1,isThinking:!1}),r.onError(s),this.close()}startAgui(e,n,r,s,a){const i=this.buildHistory();!i.some(d=>d.role==="user"&&this.hasTextContent(d.content))&&e.trim()&&i.push({id:`msg_${Date.now()}`,role:"user",content:e});const l=K.addAgentMessage();this.agentMsgId=l.id,this.aguiMessageMap.clear(),this.aguiMappedPlaceholder=!1,this.aguiCompleted=!1;const u=new URL("/agui/agent",window.location.origin),c={threadId:n,runId:`run_${Date.now()}`,messages:i,tools:[],context:[],state:{},forwardedProps:{penguiflow:{llm_context:s,tool_context:r}}};this.aguiRunId=c.runId,this.aguiSessionId=n,console.log("[AG-UI] Sending request:",JSON.stringify(c,null,2));const v=new tp({url:u.toString()}).run(c);this.aguiSubscription=v.subscribe({next:d=>this.handleAguiEvent(d,a),error:d=>{const h=this.findAgentMsg();h&&K.updateMessage(h.id,{isStreaming:!1}),a.onError(d.message),this.close()},complete:()=>{!this.aguiCompleted&&this.aguiRunId&&a.onDone(this.aguiRunId)}})}handleAguiEvent(e,n){switch(console.log("[AG-UI] Received event:",e.type,e),e.type){case"RUN_STARTED":this.aguiRunId=e.runId??this.aguiRunId;return;case"RUN_FINISHED":{const r=this.findAgentMsg();r&&K.updateMessage(r.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onDone(e.runId??this.aguiRunId),this.aguiCompleted=!0;return}case"RUN_ERROR":{const r=this.findAgentMsg();r&&K.updateMessage(r.id,{isStreaming:!1,isThinking:!1}),this.aguiCompleted||n.onError(e.message||"Run error"),this.aguiCompleted=!0;return}case"TEXT_MESSAGE_START":{const r=e;if(r.role!=="assistant")return;this.ensureAguiMessage(r.messageId);return}case"TEXT_MESSAGE_CONTENT":{const r=e,s=this.ensureAguiMessage(r.messageId),a=K.findMessage(s);a&&r.delta&&K.updateMessage(a.id,{text:`${a.text}${r.delta}`,isStreaming:!0});return}case"TEXT_MESSAGE_END":{const r=e,s=this.ensureAguiMessage(r.messageId);K.updateMessage(s,{isStreaming:!1});return}case"TOOL_CALL_START":case"TOOL_CALL_ARGS":case"TOOL_CALL_END":case"TOOL_CALL_RESULT":{mt.addEvent(e,e.type.toLowerCase());return}case"CUSTOM":{const r=e.name,s=e.value;if(r==="artifact_stored"&&s&&typeof s=="object"&&s.artifact){const i=s.artifact;ft.addArtifact({artifact_id:i.id,mime_type:i.mime_type,size_bytes:i.size_bytes,filename:i.filename,source:i.source||{},trace_id:this.aguiRunId??void 0,session_id:this.aguiSessionId??"",ts:Date.now()})}if(r==="thinking"&&s&&typeof s=="object"){const i=this.findAgentMsg();if(i){const o=s.text||"";s.phase==="action"?K.updateMessage(i.id,{isThinking:!0}):o&&K.updateMessage(i.id,{observations:`${i.observations??""}${o}`,showObservations:!0,isThinking:!1})}}if(r==="revision"&&s&&typeof s=="object"){const i=this.findAgentMsg();if(i){const o=s.text||"",u={isThinking:!1,isStreaming:!s.done};i.revisionStreamActive||(u.revisionStreamActive=!0,u.text=""),o&&(u.text=`${i.revisionStreamActive?i.text:""}${o}`),K.updateMessage(i.id,u)}}if(r==="pause"&&s&&typeof s=="object"){const i=this.findAgentMsg();i&&this.handlePause(i,{},s,this.aguiRunId,n),this.aguiCompleted=!0}const a=s&&typeof s=="object"?s:{value:s};mt.addEvent(a,r);return}default:return}}ensureAguiMessage(e){const n=this.aguiMessageMap.get(e);if(n)return n;if(!this.aguiMappedPlaceholder&&this.agentMsgId)return this.aguiMappedPlaceholder=!0,this.aguiMessageMap.set(e,this.agentMsgId),this.agentMsgId;const r=K.addAgentMessage();return this.aguiMessageMap.set(e,r.id),r.id}buildHistory(){console.log("[AG-UI] Building history from chatStore.messages:",K.messages.length,"messages");const e=K.messages.filter(n=>n.role==="user"||n.role==="agent").map(n=>({id:n.id,role:n.role==="agent"?"assistant":"user",content:n.text}));return console.log("[AG-UI] Built history:",e),e}hasTextContent(e){return typeof e=="string"?e.trim().length>0:Array.isArray(e)?e.some(n=>typeof n=="object"&&n!==null&&"text"in n):!1}}const Eo=new np;class rp{constructor(){this.eventSource=null}start(e,n){this.close();const r=new URL("/events",window.location.origin);r.searchParams.set("trace_id",e),r.searchParams.set("session_id",n),r.searchParams.set("follow","true"),this.eventSource=new EventSource(r.toString());const s=a=>{const i=Rl(a.data);if(!i)return;const o=a.type||i.event||"";if(mt.shouldProcess(o)){if(o==="artifact_chunk"){const l=i.stream_id??"artifact";Ut.addArtifactChunk(l,i.chunk)}o==="artifact_stored"&&ft.addArtifact({artifact_id:i.artifact_id,mime_type:i.mime_type,size_bytes:i.size_bytes,filename:i.filename,source:i.source||{},trace_id:i.trace_id,session_id:i.session_id,ts:i.ts}),o!=="llm_stream_chunk"&&mt.addEvent(i,o||"event")}};["event","step","chunk","llm_stream_chunk","artifact_chunk","artifact_stored"].forEach(a=>{this.eventSource.addEventListener(a,s)}),this.eventSource.onmessage=s,this.eventSource.onerror=()=>this.close()}close(){this.eventSource&&(this.eventSource.close(),this.eventSource=null)}}const ko=new rp;function Za(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var yn=Za();function Au(t){yn=t}var or={exec:()=>null};function se(t,e=""){let n=typeof t=="string"?t:t.source,r={replace:(s,a)=>{let i=typeof a=="string"?a:a.source;return i=i.replace(Be.caret,"$1"),n=n.replace(s,i),r},getRegex:()=>new RegExp(n,e)};return r}var sp=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Be={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},ap=/^(?:[ \t]*(?:\n|$))+/,ip=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,op=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,mr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,lp=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,qa=/(?:[*+-]|\d{1,9}[.)])/,Iu=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Cu=se(Iu).replace(/bull/g,qa).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),up=se(Iu).replace(/bull/g,qa).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Xa=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,cp=/^[^\n]+/,Ka=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,dp=se(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ka).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),fp=se(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,qa).getRegex(),Ns="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ja=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,hp=se("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ja).replace("tag",Ns).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Nu=se(Xa).replace("hr",mr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ns).getRegex(),vp=se(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Nu).getRegex(),Wa={blockquote:vp,code:ip,def:dp,fences:op,heading:lp,hr:mr,html:hp,lheading:Cu,list:fp,newline:ap,paragraph:Nu,table:or,text:cp},So=se("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",mr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ns).getRegex(),pp={...Wa,lheading:up,table:So,paragraph:se(Xa).replace("hr",mr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",So).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Ns).getRegex()},gp={...Wa,html:se(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ja).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:or,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:se(Xa).replace("hr",mr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Cu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},mp=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,_p=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ru=/^( {2,}|\\)\n(?!\s*$)/,yp=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Rs=/[\p{P}\p{S}]/u,Ya=/[\s\p{P}\p{S}]/u,Ou=/[^\s\p{P}\p{S}]/u,bp=se(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ya).getRegex(),Mu=/(?!~)[\p{P}\p{S}]/u,wp=/(?!~)[\s\p{P}\p{S}]/u,Ep=/(?:[^\s\p{P}\p{S}]|~)/u,kp=se(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",sp?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Pu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Sp=se(Pu,"u").replace(/punct/g,Rs).getRegex(),xp=se(Pu,"u").replace(/punct/g,Mu).getRegex(),Lu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Tp=se(Lu,"gu").replace(/notPunctSpace/g,Ou).replace(/punctSpace/g,Ya).replace(/punct/g,Rs).getRegex(),Ap=se(Lu,"gu").replace(/notPunctSpace/g,Ep).replace(/punctSpace/g,wp).replace(/punct/g,Mu).getRegex(),Ip=se("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ou).replace(/punctSpace/g,Ya).replace(/punct/g,Rs).getRegex(),Cp=se(/\\(punct)/,"gu").replace(/punct/g,Rs).getRegex(),Np=se(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Rp=se(Ja).replace("(?:-->|$)","-->").getRegex(),Op=se("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Rp).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ms=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Mp=se(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ms).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),$u=se(/^!?\[(label)\]\[(ref)\]/).replace("label",ms).replace("ref",Ka).getRegex(),Du=se(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ka).getRegex(),Pp=se("reflink|nolink(?!\\()","g").replace("reflink",$u).replace("nolink",Du).getRegex(),xo=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Qa={_backpedal:or,anyPunctuation:Cp,autolink:Np,blockSkip:kp,br:Ru,code:_p,del:or,emStrongLDelim:Sp,emStrongRDelimAst:Tp,emStrongRDelimUnd:Ip,escape:mp,link:Mp,nolink:Du,punctuation:bp,reflink:$u,reflinkSearch:Pp,tag:Op,text:yp,url:or},Lp={...Qa,link:se(/^!?\[(label)\]\((.*?)\)/).replace("label",ms).getRegex(),reflink:se(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ms).getRegex()},Ea={...Qa,emStrongRDelimAst:Ap,emStrongLDelim:xp,url:se(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",xo).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:se(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",xo).getRegex()},$p={...Ea,br:se(Ru).replace("{2,}","*").getRegex(),text:se(Ea.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},kr={normal:Wa,gfm:pp,pedantic:gp},Jn={normal:Qa,gfm:Ea,breaks:$p,pedantic:Lp},Dp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},To=t=>Dp[t];function Rt(t,e){if(e){if(Be.escapeTest.test(t))return t.replace(Be.escapeReplace,To)}else if(Be.escapeTestNoEncode.test(t))return t.replace(Be.escapeReplaceNoEncode,To);return t}function Ao(t){try{t=encodeURI(t).replace(Be.percentDecode,"%")}catch{return null}return t}function Io(t,e){let n=t.replace(Be.findPipe,(a,i,o)=>{let l=!1,u=i;for(;--u>=0&&o[u]==="\\";)l=!l;return l?"|":" |"}),r=n.split(Be.splitPipe),s=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(Be.slashPipe,"|");return r}function Wn(t,e,n){let r=t.length;if(r===0)return"";let s=0;for(;s<r&&t.charAt(r-s-1)===e;)s++;return t.slice(0,r-s)}function Up(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&(n--,n<0))return r;return n>0?-2:-1}function Co(t,e,n,r,s){let a=e.href,i=e.title||null,o=t[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:a,title:i,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function zp(t,e,n){let r=t.match(n.other.indentCodeCompensation);if(r===null)return e;let s=r[1];return e.split(`
`).map(a=>{let i=a.match(n.other.beginningSpace);if(i===null)return a;let[o]=i;return o.length>=s.length?a.slice(s.length):a}).join(`
`)}var _s=class{options;rules;lexer;constructor(t){this.options=t||yn}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Wn(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],r=zp(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let r=Wn(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Wn(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=Wn(e[0],`
`).split(`
`),r="",s="",a=[];for(;n.length>0;){let i=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),i=!0;else if(!i)o.push(n[l]);else break;n=n.slice(l);let u=o.join(`
`),c=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${u}`:u,s=s?`${s}
${c}`:c;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,a,!0),this.lexer.state.top=f,n.length===0)break;let v=a.at(-1);if(v?.type==="code")break;if(v?.type==="blockquote"){let d=v,h=d.raw+`
`+n.join(`
`),p=this.blockquote(h);a[a.length-1]=p,r=r.substring(0,r.length-d.raw.length)+p.raw,s=s.substring(0,s.length-d.text.length)+p.text;break}else if(v?.type==="list"){let d=v,h=d.raw+`
`+n.join(`
`),p=this.list(h);a[a.length-1]=p,r=r.substring(0,r.length-v.raw.length)+p.raw,s=s.substring(0,s.length-d.raw.length)+p.raw,n=h.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:a,text:s}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let a=this.rules.other.listItemRegex(n),i=!1;for(;t;){let l=!1,u="",c="";if(!(e=a.exec(t))||this.rules.block.hr.test(t))break;u=e[0],t=t.substring(u.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,p=>" ".repeat(3*p.length)),v=t.split(`
`,1)[0],d=!f.trim(),h=0;if(this.options.pedantic?(h=2,c=f.trimStart()):d?h=e[1].length+1:(h=e[2].search(this.rules.other.nonSpaceChar),h=h>4?1:h,c=f.slice(h),h+=e[1].length),d&&this.rules.other.blankLine.test(v)&&(u+=v+`
`,t=t.substring(v.length+1),l=!0),!l){let p=this.rules.other.nextBulletRegex(h),g=this.rules.other.hrRegex(h),m=this.rules.other.fencesBeginRegex(h),b=this.rules.other.headingBeginRegex(h),_=this.rules.other.htmlBeginRegex(h);for(;t;){let x=t.split(`
`,1)[0],I;if(v=x,this.options.pedantic?(v=v.replace(this.rules.other.listReplaceNesting,"  "),I=v):I=v.replace(this.rules.other.tabCharGlobal,"    "),m.test(v)||b.test(v)||_.test(v)||p.test(v)||g.test(v))break;if(I.search(this.rules.other.nonSpaceChar)>=h||!v.trim())c+=`
`+I.slice(h);else{if(d||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||m.test(f)||b.test(f)||g.test(f))break;c+=`
`+v}!d&&!v.trim()&&(d=!0),u+=x+`
`,t=t.substring(x.length+1),f=I.slice(h)}}s.loose||(i?s.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(i=!0)),s.items.push({type:"list_item",raw:u,task:!!this.options.gfm&&this.rules.other.listIsTask.test(c),loose:!1,text:c,tokens:[]}),s.raw+=u}let o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l of s.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,""),l.tokens[0]?.type==="text"||l.tokens[0]?.type==="paragraph"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let c=this.lexer.inlineQueue.length-1;c>=0;c--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[c].src)){this.lexer.inlineQueue[c].src=this.lexer.inlineQueue[c].src.replace(this.rules.other.listReplaceTask,"");break}}let u=this.rules.other.listTaskCheckbox.exec(l.raw);if(u){let c={type:"checkbox",raw:u[0]+" ",checked:u[0]!=="[ ]"};l.checked=c.checked,s.loose?l.tokens[0]&&["paragraph","text"].includes(l.tokens[0].type)&&"tokens"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=c.raw+l.tokens[0].raw,l.tokens[0].text=c.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(c)):l.tokens.unshift({type:"paragraph",raw:c.raw,text:c.raw,tokens:[c]}):l.tokens.unshift(c)}}if(!s.loose){let u=l.tokens.filter(f=>f.type==="space"),c=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));s.loose=c}}if(s.loose)for(let l of s.items){l.loose=!0;for(let u of l.tokens)u.type==="text"&&(u.type="paragraph")}return s}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:s}}}table(t){let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=Io(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let i of r)this.rules.other.tableAlignRight.test(i)?a.align.push("right"):this.rules.other.tableAlignCenter.test(i)?a.align.push("center"):this.rules.other.tableAlignLeft.test(i)?a.align.push("left"):a.align.push(null);for(let i=0;i<n.length;i++)a.header.push({text:n[i],tokens:this.lexer.inline(n[i]),header:!0,align:a.align[i]});for(let i of s)a.rows.push(Io(i,a.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:a.align[l]})));return a}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=Wn(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=Up(e[2],"()");if(a===-2)return;if(a>-1){let i=(e[0].indexOf("!")===0?5:4)+e[1].length+a;e[2]=e[2].substring(0,a),e[0]=e[0].substring(0,i).trim(),e[3]=""}}let r=e[2],s="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(r);a&&(r=a[1],s=a[3])}else s=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),Co(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=e[r.toLowerCase()];if(!s){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return Co(n,s,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...r[0]].length-1,a,i,o=s,l=0,u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,e=e.slice(-1*t.length+s);(r=u.exec(e))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(i=[...a].length,r[3]||r[4]){o+=i;continue}else if((r[5]||r[6])&&s%3&&!((s+i)%3)){l+=i;continue}if(o-=i,o>0)continue;i=Math.min(i,i+o+l);let c=[...r[0]][0].length,f=t.slice(0,s+r.index+c+i);if(Math.min(s,i)%2){let d=f.slice(1,-1);return{type:"em",raw:f,text:d,tokens:this.lexer.inlineTokens(d)}}let v=f.slice(2,-2);return{type:"strong",raw:f,text:v,tokens:this.lexer.inlineTokens(v)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,r;return e[2]==="@"?(n=e[1],r="mailto:"+n):(n=e[1],r=n),{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(t){let e;if(e=this.rules.inline.url.exec(t)){let n,r;if(e[2]==="@")n=e[0],r="mailto:"+n;else{let s;do s=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(s!==e[0]);n=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},ht=class ka{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||yn,this.options.tokenizer=this.options.tokenizer||new _s,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:Be,block:kr.normal,inline:Jn.normal};this.options.pedantic?(n.block=kr.pedantic,n.inline=Jn.pedantic):this.options.gfm&&(n.block=kr.gfm,this.options.breaks?n.inline=Jn.breaks:n.inline=Jn.gfm),this.tokenizer.rules=n}static get rules(){return{block:kr,inline:Jn}}static lex(e,n){return new ka(n).lex(e)}static lexInline(e,n){return new ka(n).inlineTokens(e)}lex(e){e=e.replace(Be.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],r=!1){for(this.options.pedantic&&(e=e.replace(Be.tabCharGlobal,"    ").replace(Be.spaceLine,""));e;){let s;if(this.options.extensions?.block?.some(i=>(s=i.call({lexer:this},e,n))?(e=e.substring(s.raw.length),n.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let i=n.at(-1);s.raw.length===1&&i!==void 0?i.raw+=`
`:n.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let i=n.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title},n.push(s));continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),n.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),n.push(s);continue}let a=e;if(this.options.extensions?.startBlock){let i=1/0,o=e.slice(1),l;this.options.extensions.startBlock.forEach(u=>{l=u.call({lexer:this},o),typeof l=="number"&&l>=0&&(i=Math.min(i,l))}),i<1/0&&i>=0&&(a=e.substring(0,i+1))}if(this.state.top&&(s=this.tokenizer.paragraph(a))){let i=n.at(-1);r&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s),r=a.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let i=n.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+s.raw,i.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):n.push(s);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){let r=e,s=null;if(this.tokens.links){let l=Object.keys(this.tokens.links);if(l.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)l.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a;for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)a=s[2]?s[2].length:0,r=r.slice(0,s.index+a)+"["+"a".repeat(s[0].length-a-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let i=!1,o="";for(;e;){i||(o=""),i=!1;let l;if(this.options.extensions?.inline?.some(c=>(l=c.call({lexer:this},e,n))?(e=e.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.escape(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.tag(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.link(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(l.raw.length);let c=n.at(-1);l.type==="text"&&c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(l=this.tokenizer.emStrong(e,r,o)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.codespan(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.br(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.del(e)){e=e.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.autolink(e)){e=e.substring(l.raw.length),n.push(l);continue}if(!this.state.inLink&&(l=this.tokenizer.url(e))){e=e.substring(l.raw.length),n.push(l);continue}let u=e;if(this.options.extensions?.startInline){let c=1/0,f=e.slice(1),v;this.options.extensions.startInline.forEach(d=>{v=d.call({lexer:this},f),typeof v=="number"&&v>=0&&(c=Math.min(c,v))}),c<1/0&&c>=0&&(u=e.substring(0,c+1))}if(l=this.tokenizer.inlineText(u)){e=e.substring(l.raw.length),l.raw.slice(-1)!=="_"&&(o=l.raw.slice(-1)),i=!0;let c=n.at(-1);c?.type==="text"?(c.raw+=l.raw,c.text+=l.text):n.push(l);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return n}},ys=class{options;parser;constructor(t){this.options=t||yn}space(t){return""}code({text:t,lang:e,escaped:n}){let r=(e||"").match(Be.notSpaceStart)?.[0],s=t.replace(Be.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Rt(r)+'">'+(n?s:Rt(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Rt(s,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,r="";for(let i=0;i<t.items.length;i++){let o=t.items[i];r+=this.listitem(o)}let s=e?"ol":"ul",a=e&&n!==1?' start="'+n+'"':"";return"<"+s+a+`>
`+r+"</"+s+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let s=0;s<t.header.length;s++)n+=this.tablecell(t.header[s]);e+=this.tablerow({text:n});let r="";for(let s=0;s<t.rows.length;s++){let a=t.rows[s];n="";for(let i=0;i<a.length;i++)n+=this.tablecell(a[i]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${Rt(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let r=this.parser.parseInline(n),s=Ao(t);if(s===null)return r;t=s;let a='<a href="'+t+'"';return e&&(a+=' title="'+Rt(e)+'"'),a+=">"+r+"</a>",a}image({href:t,title:e,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=Ao(t);if(s===null)return Rt(n);t=s;let a=`<img src="${t}" alt="${n}"`;return e&&(a+=` title="${Rt(e)}"`),a+=">",a}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:Rt(t.text)}},ei=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},vt=class Sa{options;renderer;textRenderer;constructor(e){this.options=e||yn,this.options.renderer=this.options.renderer||new ys,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ei}static parse(e,n){return new Sa(n).parse(e)}static parseInline(e,n){return new Sa(n).parseInline(e)}parse(e){let n="";for(let r=0;r<e.length;r++){let s=e[r];if(this.options.extensions?.renderers?.[s.type]){let i=s,o=this.options.extensions.renderers[i.type].call({parser:this},i);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(i.type)){n+=o||"";continue}}let a=s;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let i='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(e,n=this.renderer){let r="";for(let s=0;s<e.length;s++){let a=e[s];if(this.options.extensions?.renderers?.[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){r+=o||"";continue}}let i=a;switch(i.type){case"escape":{r+=n.text(i);break}case"html":{r+=n.html(i);break}case"link":{r+=n.link(i);break}case"image":{r+=n.image(i);break}case"checkbox":{r+=n.checkbox(i);break}case"strong":{r+=n.strong(i);break}case"em":{r+=n.em(i);break}case"codespan":{r+=n.codespan(i);break}case"br":{r+=n.br(i);break}case"del":{r+=n.del(i);break}case"text":{r+=n.text(i);break}default:{let o='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},sr=class{options;block;constructor(t){this.options=t||yn}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?ht.lex:ht.lexInline}provideParser(){return this.block?vt.parse:vt.parseInline}},Gp=class{defaults=Za();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=vt;Renderer=ys;TextRenderer=ei;Lexer=ht;Tokenizer=_s;Hooks=sr;constructor(...t){this.use(...t)}walkTokens(t,e){let n=[];for(let r of t)switch(n=n.concat(e.call(this,r)),r.type){case"table":{let s=r;for(let a of s.header)n=n.concat(this.walkTokens(a.tokens,e));for(let a of s.rows)for(let i of a)n=n.concat(this.walkTokens(i.tokens,e));break}case"list":{let s=r;n=n.concat(this.walkTokens(s.items,e));break}default:{let s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(a=>{let i=s[a].flat(1/0);n=n.concat(this.walkTokens(i,e))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let a=e.renderers[s.name];a?e.renderers[s.name]=function(...i){let o=s.renderer.apply(this,i);return o===!1&&(o=a.apply(this,i)),o}:e.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=e[s.level];a?a.unshift(s.tokenizer):e[s.level]=[s.tokenizer],s.start&&(s.level==="block"?e.startBlock?e.startBlock.push(s.start):e.startBlock=[s.start]:s.level==="inline"&&(e.startInline?e.startInline.push(s.start):e.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(e.childTokens[s.name]=s.childTokens)}),r.extensions=e),n.renderer){let s=this.defaults.renderer||new ys(this.defaults);for(let a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let i=a,o=n.renderer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c||""}}r.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new _s(this.defaults);for(let a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let i=a,o=n.tokenizer[i],l=s[i];s[i]=(...u)=>{let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new sr;for(let a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let i=a,o=n.hooks[i],l=s[i];sr.passThroughHooks.has(a)?s[i]=u=>{if(this.defaults.async&&sr.passThroughHooksRespectAsync.has(a))return(async()=>{let f=await o.call(s,u);return l.call(s,f)})();let c=o.call(s,u);return l.call(s,c)}:s[i]=(...u)=>{if(this.defaults.async)return(async()=>{let f=await o.apply(s,u);return f===!1&&(f=await l.apply(s,u)),f})();let c=o.apply(s,u);return c===!1&&(c=l.apply(s,u)),c}}r.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(i){let o=[];return o.push(a.call(this,i)),s&&(o=o.concat(s.call(this,i))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return ht.lex(t,e??this.defaults)}parser(t,e){return vt.parse(t,e??this.defaults)}parseMarkdown(t){return(e,n)=>{let r={...n},s={...this.defaults,...r},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=t),s.async)return(async()=>{let i=s.hooks?await s.hooks.preprocess(e):e,o=await(s.hooks?await s.hooks.provideLexer():t?ht.lex:ht.lexInline)(i,s),l=s.hooks?await s.hooks.processAllTokens(o):o;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let u=await(s.hooks?await s.hooks.provideParser():t?vt.parse:vt.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(u):u})().catch(a);try{s.hooks&&(e=s.hooks.preprocess(e));let i=(s.hooks?s.hooks.provideLexer():t?ht.lex:ht.lexInline)(e,s);s.hooks&&(i=s.hooks.processAllTokens(i)),s.walkTokens&&this.walkTokens(i,s.walkTokens);let o=(s.hooks?s.hooks.provideParser():t?vt.parse:vt.parseInline)(i,s);return s.hooks&&(o=s.hooks.postprocess(o)),o}catch(i){return a(i)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+Rt(n.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(n);throw n}}},pn=new Gp;function oe(t,e){return pn.parse(t,e)}oe.options=oe.setOptions=function(t){return pn.setOptions(t),oe.defaults=pn.defaults,Au(oe.defaults),oe};oe.getDefaults=Za;oe.defaults=yn;oe.use=function(...t){return pn.use(...t),oe.defaults=pn.defaults,Au(oe.defaults),oe};oe.walkTokens=function(t,e){return pn.walkTokens(t,e)};oe.parseInline=pn.parseInline;oe.Parser=vt;oe.parser=vt.parse;oe.Renderer=ys;oe.TextRenderer=ei;oe.Lexer=ht;oe.lexer=ht.lex;oe.Tokenizer=_s;oe.Hooks=sr;oe.parse=oe;oe.options;oe.setOptions;oe.use;oe.walkTokens;oe.parseInline;vt.parse;ht.lex;oe.setOptions({breaks:!0,gfm:!0});function Uu(t){if(!t)return"";try{return oe.parse(t,{async:!1})}catch{return t}}var Bp=A("<div><!></div>");function Yt(t,e){let n=Pe(e,"class",3,"");var r=Bp(),s=w(r);Ke(s,()=>e.children??Se),$(()=>xe(r,1,`card ${n()??""}`,"svelte-y5qrjl")),E(t,r)}var Fp=A("<div><!></div>");function ti(t,e){let n=Pe(e,"position",3,"center"),r=Pe(e,"class",3,"");var s=Fp(),a=w(s);Ke(a,()=>e.children??Se),$(()=>xe(s,1,`column ${n()??""} ${r()??""}`,"svelte-16y7htx")),E(t,s)}var Vp=A('<div class="page svelte-18r4hqc"><!></div>');function jp(t,e){var n=Vp(),r=w(n);Ke(r,()=>e.children??Se),E(t,n)}function Hp(t,e){ti(t,{position:"left",children:(n,r)=>{var s=Oe(),a=ne(s);Ke(a,()=>e.children??Se),E(n,s)},$$slots:{default:!0}})}kc();var Zp=A("<span><!></span>");function tt(t,e){let n=Pe(e,"variant",3,"default"),r=Pe(e,"size",3,"default"),s=Pe(e,"class",3,"");var a=Zp(),i=w(a);Ke(i,()=>e.children??Se),$(()=>xe(a,1,`pill ${n()??""} ${r()??""} ${s()??""}`,"svelte-1qx90go")),E(t,a)}var qp=A('<button type="button"> </button>'),Xp=A('<div class="tabs svelte-h216gr"><!> <!></div>');function Kp(t,e){W(e,!0);var n=Xp(),r=w(n);Ie(r,17,()=>e.tabs,a=>a.id,(a,i)=>{var o=qp();let l;o.__click=()=>e.onchange?.(y(i).id);var u=w(o);$(()=>{l=xe(o,1,"tab svelte-h216gr",null,l,{active:e.active===y(i).id}),P(u,y(i).label)}),E(a,o)});var s=k(r,2);Ke(s,()=>e.right??Se),E(t,n),Y()}It(["click"]);var Jp=A('<div class="icon svelte-iz1wg0"> </div>'),Wp=A('<div class="subtitle svelte-iz1wg0"> </div>'),Yp=A('<div><!> <div class="title svelte-iz1wg0"> </div> <!></div>');function ni(t,e){let n=Pe(e,"inline",3,!1);var r=Yp();let s;var a=w(r);{var i=f=>{var v=Jp(),d=w(v);$(()=>P(d,e.icon)),E(f,v)};B(a,f=>{e.icon&&f(i)})}var o=k(a,2),l=w(o),u=k(o,2);{var c=f=>{var v=Wp(),d=w(v);$(()=>P(d,e.subtitle)),E(f,v)};B(u,f=>{e.subtitle&&f(c)})}$(()=>{s=xe(r,1,"empty svelte-iz1wg0",null,s,{inline:n()}),P(l,e.title)}),E(t,r)}var Qp=A('<div class="error-row svelte-d2u0t1"> </div>'),eg=A('<div class="errors svelte-d2u0t1"></div>');function zu(t,e){W(e,!0);var n=Oe(),r=ne(n);{var s=a=>{var i=eg();Ie(i,21,()=>e.errors,o=>o.id,(o,l)=>{var u=Qp(),c=w(u);$(()=>P(c,`Warning ${y(l).message??""}`)),E(o,u)}),E(a,i)};B(r,a=>{e.errors.length>0&&a(s)})}E(t,n),Y()}var tg=A('<div class="label svelte-3qx5rh"> </div>'),ng=A('<div class="code-block svelte-3qx5rh"><!> <pre class="svelte-3qx5rh"> </pre></div>');function No(t,e){let n=Pe(e,"maxHeight",3,"100px");const r=lt(()=>typeof e.content=="string"?e.content:JSON.stringify(e.content,null,2));var s=ng(),a=w(s);{var i=u=>{var c=tg(),f=w(c);$(()=>P(f,e.label)),E(u,c)};B(a,u=>{e.label&&u(i)})}var o=k(a,2),l=w(o);$(()=>{pd(o,`max-height: ${n()??""}`),P(l,y(r))}),E(t,s)}var rg=A("<span><!></span>");function sg(t,e){var n=rg(),r=w(n);{var s=a=>{var i=ze();$(()=>P(i,e.label)),E(a,i)};B(r,a=>{e.label&&a(s)})}$(()=>xe(n,1,`status-dot ${e.status??""}`,"svelte-uw6csk")),E(t,n)}var ag=A('<button class="icon-btn svelte-hime8y"><!></button>');function ig(t,e){var n=ag();n.__click=function(...s){e.onclick?.apply(this,s)};var r=w(n);Ke(r,()=>e.children??Se),$(()=>pt(n,"title",e.title)),E(t,n)}It(["click"]);var og=A('<div class="row space-between align-center svelte-phqn1e"><div><div class="title svelte-phqn1e"> </div> <div class="muted svelte-phqn1e"> </div></div> <!></div> <div class="badges svelte-phqn1e"></div> <div class="stats-row svelte-phqn1e"><div class="stat svelte-phqn1e"><div class="stat-label svelte-phqn1e">TOOLS</div> <div class="stat-value svelte-phqn1e"> </div></div> <div class="stat svelte-phqn1e"><div class="stat-label svelte-phqn1e">FLOWS</div> <div class="stat-value svelte-phqn1e"> </div></div> <div class="stat svelte-phqn1e"><div class="stat-label svelte-phqn1e">SVCS</div> <div class="stat-value svelte-phqn1e"> </div></div></div>',1);function Ro(t,e){W(e,!1),We(),Yt(t,{class:"project-card",children:(n,r)=>{var s=og(),a=ne(s),i=w(a),o=w(i),l=w(o),u=k(o,2),c=w(u),f=k(i,2);tt(f,{variant:"subtle",children:(H,q)=>{var O=ze();$(()=>P(O,He.meta.version||He.meta.template)),E(H,O)},$$slots:{default:!0}});var v=k(a,2);Ie(v,5,()=>He.meta.flags,Al,(H,q)=>{tt(H,{variant:"ghost",children:(O,Z)=>{var Q=ze();$(()=>P(Q,y(q))),E(O,Q)},$$slots:{default:!0}})});var d=k(v,2),h=w(d),p=k(w(h),2),g=w(p),m=k(h,2),b=k(w(m),2),_=w(b),x=k(m,2),I=k(w(x),2),R=w(I);$(()=>{P(l,He.meta.name),P(c,He.meta.description),P(g,He.meta.tools),P(_,He.meta.flows),P(R,He.services.length)}),E(n,s)},$$slots:{default:!0}}),Y()}var lg=A('<div class="tabs svelte-blkyuy"><div class="tab active svelte-blkyuy">Spec YAML</div> <div class="tab svelte-blkyuy">Validation</div> <!></div> <pre class="spec-view svelte-blkyuy"> </pre> <!>',1);function Oo(t,e){W(e,!0);const n=lt(()=>it.status==="valid"?"Valid":it.status==="error"?"Errors":"Pending");Yt(t,{class:"spec-card",children:(r,s)=>{var a=lg(),i=ne(a),o=k(w(i),4);sg(o,{get status(){return it.status},get label(){return y(n)}});var l=k(i,2),u=w(l),c=k(l,2);zu(c,{get errors(){return it.errors}}),$(()=>P(u,it.content)),E(r,a)},$$slots:{default:!0}}),Y()}var ug=A('<div class="step svelte-c8zylx"><div class="step-icon svelte-c8zylx"> </div> <div class="step-label svelte-c8zylx"> </div> <div></div></div>'),cg=A('<div class="stepper svelte-c8zylx"></div>');function dg(t,e){const n=["Validation","Scaffold","Tools","Flows","Planner","Tests","Config"];var r=cg();Ie(r,22,()=>n,s=>s,(s,a,i)=>{var o=ug(),l=w(o),u=w(l),c=k(l,2),f=w(c),v=k(c,2);$(()=>{P(u,y(i)+1),P(f,a),xe(v,1,`step-status ${e.status==="valid"&&y(i)===0?"done":"pending"}`,"svelte-c8zylx")}),E(s,o)}),E(t,r)}var fg=A('<div class="button-row svelte-1q2p9y2"><button class="ghost-btn svelte-1q2p9y2">Validate</button> <button class="primary-btn svelte-1q2p9y2">Generate</button></div> <!>',1);function hg(t,e){W(e,!1);const n=async()=>{const s=await Hd(it.content);s&&it.setValidationResult(s)},r=async()=>{const s=await Zd(it.content);s===!0?it.markValid():s&&it.setGenerationErrors(s)};We(),Yt(t,{class:"generator-card",children:(s,a)=>{var i=fg(),o=ne(i),l=w(o);l.__click=n;var u=k(l,2);u.__click=r;var c=k(o,2);dg(c,{get status(){return it.status}}),E(s,i)},$$slots:{default:!0}}),Y()}It(["click"]);var vg=A('<span class="dot active svelte-1tgepr2"></span> ',1),pg=A('<div class="chat-header svelte-1tgepr2"><!> <!></div>');function gg(t,e){W(e,!1),We();var n=pg(),r=w(n);tt(r,{class:"header-pill",children:(a,i)=>{var o=vg(),l=k(ne(o));$(()=>P(l,` ${He.meta.name??""}`)),E(a,o)},$$slots:{default:!0}});var s=k(r,2);tt(s,{variant:"ghost",children:(a,i)=>{var o=ze("DEV PLAYGROUND");E(a,o)},$$slots:{default:!0}}),E(t,n),Y()}var mg=A('<details class="thinking-panel svelte-1rq07e1"><summary class="thinking-summary svelte-1rq07e1"> </summary> <div class="thinking-body svelte-1rq07e1"><div class="markdown-content"><!></div></div></details>');function _g(t,e){W(e,!0);const n=u=>{const c=u.currentTarget;e.ontoggle?.(c.open)};var r=mg(),s=w(r),a=w(s),i=k(s,2),o=w(i),l=w(o);Il(l,()=>Uu(e.observations)),$(()=>{r.open=e.open,P(a,e.isStreaming?"Thinking...":"Thought")}),nd("toggle",r,n),E(t,r),Y()}var yg=A('<a class="pause-link svelte-ehnm7n" target="_blank" rel="noreferrer">Open authorization link</a>'),bg=A('<div class="pause-token svelte-ehnm7n"> </div>'),wg=A('<div class="pause-card svelte-ehnm7n"><div class="pause-title svelte-ehnm7n">Action required</div> <!> <!> <div class="pause-meta svelte-ehnm7n"> <!></div></div>');function Eg(t,e){W(e,!0);const n=lt(()=>e.pause.payload?.auth_url||e.pause.payload?.url||""),r=lt(()=>e.pause.payload?.provider||"");var s=wg(),a=k(w(s),2);{var i=d=>{var h=yg();$(()=>pt(h,"href",y(n))),E(d,h)};B(a,d=>{y(n)&&d(i)})}var o=k(a,2);{var l=d=>{var h=bg(),p=w(h);$(()=>P(p,`Resume token: ${e.pause.resume_token??""}`)),E(d,h)};B(o,d=>{e.pause.resume_token&&d(l)})}var u=k(o,2),c=w(u),f=k(c);{var v=d=>{var h=ze();$(()=>P(h,`- provider: ${y(r)??""}`)),E(d,h)};B(f,d=>{y(r)&&d(v)})}$(()=>P(c,`${e.pause.reason?`reason: ${e.pause.reason}`:"paused"} `)),E(t,s),Y()}var kg=A('<div class="typing svelte-ln1usn"><span class="svelte-ln1usn"></span><span class="svelte-ln1usn"></span><span class="svelte-ln1usn"></span></div>');function Sg(t){var e=kg();E(t,e)}var xg=A('<span class="link svelte-bi1doc"> </span>'),Tg=A('<div><div><!> <div class="markdown-content"><!></div> <!> <!></div> <div class="meta-row svelte-bi1doc"><span> </span> <!></div></div>');function Ag(t,e){W(e,!0);let n=Pe(e,"message",7);const r=lt(()=>n().role==="agent"&&n().observations&&n().observations.trim()!=="");var s=Tg(),a=w(s),i=w(a);{var o=_=>{{let x=lt(()=>n().showObservations??!1),I=lt(()=>n().isStreaming??!1);_g(_,{get observations(){return n().observations},get open(){return y(x)},get isStreaming(){return y(I)},ontoggle:R=>{n().showObservations=R}})}};B(i,_=>{y(r)&&_(o)})}var l=k(i,2),u=w(l);Il(u,()=>Uu(n().text));var c=k(l,2);{var f=_=>{Eg(_,{get pause(){return n().pause}})};B(c,_=>{n().pause&&_(f)})}var v=k(c,2);{var d=_=>{Sg(_)};B(v,_=>{(n().isStreaming||n().isThinking)&&_(d)})}var h=k(a,2),p=w(h),g=w(p),m=k(p,2);{var b=_=>{var x=xg(),I=w(x);$(()=>P(I,`#${n().traceId??""}`)),E(_,x)};B(m,_=>{n().traceId&&_(b)})}$(_=>{xe(s,1,`message-row ${n().role==="agent"?"agent":"user"}`,"svelte-bi1doc"),xe(a,1,`bubble ${n().role}`,"svelte-bi1doc"),P(g,_)},[()=>Id(n().ts)]),E(t,s),Y()}var Ig=A('<div class="chat-body svelte-c4tup"><!></div>');function Cg(t,e){W(e,!0);let n=Pe(e,"chatBodyEl",15,null);var r=Ig(),s=w(r);{var a=o=>{ni(o,{icon:"*",title:"Ready to test agent behavior.",subtitle:"Type a message below to start a run."})},i=o=>{var l=Oe(),u=ne(l);Ie(u,17,()=>K.messages,c=>c.id,(c,f)=>{Ag(c,{get message(){return y(f)}})}),E(o,l)};B(s,o=>{K.isEmpty?o(a):o(i,!1)})}cr(r,o=>n(o),()=>n()),E(t,r),Y()}var Ng=A('<div class="chat-input svelte-1udd0hx"><textarea placeholder="Ask your agent something..." class="svelte-1udd0hx"></textarea> <button class="send-btn svelte-1udd0hx">></button></div>');function Rg(t,e){W(e,!0);const n=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),e.onsubmit())};var r=Ng(),s=w(r);s.__keydown=n;var a=k(s,2);a.__click=function(...i){e.onsubmit?.apply(this,i)},$(i=>a.disabled=i,[()=>De.isSending||!K.input.trim()]),kn(s,()=>K.input,i=>K.input=i),E(t,r),Y()}It(["keydown","click"]);const Gu=Symbol("agui");function Og(t){xc(Gu,t)}function Bu(){const t=Sc(Gu);if(!t)throw new Error("AGUIProvider not found");return t}var Mg=A('<span class="dots svelte-edlcut">...</span>'),Pg=A('<div class="result svelte-edlcut"><div class="label svelte-edlcut">Result</div> <pre class="svelte-edlcut"> </pre></div>'),Lg=A('<div><div class="header svelte-edlcut"><span class="icon svelte-edlcut">tool</span> <strong class="svelte-edlcut"> </strong> <!></div> <pre class="args svelte-edlcut"> </pre> <!></div>');function $g(t,e){W(e,!1);const n=Ss();let r=Pe(e,"toolCall",8);cl(()=>Ze(r()),()=>{N(n,(()=>{try{return JSON.parse(r().arguments)}catch{return null}})())}),dl(),We();var s=Lg();let a;var i=w(s),o=k(w(i),2),l=w(o),u=k(o,2);{var c=p=>{var g=Mg();E(p,g)};B(u,p=>{Ze(r()),ie(()=>r().isStreaming)&&p(c)})}var f=k(i,2),v=w(f),d=k(f,2);{var h=p=>{var g=Pg(),m=k(w(g),2),b=w(m);$(()=>P(b,(Ze(r()),ie(()=>r().result)))),E(p,g)};B(d,p=>{Ze(r()),ie(()=>r().result)&&p(h)})}$(p=>{a=xe(s,1,"agui-tool-call svelte-edlcut",null,a,{streaming:r().isStreaming}),P(l,(Ze(r()),ie(()=>r().name))),P(v,`${p??""}
  `)},[()=>(y(n),Ze(r()),ie(()=>y(n)?JSON.stringify(y(n),null,2):r().arguments))]),E(t,s),Y()}var Dg=A('<span class="cursor svelte-z6xl22">|</span>'),Ug=A('<div class="agui-tool-calls svelte-z6xl22"></div>'),zg=A('<div><div><div class="agui-role svelte-z6xl22"> </div> <div class="agui-message-content svelte-z6xl22"> <!></div> <!></div></div>');function Gg(t,e){W(e,!1);let n=Pe(e,"message",8);We();var r=zg(),s=w(r),a=w(s),i=w(a),o=k(a,2),l=w(o),u=k(l);{var c=d=>{var h=Dg();E(d,h)};B(u,d=>{Ze(n()),ie(()=>n().isStreaming)&&d(c)})}var f=k(o,2);{var v=d=>{var h=Ug();Ie(h,5,()=>(Ze(n()),ie(()=>n().toolCalls)),p=>p.id,(p,g)=>{$g(p,{get toolCall(){return y(g)}})}),E(d,h)};B(f,d=>{Ze(n()),ie(()=>n().toolCalls.length>0)&&d(v)})}$(()=>{xe(r,1,(Ze(n()),ie(()=>`agui-message-row ${n().role==="user"?"user":"assistant"}`)),"svelte-z6xl22"),xe(s,1,(Ze(n()),ie(()=>`agui-bubble ${n().role==="user"?"user":"assistant"}`)),"svelte-z6xl22"),P(i,(Ze(n()),ie(()=>n().role))),P(l,(Ze(n()),ie(()=>n().content)))}),E(t,r),Y()}var Bg=A('<p class="agui-empty svelte-18i48bq">No messages yet</p>'),Fg=A('<div class="agui-message-list svelte-18i48bq"><!> <!></div>');function Vg(t,e){W(e,!1);const n=()=>er(a,"$messages",r),[r,s]=Nl(),{messages:a}=Bu();let i=Ss();cl(()=>(n(),y(i)),()=>{n().length&&y(i)&&requestAnimationFrame(()=>{y(i)&&Uc(i,y(i).scrollTop=y(i).scrollHeight)})}),dl(),We();var o=Fg(),l=w(o);Ie(l,1,n,f=>f.id,(f,v)=>{Gg(f,{get message(){return y(v)}})});var u=k(l,2);{var c=f=>{var v=Oe(),d=ne(v);fd(d,e,"empty",{},h=>{var p=Bg();E(h,p)}),E(f,v)};B(u,f=>{n(),ie(()=>n().length===0)&&f(c)})}cr(o,f=>N(i,f),()=>y(i)),E(t,o),Y(),s()}var jg=A("<li> </li>"),Hg=A('<section class="svelte-1u8fhbt"><h4 class="svelte-1u8fhbt">Active Steps</h4> <ul class="svelte-1u8fhbt"></ul></section>'),Zg=A('<section class="error svelte-1u8fhbt"><h4 class="svelte-1u8fhbt">Error</h4> <pre class="svelte-1u8fhbt"> </pre></section>'),qg=A('<details class="agui-debugger svelte-1u8fhbt"><summary class="svelte-1u8fhbt">AG-UI Debug <span> </span></summary> <div class="content svelte-1u8fhbt"><section class="svelte-1u8fhbt"><h4 class="svelte-1u8fhbt">Thread / Run</h4> <code class="svelte-1u8fhbt"> </code></section> <!> <section class="svelte-1u8fhbt"><h4 class="svelte-1u8fhbt">Agent State</h4> <pre class="svelte-1u8fhbt"> </pre></section> <!></div></details>');function Xg(t,e){W(e,!1);const n=()=>er(u,"$status",i),r=()=>er(l,"$state",i),s=()=>er(f,"$activeSteps",i),a=()=>er(c,"$agentState",i),[i,o]=Nl(),{state:l,status:u,agentState:c,activeSteps:f}=Bu();let v=Pe(e,"expanded",12,!1);We();var d=qg(),h=w(d),p=k(w(h));let g;var m=w(p),b=k(h,2),_=w(b),x=k(w(_),2),I=w(x),R=k(_,2);{var H=_e=>{var Ce=Hg(),nt=k(w(Ce),2);Ie(nt,5,s,Al,(ct,_r)=>{var ri=jg(),Zu=w(ri);$(()=>P(Zu,(y(_r),ie(()=>y(_r).name)))),E(ct,ri)}),E(_e,Ce)};B(R,_e=>{s(),ie(()=>s().length>0)&&_e(H)})}var q=k(R,2),O=k(w(q),2),Z=w(O),Q=k(q,2);{var ve=_e=>{var Ce=Zg(),nt=k(w(Ce),2),ct=w(nt);$(_r=>P(ct,_r),[()=>(r(),ie(()=>JSON.stringify(r().error,null,2)))]),E(_e,Ce)};B(Q,_e=>{r(),ie(()=>r().error)&&_e(ve)})}$(_e=>{g=xe(p,1,"status svelte-1u8fhbt",null,g,{running:n()==="running",error:n()==="error"}),P(m,n()),P(I,`${r(),ie(()=>r().threadId??"â")??""} / ${r(),ie(()=>r().runId??"â")??""}`),P(Z,_e)},[()=>(a(),ie(()=>JSON.stringify(a(),null,2)))]),wd("open","toggle",d,v,v),E(t,d),Y(),o()}var Kg=A('<div class="muted tiny svelte-1oeq91f"> </div>'),Jg=A('<div><div class="label svelte-1oeq91f"> </div> <!> <!></div>');function En(t,e){let n=Pe(e,"full",3,!1);var r=Jg();let s;var a=w(r),i=w(a),o=k(a,2);Ke(o,()=>e.children??Se);var l=k(o,2);{var u=c=>{var f=Kg(),v=w(f);$(()=>P(v,e.hint)),E(c,f)};B(l,c=>{e.hint&&c(u)})}$(()=>{s=xe(r,1,"setup-field svelte-1oeq91f",null,s,{full:n()}),P(i,e.label)}),E(t,r)}var Sr=La(()=>De),Ae=La(()=>Tr),Wg=A('<div class="row gap svelte-16jzvak"><input class="setup-input svelte-16jzvak"/> <button class="ghost-btn small svelte-16jzvak">New</button></div>'),Yg=A('<input class="setup-input svelte-16jzvak"/>'),Qg=A('<input class="setup-input svelte-16jzvak"/>'),em=A('<textarea class="setup-textarea svelte-16jzvak"></textarea>'),tm=A('<textarea class="setup-textarea svelte-16jzvak"></textarea>'),nm=A('<label class="toggle-row svelte-16jzvak"><input class="toggle-input svelte-16jzvak" type="checkbox"/> <span>Use AG-UI</span></label>'),rm=A('<div class="agui-preview svelte-16jzvak"><div class="agui-preview-title svelte-16jzvak">AG-UI Preview</div> <!> <!></div>'),sm=A('<div class="setup-body svelte-16jzvak"><div class="setup-grid svelte-16jzvak"><!> <!> <!> <!> <!> <!></div> <!> <!></div>');function am(t,e){W(e,!1);const n={messages:Xn([{id:"preview-msg",role:"assistant",content:"AG-UI preview message with a tool call.",isStreaming:!1,toolCalls:[{id:"preview-call",name:"search",arguments:'{"query":"preview"}',isStreaming:!1,result:"ok"}]}]),state:Xn({status:"idle",threadId:"preview-thread",runId:"preview-run",messages:[],agentState:{mode:"preview"},activeSteps:[],error:null}),status:Xn("idle"),agentState:Xn({mode:"preview"}),activeSteps:Xn([])};Og(n),We();var r=sm(),s=w(r),a=w(s);En(a,{label:"Session ID",hint:"Used to scope short-term memory and trajectory lookups.",children:(p,g)=>{var m=Wg(),b=w(m),_=k(b,2);_.__click=()=>{Sr().newSession(),Ut.clear(),mt.clear()},kn(b,()=>Sr().sessionId,x=>Sr(Sr().sessionId=x)),E(p,m)},$$slots:{default:!0}});var i=k(a,2);En(i,{label:"Tenant ID",children:(p,g)=>{var m=Yg();kn(m,()=>Ae().tenantId,b=>Ae(Ae().tenantId=b)),E(p,m)},$$slots:{default:!0}});var o=k(i,2);En(o,{label:"User ID",children:(p,g)=>{var m=Qg();kn(m,()=>Ae().userId,b=>Ae(Ae().userId=b)),E(p,m)},$$slots:{default:!0}});var l=k(o,2);En(l,{label:"Tool Context (JSON)",hint:"Merged with tenant/user and injected as runtime tool_context.",full:!0,children:(p,g)=>{var m=em();pt(m,"placeholder",'{"any_runtime_key": "value"}'),kn(m,()=>Ae().toolContextRaw,b=>Ae(Ae().toolContextRaw=b)),E(p,m)},$$slots:{default:!0}});var u=k(l,2);En(u,{label:"LLM Context (JSON)",hint:"Only used when the playground wraps a planner entry point.",full:!0,children:(p,g)=>{var m=tm();pt(m,"placeholder","{}"),kn(m,()=>Ae().llmContextRaw,b=>Ae(Ae().llmContextRaw=b)),E(p,m)},$$slots:{default:!0}});var c=k(u,2);En(c,{label:"Streaming Protocol",hint:"Enable AG-UI streaming for the playground.",full:!0,children:(p,g)=>{var m=nm(),b=w(m);bd(b,()=>Ae().useAgui,_=>Ae(Ae().useAgui=_)),E(p,m)},$$slots:{default:!0}});var f=k(s,2);{var v=p=>{{let g=ks(()=>[{id:"setup-err",message:Ae().error}]);zu(p,{get errors(){return y(g)}})}};B(f,p=>{Ae().error&&p(v)})}var d=k(f,2);{var h=p=>{var g=rm(),m=k(w(g),2);Vg(m,{});var b=k(m,2);Xg(b,{}),E(p,g)};B(d,p=>{Ae().useAgui&&p(h)})}E(t,r),Y()}It(["click"]);var im=A("<!> <!>",1),om=A("<!> <!> <!>",1);function Fu(t,e){W(e,!0);let n=Pe(e,"chatBodyEl",15,null),r=j("chat");const s=[{id:"chat",label:"Chat"},{id:"setup",label:"Setup"}];var i={switchToSetup:()=>{N(r,"setup")}};return Yt(t,{class:"chat-card",children:(o,l)=>{var u=om(),c=ne(u);gg(c,{});var f=k(c,2);Kp(f,{get tabs(){return s},get active(){return y(r)},onchange:p=>{N(r,p,!0)}});var v=k(f,2);{var d=p=>{am(p,{})},h=p=>{var g=im(),m=ne(g);Cg(m,{get chatBodyEl(){return n()},set chatBodyEl(_){n(_)}});var b=k(m,2);Rg(b,{get onsubmit(){return e.onSendChat}}),E(p,g)};B(v,p=>{y(r)==="setup"?p(d):p(h,!1)})}E(o,u)},$$slots:{default:!0}}),Y(i)}var lm=A('<details class="svelte-3cnmkg"><summary class="svelte-3cnmkg">Details</summary> <!> <!></details>');function um(t,e){var n=lm(),r=k(w(n),2);{var s=o=>{No(o,{label:"args",get content(){return e.args}})};B(r,o=>{e.args&&o(s)})}var a=k(r,2);{var i=o=>{No(o,{label:"result",get content(){return e.result}})};B(a,o=>{e.result&&o(i)})}E(t,n)}var cm=A('<div class="thought svelte-1q94eug"> </div>'),dm=A('<div class="timeline-item svelte-1q94eug"><div class="line svelte-1q94eug"></div> <div></div> <div class="timeline-body svelte-1q94eug"><div class="row space-between align-center svelte-1q94eug"><div class="step-name svelte-1q94eug"> </div> <!></div> <!> <!></div></div>');function fm(t,e){W(e,!0);var n=dm(),r=k(w(n),2),s=k(r,2),a=w(s),i=w(a),o=w(i),l=k(i,2);{var u=d=>{tt(d,{variant:"subtle",size:"small",children:(h,p)=>{var g=ze();$(()=>P(g,`${e.step.latencyMs??""} ms`)),E(h,g)},$$slots:{default:!0}})};B(l,d=>{e.step.latencyMs&&d(u)})}var c=k(a,2);{var f=d=>{var h=cm(),p=w(h);$(()=>P(p,`"${e.step.thought??""}"`)),E(d,h)};B(c,d=>{e.step.thought&&d(f)})}var v=k(c,2);um(v,{get args(){return e.step.args},get result(){return e.step.result}}),$(()=>{xe(r,1,`dot ${e.step.status??""}`,"svelte-1q94eug"),P(o,e.step.name)}),E(t,n),Y()}var hm=A('<div class="timeline svelte-u1561"></div>');function vm(t,e){var n=hm();Ie(n,21,()=>e.steps,r=>r.id,(r,s)=>{fm(r,{get step(){return y(s)}})}),E(t,n)}var pm=A('<div class="trajectory-header svelte-1gi8nfl"><div class="title-small svelte-1gi8nfl">Execution Trajectory</div> <!></div> <!>',1);function Vu(t,e){W(e,!1),We(),Yt(t,{class:"trajectory-card",children:(n,r)=>{var s=pm(),a=ne(s),i=k(w(a),2);{var o=f=>{tt(f,{variant:"subtle",size:"small",children:(v,d)=>{var h=ze();$(p=>P(h,`trace ${p??""}`),[()=>De.activeTraceId.slice(0,8)]),E(v,h)},$$slots:{default:!0}})};B(i,f=>{De.activeTraceId&&f(o)})}var l=k(a,2);{var u=f=>{ni(f,{inline:!0,title:"No trajectory yet",subtitle:"Send a prompt to see steps."})},c=f=>{var v=Oe(),d=ne(v);ld(d,()=>De.activeTraceId,h=>{vm(h,{get steps(){return Ut.steps}})}),E(f,v)};B(l,f=>{Ut.isEmpty?f(u):f(c,!1)})}E(n,s)},$$slots:{default:!0}}),Y()}var gm=A("<!> <!>",1);function mm(t,e){W(e,!0);let n=Pe(e,"chatBodyEl",15,null),r;var a={switchToSetup:()=>{r?.switchToSetup()}};return ti(t,{position:"center",children:(i,o)=>{var l=gm(),u=ne(l);cr(Fu(u,{get onSendChat(){return e.onSendChat},get chatBodyEl(){return n()},set chatBodyEl(f){n(f)}}),f=>r=f,()=>r);var c=k(u,2);Vu(c,{}),E(i,l)},$$slots:{default:!0}}),Y(a)}var Yn=La(()=>mt),_m=A('<div class="events-header svelte-vdaagi"><div class="title-small svelte-vdaagi">Planner Events</div> <div class="icon-row svelte-vdaagi"><!> <select class="filter svelte-vdaagi"><option>All</option><option>step</option><option>event</option><option>chunk</option><option>artifact_chunk</option></select></div></div>');function ym(t,e){W(e,!1),We();var n=_m(),r=k(w(n),2),s=w(r);ig(s,{onclick:()=>{Yn(Yn().paused=!Yn().paused)},children:(f,v)=>{var d=ze();$(()=>P(d,Yn().paused?">":"||")),E(f,d)}});var a=k(s,2);a.__change=f=>{const v=f.currentTarget.value;Yn().setFilter(v||null)};var i=w(a);i.value=i.__value="";var o=k(i);o.value=o.__value="step";var l=k(o);l.value=l.__value="event";var u=k(l);u.value=u.__value="chunk";var c=k(u);c.value=c.__value="artifact_chunk",E(t,n),Y()}It(["change"]);var bm=A('<div class="event-desc svelte-46sgva"> </div>'),wm=A('<div class="event-detail svelte-46sgva"><span class="label svelte-46sgva">Args:</span> </div>'),Em=A('<div class="event-detail svelte-46sgva"><span class="label svelte-46sgva">Result:</span> </div>'),km=A('<div><div class="event-icon svelte-46sgva"> </div> <div class="event-main svelte-46sgva"><div class="event-header svelte-46sgva"><span class="event-name svelte-46sgva"> </span> <!></div> <!> <!> <!></div> <!></div>');function Sm(t,e){W(e,!0);let n=Pe(e,"alt",3,!1);const r={step:{icon:"â¶",variant:"ghost"},tool_call:{icon:"ð§",variant:"subtle"},artifact:{icon:"ð",variant:"accent"},other:{icon:"â¢",variant:"ghost"}};let s=lt(()=>r[e.event.type]??r.other);function a(O){return O?O<1e3?`${O.toFixed(0)}ms`:`${(O/1e3).toFixed(2)}s`:""}var i=km();let o;var l=w(i),u=w(l),c=k(l,2),f=w(c),v=w(f),d=w(v),h=k(v,2);{var p=O=>{tt(O,{variant:"subtle",size:"small",children:(Z,Q)=>{var ve=ze("tool");E(Z,ve)},$$slots:{default:!0}})},g=O=>{var Z=Oe(),Q=ne(Z);{var ve=_e=>{tt(_e,{variant:"accent",size:"small",children:(Ce,nt)=>{var ct=ze("artifact");E(Ce,ct)},$$slots:{default:!0}})};B(Q,_e=>{e.event.type==="artifact"&&_e(ve)},!0)}E(O,Z)};B(h,O=>{e.event.type==="tool_call"?O(p):O(g,!1)})}var m=k(f,2);{var b=O=>{var Z=bm(),Q=w(Z);$(()=>P(Q,e.event.description)),E(O,Z)};B(m,O=>{e.event.description&&O(b)})}var _=k(m,2);{var x=O=>{var Z=wm(),Q=k(w(Z));$(()=>P(Q,` ${e.event.args??""}`)),E(O,Z)};B(_,O=>{e.event.type==="tool_call"&&e.event.args&&O(x)})}var I=k(_,2);{var R=O=>{var Z=Em(),Q=k(w(Z));$(()=>P(Q,` ${e.event.result??""}`)),E(O,Z)};B(I,O=>{e.event.type==="tool_call"&&e.event.result&&O(R)})}var H=k(c,2);{var q=O=>{tt(O,{variant:"subtle",size:"small",children:(Z,Q)=>{var ve=ze();$(_e=>P(ve,_e),[()=>a(e.event.duration_ms)]),E(Z,ve)},$$slots:{default:!0}})};B(H,O=>{e.event.duration_ms&&O(q)})}$(()=>{o=xe(i,1,"event-row svelte-46sgva",null,o,{alt:n()}),P(u,y(s).icon),P(d,e.event.name)}),E(t,i),Y()}var xm=A('<div class="events-body svelte-tomhw3"><!></div>');function Tm(t,e){W(e,!0);let n=lt(()=>mt.displayEvents);var r=xm(),s=w(r);{var a=o=>{ni(o,{inline:!0,title:"No events yet",subtitle:"Events will appear during runs."})},i=o=>{var l=Oe(),u=ne(l);Ie(u,19,()=>y(n),c=>c.id,(c,f,v)=>{{let d=lt(()=>y(v)%2===0);Sm(c,{get event(){return y(f)},get alt(){return y(d)}})}}),E(o,l)};B(s,o=>{y(n).length===0?o(a):o(i,!1)})}E(t,r),Y()}var Am=A('<div class="artifact-row svelte-17c7jtz"><!> <pre class="svelte-17c7jtz"> </pre></div>'),Im=A('<div class="section svelte-17c7jtz"><div class="title-small svelte-17c7jtz">Artifact Streams</div> <!></div>');function Cm(t,e){W(e,!1),We();var n=Oe(),r=ne(n);{var s=a=>{var i=Im(),o=k(w(i),2);Ie(o,1,()=>Object.entries(Ut.artifactStreams),([l,u])=>l,(l,u)=>{var c=lt(()=>Wu(y(u),2));let f=()=>y(c)[0],v=()=>y(c)[1];var d=Am(),h=w(d);tt(h,{variant:"ghost",size:"small",children:(m,b)=>{var _=ze();$(()=>P(_,f())),E(m,_)},$$slots:{default:!0}});var p=k(h,2),g=w(p);$(m=>P(g,m),[()=>JSON.stringify(v()[v().length-1],null,2)]),E(l,d)}),E(a,i)};B(r,a=>{Ut.hasArtifacts&&a(s)})}E(t,n),Y()}var Nm=A("<!> <!> <!>",1);function ju(t){Yt(t,{class:"events-card",children:(e,n)=>{var r=Nm(),s=ne(r);ym(s,{});var a=k(s,2);Tm(a,{});var i=k(a,2);Cm(i,{}),E(e,r)},$$slots:{default:!0}})}var Rm=A('<span class="spinner svelte-hcf6pj"></span>'),Om=sd('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 12L3 7L4.4 5.55L7 8.15V1H9V8.15L11.6 5.55L13 7L8 12Z" fill="currentColor"></path><path d="M2 14V11H4V13H12V11H14V14C14 14.55 13.55 15 13 15H3C2.45 15 2 14.55 2 14Z" fill="currentColor"></path></svg>'),Mm=A('<span class="artifact-error svelte-hcf6pj" role="alert"> </span>'),Pm=A('<div class="artifact-item svelte-hcf6pj"><div class="artifact-info svelte-hcf6pj"><span class="artifact-icon svelte-hcf6pj"></span> <div class="artifact-details svelte-hcf6pj"><span class="artifact-name svelte-hcf6pj"> </span> <span class="artifact-meta svelte-hcf6pj"> <!></span></div></div> <button type="button" class="download-btn svelte-hcf6pj"><!></button> <!></div>');function Lm(t,e){W(e,!0);let n=j(!1),r=j(null);async function s(){N(n,!0),N(r,null);try{await Ol(e.artifact.id,De.sessionId,e.artifact.filename??void 0)}catch(I){N(r,I instanceof Error?I.message:"Download failed",!0)}finally{N(n,!1)}}var a=Pm(),i=w(a),o=w(i),l=k(o,2),u=w(l),c=w(u),f=k(u,2),v=w(f),d=k(v);{var h=I=>{tt(I,{size:"small",variant:"subtle",children:(R,H)=>{var q=ze();$(O=>P(q,O),[()=>Rd(e.artifact.mime_type)]),E(R,q)},$$slots:{default:!0}})};B(d,I=>{e.artifact.mime_type&&I(h)})}var p=k(i,2);p.__click=s;var g=w(p);{var m=I=>{var R=Rm();E(I,R)},b=I=>{var R=Om();E(I,R)};B(g,I=>{y(n)?I(m):I(b,!1)})}var _=k(p,2);{var x=I=>{var R=Mm(),H=w(R);$(()=>P(H,y(r))),E(I,R)};B(_,I=>{y(r)&&I(x)})}$((I,R)=>{pt(o,"data-type",I),pt(u,"title",e.artifact.filename||e.artifact.id),P(c,e.artifact.filename||e.artifact.id),P(v,`${R??""} `),pt(p,"title",y(n)?"Downloading...":"Download"),p.disabled=y(n),pt(p,"aria-label",y(n)?"Downloading":`Download ${e.artifact.filename||"artifact"}`)},[()=>Nd(e.artifact.mime_type),()=>Cd(e.artifact.size_bytes)]),E(t,a),Y()}It(["click"]);var $m=A('<span class="count-badge svelte-146xw4l"> </span>'),Dm=A('<span class="spinner svelte-146xw4l"></span> Downloading...',1),Um=A('<button type="button" class="download-all-btn svelte-146xw4l"><!></button>'),zm=A('<p class="no-artifacts svelte-146xw4l">No artifacts yet. Artifacts will appear here when tools generate downloadable files.</p>'),Gm=A('<div class="artifacts-list svelte-146xw4l"></div>'),Bm=A('<div class="artifacts-header svelte-146xw4l"><h3 class="artifacts-title svelte-146xw4l">Artifacts <!></h3> <!></div> <div class="artifacts-body svelte-146xw4l"><!></div>',1);function Hu(t,e){W(e,!0);let n=j(!1);async function r(){N(n,!0);for(const s of ft.list)try{await Ol(s.id,De.sessionId,s.filename??void 0),await new Promise(a=>setTimeout(a,300))}catch{}N(n,!1)}Yt(t,{class:"artifacts-card",children:(s,a)=>{var i=Bm(),o=ne(i),l=w(o),u=k(w(l));{var c=m=>{var b=$m(),_=w(b);$(()=>P(_,ft.count)),E(m,b)};B(u,m=>{ft.count>0&&m(c)})}var f=k(l,2);{var v=m=>{var b=Um();b.__click=r;var _=w(b);{var x=R=>{var H=Dm();E(R,H)},I=R=>{var H=ze("Download All");E(R,H)};B(_,R=>{y(n)?R(x):R(I,!1)})}$(()=>{b.disabled=y(n),pt(b,"aria-label",y(n)?"Downloading all artifacts":"Download all artifacts")}),E(m,b)};B(f,m=>{ft.count>1&&m(v)})}var d=k(o,2),h=w(d);{var p=m=>{var b=zm();E(m,b)},g=m=>{var b=Gm();Ie(b,21,()=>ft.list,_=>_.id,(_,x)=>{Lm(_,{get artifact(){return y(x)}})}),E(m,b)};B(h,m=>{ft.count===0?m(p):m(g,!1)})}E(s,i)},$$slots:{default:!0}}),Y()}It(["click"]);var Fm=A("<!> <!>",1);function Vm(t){ti(t,{position:"right",children:(e,n)=>{var r=Fm(),s=ne(r);ju(s);var a=k(s,2);Hu(a,{}),E(e,r)},$$slots:{default:!0}})}var jm=A('<div class="tile svelte-yij9w2"><div class="tile-label svelte-yij9w2"> </div> <div class="tile-value svelte-yij9w2"> </div></div>'),Hm=A('<div class="section svelte-yij9w2"><div class="section-label svelte-yij9w2">Planner Config</div> <div class="tile-grid svelte-yij9w2"></div></div>');function Zm(t,e){W(e,!1),We();var n=Hm(),r=k(w(n),2);Ie(r,5,()=>He.plannerConfig,s=>s.label,(s,a)=>{var i=jm(),o=w(i),l=w(o),u=k(o,2),c=w(u);$(()=>{P(l,y(a).label),P(c,y(a).value)}),E(s,i)}),E(t,n),Y()}var qm=A('<div class="service-row svelte-1fus6ji"><div><div class="service-name svelte-1fus6ji"> </div> <div class="muted tiny svelte-1fus6ji"> </div></div> <!></div>');function Xm(t,e){W(e,!0);var n=qm(),r=w(n),s=w(r),a=w(s),i=k(s,2),o=w(i),l=k(r,2);{let u=lt(()=>e.service.status==="enabled"?"subtle":"ghost");tt(l,{get variant(){return y(u)},size:"small",children:(c,f)=>{var v=ze();$(()=>P(v,e.service.status)),E(c,v)},$$slots:{default:!0}})}$(()=>{P(a,e.service.name),P(o,e.service.url||"not configured")}),E(t,n),Y()}var Km=A('<div class="section svelte-9sgnru"><div class="section-label svelte-9sgnru">Services</div> <!></div>');function Jm(t,e){W(e,!1),We();var n=Km(),r=k(w(n),2);Ie(r,1,()=>He.services,s=>s.name,(s,a)=>{Xm(s,{get service(){return y(a)}})}),E(t,n),Y()}var Wm=A('<div class="tool-row svelte-pqsxex"><div><div class="tool-name svelte-pqsxex"> </div> <div class="muted tiny svelte-pqsxex"> </div></div> <div class="tag-row svelte-pqsxex"></div></div>');function Ym(t,e){W(e,!0);var n=Wm(),r=w(n),s=w(r),a=w(s),i=k(s,2),o=w(i),l=k(r,2);Ie(l,23,()=>e.tool.tags,(u,c)=>`${e.tool.name}-${c}`,(u,c)=>{tt(u,{variant:"ghost",size:"small",children:(f,v)=>{var d=ze();$(()=>P(d,y(c))),E(f,d)},$$slots:{default:!0}})}),$(()=>{P(a,e.tool.name),P(o,e.tool.desc)}),E(t,n),Y()}var Qm=A('<div class="section svelte-1350a93"><div class="section-label svelte-1350a93">Tool Catalog</div> <!></div>');function e_(t,e){W(e,!1),We();var n=Qm(),r=k(w(n),2);Ie(r,1,()=>He.catalog,s=>s.name,(s,a)=>{Ym(s,{get tool(){return y(a)}})}),E(t,n),Y()}var t_=A('<div class="title-small svelte-14inupv">Config & Catalog</div> <!> <!> <!>',1);function Mo(t){Yt(t,{class:"config-card",children:(e,n)=>{var r=t_(),s=k(ne(r),2);Zm(s,{});var a=k(s,2);Jm(a,{});var i=k(a,2);e_(i,{}),E(e,r)},$$slots:{default:!0}})}var n_=A('<button type="button"> </button>'),r_=A('<div class="drawer svelte-ff3his"><div class="drawer-tabs svelte-ff3his"></div> <div class="drawer-content svelte-ff3his"><!></div></div>'),s_=A('<button type="button" class="backdrop svelte-ff3his" aria-label="Close menu"></button>'),a_=A('<header class="mobile-header svelte-ff3his"><div class="header-bar svelte-ff3his"><button type="button" class="menu-btn svelte-ff3his" aria-label="Toggle menu"><span><span class="svelte-ff3his"></span> <span class="svelte-ff3his"></span> <span class="svelte-ff3his"></span></span></button> <h1 class="agent-name svelte-ff3his"> </h1> <div class="header-spacer svelte-ff3his"></div></div> <!></header> <!>',1);function i_(t,e){W(e,!0);let n=j(!1),r=j("info");const s=[{id:"info",label:"Info"},{id:"spec",label:"Spec"},{id:"config",label:"Config"}],a=()=>{N(n,!1)};var i=a_(),o=ne(i),l=w(o),u=w(l);u.__click=()=>N(n,!y(n));var c=w(u);let f;var v=k(u,2),d=w(v),h=k(l,2);{var p=b=>{var _=r_(),x=w(_);Ie(x,21,()=>s,O=>O.id,(O,Z)=>{var Q=n_();let ve;Q.__click=()=>N(r,y(Z).id,!0);var _e=w(Q);$(()=>{ve=xe(Q,1,"drawer-tab svelte-ff3his",null,ve,{active:y(r)===y(Z).id}),P(_e,y(Z).label)}),E(O,Q)});var I=k(x,2),R=w(I);{var H=O=>{var Z=Oe(),Q=ne(Z);Ke(Q,()=>e.infoContent??Se),E(O,Z)},q=O=>{var Z=Oe(),Q=ne(Z);{var ve=Ce=>{var nt=Oe(),ct=ne(nt);Ke(ct,()=>e.specContent??Se),E(Ce,nt)},_e=Ce=>{var nt=Oe(),ct=ne(nt);Ke(ct,()=>e.configContent??Se),E(Ce,nt)};B(Q,Ce=>{y(r)==="spec"?Ce(ve):Ce(_e,!1)},!0)}E(O,Z)};B(R,O=>{y(r)==="info"?O(H):O(q,!1)})}E(b,_)};B(h,b=>{y(n)&&b(p)})}var g=k(o,2);{var m=b=>{var _=s_();_.__click=a,E(b,_)};B(g,b=>{y(n)&&b(m)})}$(()=>{f=xe(c,1,"hamburger svelte-ff3his",null,f,{open:y(n)}),P(d,He.meta.name)}),E(t,i),Y()}It(["click"]);var o_=A('<button type="button"> </button>'),l_=A('<div class="panel-tabs svelte-1gv7cuo"></div> <div class="panel-content svelte-1gv7cuo"><!></div>',1),u_=A('<div><button type="button" class="toggle-bar svelte-1gv7cuo"><div class="toggle-handle svelte-1gv7cuo"></div> <span class="toggle-label svelte-1gv7cuo"> </span></button> <!></div>');function c_(t,e){let n=j(!1),r=j("trajectory");const s=[{id:"trajectory",label:"Steps"},{id:"events",label:"Events"},{id:"artifacts",label:"Artifacts"}];var a=u_();let i;var o=w(a);o.__click=()=>N(n,!y(n));var l=k(w(o),2),u=w(l),c=k(o,2);{var f=v=>{var d=l_(),h=ne(d);Ie(h,21,()=>s,_=>_.id,(_,x)=>{var I=o_();let R;I.__click=()=>N(r,y(x).id,!0);var H=w(I);$(()=>{R=xe(I,1,"panel-tab svelte-1gv7cuo",null,R,{active:y(r)===y(x).id}),P(H,y(x).label)}),E(_,I)});var p=k(h,2),g=w(p);{var m=_=>{var x=Oe(),I=ne(x);Ke(I,()=>e.trajectoryContent??Se),E(_,x)},b=_=>{var x=Oe(),I=ne(x);{var R=q=>{var O=Oe(),Z=ne(O);Ke(Z,()=>e.eventsContent??Se),E(q,O)},H=q=>{var O=Oe(),Z=ne(O);Ke(Z,()=>e.artifactsContent??Se),E(q,O)};B(I,q=>{y(r)==="events"?q(R):q(H,!1)},!0)}E(_,x)};B(g,_=>{y(r)==="trajectory"?_(m):_(b,!1)})}E(v,d)};B(c,v=>{y(n)&&v(f)})}$(()=>{i=xe(a,1,"bottom-panel svelte-1gv7cuo",null,i,{open:y(n)}),pt(o,"aria-label",y(n)?"Hide details panel":"Show details panel"),pt(o,"aria-expanded",y(n)),P(u,y(n)?"Hide Details":"Show Details")}),E(t,a)}It(["click"]);var d_=A('<div class="mobile-layout svelte-1n46o8q"><!> <main class="mobile-main svelte-1n46o8q"><!></main> <!></div>'),f_=A("<!> <!> <!> <!>",1),h_=A("<!> <!> <!>",1);function v_(t,e){W(e,!0);let n=j(null),r=j(void 0),s=j(void 0),a=j(!1);const i=()=>{N(a,window.innerWidth<=1200)};Qr(()=>{K.messages.length;const d=K.messages.find(h=>h.isStreaming);d&&`${d.text}${d.observations??""}`,y(n)&&requestAnimationFrame(()=>{y(n)&&(y(n).scrollTop=y(n).scrollHeight)})}),xd(()=>(i(),window.addEventListener("resize",i),o(),()=>{window.removeEventListener("resize",i),Eo.close(),ko.close()}));const o=async()=>{const[d,h]=await Promise.all([Vd(),jd()]);d&&He.setFromResponse(d),h&&it.setFromSpecData(h)},l=()=>{const d=K.input.trim();if(!d||De.isSending)return;Tr.clearError();const h=Tr.parseContexts();if(!h){y(a)?y(s)?.switchToSetup():y(r)?.switchToSetup();return}const{toolContext:p,llmContext:g}=h;De.isSending=!0,Ut.clearArtifacts(),K.addUserMessage(d),K.clearInput(),Eo.start(d,De.sessionId,p,g,{onDone:async m=>{if(De.activeTraceId=m,m){const b=await qd(m,De.sessionId);b&&De.activeTraceId===m&&Ut.setFromPayload(b),ko.start(m,De.sessionId)}De.isSending=!1},onError:()=>{De.isSending=!1}},Tr.useAgui?"agui":"sse")};var u=Oe(),c=ne(u);{var f=d=>{var h=d_(),p=w(h);i_(p,{infoContent:R=>{Ro(R,{})},specContent:R=>{Oo(R,{})},configContent:R=>{Mo(R)},$$slots:{infoContent:!0,specContent:!0,configContent:!0}});var g=k(p,2),m=w(g);cr(Fu(m,{onSendChat:l,get chatBodyEl(){return y(n)},set chatBodyEl(_){N(n,_,!0)}}),_=>N(s,_,!0),()=>y(s));var b=k(g,2);c_(b,{trajectoryContent:R=>{Vu(R,{})},eventsContent:R=>{ju(R)},artifactsContent:R=>{Hu(R,{})}}),E(d,h)},v=d=>{jp(d,{children:(h,p)=>{var g=h_(),m=ne(g);Hp(m,{children:(x,I)=>{var R=f_(),H=ne(R);Ro(H,{});var q=k(H,2);Oo(q,{});var O=k(q,2);hg(O,{});var Z=k(O,2);Mo(Z),E(x,R)}});var b=k(m,2);cr(mm(b,{onSendChat:l,get chatBodyEl(){return y(n)},set chatBodyEl(x){N(n,x,!0)}}),x=>N(r,x,!0),()=>y(r));var _=k(b,2);Vm(_),E(h,g)}})};B(c,d=>{y(a)?d(f):d(v,!1)})}E(t,u),Y()}ad(v_,{target:document.getElementById("app")});
